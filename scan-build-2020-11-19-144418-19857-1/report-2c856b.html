<!doctype html>
<html>
<head>
<title>./cache.h</title>

<style type="text/css">
body { color:#000000; background-color:#ffffff }
body { font-family:Helvetica, sans-serif; font-size:10pt }
h1 { font-size:14pt }
.FileName { margin-top: 5px; margin-bottom: 5px; display: inline; }
.FileNav { margin-left: 5px; margin-right: 5px; display: inline; }
.FileNav a { text-decoration:none; font-size: larger; }
.divider { margin-top: 30px; margin-bottom: 30px; height: 15px; }
.divider { background-color: gray; }
.code { border-collapse:collapse; width:100%; }
.code { font-family: "Monospace", monospace; font-size:10pt }
.code { line-height: 1.2em }
.comment { color: green; font-style: oblique }
.keyword { color: blue }
.string_literal { color: red }
.directive { color: darkmagenta }

/* Macros and variables could have pop-up notes hidden by default.
  - Macro pop-up:    expansion of the macro
  - Variable pop-up: value (table) of the variable */
.macro_popup, .variable_popup { display: none; }

/* Pop-up appears on mouse-hover event. */
.macro:hover .macro_popup, .variable:hover .variable_popup {
  display: block;
  padding: 2px;
  -webkit-border-radius:5px;
  -webkit-box-shadow:1px 1px 7px #000;
  border-radius:5px;
  box-shadow:1px 1px 7px #000;
  position: absolute;
  top: -1em;
  left:10em;
  z-index: 1
}

.macro_popup {
  border: 2px solid red;
  background-color:#FFF0F0;
  font-weight: normal;
}

.variable_popup {
  border: 2px solid blue;
  background-color:#F0F0FF;
  font-weight: bold;
  font-family: Helvetica, sans-serif;
  font-size: 9pt;
}

/* Pop-up notes needs a relative position as a base where they pops up. */
.macro, .variable {
  background-color: PaleGoldenRod;
  position: relative;
}
.macro { color: DarkMagenta; }

#tooltiphint {
  position: fixed;
  width: 50em;
  margin-left: -25em;
  left: 50%;
  padding: 10px;
  border: 1px solid #b0b0b0;
  border-radius: 2px;
  box-shadow: 1px 1px 7px black;
  background-color: #c0c0c0;
  z-index: 2;
}

.num { width:2.5em; padding-right:2ex; background-color:#eeeeee }
.num { text-align:right; font-size:8pt }
.num { color:#444444 }
.line { padding-left: 1ex; border-left: 3px solid #ccc }
.line { white-space: pre }
.msg { -webkit-box-shadow:1px 1px 7px #000 }
.msg { box-shadow:1px 1px 7px #000 }
.msg { -webkit-border-radius:5px }
.msg { border-radius:5px }
.msg { font-family:Helvetica, sans-serif; font-size:8pt }
.msg { float:left }
.msg { padding:0.25em 1ex 0.25em 1ex }
.msg { margin-top:10px; margin-bottom:10px }
.msg { font-weight:bold }
.msg { max-width:60em; word-wrap: break-word; white-space: pre-wrap }
.msgT { padding:0x; spacing:0x }
.msgEvent { background-color:#fff8b4; color:#000000 }
.msgControl { background-color:#bbbbbb; color:#000000 }
.msgNote { background-color:#ddeeff; color:#000000 }
.mrange { background-color:#dfddf3 }
.mrange { border-bottom:1px solid #6F9DBE }
.PathIndex { font-weight: bold; padding:0px 5px; margin-right:5px; }
.PathIndex { -webkit-border-radius:8px }
.PathIndex { border-radius:8px }
.PathIndexEvent { background-color:#bfba87 }
.PathIndexControl { background-color:#8c8c8c }
.PathIndexPopUp { background-color: #879abc; }
.PathNav a { text-decoration:none; font-size: larger }
.CodeInsertionHint { font-weight: bold; background-color: #10dd10 }
.CodeRemovalHint { background-color:#de1010 }
.CodeRemovalHint { border-bottom:1px solid #6F9DBE }
.selected{ background-color:orange !important; }

table.simpletable {
  padding: 5px;
  font-size:12pt;
  margin:20px;
  border-collapse: collapse; border-spacing: 0px;
}
td.rowname {
  text-align: right;
  vertical-align: top;
  font-weight: bold;
  color:#444444;
  padding-right:2ex;
}

/* Hidden text. */
input.spoilerhider + label {
  cursor: pointer;
  text-decoration: underline;
  display: block;
}
input.spoilerhider {
 display: none;
}
input.spoilerhider ~ .spoiler {
  overflow: hidden;
  margin: 10px auto 0;
  height: 0;
  opacity: 0;
}
input.spoilerhider:checked + label + .spoiler{
  height: auto;
  opacity: 1;
}
</style>
</head>
<body>
<!-- BUGDESC Call to function 'memcpy' is insecure as it does not provide security checks introduced in the C11 standard. Replace with analogous functions that support length arguments or provides boundary checks such as 'memcpy_s' in case of C11 -->

<!-- BUGTYPE Potential insecure memory buffer bounds restriction in call 'memcpy' -->

<!-- BUGCATEGORY Security -->

<!-- BUGFILE /tmp/real/c_git/git/./cache.h -->

<!-- FILENAME cache.h -->

<!-- FUNCTIONNAME hashcpy -->

<!-- ISSUEHASHCONTENTOFLINEINCONTEXT 65a2a1b77db0db734aeea287c1bc9298 -->

<!-- BUGLINE 1167 -->

<!-- BUGCOLUMN 2 -->

<!-- BUGPATHLENGTH 1 -->

<!-- BUGMETAEND -->
<!-- REPORTHEADER -->
<h3>Bug Summary</h3>
<table class="simpletable">
<tr><td class="rowname">File:</td><td>./cache.h</td></tr>
<tr><td class="rowname">Warning:</td><td><a href="#EndPath">line 1167, column 2</a><br />Call to function 'memcpy' is insecure as it does not provide security checks introduced in the C11 standard. Replace with analogous functions that support length arguments or provides boundary checks such as 'memcpy_s' in case of C11</td></tr>

</table>
<!-- REPORTSUMMARYEXTRA -->
<h3>Annotated Source Code</h3>
<p>Press <a href="#" onclick="toggleHelp(); return false;">'?'</a>
   to see keyboard shortcuts</p>
<input type="checkbox" class="spoilerhider" id="showinvocation" />
<label for="showinvocation" >Show analyzer invocation</label>
<div class="spoiler">clang -cc1 -cc1 -triple x86_64-unknown-linux-gnu -analyze -disable-free -main-file-name config.c -analyzer-store=region -analyzer-opt-analyze-nested-blocks -analyzer-checker=core -analyzer-checker=apiModeling -analyzer-checker=unix -analyzer-checker=deadcode -analyzer-checker=security.insecureAPI.UncheckedReturn -analyzer-checker=security.insecureAPI.getpw -analyzer-checker=security.insecureAPI.gets -analyzer-checker=security.insecureAPI.mktemp -analyzer-checker=security.insecureAPI.mkstemp -analyzer-checker=security.insecureAPI.vfork -analyzer-checker=nullability.NullPassedToNonnull -analyzer-checker=nullability.NullReturnedFromNonnull -analyzer-output plist -w -setup-static-analyzer -mrelocation-model static -mframe-pointer=none -fmath-errno -fno-rounding-math -mconstructor-aliases -munwind-tables -target-cpu x86-64 -fno-split-dwarf-inlining -debugger-tuning=gdb -resource-dir /llvm-project/build/lib/clang/12.0.0 -I . -D HAVE_SYSINFO -D GIT_HOST_CPU="x86_64" -D HAVE_ALLOCA_H -D USE_CURL_FOR_IMAP_SEND -D SHA1_DC -D SHA1DC_NO_STANDARD_INCLUDES -D SHA1DC_INIT_SAFE_HASH_DEFAULT=0 -D SHA1DC_CUSTOM_INCLUDE_SHA1_C="cache.h" -D SHA1DC_CUSTOM_INCLUDE_UBC_CHECK_C="git-compat-util.h" -D SHA256_BLK -D HAVE_PATHS_H -D HAVE_DEV_TTY -D HAVE_CLOCK_GETTIME -D HAVE_CLOCK_MONOTONIC -D HAVE_GETDELIM -D PROCFS_EXECUTABLE_PATH="/proc/self/exe" -D FREAD_READS_DIRECTORIES -D NO_STRLCPY -D SHELL_PATH="/bin/sh" -D PAGER_ENV="LESS=FRX LV=-c" -internal-isystem /usr/local/include -internal-isystem /llvm-project/build/lib/clang/12.0.0/include -internal-externc-isystem /usr/include/x86_64-linux-gnu -internal-externc-isystem /include -internal-externc-isystem /usr/include -O2 -fdebug-compilation-dir /tmp/real/c_git/git -ferror-limit 19 -fgnuc-version=4.2.1 -vectorize-loops -vectorize-slp -analyzer-checker core -analyzer-checker cplusplus -analyzer-checker deadcode -analyzer-checker nullability -analyzer-checker optin -analyzer-checker security -analyzer-checker unix -analyzer-checker osx -analyzer-checker fuchsia -analyzer-checker webkit -analyzer-output=html -faddrsig -o /tmp/scan-build-2020-11-19-144418-19857-1 -x c builtin/config.c
</div>
<div id='tooltiphint' hidden="true">
  <p>Keyboard shortcuts: </p>
  <ul>
    <li>Use 'j/k' keys for keyboard navigation</li>
    <li>Use 'Shift+S' to show/hide relevant lines</li>
    <li>Use '?' to toggle this window</li>
  </ul>
  <a href="#" onclick="toggleHelp(); return false;">Close</a>
</div>
<script type='text/javascript'>
var relevant_lines = {"22292": {"1167": 1}};

var filterCounterexample = function (hide) {
  var tables = document.getElementsByClassName("code");
  for (var t=0; t<tables.length; t++) {
    var table = tables[t];
    var file_id = table.getAttribute("data-fileid");
    var lines_in_fid = relevant_lines[file_id];
    if (!lines_in_fid) {
      lines_in_fid = {};
    }
    var lines = table.getElementsByClassName("codeline");
    for (var i=0; i<lines.length; i++) {
        var el = lines[i];
        var lineNo = el.getAttribute("data-linenumber");
        if (!lines_in_fid[lineNo]) {
          if (hide) {
            el.setAttribute("hidden", "");
          } else {
            el.removeAttribute("hidden");
          }
        }
    }
  }
}

window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "S") {
    var checked = document.getElementsByName("showCounterexample")[0].checked;
    filterCounterexample(!checked);
    document.getElementsByName("showCounterexample")[0].checked = !checked;
  } else {
    return;
  }
  event.preventDefault();
}, true);

document.addEventListener("DOMContentLoaded", function() {
    document.querySelector('input[name="showCounterexample"]').onchange=
        function (event) {
      filterCounterexample(this.checked);
    };
});
</script>

<form>
    <input type="checkbox" name="showCounterexample" id="showCounterexample" />
    <label for="showCounterexample">
       Show only relevant lines
    </label>
</form>

<script type='text/javascript'>
var digitMatcher = new RegExp("[0-9]+");

var querySelectorAllArray = function(selector) {
  return Array.prototype.slice.call(
    document.querySelectorAll(selector));
}

document.addEventListener("DOMContentLoaded", function() {
    querySelectorAllArray(".PathNav > a").forEach(
        function(currentValue, currentIndex) {
            var hrefValue = currentValue.getAttribute("href");
            currentValue.onclick = function() {
                scrollTo(document.querySelector(hrefValue));
                return false;
            };
        });
});

var findNum = function() {
    var s = document.querySelector(".selected");
    if (!s || s.id == "EndPath") {
        return 0;
    }
    var out = parseInt(digitMatcher.exec(s.id)[0]);
    return out;
};

var scrollTo = function(el) {
    querySelectorAllArray(".selected").forEach(function(s) {
        s.classList.remove("selected");
    });
    el.classList.add("selected");
    window.scrollBy(0, el.getBoundingClientRect().top -
        (window.innerHeight / 2));
}

var move = function(num, up, numItems) {
  if (num == 1 && up || num == numItems - 1 && !up) {
    return 0;
  } else if (num == 0 && up) {
    return numItems - 1;
  } else if (num == 0 && !up) {
    return 1 % numItems;
  }
  return up ? num - 1 : num + 1;
}

var numToId = function(num) {
  if (num == 0) {
    return document.getElementById("EndPath")
  }
  return document.getElementById("Path" + num);
};

var navigateTo = function(up) {
  var numItems = document.querySelectorAll(
      ".line > .msgEvent, .line > .msgControl").length;
  var currentSelected = findNum();
  var newSelected = move(currentSelected, up, numItems);
  var newEl = numToId(newSelected, numItems);

  // Scroll element into center.
  scrollTo(newEl);
};

window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "j") {
    navigateTo(/*up=*/false);
  } else if (event.key == "k") {
    navigateTo(/*up=*/true);
  } else {
    return;
  }
  event.preventDefault();
}, true);
</script>
  
<script type='text/javascript'>

var toggleHelp = function() {
    var hint = document.querySelector("#tooltiphint");
    var attributeName = "hidden";
    if (hint.hasAttribute(attributeName)) {
      hint.removeAttribute(attributeName);
    } else {
      hint.setAttribute("hidden", "true");
    }
};
window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "?") {
    toggleHelp();
  } else {
    return;
  }
  event.preventDefault();
});
</script>
<table class="code" data-fileid="22292">
<tr class="codeline" data-linenumber="1"><td class="num" id="LN1">1</td><td class="line"><span class='directive'>#ifndef CACHE_H</span></td></tr>
<tr class="codeline" data-linenumber="2"><td class="num" id="LN2">2</td><td class="line"><span class='directive'>#define CACHE_H</span></td></tr>
<tr class="codeline" data-linenumber="3"><td class="num" id="LN3">3</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="4"><td class="num" id="LN4">4</td><td class="line"><span class='directive'>#include "git-compat-util.h"</span></td></tr>
<tr class="codeline" data-linenumber="5"><td class="num" id="LN5">5</td><td class="line"><span class='directive'>#include "strbuf.h"</span></td></tr>
<tr class="codeline" data-linenumber="6"><td class="num" id="LN6">6</td><td class="line"><span class='directive'>#include "hashmap.h"</span></td></tr>
<tr class="codeline" data-linenumber="7"><td class="num" id="LN7">7</td><td class="line"><span class='directive'>#include "list.h"</span></td></tr>
<tr class="codeline" data-linenumber="8"><td class="num" id="LN8">8</td><td class="line"><span class='directive'>#include "advice.h"</span></td></tr>
<tr class="codeline" data-linenumber="9"><td class="num" id="LN9">9</td><td class="line"><span class='directive'>#include "gettext.h"</span></td></tr>
<tr class="codeline" data-linenumber="10"><td class="num" id="LN10">10</td><td class="line"><span class='directive'>#include "convert.h"</span></td></tr>
<tr class="codeline" data-linenumber="11"><td class="num" id="LN11">11</td><td class="line"><span class='directive'>#include "trace.h"</span></td></tr>
<tr class="codeline" data-linenumber="12"><td class="num" id="LN12">12</td><td class="line"><span class='directive'>#include "trace2.h"</span></td></tr>
<tr class="codeline" data-linenumber="13"><td class="num" id="LN13">13</td><td class="line"><span class='directive'>#include "string-list.h"</span></td></tr>
<tr class="codeline" data-linenumber="14"><td class="num" id="LN14">14</td><td class="line"><span class='directive'>#include "pack-revindex.h"</span></td></tr>
<tr class="codeline" data-linenumber="15"><td class="num" id="LN15">15</td><td class="line"><span class='directive'>#include "hash.h"</span></td></tr>
<tr class="codeline" data-linenumber="16"><td class="num" id="LN16">16</td><td class="line"><span class='directive'>#include "path.h"</span></td></tr>
<tr class="codeline" data-linenumber="17"><td class="num" id="LN17">17</td><td class="line"><span class='directive'>#include "oid-array.h"</span></td></tr>
<tr class="codeline" data-linenumber="18"><td class="num" id="LN18">18</td><td class="line"><span class='directive'>#include "repository.h"</span></td></tr>
<tr class="codeline" data-linenumber="19"><td class="num" id="LN19">19</td><td class="line"><span class='directive'>#include "mem-pool.h"</span></td></tr>
<tr class="codeline" data-linenumber="20"><td class="num" id="LN20">20</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="21"><td class="num" id="LN21">21</td><td class="line"><span class='directive'>#include &lt;zlib.h&gt;</span></td></tr>
<tr class="codeline" data-linenumber="22"><td class="num" id="LN22">22</td><td class="line"><span class='keyword'>typedef</span> <span class='keyword'>struct</span> git_zstream {</td></tr>
<tr class="codeline" data-linenumber="23"><td class="num" id="LN23">23</td><td class="line">	z_stream z;</td></tr>
<tr class="codeline" data-linenumber="24"><td class="num" id="LN24">24</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>long</span> avail_in;</td></tr>
<tr class="codeline" data-linenumber="25"><td class="num" id="LN25">25</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>long</span> avail_out;</td></tr>
<tr class="codeline" data-linenumber="26"><td class="num" id="LN26">26</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>long</span> total_in;</td></tr>
<tr class="codeline" data-linenumber="27"><td class="num" id="LN27">27</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>long</span> total_out;</td></tr>
<tr class="codeline" data-linenumber="28"><td class="num" id="LN28">28</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>char</span> *next_in;</td></tr>
<tr class="codeline" data-linenumber="29"><td class="num" id="LN29">29</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>char</span> *next_out;</td></tr>
<tr class="codeline" data-linenumber="30"><td class="num" id="LN30">30</td><td class="line">} git_zstream;</td></tr>
<tr class="codeline" data-linenumber="31"><td class="num" id="LN31">31</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="32"><td class="num" id="LN32">32</td><td class="line"><span class='keyword'>void</span> git_inflate_init(git_zstream *);</td></tr>
<tr class="codeline" data-linenumber="33"><td class="num" id="LN33">33</td><td class="line"><span class='keyword'>void</span> git_inflate_init_gzip_only(git_zstream *);</td></tr>
<tr class="codeline" data-linenumber="34"><td class="num" id="LN34">34</td><td class="line"><span class='keyword'>void</span> git_inflate_end(git_zstream *);</td></tr>
<tr class="codeline" data-linenumber="35"><td class="num" id="LN35">35</td><td class="line"><span class='keyword'>int</span> git_inflate(git_zstream *, <span class='keyword'>int</span> flush);</td></tr>
<tr class="codeline" data-linenumber="36"><td class="num" id="LN36">36</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="37"><td class="num" id="LN37">37</td><td class="line"><span class='keyword'>void</span> git_deflate_init(git_zstream *, <span class='keyword'>int</span> level);</td></tr>
<tr class="codeline" data-linenumber="38"><td class="num" id="LN38">38</td><td class="line"><span class='keyword'>void</span> git_deflate_init_gzip(git_zstream *, <span class='keyword'>int</span> level);</td></tr>
<tr class="codeline" data-linenumber="39"><td class="num" id="LN39">39</td><td class="line"><span class='keyword'>void</span> git_deflate_init_raw(git_zstream *, <span class='keyword'>int</span> level);</td></tr>
<tr class="codeline" data-linenumber="40"><td class="num" id="LN40">40</td><td class="line"><span class='keyword'>void</span> git_deflate_end(git_zstream *);</td></tr>
<tr class="codeline" data-linenumber="41"><td class="num" id="LN41">41</td><td class="line"><span class='keyword'>int</span> git_deflate_abort(git_zstream *);</td></tr>
<tr class="codeline" data-linenumber="42"><td class="num" id="LN42">42</td><td class="line"><span class='keyword'>int</span> git_deflate_end_gently(git_zstream *);</td></tr>
<tr class="codeline" data-linenumber="43"><td class="num" id="LN43">43</td><td class="line"><span class='keyword'>int</span> git_deflate(git_zstream *, <span class='keyword'>int</span> flush);</td></tr>
<tr class="codeline" data-linenumber="44"><td class="num" id="LN44">44</td><td class="line"><span class='keyword'>unsigned</span> <span class='keyword'>long</span> git_deflate_bound(git_zstream *, <span class='keyword'>unsigned</span> <span class='keyword'>long</span>);</td></tr>
<tr class="codeline" data-linenumber="45"><td class="num" id="LN45">45</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="46"><td class="num" id="LN46">46</td><td class="line"><span class='directive'>#if defined(<span class='macro'>DT_UNKNOWN<span class='macro_popup'>DT_UNKNOWN</span></span>) &amp;&amp; !defined(NO_D_TYPE_IN_DIRENT)</span></td></tr>
<tr class="codeline" data-linenumber="47"><td class="num" id="LN47">47</td><td class="line"><span class='directive'>#define <span class='macro'>DTYPE(de)<span class='macro_popup'>((de)-&gt;d_type)</span></span>	((de)-&gt;d_type)</span></td></tr>
<tr class="codeline" data-linenumber="48"><td class="num" id="LN48">48</td><td class="line"><span class='directive'>#else</span></td></tr>
<tr class="codeline" data-linenumber="49"><td class="num" id="LN49">49</td><td class="line"><span class='directive'>#undef <span class='macro'>DT_UNKNOWN<span class='macro_popup'>DT_UNKNOWN</span></span></span></td></tr>
<tr class="codeline" data-linenumber="50"><td class="num" id="LN50">50</td><td class="line"><span class='directive'>#undef <span class='macro'>DT_DIR<span class='macro_popup'>DT_DIR</span></span></span></td></tr>
<tr class="codeline" data-linenumber="51"><td class="num" id="LN51">51</td><td class="line"><span class='directive'>#undef <span class='macro'>DT_REG<span class='macro_popup'>DT_REG</span></span></span></td></tr>
<tr class="codeline" data-linenumber="52"><td class="num" id="LN52">52</td><td class="line"><span class='directive'>#undef <span class='macro'>DT_LNK<span class='macro_popup'>DT_LNK</span></span></span></td></tr>
<tr class="codeline" data-linenumber="53"><td class="num" id="LN53">53</td><td class="line"><span class='directive'>#define <span class='macro'>DT_UNKNOWN<span class='macro_popup'>DT_UNKNOWN</span></span>	0</span></td></tr>
<tr class="codeline" data-linenumber="54"><td class="num" id="LN54">54</td><td class="line"><span class='directive'>#define <span class='macro'>DT_DIR<span class='macro_popup'>DT_DIR</span></span>		1</span></td></tr>
<tr class="codeline" data-linenumber="55"><td class="num" id="LN55">55</td><td class="line"><span class='directive'>#define <span class='macro'>DT_REG<span class='macro_popup'>DT_REG</span></span>		2</span></td></tr>
<tr class="codeline" data-linenumber="56"><td class="num" id="LN56">56</td><td class="line"><span class='directive'>#define <span class='macro'>DT_LNK<span class='macro_popup'>DT_LNK</span></span>		3</span></td></tr>
<tr class="codeline" data-linenumber="57"><td class="num" id="LN57">57</td><td class="line"><span class='directive'>#define <span class='macro'>DTYPE(de)<span class='macro_popup'>((de)-&gt;d_type)</span></span>	<span class='macro'>DT_UNKNOWN<span class='macro_popup'>DT_UNKNOWN</span></span></span></td></tr>
<tr class="codeline" data-linenumber="58"><td class="num" id="LN58">58</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="59"><td class="num" id="LN59">59</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="60"><td class="num" id="LN60">60</td><td class="line"><span class='comment'>/* unknown mode (impossible combination S_IFIFO|S_IFCHR) */</span></td></tr>
<tr class="codeline" data-linenumber="61"><td class="num" id="LN61">61</td><td class="line"><span class='directive'>#define <span class='macro'>S_IFINVALID<span class='macro_popup'>0030000</span></span>     0030000</span></td></tr>
<tr class="codeline" data-linenumber="62"><td class="num" id="LN62">62</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="63"><td class="num" id="LN63">63</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="64"><td class="num" id="LN64">64</td><td class="line"> <span class='comment'>* A "directory link" is a link to another git directory.</span></td></tr>
<tr class="codeline" data-linenumber="65"><td class="num" id="LN65">65</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="66"><td class="num" id="LN66">66</td><td class="line"> <span class='comment'>* The value 0160000 is not normally a valid mode, and</span></td></tr>
<tr class="codeline" data-linenumber="67"><td class="num" id="LN67">67</td><td class="line"> <span class='comment'>* also just happens to be S_IFDIR + S_IFLNK</span></td></tr>
<tr class="codeline" data-linenumber="68"><td class="num" id="LN68">68</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="69"><td class="num" id="LN69">69</td><td class="line"><span class='directive'>#define <span class='macro'>S_IFGITLINK<span class='macro_popup'>0160000</span></span>	0160000</span></td></tr>
<tr class="codeline" data-linenumber="70"><td class="num" id="LN70">70</td><td class="line"><span class='directive'>#define <span class='macro'>S_ISGITLINK(m)<span class='macro_popup'>(((m) &amp; 0170000) == 0160000)</span></span>	(((m) &amp; <span class='macro'>S_IFMT<span class='macro_popup'>0170000</span></span>) == <span class='macro'>S_IFGITLINK<span class='macro_popup'>0160000</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="71"><td class="num" id="LN71">71</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="72"><td class="num" id="LN72">72</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="73"><td class="num" id="LN73">73</td><td class="line"> <span class='comment'>* Some mode bits are also used internally for computations.</span></td></tr>
<tr class="codeline" data-linenumber="74"><td class="num" id="LN74">74</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="75"><td class="num" id="LN75">75</td><td class="line"> <span class='comment'>* They *must* not overlap with any valid modes, and they *must* not be emitted</span></td></tr>
<tr class="codeline" data-linenumber="76"><td class="num" id="LN76">76</td><td class="line"> <span class='comment'>* to outside world - i.e. appear on disk or network. In other words, it's just</span></td></tr>
<tr class="codeline" data-linenumber="77"><td class="num" id="LN77">77</td><td class="line"> <span class='comment'>* temporary fields, which we internally use, but they have to stay in-house.</span></td></tr>
<tr class="codeline" data-linenumber="78"><td class="num" id="LN78">78</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="79"><td class="num" id="LN79">79</td><td class="line"> <span class='comment'>* ( such approach is valid, as standard S_IF* fits into 16 bits, and in Git</span></td></tr>
<tr class="codeline" data-linenumber="80"><td class="num" id="LN80">80</td><td class="line"> <span class='comment'>*   codebase mode is `unsigned int` which is assumed to be at least 32 bits )</span></td></tr>
<tr class="codeline" data-linenumber="81"><td class="num" id="LN81">81</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="82"><td class="num" id="LN82">82</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="83"><td class="num" id="LN83">83</td><td class="line"><span class='comment'>/* used internally in tree-diff */</span></td></tr>
<tr class="codeline" data-linenumber="84"><td class="num" id="LN84">84</td><td class="line"><span class='directive'>#define <span class='macro'>S_DIFFTREE_IFXMIN_NEQ<span class='macro_popup'>0x80000000</span></span>	0x80000000</span></td></tr>
<tr class="codeline" data-linenumber="85"><td class="num" id="LN85">85</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="86"><td class="num" id="LN86">86</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="87"><td class="num" id="LN87">87</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="88"><td class="num" id="LN88">88</td><td class="line"> <span class='comment'>* Intensive research over the course of many years has shown that</span></td></tr>
<tr class="codeline" data-linenumber="89"><td class="num" id="LN89">89</td><td class="line"> <span class='comment'>* port 9418 is totally unused by anything else. Or</span></td></tr>
<tr class="codeline" data-linenumber="90"><td class="num" id="LN90">90</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="91"><td class="num" id="LN91">91</td><td class="line"> <span class='comment'>*	Your search - "port 9418" - did not match any documents.</span></td></tr>
<tr class="codeline" data-linenumber="92"><td class="num" id="LN92">92</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="93"><td class="num" id="LN93">93</td><td class="line"> <span class='comment'>* as www.google.com puts it.</span></td></tr>
<tr class="codeline" data-linenumber="94"><td class="num" id="LN94">94</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="95"><td class="num" id="LN95">95</td><td class="line"> <span class='comment'>* This port has been properly assigned for git use by IANA:</span></td></tr>
<tr class="codeline" data-linenumber="96"><td class="num" id="LN96">96</td><td class="line"> <span class='comment'>* git (Assigned-9418) [I06-050728-0001].</span></td></tr>
<tr class="codeline" data-linenumber="97"><td class="num" id="LN97">97</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="98"><td class="num" id="LN98">98</td><td class="line"> <span class='comment'>*	git  9418/tcp   git pack transfer service</span></td></tr>
<tr class="codeline" data-linenumber="99"><td class="num" id="LN99">99</td><td class="line"> <span class='comment'>*	git  9418/udp   git pack transfer service</span></td></tr>
<tr class="codeline" data-linenumber="100"><td class="num" id="LN100">100</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="101"><td class="num" id="LN101">101</td><td class="line"> <span class='comment'>* with Linus Torvalds &lt;torvalds@osdl.org&gt; as the point of</span></td></tr>
<tr class="codeline" data-linenumber="102"><td class="num" id="LN102">102</td><td class="line"> <span class='comment'>* contact. September 2005.</span></td></tr>
<tr class="codeline" data-linenumber="103"><td class="num" id="LN103">103</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="104"><td class="num" id="LN104">104</td><td class="line"> <span class='comment'>* See http://www.iana.org/assignments/port-numbers</span></td></tr>
<tr class="codeline" data-linenumber="105"><td class="num" id="LN105">105</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="106"><td class="num" id="LN106">106</td><td class="line"><span class='directive'>#define <span class='macro'>DEFAULT_GIT_PORT<span class='macro_popup'>9418</span></span> 9418</span></td></tr>
<tr class="codeline" data-linenumber="107"><td class="num" id="LN107">107</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="108"><td class="num" id="LN108">108</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="109"><td class="num" id="LN109">109</td><td class="line"> <span class='comment'>* Basic data structures for the directory cache</span></td></tr>
<tr class="codeline" data-linenumber="110"><td class="num" id="LN110">110</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="111"><td class="num" id="LN111">111</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="112"><td class="num" id="LN112">112</td><td class="line"><span class='directive'>#define <span class='macro'>CACHE_SIGNATURE<span class='macro_popup'>0x44495243</span></span> 0x44495243	/* "DIRC" */</span></td></tr>
<tr class="codeline" data-linenumber="113"><td class="num" id="LN113">113</td><td class="line"><span class='keyword'>struct</span> cache_header {</td></tr>
<tr class="codeline" data-linenumber="114"><td class="num" id="LN114">114</td><td class="line">	uint32_t hdr_signature;</td></tr>
<tr class="codeline" data-linenumber="115"><td class="num" id="LN115">115</td><td class="line">	uint32_t hdr_version;</td></tr>
<tr class="codeline" data-linenumber="116"><td class="num" id="LN116">116</td><td class="line">	uint32_t hdr_entries;</td></tr>
<tr class="codeline" data-linenumber="117"><td class="num" id="LN117">117</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="118"><td class="num" id="LN118">118</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="119"><td class="num" id="LN119">119</td><td class="line"><span class='directive'>#define <span class='macro'>INDEX_FORMAT_LB<span class='macro_popup'>2</span></span> 2</span></td></tr>
<tr class="codeline" data-linenumber="120"><td class="num" id="LN120">120</td><td class="line"><span class='directive'>#define <span class='macro'>INDEX_FORMAT_UB<span class='macro_popup'>4</span></span> 4</span></td></tr>
<tr class="codeline" data-linenumber="121"><td class="num" id="LN121">121</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="122"><td class="num" id="LN122">122</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="123"><td class="num" id="LN123">123</td><td class="line"> <span class='comment'>* The "cache_time" is just the low 32 bits of the</span></td></tr>
<tr class="codeline" data-linenumber="124"><td class="num" id="LN124">124</td><td class="line"> <span class='comment'>* time. It doesn't matter if it overflows - we only</span></td></tr>
<tr class="codeline" data-linenumber="125"><td class="num" id="LN125">125</td><td class="line"> <span class='comment'>* check it for equality in the 32 bits we save.</span></td></tr>
<tr class="codeline" data-linenumber="126"><td class="num" id="LN126">126</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="127"><td class="num" id="LN127">127</td><td class="line"><span class='keyword'>struct</span> cache_time {</td></tr>
<tr class="codeline" data-linenumber="128"><td class="num" id="LN128">128</td><td class="line">	uint32_t sec;</td></tr>
<tr class="codeline" data-linenumber="129"><td class="num" id="LN129">129</td><td class="line">	uint32_t nsec;</td></tr>
<tr class="codeline" data-linenumber="130"><td class="num" id="LN130">130</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="131"><td class="num" id="LN131">131</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="132"><td class="num" id="LN132">132</td><td class="line"><span class='keyword'>struct</span> stat_data {</td></tr>
<tr class="codeline" data-linenumber="133"><td class="num" id="LN133">133</td><td class="line">	<span class='keyword'>struct</span> cache_time sd_ctime;</td></tr>
<tr class="codeline" data-linenumber="134"><td class="num" id="LN134">134</td><td class="line">	<span class='keyword'>struct</span> cache_time sd_mtime;</td></tr>
<tr class="codeline" data-linenumber="135"><td class="num" id="LN135">135</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> sd_dev;</td></tr>
<tr class="codeline" data-linenumber="136"><td class="num" id="LN136">136</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> sd_ino;</td></tr>
<tr class="codeline" data-linenumber="137"><td class="num" id="LN137">137</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> sd_uid;</td></tr>
<tr class="codeline" data-linenumber="138"><td class="num" id="LN138">138</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> sd_gid;</td></tr>
<tr class="codeline" data-linenumber="139"><td class="num" id="LN139">139</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> sd_size;</td></tr>
<tr class="codeline" data-linenumber="140"><td class="num" id="LN140">140</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="141"><td class="num" id="LN141">141</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="142"><td class="num" id="LN142">142</td><td class="line"><span class='keyword'>struct</span> cache_entry {</td></tr>
<tr class="codeline" data-linenumber="143"><td class="num" id="LN143">143</td><td class="line">	<span class='keyword'>struct</span> hashmap_entry ent;</td></tr>
<tr class="codeline" data-linenumber="144"><td class="num" id="LN144">144</td><td class="line">	<span class='keyword'>struct</span> stat_data ce_stat_data;</td></tr>
<tr class="codeline" data-linenumber="145"><td class="num" id="LN145">145</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> ce_mode;</td></tr>
<tr class="codeline" data-linenumber="146"><td class="num" id="LN146">146</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> ce_flags;</td></tr>
<tr class="codeline" data-linenumber="147"><td class="num" id="LN147">147</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> mem_pool_allocated;</td></tr>
<tr class="codeline" data-linenumber="148"><td class="num" id="LN148">148</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> ce_namelen;</td></tr>
<tr class="codeline" data-linenumber="149"><td class="num" id="LN149">149</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> index;	<span class='comment'>/* for link extension */</span></td></tr>
<tr class="codeline" data-linenumber="150"><td class="num" id="LN150">150</td><td class="line">	<span class='keyword'>struct</span> object_id oid;</td></tr>
<tr class="codeline" data-linenumber="151"><td class="num" id="LN151">151</td><td class="line">	<span class='keyword'>char</span> name[FLEX_ARRAY]; <span class='comment'>/* more */</span></td></tr>
<tr class="codeline" data-linenumber="152"><td class="num" id="LN152">152</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="153"><td class="num" id="LN153">153</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="154"><td class="num" id="LN154">154</td><td class="line"><span class='directive'>#define <span class='macro'>CE_STAGEMASK<span class='macro_popup'>(0x3000)</span></span> (0x3000)</span></td></tr>
<tr class="codeline" data-linenumber="155"><td class="num" id="LN155">155</td><td class="line"><span class='directive'>#define <span class='macro'>CE_EXTENDED<span class='macro_popup'>(0x4000)</span></span>  (0x4000)</span></td></tr>
<tr class="codeline" data-linenumber="156"><td class="num" id="LN156">156</td><td class="line"><span class='directive'>#define <span class='macro'>CE_VALID<span class='macro_popup'>(0x8000)</span></span>     (0x8000)</span></td></tr>
<tr class="codeline" data-linenumber="157"><td class="num" id="LN157">157</td><td class="line"><span class='directive'>#define <span class='macro'>CE_STAGESHIFT<span class='macro_popup'>12</span></span> 12</span></td></tr>
<tr class="codeline" data-linenumber="158"><td class="num" id="LN158">158</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="159"><td class="num" id="LN159">159</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="160"><td class="num" id="LN160">160</td><td class="line"> <span class='comment'>* Range 0xFFFF0FFF in ce_flags is divided into</span></td></tr>
<tr class="codeline" data-linenumber="161"><td class="num" id="LN161">161</td><td class="line"> <span class='comment'>* two parts: in-memory flags and on-disk ones.</span></td></tr>
<tr class="codeline" data-linenumber="162"><td class="num" id="LN162">162</td><td class="line"> <span class='comment'>* Flags in CE_EXTENDED_FLAGS will get saved on-disk</span></td></tr>
<tr class="codeline" data-linenumber="163"><td class="num" id="LN163">163</td><td class="line"> <span class='comment'>* if you want to save a new flag, add it in</span></td></tr>
<tr class="codeline" data-linenumber="164"><td class="num" id="LN164">164</td><td class="line"> <span class='comment'>* CE_EXTENDED_FLAGS</span></td></tr>
<tr class="codeline" data-linenumber="165"><td class="num" id="LN165">165</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="166"><td class="num" id="LN166">166</td><td class="line"> <span class='comment'>* In-memory only flags</span></td></tr>
<tr class="codeline" data-linenumber="167"><td class="num" id="LN167">167</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="168"><td class="num" id="LN168">168</td><td class="line"><span class='directive'>#define <span class='macro'>CE_UPDATE<span class='macro_popup'>(1 &lt;&lt; 16)</span></span>            (1 &lt;&lt; 16)</span></td></tr>
<tr class="codeline" data-linenumber="169"><td class="num" id="LN169">169</td><td class="line"><span class='directive'>#define <span class='macro'>CE_REMOVE<span class='macro_popup'>(1 &lt;&lt; 17)</span></span>            (1 &lt;&lt; 17)</span></td></tr>
<tr class="codeline" data-linenumber="170"><td class="num" id="LN170">170</td><td class="line"><span class='directive'>#define <span class='macro'>CE_UPTODATE<span class='macro_popup'>(1 &lt;&lt; 18)</span></span>          (1 &lt;&lt; 18)</span></td></tr>
<tr class="codeline" data-linenumber="171"><td class="num" id="LN171">171</td><td class="line"><span class='directive'>#define <span class='macro'>CE_ADDED<span class='macro_popup'>(1 &lt;&lt; 19)</span></span>             (1 &lt;&lt; 19)</span></td></tr>
<tr class="codeline" data-linenumber="172"><td class="num" id="LN172">172</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="173"><td class="num" id="LN173">173</td><td class="line"><span class='directive'>#define <span class='macro'>CE_HASHED<span class='macro_popup'>(1 &lt;&lt; 20)</span></span>            (1 &lt;&lt; 20)</span></td></tr>
<tr class="codeline" data-linenumber="174"><td class="num" id="LN174">174</td><td class="line"><span class='directive'>#define <span class='macro'>CE_FSMONITOR_VALID<span class='macro_popup'>(1 &lt;&lt; 21)</span></span>   (1 &lt;&lt; 21)</span></td></tr>
<tr class="codeline" data-linenumber="175"><td class="num" id="LN175">175</td><td class="line"><span class='directive'>#define <span class='macro'>CE_WT_REMOVE<span class='macro_popup'>(1 &lt;&lt; 22)</span></span>         (1 &lt;&lt; 22) /* remove in work directory */</span></td></tr>
<tr class="codeline" data-linenumber="176"><td class="num" id="LN176">176</td><td class="line"><span class='directive'>#define <span class='macro'>CE_CONFLICTED<span class='macro_popup'>(1 &lt;&lt; 23)</span></span>        (1 &lt;&lt; 23)</span></td></tr>
<tr class="codeline" data-linenumber="177"><td class="num" id="LN177">177</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="178"><td class="num" id="LN178">178</td><td class="line"><span class='directive'>#define <span class='macro'>CE_UNPACKED<span class='macro_popup'>(1 &lt;&lt; 24)</span></span>          (1 &lt;&lt; 24)</span></td></tr>
<tr class="codeline" data-linenumber="179"><td class="num" id="LN179">179</td><td class="line"><span class='directive'>#define <span class='macro'>CE_NEW_SKIP_WORKTREE<span class='macro_popup'>(1 &lt;&lt; 25)</span></span> (1 &lt;&lt; 25)</span></td></tr>
<tr class="codeline" data-linenumber="180"><td class="num" id="LN180">180</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="181"><td class="num" id="LN181">181</td><td class="line"><span class='comment'>/* used to temporarily mark paths matched by pathspecs */</span></td></tr>
<tr class="codeline" data-linenumber="182"><td class="num" id="LN182">182</td><td class="line"><span class='directive'>#define <span class='macro'>CE_MATCHED<span class='macro_popup'>(1 &lt;&lt; 26)</span></span>           (1 &lt;&lt; 26)</span></td></tr>
<tr class="codeline" data-linenumber="183"><td class="num" id="LN183">183</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="184"><td class="num" id="LN184">184</td><td class="line"><span class='directive'>#define <span class='macro'>CE_UPDATE_IN_BASE<span class='macro_popup'>(1 &lt;&lt; 27)</span></span>    (1 &lt;&lt; 27)</span></td></tr>
<tr class="codeline" data-linenumber="185"><td class="num" id="LN185">185</td><td class="line"><span class='directive'>#define <span class='macro'>CE_STRIP_NAME<span class='macro_popup'>(1 &lt;&lt; 28)</span></span>        (1 &lt;&lt; 28)</span></td></tr>
<tr class="codeline" data-linenumber="186"><td class="num" id="LN186">186</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="187"><td class="num" id="LN187">187</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="188"><td class="num" id="LN188">188</td><td class="line"> <span class='comment'>* Extended on-disk flags</span></td></tr>
<tr class="codeline" data-linenumber="189"><td class="num" id="LN189">189</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="190"><td class="num" id="LN190">190</td><td class="line"><span class='directive'>#define <span class='macro'>CE_INTENT_TO_ADD<span class='macro_popup'>(1 &lt;&lt; 29)</span></span>     (1 &lt;&lt; 29)</span></td></tr>
<tr class="codeline" data-linenumber="191"><td class="num" id="LN191">191</td><td class="line"><span class='directive'>#define <span class='macro'>CE_SKIP_WORKTREE<span class='macro_popup'>(1 &lt;&lt; 30)</span></span>     (1 &lt;&lt; 30)</span></td></tr>
<tr class="codeline" data-linenumber="192"><td class="num" id="LN192">192</td><td class="line"><span class='comment'>/* CE_EXTENDED2 is for future extension */</span></td></tr>
<tr class="codeline" data-linenumber="193"><td class="num" id="LN193">193</td><td class="line"><span class='directive'>#define <span class='macro'>CE_EXTENDED2<span class='macro_popup'>(1U &lt;&lt; 31)</span></span>         (1U &lt;&lt; 31)</span></td></tr>
<tr class="codeline" data-linenumber="194"><td class="num" id="LN194">194</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="195"><td class="num" id="LN195">195</td><td class="line"><span class='directive'>#define <span class='macro'>CE_EXTENDED_FLAGS<span class='macro_popup'>((1 &lt;&lt; 29) | (1 &lt;&lt; 30))</span></span> (<span class='macro'>CE_INTENT_TO_ADD<span class='macro_popup'>(1 &lt;&lt; 29)</span></span> | <span class='macro'>CE_SKIP_WORKTREE<span class='macro_popup'>(1 &lt;&lt; 30)</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="196"><td class="num" id="LN196">196</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="197"><td class="num" id="LN197">197</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="198"><td class="num" id="LN198">198</td><td class="line"> <span class='comment'>* Safeguard to avoid saving wrong flags:</span></td></tr>
<tr class="codeline" data-linenumber="199"><td class="num" id="LN199">199</td><td class="line"> <span class='comment'>*  - CE_EXTENDED2 won't get saved until its semantic is known</span></td></tr>
<tr class="codeline" data-linenumber="200"><td class="num" id="LN200">200</td><td class="line"> <span class='comment'>*  - Bits in 0x0000FFFF have been saved in ce_flags already</span></td></tr>
<tr class="codeline" data-linenumber="201"><td class="num" id="LN201">201</td><td class="line"> <span class='comment'>*  - Bits in 0x003F0000 are currently in-memory flags</span></td></tr>
<tr class="codeline" data-linenumber="202"><td class="num" id="LN202">202</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="203"><td class="num" id="LN203">203</td><td class="line"><span class='directive'>#if <span class='macro'>CE_EXTENDED_FLAGS<span class='macro_popup'>((1 &lt;&lt; 29) | (1 &lt;&lt; 30))</span></span> &amp; 0x803FFFFF</span></td></tr>
<tr class="codeline" data-linenumber="204"><td class="num" id="LN204">204</td><td class="line"><span class='directive'>#error "CE_EXTENDED_FLAGS out of range"</span></td></tr>
<tr class="codeline" data-linenumber="205"><td class="num" id="LN205">205</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="206"><td class="num" id="LN206">206</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="207"><td class="num" id="LN207">207</td><td class="line"><span class='comment'>/* Forward structure decls */</span></td></tr>
<tr class="codeline" data-linenumber="208"><td class="num" id="LN208">208</td><td class="line"><span class='keyword'>struct</span> pathspec;</td></tr>
<tr class="codeline" data-linenumber="209"><td class="num" id="LN209">209</td><td class="line"><span class='keyword'>struct</span> child_process;</td></tr>
<tr class="codeline" data-linenumber="210"><td class="num" id="LN210">210</td><td class="line"><span class='keyword'>struct</span> tree;</td></tr>
<tr class="codeline" data-linenumber="211"><td class="num" id="LN211">211</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="212"><td class="num" id="LN212">212</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="213"><td class="num" id="LN213">213</td><td class="line"> <span class='comment'>* Copy the sha1 and stat state of a cache entry from one to</span></td></tr>
<tr class="codeline" data-linenumber="214"><td class="num" id="LN214">214</td><td class="line"> <span class='comment'>* another. But we never change the name, or the hash state!</span></td></tr>
<tr class="codeline" data-linenumber="215"><td class="num" id="LN215">215</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="216"><td class="num" id="LN216">216</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span> copy_cache_entry(<span class='keyword'>struct</span> cache_entry *dst,</td></tr>
<tr class="codeline" data-linenumber="217"><td class="num" id="LN217">217</td><td class="line">				    <span class='keyword'>const</span> <span class='keyword'>struct</span> cache_entry *src)</td></tr>
<tr class="codeline" data-linenumber="218"><td class="num" id="LN218">218</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="219"><td class="num" id="LN219">219</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> state = dst-&gt;ce_flags &amp; <span class='macro'>CE_HASHED<span class='macro_popup'>(1 &lt;&lt; 20)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="220"><td class="num" id="LN220">220</td><td class="line">	<span class='keyword'>int</span> mem_pool_allocated = dst-&gt;mem_pool_allocated;</td></tr>
<tr class="codeline" data-linenumber="221"><td class="num" id="LN221">221</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="222"><td class="num" id="LN222">222</td><td class="line">	<span class='comment'>/* Don't copy hash chain and name */</span></td></tr>
<tr class="codeline" data-linenumber="223"><td class="num" id="LN223">223</td><td class="line">	memcpy(&amp;dst-&gt;ce_stat_data, &amp;src-&gt;ce_stat_data,</td></tr>
<tr class="codeline" data-linenumber="224"><td class="num" id="LN224">224</td><td class="line">			<span class='macro'>offsetof(<span class='keyword'>struct</span> cache_entry, name)<span class='macro_popup'>__builtin_offsetof(struct cache_entry, name)</span></span> -</td></tr>
<tr class="codeline" data-linenumber="225"><td class="num" id="LN225">225</td><td class="line">			<span class='macro'>offsetof(<span class='keyword'>struct</span> cache_entry, ce_stat_data)<span class='macro_popup'>__builtin_offsetof(struct cache_entry, ce_stat_data)</span></span>);</td></tr>
<tr class="codeline" data-linenumber="226"><td class="num" id="LN226">226</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="227"><td class="num" id="LN227">227</td><td class="line">	<span class='comment'>/* Restore the hash state */</span></td></tr>
<tr class="codeline" data-linenumber="228"><td class="num" id="LN228">228</td><td class="line">	dst-&gt;ce_flags = (dst-&gt;ce_flags &amp; ~<span class='macro'>CE_HASHED<span class='macro_popup'>(1 &lt;&lt; 20)</span></span>) | state;</td></tr>
<tr class="codeline" data-linenumber="229"><td class="num" id="LN229">229</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="230"><td class="num" id="LN230">230</td><td class="line">	<span class='comment'>/* Restore the mem_pool_allocated flag */</span></td></tr>
<tr class="codeline" data-linenumber="231"><td class="num" id="LN231">231</td><td class="line">	dst-&gt;mem_pool_allocated = mem_pool_allocated;</td></tr>
<tr class="codeline" data-linenumber="232"><td class="num" id="LN232">232</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="233"><td class="num" id="LN233">233</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="234"><td class="num" id="LN234">234</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>unsigned</span> create_ce_flags(<span class='keyword'>unsigned</span> stage)</td></tr>
<tr class="codeline" data-linenumber="235"><td class="num" id="LN235">235</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="236"><td class="num" id="LN236">236</td><td class="line">	<span class='keyword'>return</span> (stage &lt;&lt; <span class='macro'>CE_STAGESHIFT<span class='macro_popup'>12</span></span>);</td></tr>
<tr class="codeline" data-linenumber="237"><td class="num" id="LN237">237</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="238"><td class="num" id="LN238">238</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="239"><td class="num" id="LN239">239</td><td class="line"><span class='directive'>#define <span class='macro'>ce_namelen(ce)<span class='macro_popup'>((ce)-&gt;ce_namelen)</span></span> ((ce)-&gt;ce_namelen)</span></td></tr>
<tr class="codeline" data-linenumber="240"><td class="num" id="LN240">240</td><td class="line"><span class='directive'>#define <span class='macro'>ce_size(ce)<span class='macro_popup'>(__builtin_offsetof(struct cache_entry, name) + (((ce)-&gt;ce_namelen<br>)) + 1)</span></span> <span class='macro'>cache_entry_size(ce_namelen(ce))<span class='macro_popup'>(__builtin_offsetof(struct cache_entry, name) + (((ce)-&gt;ce_namelen<br>)) + 1)</span></span></span></td></tr>
<tr class="codeline" data-linenumber="241"><td class="num" id="LN241">241</td><td class="line"><span class='directive'>#define <span class='macro'>ce_stage(ce)<span class='macro_popup'>(((0x3000) &amp; (ce)-&gt;ce_flags) &gt;&gt; 12)</span></span> ((<span class='macro'>CE_STAGEMASK<span class='macro_popup'>(0x3000)</span></span> &amp; (ce)-&gt;ce_flags) &gt;&gt; <span class='macro'>CE_STAGESHIFT<span class='macro_popup'>12</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="242"><td class="num" id="LN242">242</td><td class="line"><span class='directive'>#define <span class='macro'>ce_uptodate(ce)<span class='macro_popup'>((ce)-&gt;ce_flags &amp; (1 &lt;&lt; 18))</span></span> ((ce)-&gt;ce_flags &amp; <span class='macro'>CE_UPTODATE<span class='macro_popup'>(1 &lt;&lt; 18)</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="243"><td class="num" id="LN243">243</td><td class="line"><span class='directive'>#define <span class='macro'>ce_skip_worktree(ce)<span class='macro_popup'>((ce)-&gt;ce_flags &amp; (1 &lt;&lt; 30))</span></span> ((ce)-&gt;ce_flags &amp; <span class='macro'>CE_SKIP_WORKTREE<span class='macro_popup'>(1 &lt;&lt; 30)</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="244"><td class="num" id="LN244">244</td><td class="line"><span class='directive'>#define <span class='macro'>ce_mark_uptodate(ce)<span class='macro_popup'>((ce)-&gt;ce_flags |= (1 &lt;&lt; 18))</span></span> ((ce)-&gt;ce_flags |= <span class='macro'>CE_UPTODATE<span class='macro_popup'>(1 &lt;&lt; 18)</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="245"><td class="num" id="LN245">245</td><td class="line"><span class='directive'>#define <span class='macro'>ce_intent_to_add(ce)<span class='macro_popup'>((ce)-&gt;ce_flags &amp; (1 &lt;&lt; 29))</span></span> ((ce)-&gt;ce_flags &amp; <span class='macro'>CE_INTENT_TO_ADD<span class='macro_popup'>(1 &lt;&lt; 29)</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="246"><td class="num" id="LN246">246</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="247"><td class="num" id="LN247">247</td><td class="line"><span class='directive'>#define <span class='macro'>ce_permissions(mode)<span class='macro_popup'>(((mode) &amp; 0100) ? 0755 : 0644)</span></span> (((mode) &amp; 0100) ? 0755 : 0644)</span></td></tr>
<tr class="codeline" data-linenumber="248"><td class="num" id="LN248">248</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>unsigned</span> <span class='keyword'>int</span> create_ce_mode(<span class='keyword'>unsigned</span> <span class='keyword'>int</span> mode)</td></tr>
<tr class="codeline" data-linenumber="249"><td class="num" id="LN249">249</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="250"><td class="num" id="LN250">250</td><td class="line">	<span class='keyword'>if</span> (<span class='macro'>S_ISLNK(mode)<span class='macro_popup'>((((mode)) &amp; 0170000) == (0120000))</span></span>)</td></tr>
<tr class="codeline" data-linenumber="251"><td class="num" id="LN251">251</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>S_IFLNK<span class='macro_popup'>0120000</span></span>;</td></tr>
<tr class="codeline" data-linenumber="252"><td class="num" id="LN252">252</td><td class="line">	<span class='keyword'>if</span> (<span class='macro'>S_ISDIR(mode)<span class='macro_popup'>((((mode)) &amp; 0170000) == (0040000))</span></span> || <span class='macro'>S_ISGITLINK(mode)<span class='macro_popup'>(((mode) &amp; 0170000) == 0160000)</span></span>)</td></tr>
<tr class="codeline" data-linenumber="253"><td class="num" id="LN253">253</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>S_IFGITLINK<span class='macro_popup'>0160000</span></span>;</td></tr>
<tr class="codeline" data-linenumber="254"><td class="num" id="LN254">254</td><td class="line">	<span class='keyword'>return</span> <span class='macro'>S_IFREG<span class='macro_popup'>0100000</span></span> | <span class='macro'>ce_permissions(mode)<span class='macro_popup'>(((mode) &amp; 0100) ? 0755 : 0644)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="255"><td class="num" id="LN255">255</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="256"><td class="num" id="LN256">256</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>unsigned</span> <span class='keyword'>int</span> ce_mode_from_stat(<span class='keyword'>const</span> <span class='keyword'>struct</span> cache_entry *ce,</td></tr>
<tr class="codeline" data-linenumber="257"><td class="num" id="LN257">257</td><td class="line">					     <span class='keyword'>unsigned</span> <span class='keyword'>int</span> mode)</td></tr>
<tr class="codeline" data-linenumber="258"><td class="num" id="LN258">258</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="259"><td class="num" id="LN259">259</td><td class="line">	<span class='keyword'>extern</span> <span class='keyword'>int</span> trust_executable_bit, has_symlinks;</td></tr>
<tr class="codeline" data-linenumber="260"><td class="num" id="LN260">260</td><td class="line">	<span class='keyword'>if</span> (!has_symlinks &amp;&amp; <span class='macro'>S_ISREG(mode)<span class='macro_popup'>((((mode)) &amp; 0170000) == (0100000))</span></span> &amp;&amp;</td></tr>
<tr class="codeline" data-linenumber="261"><td class="num" id="LN261">261</td><td class="line">	    ce &amp;&amp; <span class='macro'>S_ISLNK(ce-&gt;ce_mode)<span class='macro_popup'>((((ce-&gt;ce_mode)) &amp; 0170000) == (0120000))</span></span>)</td></tr>
<tr class="codeline" data-linenumber="262"><td class="num" id="LN262">262</td><td class="line">		<span class='keyword'>return</span> ce-&gt;ce_mode;</td></tr>
<tr class="codeline" data-linenumber="263"><td class="num" id="LN263">263</td><td class="line">	<span class='keyword'>if</span> (!trust_executable_bit &amp;&amp; <span class='macro'>S_ISREG(mode)<span class='macro_popup'>((((mode)) &amp; 0170000) == (0100000))</span></span>) {</td></tr>
<tr class="codeline" data-linenumber="264"><td class="num" id="LN264">264</td><td class="line">		<span class='keyword'>if</span> (ce &amp;&amp; <span class='macro'>S_ISREG(ce-&gt;ce_mode)<span class='macro_popup'>((((ce-&gt;ce_mode)) &amp; 0170000) == (0100000))</span></span>)</td></tr>
<tr class="codeline" data-linenumber="265"><td class="num" id="LN265">265</td><td class="line">			<span class='keyword'>return</span> ce-&gt;ce_mode;</td></tr>
<tr class="codeline" data-linenumber="266"><td class="num" id="LN266">266</td><td class="line">		<span class='keyword'>return</span> create_ce_mode(0666);</td></tr>
<tr class="codeline" data-linenumber="267"><td class="num" id="LN267">267</td><td class="line">	}</td></tr>
<tr class="codeline" data-linenumber="268"><td class="num" id="LN268">268</td><td class="line">	<span class='keyword'>return</span> create_ce_mode(mode);</td></tr>
<tr class="codeline" data-linenumber="269"><td class="num" id="LN269">269</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="270"><td class="num" id="LN270">270</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> ce_to_dtype(<span class='keyword'>const</span> <span class='keyword'>struct</span> cache_entry *ce)</td></tr>
<tr class="codeline" data-linenumber="271"><td class="num" id="LN271">271</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="272"><td class="num" id="LN272">272</td><td class="line">	<span class='keyword'>unsigned</span> ce_mode = <span class='macro'>ntohl(ce-&gt;ce_mode)<span class='macro_popup'>git_bswap32(ce-&gt;ce_mode)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="273"><td class="num" id="LN273">273</td><td class="line">	<span class='keyword'>if</span> (<span class='macro'>S_ISREG(ce_mode)<span class='macro_popup'>((((ce_mode)) &amp; 0170000) == (0100000))</span></span>)</td></tr>
<tr class="codeline" data-linenumber="274"><td class="num" id="LN274">274</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>DT_REG<span class='macro_popup'>DT_REG</span></span>;</td></tr>
<tr class="codeline" data-linenumber="275"><td class="num" id="LN275">275</td><td class="line">	<span class='keyword'>else</span> <span class='keyword'>if</span> (<span class='macro'>S_ISDIR(ce_mode)<span class='macro_popup'>((((ce_mode)) &amp; 0170000) == (0040000))</span></span> || <span class='macro'>S_ISGITLINK(ce_mode)<span class='macro_popup'>(((ce_mode) &amp; 0170000) == 0160000)</span></span>)</td></tr>
<tr class="codeline" data-linenumber="276"><td class="num" id="LN276">276</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>DT_DIR<span class='macro_popup'>DT_DIR</span></span>;</td></tr>
<tr class="codeline" data-linenumber="277"><td class="num" id="LN277">277</td><td class="line">	<span class='keyword'>else</span> <span class='keyword'>if</span> (<span class='macro'>S_ISLNK(ce_mode)<span class='macro_popup'>((((ce_mode)) &amp; 0170000) == (0120000))</span></span>)</td></tr>
<tr class="codeline" data-linenumber="278"><td class="num" id="LN278">278</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>DT_LNK<span class='macro_popup'>DT_LNK</span></span>;</td></tr>
<tr class="codeline" data-linenumber="279"><td class="num" id="LN279">279</td><td class="line">	<span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="280"><td class="num" id="LN280">280</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>DT_UNKNOWN<span class='macro_popup'>DT_UNKNOWN</span></span>;</td></tr>
<tr class="codeline" data-linenumber="281"><td class="num" id="LN281">281</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="282"><td class="num" id="LN282">282</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>unsigned</span> <span class='keyword'>int</span> canon_mode(<span class='keyword'>unsigned</span> <span class='keyword'>int</span> mode)</td></tr>
<tr class="codeline" data-linenumber="283"><td class="num" id="LN283">283</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="284"><td class="num" id="LN284">284</td><td class="line">	<span class='keyword'>if</span> (<span class='macro'>S_ISREG(mode)<span class='macro_popup'>((((mode)) &amp; 0170000) == (0100000))</span></span>)</td></tr>
<tr class="codeline" data-linenumber="285"><td class="num" id="LN285">285</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>S_IFREG<span class='macro_popup'>0100000</span></span> | <span class='macro'>ce_permissions(mode)<span class='macro_popup'>(((mode) &amp; 0100) ? 0755 : 0644)</span></span>;</td></tr>
<tr class="codeline" data-linenumber="286"><td class="num" id="LN286">286</td><td class="line">	<span class='keyword'>if</span> (<span class='macro'>S_ISLNK(mode)<span class='macro_popup'>((((mode)) &amp; 0170000) == (0120000))</span></span>)</td></tr>
<tr class="codeline" data-linenumber="287"><td class="num" id="LN287">287</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>S_IFLNK<span class='macro_popup'>0120000</span></span>;</td></tr>
<tr class="codeline" data-linenumber="288"><td class="num" id="LN288">288</td><td class="line">	<span class='keyword'>if</span> (<span class='macro'>S_ISDIR(mode)<span class='macro_popup'>((((mode)) &amp; 0170000) == (0040000))</span></span>)</td></tr>
<tr class="codeline" data-linenumber="289"><td class="num" id="LN289">289</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>S_IFDIR<span class='macro_popup'>0040000</span></span>;</td></tr>
<tr class="codeline" data-linenumber="290"><td class="num" id="LN290">290</td><td class="line">	<span class='keyword'>return</span> <span class='macro'>S_IFGITLINK<span class='macro_popup'>0160000</span></span>;</td></tr>
<tr class="codeline" data-linenumber="291"><td class="num" id="LN291">291</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="292"><td class="num" id="LN292">292</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="293"><td class="num" id="LN293">293</td><td class="line"><span class='directive'>#define <span class='macro'>cache_entry_size(len)<span class='macro_popup'>(__builtin_offsetof(struct cache_entry, name) + (len) + 1)</span></span> (<span class='macro'>offsetof(struct cache_entry,name)<span class='macro_popup'>__builtin_offsetof(struct cache_entry, name)</span></span> + (len) + 1)</span></td></tr>
<tr class="codeline" data-linenumber="294"><td class="num" id="LN294">294</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="295"><td class="num" id="LN295">295</td><td class="line"><span class='directive'>#define <span class='macro'>SOMETHING_CHANGED<span class='macro_popup'>(1 &lt;&lt; 0)</span></span>	(1 &lt;&lt; 0) /* unclassified changes go here */</span></td></tr>
<tr class="codeline" data-linenumber="296"><td class="num" id="LN296">296</td><td class="line"><span class='directive'>#define <span class='macro'>CE_ENTRY_CHANGED<span class='macro_popup'>(1 &lt;&lt; 1)</span></span>	(1 &lt;&lt; 1)</span></td></tr>
<tr class="codeline" data-linenumber="297"><td class="num" id="LN297">297</td><td class="line"><span class='directive'>#define <span class='macro'>CE_ENTRY_REMOVED<span class='macro_popup'>(1 &lt;&lt; 2)</span></span>	(1 &lt;&lt; 2)</span></td></tr>
<tr class="codeline" data-linenumber="298"><td class="num" id="LN298">298</td><td class="line"><span class='directive'>#define <span class='macro'>CE_ENTRY_ADDED<span class='macro_popup'>(1 &lt;&lt; 3)</span></span>		(1 &lt;&lt; 3)</span></td></tr>
<tr class="codeline" data-linenumber="299"><td class="num" id="LN299">299</td><td class="line"><span class='directive'>#define <span class='macro'>RESOLVE_UNDO_CHANGED<span class='macro_popup'>(1 &lt;&lt; 4)</span></span>	(1 &lt;&lt; 4)</span></td></tr>
<tr class="codeline" data-linenumber="300"><td class="num" id="LN300">300</td><td class="line"><span class='directive'>#define <span class='macro'>CACHE_TREE_CHANGED<span class='macro_popup'>(1 &lt;&lt; 5)</span></span>	(1 &lt;&lt; 5)</span></td></tr>
<tr class="codeline" data-linenumber="301"><td class="num" id="LN301">301</td><td class="line"><span class='directive'>#define <span class='macro'>SPLIT_INDEX_ORDERED<span class='macro_popup'>(1 &lt;&lt; 6)</span></span>	(1 &lt;&lt; 6)</span></td></tr>
<tr class="codeline" data-linenumber="302"><td class="num" id="LN302">302</td><td class="line"><span class='directive'>#define <span class='macro'>UNTRACKED_CHANGED<span class='macro_popup'>(1 &lt;&lt; 7)</span></span>	(1 &lt;&lt; 7)</span></td></tr>
<tr class="codeline" data-linenumber="303"><td class="num" id="LN303">303</td><td class="line"><span class='directive'>#define <span class='macro'>FSMONITOR_CHANGED<span class='macro_popup'>(1 &lt;&lt; 8)</span></span>	(1 &lt;&lt; 8)</span></td></tr>
<tr class="codeline" data-linenumber="304"><td class="num" id="LN304">304</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="305"><td class="num" id="LN305">305</td><td class="line"><span class='keyword'>struct</span> split_index;</td></tr>
<tr class="codeline" data-linenumber="306"><td class="num" id="LN306">306</td><td class="line"><span class='keyword'>struct</span> untracked_cache;</td></tr>
<tr class="codeline" data-linenumber="307"><td class="num" id="LN307">307</td><td class="line"><span class='keyword'>struct</span> progress;</td></tr>
<tr class="codeline" data-linenumber="308"><td class="num" id="LN308">308</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="309"><td class="num" id="LN309">309</td><td class="line"><span class='keyword'>struct</span> index_state {</td></tr>
<tr class="codeline" data-linenumber="310"><td class="num" id="LN310">310</td><td class="line">	<span class='keyword'>struct</span> cache_entry **cache;</td></tr>
<tr class="codeline" data-linenumber="311"><td class="num" id="LN311">311</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> version;</td></tr>
<tr class="codeline" data-linenumber="312"><td class="num" id="LN312">312</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> cache_nr, cache_alloc, cache_changed;</td></tr>
<tr class="codeline" data-linenumber="313"><td class="num" id="LN313">313</td><td class="line">	<span class='keyword'>struct</span> string_list *resolve_undo;</td></tr>
<tr class="codeline" data-linenumber="314"><td class="num" id="LN314">314</td><td class="line">	<span class='keyword'>struct</span> cache_tree *cache_tree;</td></tr>
<tr class="codeline" data-linenumber="315"><td class="num" id="LN315">315</td><td class="line">	<span class='keyword'>struct</span> split_index *split_index;</td></tr>
<tr class="codeline" data-linenumber="316"><td class="num" id="LN316">316</td><td class="line">	<span class='keyword'>struct</span> cache_time timestamp;</td></tr>
<tr class="codeline" data-linenumber="317"><td class="num" id="LN317">317</td><td class="line">	<span class='keyword'>unsigned</span> name_hash_initialized : 1,</td></tr>
<tr class="codeline" data-linenumber="318"><td class="num" id="LN318">318</td><td class="line">		 initialized : 1,</td></tr>
<tr class="codeline" data-linenumber="319"><td class="num" id="LN319">319</td><td class="line">		 drop_cache_tree : 1,</td></tr>
<tr class="codeline" data-linenumber="320"><td class="num" id="LN320">320</td><td class="line">		 updated_workdir : 1,</td></tr>
<tr class="codeline" data-linenumber="321"><td class="num" id="LN321">321</td><td class="line">		 updated_skipworktree : 1,</td></tr>
<tr class="codeline" data-linenumber="322"><td class="num" id="LN322">322</td><td class="line">		 fsmonitor_has_run_once : 1;</td></tr>
<tr class="codeline" data-linenumber="323"><td class="num" id="LN323">323</td><td class="line">	<span class='keyword'>struct</span> hashmap name_hash;</td></tr>
<tr class="codeline" data-linenumber="324"><td class="num" id="LN324">324</td><td class="line">	<span class='keyword'>struct</span> hashmap dir_hash;</td></tr>
<tr class="codeline" data-linenumber="325"><td class="num" id="LN325">325</td><td class="line">	<span class='keyword'>struct</span> object_id oid;</td></tr>
<tr class="codeline" data-linenumber="326"><td class="num" id="LN326">326</td><td class="line">	<span class='keyword'>struct</span> untracked_cache *untracked;</td></tr>
<tr class="codeline" data-linenumber="327"><td class="num" id="LN327">327</td><td class="line">	<span class='keyword'>char</span> *fsmonitor_last_update;</td></tr>
<tr class="codeline" data-linenumber="328"><td class="num" id="LN328">328</td><td class="line">	<span class='keyword'>struct</span> ewah_bitmap *fsmonitor_dirty;</td></tr>
<tr class="codeline" data-linenumber="329"><td class="num" id="LN329">329</td><td class="line">	<span class='keyword'>struct</span> mem_pool *ce_mem_pool;</td></tr>
<tr class="codeline" data-linenumber="330"><td class="num" id="LN330">330</td><td class="line">	<span class='keyword'>struct</span> progress *progress;</td></tr>
<tr class="codeline" data-linenumber="331"><td class="num" id="LN331">331</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="332"><td class="num" id="LN332">332</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="333"><td class="num" id="LN333">333</td><td class="line"><span class='comment'>/* Name hashing */</span></td></tr>
<tr class="codeline" data-linenumber="334"><td class="num" id="LN334">334</td><td class="line"><span class='keyword'>int</span> test_lazy_init_name_hash(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>int</span> try_threaded);</td></tr>
<tr class="codeline" data-linenumber="335"><td class="num" id="LN335">335</td><td class="line"><span class='keyword'>void</span> add_name_hash(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>struct</span> cache_entry *ce);</td></tr>
<tr class="codeline" data-linenumber="336"><td class="num" id="LN336">336</td><td class="line"><span class='keyword'>void</span> remove_name_hash(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>struct</span> cache_entry *ce);</td></tr>
<tr class="codeline" data-linenumber="337"><td class="num" id="LN337">337</td><td class="line"><span class='keyword'>void</span> free_name_hash(<span class='keyword'>struct</span> index_state *istate);</td></tr>
<tr class="codeline" data-linenumber="338"><td class="num" id="LN338">338</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="339"><td class="num" id="LN339">339</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="340"><td class="num" id="LN340">340</td><td class="line"><span class='comment'>/* Cache entry creation and cleanup */</span></td></tr>
<tr class="codeline" data-linenumber="341"><td class="num" id="LN341">341</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="342"><td class="num" id="LN342">342</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="343"><td class="num" id="LN343">343</td><td class="line"> <span class='comment'>* Create cache_entry intended for use in the specified index. Caller</span></td></tr>
<tr class="codeline" data-linenumber="344"><td class="num" id="LN344">344</td><td class="line"> <span class='comment'>* is responsible for discarding the cache_entry with</span></td></tr>
<tr class="codeline" data-linenumber="345"><td class="num" id="LN345">345</td><td class="line"> <span class='comment'>* `discard_cache_entry`.</span></td></tr>
<tr class="codeline" data-linenumber="346"><td class="num" id="LN346">346</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="347"><td class="num" id="LN347">347</td><td class="line"><span class='keyword'>struct</span> cache_entry *make_cache_entry(<span class='keyword'>struct</span> index_state *istate,</td></tr>
<tr class="codeline" data-linenumber="348"><td class="num" id="LN348">348</td><td class="line">				     <span class='keyword'>unsigned</span> <span class='keyword'>int</span> mode,</td></tr>
<tr class="codeline" data-linenumber="349"><td class="num" id="LN349">349</td><td class="line">				     <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid,</td></tr>
<tr class="codeline" data-linenumber="350"><td class="num" id="LN350">350</td><td class="line">				     <span class='keyword'>const</span> <span class='keyword'>char</span> *path,</td></tr>
<tr class="codeline" data-linenumber="351"><td class="num" id="LN351">351</td><td class="line">				     <span class='keyword'>int</span> stage,</td></tr>
<tr class="codeline" data-linenumber="352"><td class="num" id="LN352">352</td><td class="line">				     <span class='keyword'>unsigned</span> <span class='keyword'>int</span> refresh_options);</td></tr>
<tr class="codeline" data-linenumber="353"><td class="num" id="LN353">353</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="354"><td class="num" id="LN354">354</td><td class="line"><span class='keyword'>struct</span> cache_entry *make_empty_cache_entry(<span class='keyword'>struct</span> index_state *istate,</td></tr>
<tr class="codeline" data-linenumber="355"><td class="num" id="LN355">355</td><td class="line">					   size_t name_len);</td></tr>
<tr class="codeline" data-linenumber="356"><td class="num" id="LN356">356</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="357"><td class="num" id="LN357">357</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="358"><td class="num" id="LN358">358</td><td class="line"> <span class='comment'>* Create a cache_entry that is not intended to be added to an index.</span></td></tr>
<tr class="codeline" data-linenumber="359"><td class="num" id="LN359">359</td><td class="line"> <span class='comment'>* Caller is responsible for discarding the cache_entry</span></td></tr>
<tr class="codeline" data-linenumber="360"><td class="num" id="LN360">360</td><td class="line"> <span class='comment'>* with `discard_cache_entry`.</span></td></tr>
<tr class="codeline" data-linenumber="361"><td class="num" id="LN361">361</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="362"><td class="num" id="LN362">362</td><td class="line"><span class='keyword'>struct</span> cache_entry *make_transient_cache_entry(<span class='keyword'>unsigned</span> <span class='keyword'>int</span> mode,</td></tr>
<tr class="codeline" data-linenumber="363"><td class="num" id="LN363">363</td><td class="line">					       <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid,</td></tr>
<tr class="codeline" data-linenumber="364"><td class="num" id="LN364">364</td><td class="line">					       <span class='keyword'>const</span> <span class='keyword'>char</span> *path,</td></tr>
<tr class="codeline" data-linenumber="365"><td class="num" id="LN365">365</td><td class="line">					       <span class='keyword'>int</span> stage);</td></tr>
<tr class="codeline" data-linenumber="366"><td class="num" id="LN366">366</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="367"><td class="num" id="LN367">367</td><td class="line"><span class='keyword'>struct</span> cache_entry *make_empty_transient_cache_entry(size_t name_len);</td></tr>
<tr class="codeline" data-linenumber="368"><td class="num" id="LN368">368</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="369"><td class="num" id="LN369">369</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="370"><td class="num" id="LN370">370</td><td class="line"> <span class='comment'>* Discard cache entry.</span></td></tr>
<tr class="codeline" data-linenumber="371"><td class="num" id="LN371">371</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="372"><td class="num" id="LN372">372</td><td class="line"><span class='keyword'>void</span> discard_cache_entry(<span class='keyword'>struct</span> cache_entry *ce);</td></tr>
<tr class="codeline" data-linenumber="373"><td class="num" id="LN373">373</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="374"><td class="num" id="LN374">374</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="375"><td class="num" id="LN375">375</td><td class="line"> <span class='comment'>* Check configuration if we should perform extra validation on cache</span></td></tr>
<tr class="codeline" data-linenumber="376"><td class="num" id="LN376">376</td><td class="line"> <span class='comment'>* entries.</span></td></tr>
<tr class="codeline" data-linenumber="377"><td class="num" id="LN377">377</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="378"><td class="num" id="LN378">378</td><td class="line"><span class='keyword'>int</span> should_validate_cache_entries(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="379"><td class="num" id="LN379">379</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="380"><td class="num" id="LN380">380</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="381"><td class="num" id="LN381">381</td><td class="line"> <span class='comment'>* Duplicate a cache_entry. Allocate memory for the new entry from a</span></td></tr>
<tr class="codeline" data-linenumber="382"><td class="num" id="LN382">382</td><td class="line"> <span class='comment'>* memory_pool. Takes into account cache_entry fields that are meant</span></td></tr>
<tr class="codeline" data-linenumber="383"><td class="num" id="LN383">383</td><td class="line"> <span class='comment'>* for managing the underlying memory allocation of the cache_entry.</span></td></tr>
<tr class="codeline" data-linenumber="384"><td class="num" id="LN384">384</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="385"><td class="num" id="LN385">385</td><td class="line"><span class='keyword'>struct</span> cache_entry *dup_cache_entry(<span class='keyword'>const</span> <span class='keyword'>struct</span> cache_entry *ce, <span class='keyword'>struct</span> index_state *istate);</td></tr>
<tr class="codeline" data-linenumber="386"><td class="num" id="LN386">386</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="387"><td class="num" id="LN387">387</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="388"><td class="num" id="LN388">388</td><td class="line"> <span class='comment'>* Validate the cache entries in the index.  This is an internal</span></td></tr>
<tr class="codeline" data-linenumber="389"><td class="num" id="LN389">389</td><td class="line"> <span class='comment'>* consistency check that the cache_entry structs are allocated from</span></td></tr>
<tr class="codeline" data-linenumber="390"><td class="num" id="LN390">390</td><td class="line"> <span class='comment'>* the expected memory pool.</span></td></tr>
<tr class="codeline" data-linenumber="391"><td class="num" id="LN391">391</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="392"><td class="num" id="LN392">392</td><td class="line"><span class='keyword'>void</span> validate_cache_entries(<span class='keyword'>const</span> <span class='keyword'>struct</span> index_state *istate);</td></tr>
<tr class="codeline" data-linenumber="393"><td class="num" id="LN393">393</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="394"><td class="num" id="LN394">394</td><td class="line"><span class='directive'>#ifdef USE_THE_INDEX_COMPATIBILITY_MACROS</span></td></tr>
<tr class="codeline" data-linenumber="395"><td class="num" id="LN395">395</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>struct</span> index_state the_index;</td></tr>
<tr class="codeline" data-linenumber="396"><td class="num" id="LN396">396</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="397"><td class="num" id="LN397">397</td><td class="line"><span class='directive'>#define active_cache (the_index.cache)</span></td></tr>
<tr class="codeline" data-linenumber="398"><td class="num" id="LN398">398</td><td class="line"><span class='directive'>#define active_nr (the_index.cache_nr)</span></td></tr>
<tr class="codeline" data-linenumber="399"><td class="num" id="LN399">399</td><td class="line"><span class='directive'>#define active_alloc (the_index.cache_alloc)</span></td></tr>
<tr class="codeline" data-linenumber="400"><td class="num" id="LN400">400</td><td class="line"><span class='directive'>#define active_cache_changed (the_index.cache_changed)</span></td></tr>
<tr class="codeline" data-linenumber="401"><td class="num" id="LN401">401</td><td class="line"><span class='directive'>#define active_cache_tree (the_index.cache_tree)</span></td></tr>
<tr class="codeline" data-linenumber="402"><td class="num" id="LN402">402</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="403"><td class="num" id="LN403">403</td><td class="line"><span class='directive'>#define read_cache() repo_read_index(the_repository)</span></td></tr>
<tr class="codeline" data-linenumber="404"><td class="num" id="LN404">404</td><td class="line"><span class='directive'>#define read_cache_from(path) read_index_from(&amp;the_index, (path), (get_git_dir()))</span></td></tr>
<tr class="codeline" data-linenumber="405"><td class="num" id="LN405">405</td><td class="line"><span class='directive'>#define read_cache_preload(pathspec) repo_read_index_preload(the_repository, (pathspec), 0)</span></td></tr>
<tr class="codeline" data-linenumber="406"><td class="num" id="LN406">406</td><td class="line"><span class='directive'>#define is_cache_unborn() is_index_unborn(&amp;the_index)</span></td></tr>
<tr class="codeline" data-linenumber="407"><td class="num" id="LN407">407</td><td class="line"><span class='directive'>#define read_cache_unmerged() repo_read_index_unmerged(the_repository)</span></td></tr>
<tr class="codeline" data-linenumber="408"><td class="num" id="LN408">408</td><td class="line"><span class='directive'>#define discard_cache() discard_index(&amp;the_index)</span></td></tr>
<tr class="codeline" data-linenumber="409"><td class="num" id="LN409">409</td><td class="line"><span class='directive'>#define unmerged_cache() unmerged_index(&amp;the_index)</span></td></tr>
<tr class="codeline" data-linenumber="410"><td class="num" id="LN410">410</td><td class="line"><span class='directive'>#define cache_name_pos(name, namelen) index_name_pos(&amp;the_index,(name),(namelen))</span></td></tr>
<tr class="codeline" data-linenumber="411"><td class="num" id="LN411">411</td><td class="line"><span class='directive'>#define add_cache_entry(ce, option) add_index_entry(&amp;the_index, (ce), (option))</span></td></tr>
<tr class="codeline" data-linenumber="412"><td class="num" id="LN412">412</td><td class="line"><span class='directive'>#define rename_cache_entry_at(pos, new_name) rename_index_entry_at(&amp;the_index, (pos), (new_name))</span></td></tr>
<tr class="codeline" data-linenumber="413"><td class="num" id="LN413">413</td><td class="line"><span class='directive'>#define remove_cache_entry_at(pos) remove_index_entry_at(&amp;the_index, (pos))</span></td></tr>
<tr class="codeline" data-linenumber="414"><td class="num" id="LN414">414</td><td class="line"><span class='directive'>#define remove_file_from_cache(path) remove_file_from_index(&amp;the_index, (path))</span></td></tr>
<tr class="codeline" data-linenumber="415"><td class="num" id="LN415">415</td><td class="line"><span class='directive'>#define add_to_cache(path, st, flags) add_to_index(&amp;the_index, (path), (st), (flags))</span></td></tr>
<tr class="codeline" data-linenumber="416"><td class="num" id="LN416">416</td><td class="line"><span class='directive'>#define add_file_to_cache(path, flags) add_file_to_index(&amp;the_index, (path), (flags))</span></td></tr>
<tr class="codeline" data-linenumber="417"><td class="num" id="LN417">417</td><td class="line"><span class='directive'>#define chmod_cache_entry(ce, flip) chmod_index_entry(&amp;the_index, (ce), (flip))</span></td></tr>
<tr class="codeline" data-linenumber="418"><td class="num" id="LN418">418</td><td class="line"><span class='directive'>#define refresh_cache(flags) refresh_index(&amp;the_index, (flags), <span class='macro'>NULL<span class='macro_popup'>((void*)0)</span></span>, <span class='macro'>NULL<span class='macro_popup'>((void*)0)</span></span>, <span class='macro'>NULL<span class='macro_popup'>((void*)0)</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="419"><td class="num" id="LN419">419</td><td class="line"><span class='directive'>#define refresh_and_write_cache(refresh_flags, write_flags, gentle) repo_refresh_and_write_index(the_repository, (refresh_flags), (write_flags), (gentle), <span class='macro'>NULL<span class='macro_popup'>((void*)0)</span></span>, <span class='macro'>NULL<span class='macro_popup'>((void*)0)</span></span>, <span class='macro'>NULL<span class='macro_popup'>((void*)0)</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="420"><td class="num" id="LN420">420</td><td class="line"><span class='directive'>#define ce_match_stat(ce, st, options) ie_match_stat(&amp;the_index, (ce), (st), (options))</span></td></tr>
<tr class="codeline" data-linenumber="421"><td class="num" id="LN421">421</td><td class="line"><span class='directive'>#define ce_modified(ce, st, options) ie_modified(&amp;the_index, (ce), (st), (options))</span></td></tr>
<tr class="codeline" data-linenumber="422"><td class="num" id="LN422">422</td><td class="line"><span class='directive'>#define cache_dir_exists(name, namelen) index_dir_exists(&amp;the_index, (name), (namelen))</span></td></tr>
<tr class="codeline" data-linenumber="423"><td class="num" id="LN423">423</td><td class="line"><span class='directive'>#define cache_file_exists(name, namelen, igncase) index_file_exists(&amp;the_index, (name), (namelen), (igncase))</span></td></tr>
<tr class="codeline" data-linenumber="424"><td class="num" id="LN424">424</td><td class="line"><span class='directive'>#define cache_name_is_other(name, namelen) index_name_is_other(&amp;the_index, (name), (namelen))</span></td></tr>
<tr class="codeline" data-linenumber="425"><td class="num" id="LN425">425</td><td class="line"><span class='directive'>#define resolve_undo_clear() resolve_undo_clear_index(&amp;the_index)</span></td></tr>
<tr class="codeline" data-linenumber="426"><td class="num" id="LN426">426</td><td class="line"><span class='directive'>#define unmerge_cache_entry_at(at) unmerge_index_entry_at(&amp;the_index, at)</span></td></tr>
<tr class="codeline" data-linenumber="427"><td class="num" id="LN427">427</td><td class="line"><span class='directive'>#define unmerge_cache(pathspec) unmerge_index(&amp;the_index, pathspec)</span></td></tr>
<tr class="codeline" data-linenumber="428"><td class="num" id="LN428">428</td><td class="line"><span class='directive'>#define read_blob_data_from_cache(path, sz) read_blob_data_from_index(&amp;the_index, (path), (sz))</span></td></tr>
<tr class="codeline" data-linenumber="429"><td class="num" id="LN429">429</td><td class="line"><span class='directive'>#define hold_locked_index(lock_file, flags) repo_hold_locked_index(the_repository, (lock_file), (flags))</span></td></tr>
<tr class="codeline" data-linenumber="430"><td class="num" id="LN430">430</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="431"><td class="num" id="LN431">431</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="432"><td class="num" id="LN432">432</td><td class="line"><span class='directive'>#define <span class='macro'>TYPE_BITS<span class='macro_popup'>3</span></span> 3</span></td></tr>
<tr class="codeline" data-linenumber="433"><td class="num" id="LN433">433</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="434"><td class="num" id="LN434">434</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="435"><td class="num" id="LN435">435</td><td class="line"> <span class='comment'>* Values in this enum (except those outside the 3 bit range) are part</span></td></tr>
<tr class="codeline" data-linenumber="436"><td class="num" id="LN436">436</td><td class="line"> <span class='comment'>* of pack file format. See Documentation/technical/pack-format.txt</span></td></tr>
<tr class="codeline" data-linenumber="437"><td class="num" id="LN437">437</td><td class="line"> <span class='comment'>* for more information.</span></td></tr>
<tr class="codeline" data-linenumber="438"><td class="num" id="LN438">438</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="439"><td class="num" id="LN439">439</td><td class="line"><span class='keyword'>enum</span> object_type {</td></tr>
<tr class="codeline" data-linenumber="440"><td class="num" id="LN440">440</td><td class="line">	OBJ_BAD = -1,</td></tr>
<tr class="codeline" data-linenumber="441"><td class="num" id="LN441">441</td><td class="line">	OBJ_NONE = 0,</td></tr>
<tr class="codeline" data-linenumber="442"><td class="num" id="LN442">442</td><td class="line">	OBJ_COMMIT = 1,</td></tr>
<tr class="codeline" data-linenumber="443"><td class="num" id="LN443">443</td><td class="line">	OBJ_TREE = 2,</td></tr>
<tr class="codeline" data-linenumber="444"><td class="num" id="LN444">444</td><td class="line">	OBJ_BLOB = 3,</td></tr>
<tr class="codeline" data-linenumber="445"><td class="num" id="LN445">445</td><td class="line">	OBJ_TAG = 4,</td></tr>
<tr class="codeline" data-linenumber="446"><td class="num" id="LN446">446</td><td class="line">	<span class='comment'>/* 5 for future expansion */</span></td></tr>
<tr class="codeline" data-linenumber="447"><td class="num" id="LN447">447</td><td class="line">	OBJ_OFS_DELTA = 6,</td></tr>
<tr class="codeline" data-linenumber="448"><td class="num" id="LN448">448</td><td class="line">	OBJ_REF_DELTA = 7,</td></tr>
<tr class="codeline" data-linenumber="449"><td class="num" id="LN449">449</td><td class="line">	OBJ_ANY,</td></tr>
<tr class="codeline" data-linenumber="450"><td class="num" id="LN450">450</td><td class="line">	OBJ_MAX</td></tr>
<tr class="codeline" data-linenumber="451"><td class="num" id="LN451">451</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="452"><td class="num" id="LN452">452</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="453"><td class="num" id="LN453">453</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>enum</span> object_type object_type(<span class='keyword'>unsigned</span> <span class='keyword'>int</span> mode)</td></tr>
<tr class="codeline" data-linenumber="454"><td class="num" id="LN454">454</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="455"><td class="num" id="LN455">455</td><td class="line">	<span class='keyword'>return</span> <span class='macro'>S_ISDIR(mode)<span class='macro_popup'>((((mode)) &amp; 0170000) == (0040000))</span></span> ? OBJ_TREE :</td></tr>
<tr class="codeline" data-linenumber="456"><td class="num" id="LN456">456</td><td class="line">		<span class='macro'>S_ISGITLINK(mode)<span class='macro_popup'>(((mode) &amp; 0170000) == 0160000)</span></span> ? OBJ_COMMIT :</td></tr>
<tr class="codeline" data-linenumber="457"><td class="num" id="LN457">457</td><td class="line">		OBJ_BLOB;</td></tr>
<tr class="codeline" data-linenumber="458"><td class="num" id="LN458">458</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="459"><td class="num" id="LN459">459</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="460"><td class="num" id="LN460">460</td><td class="line"><span class='comment'>/* Double-check local_repo_env below if you add to this list. */</span></td></tr>
<tr class="codeline" data-linenumber="461"><td class="num" id="LN461">461</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_DIR_ENVIRONMENT<span class='macro_popup'>"GIT_DIR"</span></span> "GIT_DIR"</span></td></tr>
<tr class="codeline" data-linenumber="462"><td class="num" id="LN462">462</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_COMMON_DIR_ENVIRONMENT<span class='macro_popup'>"GIT_COMMON_DIR"</span></span> "GIT_COMMON_DIR"</span></td></tr>
<tr class="codeline" data-linenumber="463"><td class="num" id="LN463">463</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_NAMESPACE_ENVIRONMENT<span class='macro_popup'>"GIT_NAMESPACE"</span></span> "GIT_NAMESPACE"</span></td></tr>
<tr class="codeline" data-linenumber="464"><td class="num" id="LN464">464</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_WORK_TREE_ENVIRONMENT<span class='macro_popup'>"GIT_WORK_TREE"</span></span> "GIT_WORK_TREE"</span></td></tr>
<tr class="codeline" data-linenumber="465"><td class="num" id="LN465">465</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_PREFIX_ENVIRONMENT<span class='macro_popup'>"GIT_PREFIX"</span></span> "GIT_PREFIX"</span></td></tr>
<tr class="codeline" data-linenumber="466"><td class="num" id="LN466">466</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_SUPER_PREFIX_ENVIRONMENT<span class='macro_popup'>"GIT_INTERNAL_SUPER_PREFIX"</span></span> "GIT_INTERNAL_SUPER_PREFIX"</span></td></tr>
<tr class="codeline" data-linenumber="467"><td class="num" id="LN467">467</td><td class="line"><span class='directive'>#define <span class='macro'>DEFAULT_GIT_DIR_ENVIRONMENT<span class='macro_popup'>".git"</span></span> ".git"</span></td></tr>
<tr class="codeline" data-linenumber="468"><td class="num" id="LN468">468</td><td class="line"><span class='directive'>#define <span class='macro'>DB_ENVIRONMENT<span class='macro_popup'>"GIT_OBJECT_DIRECTORY"</span></span> "GIT_OBJECT_DIRECTORY"</span></td></tr>
<tr class="codeline" data-linenumber="469"><td class="num" id="LN469">469</td><td class="line"><span class='directive'>#define <span class='macro'>INDEX_ENVIRONMENT<span class='macro_popup'>"GIT_INDEX_FILE"</span></span> "GIT_INDEX_FILE"</span></td></tr>
<tr class="codeline" data-linenumber="470"><td class="num" id="LN470">470</td><td class="line"><span class='directive'>#define <span class='macro'>GRAFT_ENVIRONMENT<span class='macro_popup'>"GIT_GRAFT_FILE"</span></span> "GIT_GRAFT_FILE"</span></td></tr>
<tr class="codeline" data-linenumber="471"><td class="num" id="LN471">471</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_SHALLOW_FILE_ENVIRONMENT<span class='macro_popup'>"GIT_SHALLOW_FILE"</span></span> "GIT_SHALLOW_FILE"</span></td></tr>
<tr class="codeline" data-linenumber="472"><td class="num" id="LN472">472</td><td class="line"><span class='directive'>#define <span class='macro'>TEMPLATE_DIR_ENVIRONMENT<span class='macro_popup'>"GIT_TEMPLATE_DIR"</span></span> "GIT_TEMPLATE_DIR"</span></td></tr>
<tr class="codeline" data-linenumber="473"><td class="num" id="LN473">473</td><td class="line"><span class='directive'>#define <span class='macro'>CONFIG_ENVIRONMENT<span class='macro_popup'>"GIT_CONFIG"</span></span> "GIT_CONFIG"</span></td></tr>
<tr class="codeline" data-linenumber="474"><td class="num" id="LN474">474</td><td class="line"><span class='directive'>#define <span class='macro'>CONFIG_DATA_ENVIRONMENT<span class='macro_popup'>"GIT_CONFIG_PARAMETERS"</span></span> "GIT_CONFIG_PARAMETERS"</span></td></tr>
<tr class="codeline" data-linenumber="475"><td class="num" id="LN475">475</td><td class="line"><span class='directive'>#define <span class='macro'>EXEC_PATH_ENVIRONMENT<span class='macro_popup'>"GIT_EXEC_PATH"</span></span> "GIT_EXEC_PATH"</span></td></tr>
<tr class="codeline" data-linenumber="476"><td class="num" id="LN476">476</td><td class="line"><span class='directive'>#define <span class='macro'>CEILING_DIRECTORIES_ENVIRONMENT<span class='macro_popup'>"GIT_CEILING_DIRECTORIES"</span></span> "GIT_CEILING_DIRECTORIES"</span></td></tr>
<tr class="codeline" data-linenumber="477"><td class="num" id="LN477">477</td><td class="line"><span class='directive'>#define <span class='macro'>NO_REPLACE_OBJECTS_ENVIRONMENT<span class='macro_popup'>"GIT_NO_REPLACE_OBJECTS"</span></span> "GIT_NO_REPLACE_OBJECTS"</span></td></tr>
<tr class="codeline" data-linenumber="478"><td class="num" id="LN478">478</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_REPLACE_REF_BASE_ENVIRONMENT<span class='macro_popup'>"GIT_REPLACE_REF_BASE"</span></span> "GIT_REPLACE_REF_BASE"</span></td></tr>
<tr class="codeline" data-linenumber="479"><td class="num" id="LN479">479</td><td class="line"><span class='directive'>#define <span class='macro'>GITATTRIBUTES_FILE<span class='macro_popup'>".gitattributes"</span></span> ".gitattributes"</span></td></tr>
<tr class="codeline" data-linenumber="480"><td class="num" id="LN480">480</td><td class="line"><span class='directive'>#define <span class='macro'>INFOATTRIBUTES_FILE<span class='macro_popup'>"info/attributes"</span></span> "info/attributes"</span></td></tr>
<tr class="codeline" data-linenumber="481"><td class="num" id="LN481">481</td><td class="line"><span class='directive'>#define <span class='macro'>ATTRIBUTE_MACRO_PREFIX<span class='macro_popup'>"[attr]"</span></span> "[attr]"</span></td></tr>
<tr class="codeline" data-linenumber="482"><td class="num" id="LN482">482</td><td class="line"><span class='directive'>#define <span class='macro'>GITMODULES_FILE<span class='macro_popup'>".gitmodules"</span></span> ".gitmodules"</span></td></tr>
<tr class="codeline" data-linenumber="483"><td class="num" id="LN483">483</td><td class="line"><span class='directive'>#define <span class='macro'>GITMODULES_INDEX<span class='macro_popup'>":.gitmodules"</span></span> ":.gitmodules"</span></td></tr>
<tr class="codeline" data-linenumber="484"><td class="num" id="LN484">484</td><td class="line"><span class='directive'>#define <span class='macro'>GITMODULES_HEAD<span class='macro_popup'>"HEAD:.gitmodules"</span></span> "HEAD:.gitmodules"</span></td></tr>
<tr class="codeline" data-linenumber="485"><td class="num" id="LN485">485</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_NOTES_REF_ENVIRONMENT<span class='macro_popup'>"GIT_NOTES_REF"</span></span> "GIT_NOTES_REF"</span></td></tr>
<tr class="codeline" data-linenumber="486"><td class="num" id="LN486">486</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_NOTES_DEFAULT_REF<span class='macro_popup'>"refs/notes/commits"</span></span> "refs/notes/commits"</span></td></tr>
<tr class="codeline" data-linenumber="487"><td class="num" id="LN487">487</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_NOTES_DISPLAY_REF_ENVIRONMENT<span class='macro_popup'>"GIT_NOTES_DISPLAY_REF"</span></span> "GIT_NOTES_DISPLAY_REF"</span></td></tr>
<tr class="codeline" data-linenumber="488"><td class="num" id="LN488">488</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_NOTES_REWRITE_REF_ENVIRONMENT<span class='macro_popup'>"GIT_NOTES_REWRITE_REF"</span></span> "GIT_NOTES_REWRITE_REF"</span></td></tr>
<tr class="codeline" data-linenumber="489"><td class="num" id="LN489">489</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_NOTES_REWRITE_MODE_ENVIRONMENT<span class='macro_popup'>"GIT_NOTES_REWRITE_MODE"</span></span> "GIT_NOTES_REWRITE_MODE"</span></td></tr>
<tr class="codeline" data-linenumber="490"><td class="num" id="LN490">490</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_LITERAL_PATHSPECS_ENVIRONMENT<span class='macro_popup'>"GIT_LITERAL_PATHSPECS"</span></span> "GIT_LITERAL_PATHSPECS"</span></td></tr>
<tr class="codeline" data-linenumber="491"><td class="num" id="LN491">491</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_GLOB_PATHSPECS_ENVIRONMENT<span class='macro_popup'>"GIT_GLOB_PATHSPECS"</span></span> "GIT_GLOB_PATHSPECS"</span></td></tr>
<tr class="codeline" data-linenumber="492"><td class="num" id="LN492">492</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_NOGLOB_PATHSPECS_ENVIRONMENT<span class='macro_popup'>"GIT_NOGLOB_PATHSPECS"</span></span> "GIT_NOGLOB_PATHSPECS"</span></td></tr>
<tr class="codeline" data-linenumber="493"><td class="num" id="LN493">493</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_ICASE_PATHSPECS_ENVIRONMENT<span class='macro_popup'>"GIT_ICASE_PATHSPECS"</span></span> "GIT_ICASE_PATHSPECS"</span></td></tr>
<tr class="codeline" data-linenumber="494"><td class="num" id="LN494">494</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_QUARANTINE_ENVIRONMENT<span class='macro_popup'>"GIT_QUARANTINE_PATH"</span></span> "GIT_QUARANTINE_PATH"</span></td></tr>
<tr class="codeline" data-linenumber="495"><td class="num" id="LN495">495</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_OPTIONAL_LOCKS_ENVIRONMENT<span class='macro_popup'>"GIT_OPTIONAL_LOCKS"</span></span> "GIT_OPTIONAL_LOCKS"</span></td></tr>
<tr class="codeline" data-linenumber="496"><td class="num" id="LN496">496</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_TEXT_DOMAIN_DIR_ENVIRONMENT<span class='macro_popup'>"GIT_TEXTDOMAINDIR"</span></span> "GIT_TEXTDOMAINDIR"</span></td></tr>
<tr class="codeline" data-linenumber="497"><td class="num" id="LN497">497</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="498"><td class="num" id="LN498">498</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="499"><td class="num" id="LN499">499</td><td class="line"> <span class='comment'>* Environment variable used in handshaking the wire protocol.</span></td></tr>
<tr class="codeline" data-linenumber="500"><td class="num" id="LN500">500</td><td class="line"> <span class='comment'>* Contains a colon ':' separated list of keys with optional values</span></td></tr>
<tr class="codeline" data-linenumber="501"><td class="num" id="LN501">501</td><td class="line"> <span class='comment'>* 'key[=value]'.  Presence of unknown keys and values must be</span></td></tr>
<tr class="codeline" data-linenumber="502"><td class="num" id="LN502">502</td><td class="line"> <span class='comment'>* ignored.</span></td></tr>
<tr class="codeline" data-linenumber="503"><td class="num" id="LN503">503</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="504"><td class="num" id="LN504">504</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_PROTOCOL_ENVIRONMENT<span class='macro_popup'>"GIT_PROTOCOL"</span></span> "GIT_PROTOCOL"</span></td></tr>
<tr class="codeline" data-linenumber="505"><td class="num" id="LN505">505</td><td class="line"><span class='comment'>/* HTTP header used to handshake the wire protocol */</span></td></tr>
<tr class="codeline" data-linenumber="506"><td class="num" id="LN506">506</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_PROTOCOL_HEADER<span class='macro_popup'>"Git-Protocol"</span></span> "Git-Protocol"</span></td></tr>
<tr class="codeline" data-linenumber="507"><td class="num" id="LN507">507</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="508"><td class="num" id="LN508">508</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="509"><td class="num" id="LN509">509</td><td class="line"> <span class='comment'>* This environment variable is expected to contain a boolean indicating</span></td></tr>
<tr class="codeline" data-linenumber="510"><td class="num" id="LN510">510</td><td class="line"> <span class='comment'>* whether we should or should not treat:</span></td></tr>
<tr class="codeline" data-linenumber="511"><td class="num" id="LN511">511</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="512"><td class="num" id="LN512">512</td><td class="line"> <span class='comment'>*   GIT_DIR=foo.git git ...</span></td></tr>
<tr class="codeline" data-linenumber="513"><td class="num" id="LN513">513</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="514"><td class="num" id="LN514">514</td><td class="line"> <span class='comment'>* as if GIT_WORK_TREE=. was given. It's not expected that users will make use</span></td></tr>
<tr class="codeline" data-linenumber="515"><td class="num" id="LN515">515</td><td class="line"> <span class='comment'>* of this, but we use it internally to communicate to sub-processes that we</span></td></tr>
<tr class="codeline" data-linenumber="516"><td class="num" id="LN516">516</td><td class="line"> <span class='comment'>* are in a bare repo. If not set, defaults to true.</span></td></tr>
<tr class="codeline" data-linenumber="517"><td class="num" id="LN517">517</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="518"><td class="num" id="LN518">518</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_IMPLICIT_WORK_TREE_ENVIRONMENT<span class='macro_popup'>"GIT_IMPLICIT_WORK_TREE"</span></span> "GIT_IMPLICIT_WORK_TREE"</span></td></tr>
<tr class="codeline" data-linenumber="519"><td class="num" id="LN519">519</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="520"><td class="num" id="LN520">520</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="521"><td class="num" id="LN521">521</td><td class="line"> <span class='comment'>* Repository-local GIT_* environment variables; these will be cleared</span></td></tr>
<tr class="codeline" data-linenumber="522"><td class="num" id="LN522">522</td><td class="line"> <span class='comment'>* when git spawns a sub-process that runs inside another repository.</span></td></tr>
<tr class="codeline" data-linenumber="523"><td class="num" id="LN523">523</td><td class="line"> <span class='comment'>* The array is NULL-terminated, which makes it easy to pass in the "env"</span></td></tr>
<tr class="codeline" data-linenumber="524"><td class="num" id="LN524">524</td><td class="line"> <span class='comment'>* parameter of a run-command invocation, or to do a simple walk.</span></td></tr>
<tr class="codeline" data-linenumber="525"><td class="num" id="LN525">525</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="526"><td class="num" id="LN526">526</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> * <span class='keyword'>const</span> local_repo_env[];</td></tr>
<tr class="codeline" data-linenumber="527"><td class="num" id="LN527">527</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="528"><td class="num" id="LN528">528</td><td class="line"><span class='keyword'>void</span> setup_git_env(<span class='keyword'>const</span> <span class='keyword'>char</span> *git_dir);</td></tr>
<tr class="codeline" data-linenumber="529"><td class="num" id="LN529">529</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="530"><td class="num" id="LN530">530</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="531"><td class="num" id="LN531">531</td><td class="line"> <span class='comment'>* Returns true iff we have a configured git repository (either via</span></td></tr>
<tr class="codeline" data-linenumber="532"><td class="num" id="LN532">532</td><td class="line"> <span class='comment'>* setup_git_directory, or in the environment via $GIT_DIR).</span></td></tr>
<tr class="codeline" data-linenumber="533"><td class="num" id="LN533">533</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="534"><td class="num" id="LN534">534</td><td class="line"><span class='keyword'>int</span> have_git_dir(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="535"><td class="num" id="LN535">535</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="536"><td class="num" id="LN536">536</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> is_bare_repository_cfg;</td></tr>
<tr class="codeline" data-linenumber="537"><td class="num" id="LN537">537</td><td class="line"><span class='keyword'>int</span> is_bare_repository(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="538"><td class="num" id="LN538">538</td><td class="line"><span class='keyword'>int</span> is_inside_git_dir(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="539"><td class="num" id="LN539">539</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>char</span> *git_work_tree_cfg;</td></tr>
<tr class="codeline" data-linenumber="540"><td class="num" id="LN540">540</td><td class="line"><span class='keyword'>int</span> is_inside_work_tree(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="541"><td class="num" id="LN541">541</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *get_git_dir(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="542"><td class="num" id="LN542">542</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *get_git_common_dir(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="543"><td class="num" id="LN543">543</td><td class="line"><span class='keyword'>char</span> *get_object_directory(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="544"><td class="num" id="LN544">544</td><td class="line"><span class='keyword'>char</span> *get_index_file(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="545"><td class="num" id="LN545">545</td><td class="line"><span class='keyword'>char</span> *get_graft_file(<span class='keyword'>struct</span> repository *r);</td></tr>
<tr class="codeline" data-linenumber="546"><td class="num" id="LN546">546</td><td class="line"><span class='keyword'>void</span> set_git_dir(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>int</span> make_realpath);</td></tr>
<tr class="codeline" data-linenumber="547"><td class="num" id="LN547">547</td><td class="line"><span class='keyword'>int</span> get_common_dir_noenv(<span class='keyword'>struct</span> strbuf *sb, <span class='keyword'>const</span> <span class='keyword'>char</span> *gitdir);</td></tr>
<tr class="codeline" data-linenumber="548"><td class="num" id="LN548">548</td><td class="line"><span class='keyword'>int</span> get_common_dir(<span class='keyword'>struct</span> strbuf *sb, <span class='keyword'>const</span> <span class='keyword'>char</span> *gitdir);</td></tr>
<tr class="codeline" data-linenumber="549"><td class="num" id="LN549">549</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *get_git_namespace(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="550"><td class="num" id="LN550">550</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *strip_namespace(<span class='keyword'>const</span> <span class='keyword'>char</span> *namespaced_ref);</td></tr>
<tr class="codeline" data-linenumber="551"><td class="num" id="LN551">551</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *get_super_prefix(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="552"><td class="num" id="LN552">552</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *get_git_work_tree(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="553"><td class="num" id="LN553">553</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="554"><td class="num" id="LN554">554</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="555"><td class="num" id="LN555">555</td><td class="line"> <span class='comment'>* Return true if the given path is a git directory; note that this _just_</span></td></tr>
<tr class="codeline" data-linenumber="556"><td class="num" id="LN556">556</td><td class="line"> <span class='comment'>* looks at the directory itself. If you want to know whether "foo/.git"</span></td></tr>
<tr class="codeline" data-linenumber="557"><td class="num" id="LN557">557</td><td class="line"> <span class='comment'>* is a repository, you must feed that path, not just "foo".</span></td></tr>
<tr class="codeline" data-linenumber="558"><td class="num" id="LN558">558</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="559"><td class="num" id="LN559">559</td><td class="line"><span class='keyword'>int</span> is_git_directory(<span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="560"><td class="num" id="LN560">560</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="561"><td class="num" id="LN561">561</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="562"><td class="num" id="LN562">562</td><td class="line"> <span class='comment'>* Return 1 if the given path is the root of a git repository or</span></td></tr>
<tr class="codeline" data-linenumber="563"><td class="num" id="LN563">563</td><td class="line"> <span class='comment'>* submodule, else 0. Will not return 1 for bare repositories with the</span></td></tr>
<tr class="codeline" data-linenumber="564"><td class="num" id="LN564">564</td><td class="line"> <span class='comment'>* exception of creating a bare repository in "foo/.git" and calling</span></td></tr>
<tr class="codeline" data-linenumber="565"><td class="num" id="LN565">565</td><td class="line"> <span class='comment'>* is_git_repository("foo").</span></td></tr>
<tr class="codeline" data-linenumber="566"><td class="num" id="LN566">566</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="567"><td class="num" id="LN567">567</td><td class="line"> <span class='comment'>* If we run into read errors, we err on the side of saying "yes, it is",</span></td></tr>
<tr class="codeline" data-linenumber="568"><td class="num" id="LN568">568</td><td class="line"> <span class='comment'>* as we usually consider sub-repos precious, and would prefer to err on the</span></td></tr>
<tr class="codeline" data-linenumber="569"><td class="num" id="LN569">569</td><td class="line"> <span class='comment'>* side of not disrupting or deleting them.</span></td></tr>
<tr class="codeline" data-linenumber="570"><td class="num" id="LN570">570</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="571"><td class="num" id="LN571">571</td><td class="line"><span class='keyword'>int</span> is_nonbare_repository_dir(<span class='keyword'>struct</span> strbuf *path);</td></tr>
<tr class="codeline" data-linenumber="572"><td class="num" id="LN572">572</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="573"><td class="num" id="LN573">573</td><td class="line"><span class='directive'>#define <span class='macro'>READ_GITFILE_ERR_STAT_FAILED<span class='macro_popup'>1</span></span> 1</span></td></tr>
<tr class="codeline" data-linenumber="574"><td class="num" id="LN574">574</td><td class="line"><span class='directive'>#define <span class='macro'>READ_GITFILE_ERR_NOT_A_FILE<span class='macro_popup'>2</span></span> 2</span></td></tr>
<tr class="codeline" data-linenumber="575"><td class="num" id="LN575">575</td><td class="line"><span class='directive'>#define <span class='macro'>READ_GITFILE_ERR_OPEN_FAILED<span class='macro_popup'>3</span></span> 3</span></td></tr>
<tr class="codeline" data-linenumber="576"><td class="num" id="LN576">576</td><td class="line"><span class='directive'>#define <span class='macro'>READ_GITFILE_ERR_READ_FAILED<span class='macro_popup'>4</span></span> 4</span></td></tr>
<tr class="codeline" data-linenumber="577"><td class="num" id="LN577">577</td><td class="line"><span class='directive'>#define <span class='macro'>READ_GITFILE_ERR_INVALID_FORMAT<span class='macro_popup'>5</span></span> 5</span></td></tr>
<tr class="codeline" data-linenumber="578"><td class="num" id="LN578">578</td><td class="line"><span class='directive'>#define <span class='macro'>READ_GITFILE_ERR_NO_PATH<span class='macro_popup'>6</span></span> 6</span></td></tr>
<tr class="codeline" data-linenumber="579"><td class="num" id="LN579">579</td><td class="line"><span class='directive'>#define <span class='macro'>READ_GITFILE_ERR_NOT_A_REPO<span class='macro_popup'>7</span></span> 7</span></td></tr>
<tr class="codeline" data-linenumber="580"><td class="num" id="LN580">580</td><td class="line"><span class='directive'>#define <span class='macro'>READ_GITFILE_ERR_TOO_LARGE<span class='macro_popup'>8</span></span> 8</span></td></tr>
<tr class="codeline" data-linenumber="581"><td class="num" id="LN581">581</td><td class="line"><span class='keyword'>void</span> read_gitfile_error_die(<span class='keyword'>int</span> error_code, <span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>const</span> <span class='keyword'>char</span> *dir);</td></tr>
<tr class="codeline" data-linenumber="582"><td class="num" id="LN582">582</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *read_gitfile_gently(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>int</span> *return_error_code);</td></tr>
<tr class="codeline" data-linenumber="583"><td class="num" id="LN583">583</td><td class="line"><span class='directive'>#define <span class='macro'>read_gitfile(path)<span class='macro_popup'>read_gitfile_gently((path), ((void*)0))</span></span> read_gitfile_gently((path), <span class='macro'>NULL<span class='macro_popup'>((void*)0)</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="584"><td class="num" id="LN584">584</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *resolve_gitdir_gently(<span class='keyword'>const</span> <span class='keyword'>char</span> *suspect, <span class='keyword'>int</span> *return_error_code);</td></tr>
<tr class="codeline" data-linenumber="585"><td class="num" id="LN585">585</td><td class="line"><span class='directive'>#define <span class='macro'>resolve_gitdir(path)<span class='macro_popup'>resolve_gitdir_gently((path), ((void*)0))</span></span> resolve_gitdir_gently((path), <span class='macro'>NULL<span class='macro_popup'>((void*)0)</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="586"><td class="num" id="LN586">586</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="587"><td class="num" id="LN587">587</td><td class="line"><span class='keyword'>void</span> set_git_work_tree(<span class='keyword'>const</span> <span class='keyword'>char</span> *tree);</td></tr>
<tr class="codeline" data-linenumber="588"><td class="num" id="LN588">588</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="589"><td class="num" id="LN589">589</td><td class="line"><span class='directive'>#define <span class='macro'>ALTERNATE_DB_ENVIRONMENT<span class='macro_popup'>"GIT_ALTERNATE_OBJECT_DIRECTORIES"</span></span> "GIT_ALTERNATE_OBJECT_DIRECTORIES"</span></td></tr>
<tr class="codeline" data-linenumber="590"><td class="num" id="LN590">590</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="591"><td class="num" id="LN591">591</td><td class="line"><span class='keyword'>void</span> setup_work_tree(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="592"><td class="num" id="LN592">592</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="593"><td class="num" id="LN593">593</td><td class="line"> <span class='comment'>* Find the commondir and gitdir of the repository that contains the current</span></td></tr>
<tr class="codeline" data-linenumber="594"><td class="num" id="LN594">594</td><td class="line"> <span class='comment'>* working directory, without changing the working directory or other global</span></td></tr>
<tr class="codeline" data-linenumber="595"><td class="num" id="LN595">595</td><td class="line"> <span class='comment'>* state. The result is appended to commondir and gitdir.  If the discovered</span></td></tr>
<tr class="codeline" data-linenumber="596"><td class="num" id="LN596">596</td><td class="line"> <span class='comment'>* gitdir does not correspond to a worktree, then 'commondir' and 'gitdir' will</span></td></tr>
<tr class="codeline" data-linenumber="597"><td class="num" id="LN597">597</td><td class="line"> <span class='comment'>* both have the same result appended to the buffer.  The return value is</span></td></tr>
<tr class="codeline" data-linenumber="598"><td class="num" id="LN598">598</td><td class="line"> <span class='comment'>* either 0 upon success and non-zero if no repository was found.</span></td></tr>
<tr class="codeline" data-linenumber="599"><td class="num" id="LN599">599</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="600"><td class="num" id="LN600">600</td><td class="line"><span class='keyword'>int</span> discover_git_directory(<span class='keyword'>struct</span> strbuf *commondir,</td></tr>
<tr class="codeline" data-linenumber="601"><td class="num" id="LN601">601</td><td class="line">			   <span class='keyword'>struct</span> strbuf *gitdir);</td></tr>
<tr class="codeline" data-linenumber="602"><td class="num" id="LN602">602</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *setup_git_directory_gently(<span class='keyword'>int</span> *);</td></tr>
<tr class="codeline" data-linenumber="603"><td class="num" id="LN603">603</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *setup_git_directory(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="604"><td class="num" id="LN604">604</td><td class="line"><span class='keyword'>char</span> *prefix_path(<span class='keyword'>const</span> <span class='keyword'>char</span> *prefix, <span class='keyword'>int</span> len, <span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="605"><td class="num" id="LN605">605</td><td class="line"><span class='keyword'>char</span> *prefix_path_gently(<span class='keyword'>const</span> <span class='keyword'>char</span> *prefix, <span class='keyword'>int</span> len, <span class='keyword'>int</span> *remaining, <span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="606"><td class="num" id="LN606">606</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="607"><td class="num" id="LN607">607</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="608"><td class="num" id="LN608">608</td><td class="line"> <span class='comment'>* Concatenate "prefix" (if len is non-zero) and "path", with no</span></td></tr>
<tr class="codeline" data-linenumber="609"><td class="num" id="LN609">609</td><td class="line"> <span class='comment'>* connecting characters (so "prefix" should end with a "/").</span></td></tr>
<tr class="codeline" data-linenumber="610"><td class="num" id="LN610">610</td><td class="line"> <span class='comment'>* Unlike prefix_path, this should be used if the named file does</span></td></tr>
<tr class="codeline" data-linenumber="611"><td class="num" id="LN611">611</td><td class="line"> <span class='comment'>* not have to interact with index entry; i.e. name of a random file</span></td></tr>
<tr class="codeline" data-linenumber="612"><td class="num" id="LN612">612</td><td class="line"> <span class='comment'>* on the filesystem.</span></td></tr>
<tr class="codeline" data-linenumber="613"><td class="num" id="LN613">613</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="614"><td class="num" id="LN614">614</td><td class="line"> <span class='comment'>* The return value is always a newly allocated string (even if the</span></td></tr>
<tr class="codeline" data-linenumber="615"><td class="num" id="LN615">615</td><td class="line"> <span class='comment'>* prefix was empty).</span></td></tr>
<tr class="codeline" data-linenumber="616"><td class="num" id="LN616">616</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="617"><td class="num" id="LN617">617</td><td class="line"><span class='keyword'>char</span> *prefix_filename(<span class='keyword'>const</span> <span class='keyword'>char</span> *prefix, <span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="618"><td class="num" id="LN618">618</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="619"><td class="num" id="LN619">619</td><td class="line"><span class='keyword'>int</span> check_filename(<span class='keyword'>const</span> <span class='keyword'>char</span> *prefix, <span class='keyword'>const</span> <span class='keyword'>char</span> *name);</td></tr>
<tr class="codeline" data-linenumber="620"><td class="num" id="LN620">620</td><td class="line"><span class='keyword'>void</span> verify_filename(<span class='keyword'>const</span> <span class='keyword'>char</span> *prefix,</td></tr>
<tr class="codeline" data-linenumber="621"><td class="num" id="LN621">621</td><td class="line">		     <span class='keyword'>const</span> <span class='keyword'>char</span> *name,</td></tr>
<tr class="codeline" data-linenumber="622"><td class="num" id="LN622">622</td><td class="line">		     <span class='keyword'>int</span> diagnose_misspelt_rev);</td></tr>
<tr class="codeline" data-linenumber="623"><td class="num" id="LN623">623</td><td class="line"><span class='keyword'>void</span> verify_non_filename(<span class='keyword'>const</span> <span class='keyword'>char</span> *prefix, <span class='keyword'>const</span> <span class='keyword'>char</span> *name);</td></tr>
<tr class="codeline" data-linenumber="624"><td class="num" id="LN624">624</td><td class="line"><span class='keyword'>int</span> path_inside_repo(<span class='keyword'>const</span> <span class='keyword'>char</span> *prefix, <span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="625"><td class="num" id="LN625">625</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="626"><td class="num" id="LN626">626</td><td class="line"><span class='directive'>#define <span class='macro'>INIT_DB_QUIET<span class='macro_popup'>0x0001</span></span> 0x0001</span></td></tr>
<tr class="codeline" data-linenumber="627"><td class="num" id="LN627">627</td><td class="line"><span class='directive'>#define <span class='macro'>INIT_DB_EXIST_OK<span class='macro_popup'>0x0002</span></span> 0x0002</span></td></tr>
<tr class="codeline" data-linenumber="628"><td class="num" id="LN628">628</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="629"><td class="num" id="LN629">629</td><td class="line"><span class='keyword'>int</span> init_db(<span class='keyword'>const</span> <span class='keyword'>char</span> *git_dir, <span class='keyword'>const</span> <span class='keyword'>char</span> *real_git_dir,</td></tr>
<tr class="codeline" data-linenumber="630"><td class="num" id="LN630">630</td><td class="line">	    <span class='keyword'>const</span> <span class='keyword'>char</span> *template_dir, <span class='keyword'>int</span> hash_algo,</td></tr>
<tr class="codeline" data-linenumber="631"><td class="num" id="LN631">631</td><td class="line">	    <span class='keyword'>const</span> <span class='keyword'>char</span> *initial_branch, <span class='keyword'>unsigned</span> <span class='keyword'>int</span> flags);</td></tr>
<tr class="codeline" data-linenumber="632"><td class="num" id="LN632">632</td><td class="line"><span class='keyword'>void</span> initialize_repository_version(<span class='keyword'>int</span> hash_algo, <span class='keyword'>int</span> reinit);</td></tr>
<tr class="codeline" data-linenumber="633"><td class="num" id="LN633">633</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="634"><td class="num" id="LN634">634</td><td class="line"><span class='keyword'>void</span> sanitize_stdfds(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="635"><td class="num" id="LN635">635</td><td class="line"><span class='keyword'>int</span> daemonize(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="636"><td class="num" id="LN636">636</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="637"><td class="num" id="LN637">637</td><td class="line"><span class='directive'>#define <span class='macro'>alloc_nr(x)<span class='macro_popup'>(((x)+16)*3/2)</span></span> (((x)+16)*3/2)</span></td></tr>
<tr class="codeline" data-linenumber="638"><td class="num" id="LN638">638</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="639"><td class="num" id="LN639">639</td><td class="line"><span class='comment'>/**</span></td></tr>
<tr class="codeline" data-linenumber="640"><td class="num" id="LN640">640</td><td class="line"> <span class='comment'>* Dynamically growing an array using realloc() is error prone and boring.</span></td></tr>
<tr class="codeline" data-linenumber="641"><td class="num" id="LN641">641</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="642"><td class="num" id="LN642">642</td><td class="line"> <span class='comment'>* Define your array with:</span></td></tr>
<tr class="codeline" data-linenumber="643"><td class="num" id="LN643">643</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="644"><td class="num" id="LN644">644</td><td class="line"> <span class='comment'>* - a pointer (`item`) that points at the array, initialized to `NULL`</span></td></tr>
<tr class="codeline" data-linenumber="645"><td class="num" id="LN645">645</td><td class="line"> <span class='comment'>*   (although please name the variable based on its contents, not on its</span></td></tr>
<tr class="codeline" data-linenumber="646"><td class="num" id="LN646">646</td><td class="line"> <span class='comment'>*   type);</span></td></tr>
<tr class="codeline" data-linenumber="647"><td class="num" id="LN647">647</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="648"><td class="num" id="LN648">648</td><td class="line"> <span class='comment'>* - an integer variable (`alloc`) that keeps track of how big the current</span></td></tr>
<tr class="codeline" data-linenumber="649"><td class="num" id="LN649">649</td><td class="line"> <span class='comment'>*   allocation is, initialized to `0`;</span></td></tr>
<tr class="codeline" data-linenumber="650"><td class="num" id="LN650">650</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="651"><td class="num" id="LN651">651</td><td class="line"> <span class='comment'>* - another integer variable (`nr`) to keep track of how many elements the</span></td></tr>
<tr class="codeline" data-linenumber="652"><td class="num" id="LN652">652</td><td class="line"> <span class='comment'>*   array currently has, initialized to `0`.</span></td></tr>
<tr class="codeline" data-linenumber="653"><td class="num" id="LN653">653</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="654"><td class="num" id="LN654">654</td><td class="line"> <span class='comment'>* Then before adding `n`th element to the item, call `ALLOC_GROW(item, n,</span></td></tr>
<tr class="codeline" data-linenumber="655"><td class="num" id="LN655">655</td><td class="line"> <span class='comment'>* alloc)`.  This ensures that the array can hold at least `n` elements by</span></td></tr>
<tr class="codeline" data-linenumber="656"><td class="num" id="LN656">656</td><td class="line"> <span class='comment'>* calling `realloc(3)` and adjusting `alloc` variable.</span></td></tr>
<tr class="codeline" data-linenumber="657"><td class="num" id="LN657">657</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="658"><td class="num" id="LN658">658</td><td class="line"> <span class='comment'>* ------------</span></td></tr>
<tr class="codeline" data-linenumber="659"><td class="num" id="LN659">659</td><td class="line"> <span class='comment'>* sometype *item;</span></td></tr>
<tr class="codeline" data-linenumber="660"><td class="num" id="LN660">660</td><td class="line"> <span class='comment'>* size_t nr;</span></td></tr>
<tr class="codeline" data-linenumber="661"><td class="num" id="LN661">661</td><td class="line"> <span class='comment'>* size_t alloc</span></td></tr>
<tr class="codeline" data-linenumber="662"><td class="num" id="LN662">662</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="663"><td class="num" id="LN663">663</td><td class="line"> <span class='comment'>* for (i = 0; i &lt; nr; i++)</span></td></tr>
<tr class="codeline" data-linenumber="664"><td class="num" id="LN664">664</td><td class="line"> <span class='comment'>* 	if (we like item[i] already)</span></td></tr>
<tr class="codeline" data-linenumber="665"><td class="num" id="LN665">665</td><td class="line"> <span class='comment'>* 		return;</span></td></tr>
<tr class="codeline" data-linenumber="666"><td class="num" id="LN666">666</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="667"><td class="num" id="LN667">667</td><td class="line"> <span class='comment'>* // we did not like any existing one, so add one</span></td></tr>
<tr class="codeline" data-linenumber="668"><td class="num" id="LN668">668</td><td class="line"> <span class='comment'>* ALLOC_GROW(item, nr + 1, alloc);</span></td></tr>
<tr class="codeline" data-linenumber="669"><td class="num" id="LN669">669</td><td class="line"> <span class='comment'>* item[nr++] = value you like;</span></td></tr>
<tr class="codeline" data-linenumber="670"><td class="num" id="LN670">670</td><td class="line"> <span class='comment'>* ------------</span></td></tr>
<tr class="codeline" data-linenumber="671"><td class="num" id="LN671">671</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="672"><td class="num" id="LN672">672</td><td class="line"> <span class='comment'>* You are responsible for updating the `nr` variable.</span></td></tr>
<tr class="codeline" data-linenumber="673"><td class="num" id="LN673">673</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="674"><td class="num" id="LN674">674</td><td class="line"> <span class='comment'>* If you need to specify the number of elements to allocate explicitly</span></td></tr>
<tr class="codeline" data-linenumber="675"><td class="num" id="LN675">675</td><td class="line"> <span class='comment'>* then use the macro `REALLOC_ARRAY(item, alloc)` instead of `ALLOC_GROW`.</span></td></tr>
<tr class="codeline" data-linenumber="676"><td class="num" id="LN676">676</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="677"><td class="num" id="LN677">677</td><td class="line"> <span class='comment'>* Consider using ALLOC_GROW_BY instead of ALLOC_GROW as it has some</span></td></tr>
<tr class="codeline" data-linenumber="678"><td class="num" id="LN678">678</td><td class="line"> <span class='comment'>* added niceties.</span></td></tr>
<tr class="codeline" data-linenumber="679"><td class="num" id="LN679">679</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="680"><td class="num" id="LN680">680</td><td class="line"> <span class='comment'>* DO NOT USE any expression with side-effect for 'x', 'nr', or 'alloc'.</span></td></tr>
<tr class="codeline" data-linenumber="681"><td class="num" id="LN681">681</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="682"><td class="num" id="LN682">682</td><td class="line"><span class='directive'>#define <span class='macro'>ALLOC_GROW(x, nr, alloc)<span class='macro_popup'>do { if ((nr) &gt; alloc) { if ((((alloc)+16)*3/2) &lt; (nr))<br> alloc = (nr); else alloc = (((alloc)+16)*3/2); (x) = xrealloc<br>((x), st_mult(sizeof(*(x)), (alloc))); } } while (0)</span></span> \</span></td></tr>
<tr class="codeline" data-linenumber="683"><td class="num" id="LN683">683</td><td class="line">	<span class='directive'>do { \</span></td></tr>
<tr class="codeline" data-linenumber="684"><td class="num" id="LN684">684</td><td class="line">		<span class='directive'>if ((nr) &gt; alloc) { \</span></td></tr>
<tr class="codeline" data-linenumber="685"><td class="num" id="LN685">685</td><td class="line">			<span class='directive'>if (<span class='macro'>alloc_nr(alloc)<span class='macro_popup'>(((alloc)+16)*3/2)</span></span> &lt; (nr)) \</span></td></tr>
<tr class="codeline" data-linenumber="686"><td class="num" id="LN686">686</td><td class="line">				<span class='directive'>alloc = (nr); \</span></td></tr>
<tr class="codeline" data-linenumber="687"><td class="num" id="LN687">687</td><td class="line">			<span class='directive'>else \</span></td></tr>
<tr class="codeline" data-linenumber="688"><td class="num" id="LN688">688</td><td class="line">				<span class='directive'>alloc = <span class='macro'>alloc_nr(alloc)<span class='macro_popup'>(((alloc)+16)*3/2)</span></span>; \</span></td></tr>
<tr class="codeline" data-linenumber="689"><td class="num" id="LN689">689</td><td class="line">			<span class='directive'><span class='macro'>REALLOC_ARRAY(x, alloc)<span class='macro_popup'>(x) = xrealloc((x), st_mult(sizeof(*(x)), (alloc)))</span></span>; \</span></td></tr>
<tr class="codeline" data-linenumber="690"><td class="num" id="LN690">690</td><td class="line">		<span class='directive'>} \</span></td></tr>
<tr class="codeline" data-linenumber="691"><td class="num" id="LN691">691</td><td class="line">	<span class='directive'>} while (0)</span></td></tr>
<tr class="codeline" data-linenumber="692"><td class="num" id="LN692">692</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="693"><td class="num" id="LN693">693</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="694"><td class="num" id="LN694">694</td><td class="line"> <span class='comment'>* Similar to ALLOC_GROW but handles updating of the nr value and</span></td></tr>
<tr class="codeline" data-linenumber="695"><td class="num" id="LN695">695</td><td class="line"> <span class='comment'>* zeroing the bytes of the newly-grown array elements.</span></td></tr>
<tr class="codeline" data-linenumber="696"><td class="num" id="LN696">696</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="697"><td class="num" id="LN697">697</td><td class="line"> <span class='comment'>* DO NOT USE any expression with side-effect for any of the</span></td></tr>
<tr class="codeline" data-linenumber="698"><td class="num" id="LN698">698</td><td class="line"> <span class='comment'>* arguments.</span></td></tr>
<tr class="codeline" data-linenumber="699"><td class="num" id="LN699">699</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="700"><td class="num" id="LN700">700</td><td class="line"><span class='directive'>#define <span class='macro'>ALLOC_GROW_BY(x, nr, increase, alloc)<span class='macro_popup'>do { if (increase) { size_t new_nr = nr + (increase); if (new_nr<br> &lt; nr) BUG_fl("./cache.h", 700, "negative growth in ALLOC_GROW_BY"<br>); do { if ((new_nr) &gt; alloc) { if ((((alloc)+16)*3/2) &lt;<br> (new_nr)) alloc = (new_nr); else alloc = (((alloc)+16)*3/2);<br> (x) = xrealloc((x), st_mult(sizeof(*(x)), (alloc))); } } while<br> (0); memset((x) + nr, 0, sizeof(*(x)) * (increase)); nr = new_nr<br>; } } while (0)</span></span> \</span></td></tr>
<tr class="codeline" data-linenumber="701"><td class="num" id="LN701">701</td><td class="line">	<span class='directive'>do { \</span></td></tr>
<tr class="codeline" data-linenumber="702"><td class="num" id="LN702">702</td><td class="line">		<span class='directive'>if (increase) { \</span></td></tr>
<tr class="codeline" data-linenumber="703"><td class="num" id="LN703">703</td><td class="line">			<span class='directive'>size_t new_nr = nr + (increase); \</span></td></tr>
<tr class="codeline" data-linenumber="704"><td class="num" id="LN704">704</td><td class="line">			<span class='directive'>if (new_nr &lt; nr) \</span></td></tr>
<tr class="codeline" data-linenumber="705"><td class="num" id="LN705">705</td><td class="line">				<span class='directive'><span class='macro'>BUG("negative growth in ALLOC_GROW_BY")<span class='macro_popup'>BUG_fl("./cache.h", 705, "negative growth in ALLOC_GROW_BY")</span></span>; \</span></td></tr>
<tr class="codeline" data-linenumber="706"><td class="num" id="LN706">706</td><td class="line">			<span class='directive'><span class='macro'>ALLOC_GROW(x, new_nr, alloc)<span class='macro_popup'>do { if ((new_nr) &gt; alloc) { if ((((alloc)+16)*3/2) &lt; (<br>new_nr)) alloc = (new_nr); else alloc = (((alloc)+16)*3/2); (<br>x) = xrealloc((x), st_mult(sizeof(*(x)), (alloc))); } } while<br> (0)</span></span>; \</span></td></tr>
<tr class="codeline" data-linenumber="707"><td class="num" id="LN707">707</td><td class="line">			<span class='directive'>memset((x) + nr, 0, sizeof(*(x)) * (increase)); \</span></td></tr>
<tr class="codeline" data-linenumber="708"><td class="num" id="LN708">708</td><td class="line">			<span class='directive'>nr = new_nr; \</span></td></tr>
<tr class="codeline" data-linenumber="709"><td class="num" id="LN709">709</td><td class="line">		<span class='directive'>} \</span></td></tr>
<tr class="codeline" data-linenumber="710"><td class="num" id="LN710">710</td><td class="line">	<span class='directive'>} while (0)</span></td></tr>
<tr class="codeline" data-linenumber="711"><td class="num" id="LN711">711</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="712"><td class="num" id="LN712">712</td><td class="line"><span class='comment'>/* Initialize and use the cache information */</span></td></tr>
<tr class="codeline" data-linenumber="713"><td class="num" id="LN713">713</td><td class="line"><span class='keyword'>struct</span> lock_file;</td></tr>
<tr class="codeline" data-linenumber="714"><td class="num" id="LN714">714</td><td class="line"><span class='keyword'>void</span> preload_index(<span class='keyword'>struct</span> index_state *index,</td></tr>
<tr class="codeline" data-linenumber="715"><td class="num" id="LN715">715</td><td class="line">		   <span class='keyword'>const</span> <span class='keyword'>struct</span> pathspec *pathspec,</td></tr>
<tr class="codeline" data-linenumber="716"><td class="num" id="LN716">716</td><td class="line">		   <span class='keyword'>unsigned</span> <span class='keyword'>int</span> refresh_flags);</td></tr>
<tr class="codeline" data-linenumber="717"><td class="num" id="LN717">717</td><td class="line"><span class='keyword'>int</span> do_read_index(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>const</span> <span class='keyword'>char</span> *path,</td></tr>
<tr class="codeline" data-linenumber="718"><td class="num" id="LN718">718</td><td class="line">		  <span class='keyword'>int</span> must_exist); <span class='comment'>/* for testting only! */</span></td></tr>
<tr class="codeline" data-linenumber="719"><td class="num" id="LN719">719</td><td class="line"><span class='keyword'>int</span> read_index_from(<span class='keyword'>struct</span> index_state *, <span class='keyword'>const</span> <span class='keyword'>char</span> *path,</td></tr>
<tr class="codeline" data-linenumber="720"><td class="num" id="LN720">720</td><td class="line">		    <span class='keyword'>const</span> <span class='keyword'>char</span> *gitdir);</td></tr>
<tr class="codeline" data-linenumber="721"><td class="num" id="LN721">721</td><td class="line"><span class='keyword'>int</span> is_index_unborn(<span class='keyword'>struct</span> index_state *);</td></tr>
<tr class="codeline" data-linenumber="722"><td class="num" id="LN722">722</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="723"><td class="num" id="LN723">723</td><td class="line"><span class='comment'>/* For use with `write_locked_index()`. */</span></td></tr>
<tr class="codeline" data-linenumber="724"><td class="num" id="LN724">724</td><td class="line"><span class='directive'>#define <span class='macro'>COMMIT_LOCK<span class='macro_popup'>(1 &lt;&lt; 0)</span></span>		(1 &lt;&lt; 0)</span></td></tr>
<tr class="codeline" data-linenumber="725"><td class="num" id="LN725">725</td><td class="line"><span class='directive'>#define <span class='macro'>SKIP_IF_UNCHANGED<span class='macro_popup'>(1 &lt;&lt; 1)</span></span>	(1 &lt;&lt; 1)</span></td></tr>
<tr class="codeline" data-linenumber="726"><td class="num" id="LN726">726</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="727"><td class="num" id="LN727">727</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="728"><td class="num" id="LN728">728</td><td class="line"> <span class='comment'>* Write the index while holding an already-taken lock. Close the lock,</span></td></tr>
<tr class="codeline" data-linenumber="729"><td class="num" id="LN729">729</td><td class="line"> <span class='comment'>* and if `COMMIT_LOCK` is given, commit it.</span></td></tr>
<tr class="codeline" data-linenumber="730"><td class="num" id="LN730">730</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="731"><td class="num" id="LN731">731</td><td class="line"> <span class='comment'>* Unless a split index is in use, write the index into the lockfile.</span></td></tr>
<tr class="codeline" data-linenumber="732"><td class="num" id="LN732">732</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="733"><td class="num" id="LN733">733</td><td class="line"> <span class='comment'>* With a split index, write the shared index to a temporary file,</span></td></tr>
<tr class="codeline" data-linenumber="734"><td class="num" id="LN734">734</td><td class="line"> <span class='comment'>* adjust its permissions and rename it into place, then write the</span></td></tr>
<tr class="codeline" data-linenumber="735"><td class="num" id="LN735">735</td><td class="line"> <span class='comment'>* split index to the lockfile. If the temporary file for the shared</span></td></tr>
<tr class="codeline" data-linenumber="736"><td class="num" id="LN736">736</td><td class="line"> <span class='comment'>* index cannot be created, fall back to the behavior described in</span></td></tr>
<tr class="codeline" data-linenumber="737"><td class="num" id="LN737">737</td><td class="line"> <span class='comment'>* the previous paragraph.</span></td></tr>
<tr class="codeline" data-linenumber="738"><td class="num" id="LN738">738</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="739"><td class="num" id="LN739">739</td><td class="line"> <span class='comment'>* With `COMMIT_LOCK`, the lock is always committed or rolled back.</span></td></tr>
<tr class="codeline" data-linenumber="740"><td class="num" id="LN740">740</td><td class="line"> <span class='comment'>* Without it, the lock is closed, but neither committed nor rolled</span></td></tr>
<tr class="codeline" data-linenumber="741"><td class="num" id="LN741">741</td><td class="line"> <span class='comment'>* back.</span></td></tr>
<tr class="codeline" data-linenumber="742"><td class="num" id="LN742">742</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="743"><td class="num" id="LN743">743</td><td class="line"> <span class='comment'>* If `SKIP_IF_UNCHANGED` is given and the index is unchanged, nothing</span></td></tr>
<tr class="codeline" data-linenumber="744"><td class="num" id="LN744">744</td><td class="line"> <span class='comment'>* is written (and the lock is rolled back if `COMMIT_LOCK` is given).</span></td></tr>
<tr class="codeline" data-linenumber="745"><td class="num" id="LN745">745</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="746"><td class="num" id="LN746">746</td><td class="line"><span class='keyword'>int</span> write_locked_index(<span class='keyword'>struct</span> index_state *, <span class='keyword'>struct</span> lock_file *lock, <span class='keyword'>unsigned</span> flags);</td></tr>
<tr class="codeline" data-linenumber="747"><td class="num" id="LN747">747</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="748"><td class="num" id="LN748">748</td><td class="line"><span class='keyword'>int</span> discard_index(<span class='keyword'>struct</span> index_state *);</td></tr>
<tr class="codeline" data-linenumber="749"><td class="num" id="LN749">749</td><td class="line"><span class='keyword'>void</span> move_index_extensions(<span class='keyword'>struct</span> index_state *dst, <span class='keyword'>struct</span> index_state *src);</td></tr>
<tr class="codeline" data-linenumber="750"><td class="num" id="LN750">750</td><td class="line"><span class='keyword'>int</span> unmerged_index(<span class='keyword'>const</span> <span class='keyword'>struct</span> index_state *);</td></tr>
<tr class="codeline" data-linenumber="751"><td class="num" id="LN751">751</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="752"><td class="num" id="LN752">752</td><td class="line"><span class='comment'>/**</span></td></tr>
<tr class="codeline" data-linenumber="753"><td class="num" id="LN753">753</td><td class="line"> <span class='comment'>* Returns 1 if istate differs from tree, 0 otherwise.  If tree is NULL,</span></td></tr>
<tr class="codeline" data-linenumber="754"><td class="num" id="LN754">754</td><td class="line"> <span class='comment'>* compares istate to HEAD.  If tree is NULL and on an unborn branch,</span></td></tr>
<tr class="codeline" data-linenumber="755"><td class="num" id="LN755">755</td><td class="line"> <span class='comment'>* returns 1 if there are entries in istate, 0 otherwise.  If an strbuf is</span></td></tr>
<tr class="codeline" data-linenumber="756"><td class="num" id="LN756">756</td><td class="line"> <span class='comment'>* provided, the space-separated list of files that differ will be appended</span></td></tr>
<tr class="codeline" data-linenumber="757"><td class="num" id="LN757">757</td><td class="line"> <span class='comment'>* to it.</span></td></tr>
<tr class="codeline" data-linenumber="758"><td class="num" id="LN758">758</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="759"><td class="num" id="LN759">759</td><td class="line"><span class='keyword'>int</span> repo_index_has_changes(<span class='keyword'>struct</span> repository *repo,</td></tr>
<tr class="codeline" data-linenumber="760"><td class="num" id="LN760">760</td><td class="line">			   <span class='keyword'>struct</span> tree *tree,</td></tr>
<tr class="codeline" data-linenumber="761"><td class="num" id="LN761">761</td><td class="line">			   <span class='keyword'>struct</span> strbuf *sb);</td></tr>
<tr class="codeline" data-linenumber="762"><td class="num" id="LN762">762</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="763"><td class="num" id="LN763">763</td><td class="line"><span class='keyword'>int</span> verify_path(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>unsigned</span> mode);</td></tr>
<tr class="codeline" data-linenumber="764"><td class="num" id="LN764">764</td><td class="line"><span class='keyword'>int</span> strcmp_offset(<span class='keyword'>const</span> <span class='keyword'>char</span> *s1, <span class='keyword'>const</span> <span class='keyword'>char</span> *s2, size_t *first_change);</td></tr>
<tr class="codeline" data-linenumber="765"><td class="num" id="LN765">765</td><td class="line"><span class='keyword'>int</span> index_dir_exists(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>int</span> namelen);</td></tr>
<tr class="codeline" data-linenumber="766"><td class="num" id="LN766">766</td><td class="line"><span class='keyword'>void</span> adjust_dirname_case(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>char</span> *name);</td></tr>
<tr class="codeline" data-linenumber="767"><td class="num" id="LN767">767</td><td class="line"><span class='keyword'>struct</span> cache_entry *index_file_exists(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>int</span> namelen, <span class='keyword'>int</span> igncase);</td></tr>
<tr class="codeline" data-linenumber="768"><td class="num" id="LN768">768</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="769"><td class="num" id="LN769">769</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="770"><td class="num" id="LN770">770</td><td class="line"> <span class='comment'>* Searches for an entry defined by name and namelen in the given index.</span></td></tr>
<tr class="codeline" data-linenumber="771"><td class="num" id="LN771">771</td><td class="line"> <span class='comment'>* If the return value is positive (including 0) it is the position of an</span></td></tr>
<tr class="codeline" data-linenumber="772"><td class="num" id="LN772">772</td><td class="line"> <span class='comment'>* exact match. If the return value is negative, the negated value minus 1</span></td></tr>
<tr class="codeline" data-linenumber="773"><td class="num" id="LN773">773</td><td class="line"> <span class='comment'>* is the position where the entry would be inserted.</span></td></tr>
<tr class="codeline" data-linenumber="774"><td class="num" id="LN774">774</td><td class="line"> <span class='comment'>* Example: The current index consists of these files and its stages:</span></td></tr>
<tr class="codeline" data-linenumber="775"><td class="num" id="LN775">775</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="776"><td class="num" id="LN776">776</td><td class="line"> <span class='comment'>*   b#0, d#0, f#1, f#3</span></td></tr>
<tr class="codeline" data-linenumber="777"><td class="num" id="LN777">777</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="778"><td class="num" id="LN778">778</td><td class="line"> <span class='comment'>* index_name_pos(&amp;index, "a", 1) -&gt; -1</span></td></tr>
<tr class="codeline" data-linenumber="779"><td class="num" id="LN779">779</td><td class="line"> <span class='comment'>* index_name_pos(&amp;index, "b", 1) -&gt;  0</span></td></tr>
<tr class="codeline" data-linenumber="780"><td class="num" id="LN780">780</td><td class="line"> <span class='comment'>* index_name_pos(&amp;index, "c", 1) -&gt; -2</span></td></tr>
<tr class="codeline" data-linenumber="781"><td class="num" id="LN781">781</td><td class="line"> <span class='comment'>* index_name_pos(&amp;index, "d", 1) -&gt;  1</span></td></tr>
<tr class="codeline" data-linenumber="782"><td class="num" id="LN782">782</td><td class="line"> <span class='comment'>* index_name_pos(&amp;index, "e", 1) -&gt; -3</span></td></tr>
<tr class="codeline" data-linenumber="783"><td class="num" id="LN783">783</td><td class="line"> <span class='comment'>* index_name_pos(&amp;index, "f", 1) -&gt; -3</span></td></tr>
<tr class="codeline" data-linenumber="784"><td class="num" id="LN784">784</td><td class="line"> <span class='comment'>* index_name_pos(&amp;index, "g", 1) -&gt; -5</span></td></tr>
<tr class="codeline" data-linenumber="785"><td class="num" id="LN785">785</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="786"><td class="num" id="LN786">786</td><td class="line"><span class='keyword'>int</span> index_name_pos(<span class='keyword'>const</span> <span class='keyword'>struct</span> index_state *, <span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>int</span> namelen);</td></tr>
<tr class="codeline" data-linenumber="787"><td class="num" id="LN787">787</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="788"><td class="num" id="LN788">788</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="789"><td class="num" id="LN789">789</td><td class="line"> <span class='comment'>* Some functions return the negative complement of an insert position when a</span></td></tr>
<tr class="codeline" data-linenumber="790"><td class="num" id="LN790">790</td><td class="line"> <span class='comment'>* precise match was not found but a position was found where the entry would</span></td></tr>
<tr class="codeline" data-linenumber="791"><td class="num" id="LN791">791</td><td class="line"> <span class='comment'>* need to be inserted. This helper protects that logic from any integer</span></td></tr>
<tr class="codeline" data-linenumber="792"><td class="num" id="LN792">792</td><td class="line"> <span class='comment'>* underflow.</span></td></tr>
<tr class="codeline" data-linenumber="793"><td class="num" id="LN793">793</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="794"><td class="num" id="LN794">794</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> index_pos_to_insert_pos(uintmax_t pos)</td></tr>
<tr class="codeline" data-linenumber="795"><td class="num" id="LN795">795</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="796"><td class="num" id="LN796">796</td><td class="line">	<span class='keyword'>if</span> (pos &gt; <span class='macro'>INT_MAX<span class='macro_popup'>2147483647</span></span>)</td></tr>
<tr class="codeline" data-linenumber="797"><td class="num" id="LN797">797</td><td class="line">		die(<span class='string_literal'>"overflow: -1 - %"</span><span class='macro'>PRIuMAX<span class='macro_popup'>"l" "u"</span></span>, pos);</td></tr>
<tr class="codeline" data-linenumber="798"><td class="num" id="LN798">798</td><td class="line">	<span class='keyword'>return</span> -1 - (<span class='keyword'>int</span>)pos;</td></tr>
<tr class="codeline" data-linenumber="799"><td class="num" id="LN799">799</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="800"><td class="num" id="LN800">800</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="801"><td class="num" id="LN801">801</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_OK_TO_ADD<span class='macro_popup'>1</span></span> 1		/* Ok to add */</span></td></tr>
<tr class="codeline" data-linenumber="802"><td class="num" id="LN802">802</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_OK_TO_REPLACE<span class='macro_popup'>2</span></span> 2	/* Ok to replace file/directory */</span></td></tr>
<tr class="codeline" data-linenumber="803"><td class="num" id="LN803">803</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_SKIP_DFCHECK<span class='macro_popup'>4</span></span> 4	/* Ok to skip DF conflict checks */</span></td></tr>
<tr class="codeline" data-linenumber="804"><td class="num" id="LN804">804</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_JUST_APPEND<span class='macro_popup'>8</span></span> 8		/* Append only; tree.c::read_tree() */</span></td></tr>
<tr class="codeline" data-linenumber="805"><td class="num" id="LN805">805</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_NEW_ONLY<span class='macro_popup'>16</span></span> 16		/* Do not replace existing ones */</span></td></tr>
<tr class="codeline" data-linenumber="806"><td class="num" id="LN806">806</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_KEEP_CACHE_TREE<span class='macro_popup'>32</span></span> 32	/* Do not invalidate cache-tree */</span></td></tr>
<tr class="codeline" data-linenumber="807"><td class="num" id="LN807">807</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_RENORMALIZE<span class='macro_popup'>64</span></span> 64        /* Pass along HASH_RENORMALIZE */</span></td></tr>
<tr class="codeline" data-linenumber="808"><td class="num" id="LN808">808</td><td class="line"><span class='keyword'>int</span> add_index_entry(<span class='keyword'>struct</span> index_state *, <span class='keyword'>struct</span> cache_entry *ce, <span class='keyword'>int</span> option);</td></tr>
<tr class="codeline" data-linenumber="809"><td class="num" id="LN809">809</td><td class="line"><span class='keyword'>void</span> rename_index_entry_at(<span class='keyword'>struct</span> index_state *, <span class='keyword'>int</span> pos, <span class='keyword'>const</span> <span class='keyword'>char</span> *new_name);</td></tr>
<tr class="codeline" data-linenumber="810"><td class="num" id="LN810">810</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="811"><td class="num" id="LN811">811</td><td class="line"><span class='comment'>/* Remove entry, return true if there are more entries to go. */</span></td></tr>
<tr class="codeline" data-linenumber="812"><td class="num" id="LN812">812</td><td class="line"><span class='keyword'>int</span> remove_index_entry_at(<span class='keyword'>struct</span> index_state *, <span class='keyword'>int</span> pos);</td></tr>
<tr class="codeline" data-linenumber="813"><td class="num" id="LN813">813</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="814"><td class="num" id="LN814">814</td><td class="line"><span class='keyword'>void</span> remove_marked_cache_entries(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>int</span> invalidate);</td></tr>
<tr class="codeline" data-linenumber="815"><td class="num" id="LN815">815</td><td class="line"><span class='keyword'>int</span> remove_file_from_index(<span class='keyword'>struct</span> index_state *, <span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="816"><td class="num" id="LN816">816</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_VERBOSE<span class='macro_popup'>1</span></span> 1</span></td></tr>
<tr class="codeline" data-linenumber="817"><td class="num" id="LN817">817</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_PRETEND<span class='macro_popup'>2</span></span> 2</span></td></tr>
<tr class="codeline" data-linenumber="818"><td class="num" id="LN818">818</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_IGNORE_ERRORS<span class='macro_popup'>4</span></span>	4</span></td></tr>
<tr class="codeline" data-linenumber="819"><td class="num" id="LN819">819</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_IGNORE_REMOVAL<span class='macro_popup'>8</span></span> 8</span></td></tr>
<tr class="codeline" data-linenumber="820"><td class="num" id="LN820">820</td><td class="line"><span class='directive'>#define <span class='macro'>ADD_CACHE_INTENT<span class='macro_popup'>16</span></span> 16</span></td></tr>
<tr class="codeline" data-linenumber="821"><td class="num" id="LN821">821</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="822"><td class="num" id="LN822">822</td><td class="line"> <span class='comment'>* These two are used to add the contents of the file at path</span></td></tr>
<tr class="codeline" data-linenumber="823"><td class="num" id="LN823">823</td><td class="line"> <span class='comment'>* to the index, marking the working tree up-to-date by storing</span></td></tr>
<tr class="codeline" data-linenumber="824"><td class="num" id="LN824">824</td><td class="line"> <span class='comment'>* the cached stat info in the resulting cache entry.  A caller</span></td></tr>
<tr class="codeline" data-linenumber="825"><td class="num" id="LN825">825</td><td class="line"> <span class='comment'>* that has already run lstat(2) on the path can call</span></td></tr>
<tr class="codeline" data-linenumber="826"><td class="num" id="LN826">826</td><td class="line"> <span class='comment'>* add_to_index(), and all others can call add_file_to_index();</span></td></tr>
<tr class="codeline" data-linenumber="827"><td class="num" id="LN827">827</td><td class="line"> <span class='comment'>* the latter will do necessary lstat(2) internally before</span></td></tr>
<tr class="codeline" data-linenumber="828"><td class="num" id="LN828">828</td><td class="line"> <span class='comment'>* calling the former.</span></td></tr>
<tr class="codeline" data-linenumber="829"><td class="num" id="LN829">829</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="830"><td class="num" id="LN830">830</td><td class="line"><span class='keyword'>int</span> add_to_index(<span class='keyword'>struct</span> index_state *, <span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>struct</span> stat *, <span class='keyword'>int</span> flags);</td></tr>
<tr class="codeline" data-linenumber="831"><td class="num" id="LN831">831</td><td class="line"><span class='keyword'>int</span> add_file_to_index(<span class='keyword'>struct</span> index_state *, <span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>int</span> flags);</td></tr>
<tr class="codeline" data-linenumber="832"><td class="num" id="LN832">832</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="833"><td class="num" id="LN833">833</td><td class="line"><span class='keyword'>int</span> chmod_index_entry(<span class='keyword'>struct</span> index_state *, <span class='keyword'>struct</span> cache_entry *ce, <span class='keyword'>char</span> flip);</td></tr>
<tr class="codeline" data-linenumber="834"><td class="num" id="LN834">834</td><td class="line"><span class='keyword'>int</span> ce_same_name(<span class='keyword'>const</span> <span class='keyword'>struct</span> cache_entry *a, <span class='keyword'>const</span> <span class='keyword'>struct</span> cache_entry *b);</td></tr>
<tr class="codeline" data-linenumber="835"><td class="num" id="LN835">835</td><td class="line"><span class='keyword'>void</span> set_object_name_for_intent_to_add_entry(<span class='keyword'>struct</span> cache_entry *ce);</td></tr>
<tr class="codeline" data-linenumber="836"><td class="num" id="LN836">836</td><td class="line"><span class='keyword'>int</span> index_name_is_other(<span class='keyword'>const</span> <span class='keyword'>struct</span> index_state *, <span class='keyword'>const</span> <span class='keyword'>char</span> *, <span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="837"><td class="num" id="LN837">837</td><td class="line"><span class='keyword'>void</span> *read_blob_data_from_index(<span class='keyword'>const</span> <span class='keyword'>struct</span> index_state *, <span class='keyword'>const</span> <span class='keyword'>char</span> *, <span class='keyword'>unsigned</span> <span class='keyword'>long</span> *);</td></tr>
<tr class="codeline" data-linenumber="838"><td class="num" id="LN838">838</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="839"><td class="num" id="LN839">839</td><td class="line"><span class='comment'>/* do stat comparison even if CE_VALID is true */</span></td></tr>
<tr class="codeline" data-linenumber="840"><td class="num" id="LN840">840</td><td class="line"><span class='directive'>#define <span class='macro'>CE_MATCH_IGNORE_VALID<span class='macro_popup'>01</span></span>		01</span></td></tr>
<tr class="codeline" data-linenumber="841"><td class="num" id="LN841">841</td><td class="line"><span class='comment'>/* do not check the contents but report dirty on racily-clean entries */</span></td></tr>
<tr class="codeline" data-linenumber="842"><td class="num" id="LN842">842</td><td class="line"><span class='directive'>#define <span class='macro'>CE_MATCH_RACY_IS_DIRTY<span class='macro_popup'>02</span></span>		02</span></td></tr>
<tr class="codeline" data-linenumber="843"><td class="num" id="LN843">843</td><td class="line"><span class='comment'>/* do stat comparison even if CE_SKIP_WORKTREE is true */</span></td></tr>
<tr class="codeline" data-linenumber="844"><td class="num" id="LN844">844</td><td class="line"><span class='directive'>#define <span class='macro'>CE_MATCH_IGNORE_SKIP_WORKTREE<span class='macro_popup'>04</span></span>	04</span></td></tr>
<tr class="codeline" data-linenumber="845"><td class="num" id="LN845">845</td><td class="line"><span class='comment'>/* ignore non-existent files during stat update  */</span></td></tr>
<tr class="codeline" data-linenumber="846"><td class="num" id="LN846">846</td><td class="line"><span class='directive'>#define <span class='macro'>CE_MATCH_IGNORE_MISSING<span class='macro_popup'>0x08</span></span>		0x08</span></td></tr>
<tr class="codeline" data-linenumber="847"><td class="num" id="LN847">847</td><td class="line"><span class='comment'>/* enable stat refresh */</span></td></tr>
<tr class="codeline" data-linenumber="848"><td class="num" id="LN848">848</td><td class="line"><span class='directive'>#define <span class='macro'>CE_MATCH_REFRESH<span class='macro_popup'>0x10</span></span>		0x10</span></td></tr>
<tr class="codeline" data-linenumber="849"><td class="num" id="LN849">849</td><td class="line"><span class='comment'>/* don't refresh_fsmonitor state or do stat comparison even if CE_FSMONITOR_VALID is true */</span></td></tr>
<tr class="codeline" data-linenumber="850"><td class="num" id="LN850">850</td><td class="line"><span class='directive'>#define <span class='macro'>CE_MATCH_IGNORE_FSMONITOR<span class='macro_popup'>0X20</span></span> 0X20</span></td></tr>
<tr class="codeline" data-linenumber="851"><td class="num" id="LN851">851</td><td class="line"><span class='keyword'>int</span> is_racy_timestamp(<span class='keyword'>const</span> <span class='keyword'>struct</span> index_state *istate,</td></tr>
<tr class="codeline" data-linenumber="852"><td class="num" id="LN852">852</td><td class="line">		      <span class='keyword'>const</span> <span class='keyword'>struct</span> cache_entry *ce);</td></tr>
<tr class="codeline" data-linenumber="853"><td class="num" id="LN853">853</td><td class="line"><span class='keyword'>int</span> ie_match_stat(<span class='keyword'>struct</span> index_state *, <span class='keyword'>const</span> <span class='keyword'>struct</span> cache_entry *, <span class='keyword'>struct</span> stat *, <span class='keyword'>unsigned</span> <span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="854"><td class="num" id="LN854">854</td><td class="line"><span class='keyword'>int</span> ie_modified(<span class='keyword'>struct</span> index_state *, <span class='keyword'>const</span> <span class='keyword'>struct</span> cache_entry *, <span class='keyword'>struct</span> stat *, <span class='keyword'>unsigned</span> <span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="855"><td class="num" id="LN855">855</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="856"><td class="num" id="LN856">856</td><td class="line"><span class='directive'>#define <span class='macro'>HASH_WRITE_OBJECT<span class='macro_popup'>1</span></span> 1</span></td></tr>
<tr class="codeline" data-linenumber="857"><td class="num" id="LN857">857</td><td class="line"><span class='directive'>#define <span class='macro'>HASH_FORMAT_CHECK<span class='macro_popup'>2</span></span> 2</span></td></tr>
<tr class="codeline" data-linenumber="858"><td class="num" id="LN858">858</td><td class="line"><span class='directive'>#define <span class='macro'>HASH_RENORMALIZE<span class='macro_popup'>4</span></span>  4</span></td></tr>
<tr class="codeline" data-linenumber="859"><td class="num" id="LN859">859</td><td class="line"><span class='keyword'>int</span> index_fd(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>struct</span> object_id *oid, <span class='keyword'>int</span> fd, <span class='keyword'>struct</span> stat *st, <span class='keyword'>enum</span> object_type type, <span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>unsigned</span> flags);</td></tr>
<tr class="codeline" data-linenumber="860"><td class="num" id="LN860">860</td><td class="line"><span class='keyword'>int</span> index_path(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>struct</span> object_id *oid, <span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>struct</span> stat *st, <span class='keyword'>unsigned</span> flags);</td></tr>
<tr class="codeline" data-linenumber="861"><td class="num" id="LN861">861</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="862"><td class="num" id="LN862">862</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="863"><td class="num" id="LN863">863</td><td class="line"> <span class='comment'>* Record to sd the data from st that we use to check whether a file</span></td></tr>
<tr class="codeline" data-linenumber="864"><td class="num" id="LN864">864</td><td class="line"> <span class='comment'>* might have changed.</span></td></tr>
<tr class="codeline" data-linenumber="865"><td class="num" id="LN865">865</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="866"><td class="num" id="LN866">866</td><td class="line"><span class='keyword'>void</span> fill_stat_data(<span class='keyword'>struct</span> stat_data *sd, <span class='keyword'>struct</span> stat *st);</td></tr>
<tr class="codeline" data-linenumber="867"><td class="num" id="LN867">867</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="868"><td class="num" id="LN868">868</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="869"><td class="num" id="LN869">869</td><td class="line"> <span class='comment'>* Return 0 if st is consistent with a file not having been changed</span></td></tr>
<tr class="codeline" data-linenumber="870"><td class="num" id="LN870">870</td><td class="line"> <span class='comment'>* since sd was filled.  If there are differences, return a</span></td></tr>
<tr class="codeline" data-linenumber="871"><td class="num" id="LN871">871</td><td class="line"> <span class='comment'>* combination of MTIME_CHANGED, CTIME_CHANGED, OWNER_CHANGED,</span></td></tr>
<tr class="codeline" data-linenumber="872"><td class="num" id="LN872">872</td><td class="line"> <span class='comment'>* INODE_CHANGED, and DATA_CHANGED.</span></td></tr>
<tr class="codeline" data-linenumber="873"><td class="num" id="LN873">873</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="874"><td class="num" id="LN874">874</td><td class="line"><span class='keyword'>int</span> match_stat_data(<span class='keyword'>const</span> <span class='keyword'>struct</span> stat_data *sd, <span class='keyword'>struct</span> stat *st);</td></tr>
<tr class="codeline" data-linenumber="875"><td class="num" id="LN875">875</td><td class="line"><span class='keyword'>int</span> match_stat_data_racy(<span class='keyword'>const</span> <span class='keyword'>struct</span> index_state *istate,</td></tr>
<tr class="codeline" data-linenumber="876"><td class="num" id="LN876">876</td><td class="line">			 <span class='keyword'>const</span> <span class='keyword'>struct</span> stat_data *sd, <span class='keyword'>struct</span> stat *st);</td></tr>
<tr class="codeline" data-linenumber="877"><td class="num" id="LN877">877</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="878"><td class="num" id="LN878">878</td><td class="line"><span class='keyword'>void</span> fill_stat_cache_info(<span class='keyword'>struct</span> index_state *istate, <span class='keyword'>struct</span> cache_entry *ce, <span class='keyword'>struct</span> stat *st);</td></tr>
<tr class="codeline" data-linenumber="879"><td class="num" id="LN879">879</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="880"><td class="num" id="LN880">880</td><td class="line"><span class='directive'>#define <span class='macro'>REFRESH_REALLY<span class='macro_popup'>0x0001</span></span>		0x0001	/* ignore_valid */</span></td></tr>
<tr class="codeline" data-linenumber="881"><td class="num" id="LN881">881</td><td class="line"><span class='directive'>#define <span class='macro'>REFRESH_UNMERGED<span class='macro_popup'>0x0002</span></span>	0x0002	/* allow unmerged */</span></td></tr>
<tr class="codeline" data-linenumber="882"><td class="num" id="LN882">882</td><td class="line"><span class='directive'>#define <span class='macro'>REFRESH_QUIET<span class='macro_popup'>0x0004</span></span>		0x0004	/* be quiet about it */</span></td></tr>
<tr class="codeline" data-linenumber="883"><td class="num" id="LN883">883</td><td class="line"><span class='directive'>#define <span class='macro'>REFRESH_IGNORE_MISSING<span class='macro_popup'>0x0008</span></span>	0x0008	/* ignore non-existent */</span></td></tr>
<tr class="codeline" data-linenumber="884"><td class="num" id="LN884">884</td><td class="line"><span class='directive'>#define <span class='macro'>REFRESH_IGNORE_SUBMODULES<span class='macro_popup'>0x0010</span></span>	0x0010	/* ignore submodules */</span></td></tr>
<tr class="codeline" data-linenumber="885"><td class="num" id="LN885">885</td><td class="line"><span class='directive'>#define <span class='macro'>REFRESH_IN_PORCELAIN<span class='macro_popup'>0x0020</span></span>	0x0020	/* user friendly output, not "needs update" */</span></td></tr>
<tr class="codeline" data-linenumber="886"><td class="num" id="LN886">886</td><td class="line"><span class='directive'>#define <span class='macro'>REFRESH_PROGRESS<span class='macro_popup'>0x0040</span></span>	0x0040  /* show progress bar if stderr is tty */</span></td></tr>
<tr class="codeline" data-linenumber="887"><td class="num" id="LN887">887</td><td class="line"><span class='keyword'>int</span> refresh_index(<span class='keyword'>struct</span> index_state *, <span class='keyword'>unsigned</span> <span class='keyword'>int</span> flags, <span class='keyword'>const</span> <span class='keyword'>struct</span> pathspec *pathspec, <span class='keyword'>char</span> *seen, <span class='keyword'>const</span> <span class='keyword'>char</span> *header_msg);</td></tr>
<tr class="codeline" data-linenumber="888"><td class="num" id="LN888">888</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="889"><td class="num" id="LN889">889</td><td class="line"> <span class='comment'>* Refresh the index and write it to disk.</span></td></tr>
<tr class="codeline" data-linenumber="890"><td class="num" id="LN890">890</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="891"><td class="num" id="LN891">891</td><td class="line"> <span class='comment'>* 'refresh_flags' is passed directly to 'refresh_index()', while</span></td></tr>
<tr class="codeline" data-linenumber="892"><td class="num" id="LN892">892</td><td class="line"> <span class='comment'>* 'COMMIT_LOCK | write_flags' is passed to 'write_locked_index()', so</span></td></tr>
<tr class="codeline" data-linenumber="893"><td class="num" id="LN893">893</td><td class="line"> <span class='comment'>* the lockfile is always either committed or rolled back.</span></td></tr>
<tr class="codeline" data-linenumber="894"><td class="num" id="LN894">894</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="895"><td class="num" id="LN895">895</td><td class="line"> <span class='comment'>* If 'gentle' is passed, errors locking the index are ignored.</span></td></tr>
<tr class="codeline" data-linenumber="896"><td class="num" id="LN896">896</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="897"><td class="num" id="LN897">897</td><td class="line"> <span class='comment'>* Return 1 if refreshing the index returns an error, -1 if writing</span></td></tr>
<tr class="codeline" data-linenumber="898"><td class="num" id="LN898">898</td><td class="line"> <span class='comment'>* the index to disk fails, 0 on success.</span></td></tr>
<tr class="codeline" data-linenumber="899"><td class="num" id="LN899">899</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="900"><td class="num" id="LN900">900</td><td class="line"> <span class='comment'>* Note that if refreshing the index returns an error, we still write</span></td></tr>
<tr class="codeline" data-linenumber="901"><td class="num" id="LN901">901</td><td class="line"> <span class='comment'>* out the index (unless locking fails).</span></td></tr>
<tr class="codeline" data-linenumber="902"><td class="num" id="LN902">902</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="903"><td class="num" id="LN903">903</td><td class="line"><span class='keyword'>int</span> repo_refresh_and_write_index(<span class='keyword'>struct</span> repository*, <span class='keyword'>unsigned</span> <span class='keyword'>int</span> refresh_flags, <span class='keyword'>unsigned</span> <span class='keyword'>int</span> write_flags, <span class='keyword'>int</span> gentle, <span class='keyword'>const</span> <span class='keyword'>struct</span> pathspec *, <span class='keyword'>char</span> *seen, <span class='keyword'>const</span> <span class='keyword'>char</span> *header_msg);</td></tr>
<tr class="codeline" data-linenumber="904"><td class="num" id="LN904">904</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="905"><td class="num" id="LN905">905</td><td class="line"><span class='keyword'>struct</span> cache_entry *refresh_cache_entry(<span class='keyword'>struct</span> index_state *, <span class='keyword'>struct</span> cache_entry *, <span class='keyword'>unsigned</span> <span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="906"><td class="num" id="LN906">906</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="907"><td class="num" id="LN907">907</td><td class="line"><span class='keyword'>void</span> set_alternate_index_output(<span class='keyword'>const</span> <span class='keyword'>char</span> *);</td></tr>
<tr class="codeline" data-linenumber="908"><td class="num" id="LN908">908</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="909"><td class="num" id="LN909">909</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> verify_index_checksum;</td></tr>
<tr class="codeline" data-linenumber="910"><td class="num" id="LN910">910</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> verify_ce_order;</td></tr>
<tr class="codeline" data-linenumber="911"><td class="num" id="LN911">911</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="912"><td class="num" id="LN912">912</td><td class="line"><span class='comment'>/* Environment bits from configuration mechanism */</span></td></tr>
<tr class="codeline" data-linenumber="913"><td class="num" id="LN913">913</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> trust_executable_bit;</td></tr>
<tr class="codeline" data-linenumber="914"><td class="num" id="LN914">914</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> trust_ctime;</td></tr>
<tr class="codeline" data-linenumber="915"><td class="num" id="LN915">915</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> check_stat;</td></tr>
<tr class="codeline" data-linenumber="916"><td class="num" id="LN916">916</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> quote_path_fully;</td></tr>
<tr class="codeline" data-linenumber="917"><td class="num" id="LN917">917</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> has_symlinks;</td></tr>
<tr class="codeline" data-linenumber="918"><td class="num" id="LN918">918</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> minimum_abbrev, default_abbrev;</td></tr>
<tr class="codeline" data-linenumber="919"><td class="num" id="LN919">919</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> ignore_case;</td></tr>
<tr class="codeline" data-linenumber="920"><td class="num" id="LN920">920</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> assume_unchanged;</td></tr>
<tr class="codeline" data-linenumber="921"><td class="num" id="LN921">921</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> prefer_symlink_refs;</td></tr>
<tr class="codeline" data-linenumber="922"><td class="num" id="LN922">922</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> warn_ambiguous_refs;</td></tr>
<tr class="codeline" data-linenumber="923"><td class="num" id="LN923">923</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> warn_on_object_refname_ambiguity;</td></tr>
<tr class="codeline" data-linenumber="924"><td class="num" id="LN924">924</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>char</span> *apply_default_whitespace;</td></tr>
<tr class="codeline" data-linenumber="925"><td class="num" id="LN925">925</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>char</span> *apply_default_ignorewhitespace;</td></tr>
<tr class="codeline" data-linenumber="926"><td class="num" id="LN926">926</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> *git_attributes_file;</td></tr>
<tr class="codeline" data-linenumber="927"><td class="num" id="LN927">927</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> *git_hooks_path;</td></tr>
<tr class="codeline" data-linenumber="928"><td class="num" id="LN928">928</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> zlib_compression_level;</td></tr>
<tr class="codeline" data-linenumber="929"><td class="num" id="LN929">929</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> core_compression_level;</td></tr>
<tr class="codeline" data-linenumber="930"><td class="num" id="LN930">930</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> pack_compression_level;</td></tr>
<tr class="codeline" data-linenumber="931"><td class="num" id="LN931">931</td><td class="line"><span class='keyword'>extern</span> size_t packed_git_window_size;</td></tr>
<tr class="codeline" data-linenumber="932"><td class="num" id="LN932">932</td><td class="line"><span class='keyword'>extern</span> size_t packed_git_limit;</td></tr>
<tr class="codeline" data-linenumber="933"><td class="num" id="LN933">933</td><td class="line"><span class='keyword'>extern</span> size_t delta_base_cache_limit;</td></tr>
<tr class="codeline" data-linenumber="934"><td class="num" id="LN934">934</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>unsigned</span> <span class='keyword'>long</span> big_file_threshold;</td></tr>
<tr class="codeline" data-linenumber="935"><td class="num" id="LN935">935</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>unsigned</span> <span class='keyword'>long</span> pack_size_limit_cfg;</td></tr>
<tr class="codeline" data-linenumber="936"><td class="num" id="LN936">936</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="937"><td class="num" id="LN937">937</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="938"><td class="num" id="LN938">938</td><td class="line"> <span class='comment'>* Accessors for the core.sharedrepository config which lazy-load the value</span></td></tr>
<tr class="codeline" data-linenumber="939"><td class="num" id="LN939">939</td><td class="line"> <span class='comment'>* from the config (if not already set). The "reset" function can be</span></td></tr>
<tr class="codeline" data-linenumber="940"><td class="num" id="LN940">940</td><td class="line"> <span class='comment'>* used to unset "set" or cached value, meaning that the value will be loaded</span></td></tr>
<tr class="codeline" data-linenumber="941"><td class="num" id="LN941">941</td><td class="line"> <span class='comment'>* fresh from the config file on the next call to get_shared_repository().</span></td></tr>
<tr class="codeline" data-linenumber="942"><td class="num" id="LN942">942</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="943"><td class="num" id="LN943">943</td><td class="line"><span class='keyword'>void</span> set_shared_repository(<span class='keyword'>int</span> value);</td></tr>
<tr class="codeline" data-linenumber="944"><td class="num" id="LN944">944</td><td class="line"><span class='keyword'>int</span> get_shared_repository(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="945"><td class="num" id="LN945">945</td><td class="line"><span class='keyword'>void</span> reset_shared_repository(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="946"><td class="num" id="LN946">946</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="947"><td class="num" id="LN947">947</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="948"><td class="num" id="LN948">948</td><td class="line"> <span class='comment'>* Do replace refs need to be checked this run?  This variable is</span></td></tr>
<tr class="codeline" data-linenumber="949"><td class="num" id="LN949">949</td><td class="line"> <span class='comment'>* initialized to true unless --no-replace-object is used or</span></td></tr>
<tr class="codeline" data-linenumber="950"><td class="num" id="LN950">950</td><td class="line"> <span class='comment'>* $GIT_NO_REPLACE_OBJECTS is set, but is set to false by some</span></td></tr>
<tr class="codeline" data-linenumber="951"><td class="num" id="LN951">951</td><td class="line"> <span class='comment'>* commands that do not want replace references to be active.</span></td></tr>
<tr class="codeline" data-linenumber="952"><td class="num" id="LN952">952</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="953"><td class="num" id="LN953">953</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> read_replace_refs;</td></tr>
<tr class="codeline" data-linenumber="954"><td class="num" id="LN954">954</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>char</span> *git_replace_ref_base;</td></tr>
<tr class="codeline" data-linenumber="955"><td class="num" id="LN955">955</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="956"><td class="num" id="LN956">956</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> fsync_object_files;</td></tr>
<tr class="codeline" data-linenumber="957"><td class="num" id="LN957">957</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> core_preload_index;</td></tr>
<tr class="codeline" data-linenumber="958"><td class="num" id="LN958">958</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> precomposed_unicode;</td></tr>
<tr class="codeline" data-linenumber="959"><td class="num" id="LN959">959</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> protect_hfs;</td></tr>
<tr class="codeline" data-linenumber="960"><td class="num" id="LN960">960</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> protect_ntfs;</td></tr>
<tr class="codeline" data-linenumber="961"><td class="num" id="LN961">961</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> *core_fsmonitor;</td></tr>
<tr class="codeline" data-linenumber="962"><td class="num" id="LN962">962</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="963"><td class="num" id="LN963">963</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> core_apply_sparse_checkout;</td></tr>
<tr class="codeline" data-linenumber="964"><td class="num" id="LN964">964</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> core_sparse_checkout_cone;</td></tr>
<tr class="codeline" data-linenumber="965"><td class="num" id="LN965">965</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="966"><td class="num" id="LN966">966</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="967"><td class="num" id="LN967">967</td><td class="line"> <span class='comment'>* Include broken refs in all ref iterations, which will</span></td></tr>
<tr class="codeline" data-linenumber="968"><td class="num" id="LN968">968</td><td class="line"> <span class='comment'>* generally choke dangerous operations rather than letting</span></td></tr>
<tr class="codeline" data-linenumber="969"><td class="num" id="LN969">969</td><td class="line"> <span class='comment'>* them silently proceed without taking the broken ref into</span></td></tr>
<tr class="codeline" data-linenumber="970"><td class="num" id="LN970">970</td><td class="line"> <span class='comment'>* account.</span></td></tr>
<tr class="codeline" data-linenumber="971"><td class="num" id="LN971">971</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="972"><td class="num" id="LN972">972</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> ref_paranoia;</td></tr>
<tr class="codeline" data-linenumber="973"><td class="num" id="LN973">973</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="974"><td class="num" id="LN974">974</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="975"><td class="num" id="LN975">975</td><td class="line"> <span class='comment'>* Returns the boolean value of $GIT_OPTIONAL_LOCKS (or the default value).</span></td></tr>
<tr class="codeline" data-linenumber="976"><td class="num" id="LN976">976</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="977"><td class="num" id="LN977">977</td><td class="line"><span class='keyword'>int</span> use_optional_locks(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="978"><td class="num" id="LN978">978</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="979"><td class="num" id="LN979">979</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="980"><td class="num" id="LN980">980</td><td class="line"> <span class='comment'>* The character that begins a commented line in user-editable file</span></td></tr>
<tr class="codeline" data-linenumber="981"><td class="num" id="LN981">981</td><td class="line"> <span class='comment'>* that is subject to stripspace.</span></td></tr>
<tr class="codeline" data-linenumber="982"><td class="num" id="LN982">982</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="983"><td class="num" id="LN983">983</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>char</span> comment_line_char;</td></tr>
<tr class="codeline" data-linenumber="984"><td class="num" id="LN984">984</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> auto_comment_line_char;</td></tr>
<tr class="codeline" data-linenumber="985"><td class="num" id="LN985">985</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="986"><td class="num" id="LN986">986</td><td class="line"><span class='keyword'>enum</span> log_refs_config {</td></tr>
<tr class="codeline" data-linenumber="987"><td class="num" id="LN987">987</td><td class="line">	LOG_REFS_UNSET = -1,</td></tr>
<tr class="codeline" data-linenumber="988"><td class="num" id="LN988">988</td><td class="line">	LOG_REFS_NONE = 0,</td></tr>
<tr class="codeline" data-linenumber="989"><td class="num" id="LN989">989</td><td class="line">	LOG_REFS_NORMAL,</td></tr>
<tr class="codeline" data-linenumber="990"><td class="num" id="LN990">990</td><td class="line">	LOG_REFS_ALWAYS</td></tr>
<tr class="codeline" data-linenumber="991"><td class="num" id="LN991">991</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="992"><td class="num" id="LN992">992</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>enum</span> log_refs_config log_all_ref_updates;</td></tr>
<tr class="codeline" data-linenumber="993"><td class="num" id="LN993">993</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="994"><td class="num" id="LN994">994</td><td class="line"><span class='keyword'>enum</span> rebase_setup_type {</td></tr>
<tr class="codeline" data-linenumber="995"><td class="num" id="LN995">995</td><td class="line">	AUTOREBASE_NEVER = 0,</td></tr>
<tr class="codeline" data-linenumber="996"><td class="num" id="LN996">996</td><td class="line">	AUTOREBASE_LOCAL,</td></tr>
<tr class="codeline" data-linenumber="997"><td class="num" id="LN997">997</td><td class="line">	AUTOREBASE_REMOTE,</td></tr>
<tr class="codeline" data-linenumber="998"><td class="num" id="LN998">998</td><td class="line">	AUTOREBASE_ALWAYS</td></tr>
<tr class="codeline" data-linenumber="999"><td class="num" id="LN999">999</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1000"><td class="num" id="LN1000">1000</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1001"><td class="num" id="LN1001">1001</td><td class="line"><span class='keyword'>enum</span> push_default_type {</td></tr>
<tr class="codeline" data-linenumber="1002"><td class="num" id="LN1002">1002</td><td class="line">	PUSH_DEFAULT_NOTHING = 0,</td></tr>
<tr class="codeline" data-linenumber="1003"><td class="num" id="LN1003">1003</td><td class="line">	PUSH_DEFAULT_MATCHING,</td></tr>
<tr class="codeline" data-linenumber="1004"><td class="num" id="LN1004">1004</td><td class="line">	PUSH_DEFAULT_SIMPLE,</td></tr>
<tr class="codeline" data-linenumber="1005"><td class="num" id="LN1005">1005</td><td class="line">	PUSH_DEFAULT_UPSTREAM,</td></tr>
<tr class="codeline" data-linenumber="1006"><td class="num" id="LN1006">1006</td><td class="line">	PUSH_DEFAULT_CURRENT,</td></tr>
<tr class="codeline" data-linenumber="1007"><td class="num" id="LN1007">1007</td><td class="line">	PUSH_DEFAULT_UNSPECIFIED</td></tr>
<tr class="codeline" data-linenumber="1008"><td class="num" id="LN1008">1008</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1009"><td class="num" id="LN1009">1009</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1010"><td class="num" id="LN1010">1010</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>enum</span> rebase_setup_type autorebase;</td></tr>
<tr class="codeline" data-linenumber="1011"><td class="num" id="LN1011">1011</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>enum</span> push_default_type push_default;</td></tr>
<tr class="codeline" data-linenumber="1012"><td class="num" id="LN1012">1012</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1013"><td class="num" id="LN1013">1013</td><td class="line"><span class='keyword'>enum</span> object_creation_mode {</td></tr>
<tr class="codeline" data-linenumber="1014"><td class="num" id="LN1014">1014</td><td class="line">	OBJECT_CREATION_USES_HARDLINKS = 0,</td></tr>
<tr class="codeline" data-linenumber="1015"><td class="num" id="LN1015">1015</td><td class="line">	OBJECT_CREATION_USES_RENAMES = 1</td></tr>
<tr class="codeline" data-linenumber="1016"><td class="num" id="LN1016">1016</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1017"><td class="num" id="LN1017">1017</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1018"><td class="num" id="LN1018">1018</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>enum</span> object_creation_mode object_creation_mode;</td></tr>
<tr class="codeline" data-linenumber="1019"><td class="num" id="LN1019">1019</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1020"><td class="num" id="LN1020">1020</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>char</span> *notes_ref_name;</td></tr>
<tr class="codeline" data-linenumber="1021"><td class="num" id="LN1021">1021</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1022"><td class="num" id="LN1022">1022</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> grafts_replace_parents;</td></tr>
<tr class="codeline" data-linenumber="1023"><td class="num" id="LN1023">1023</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1024"><td class="num" id="LN1024">1024</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1025"><td class="num" id="LN1025">1025</td><td class="line"> <span class='comment'>* GIT_REPO_VERSION is the version we write by default. The</span></td></tr>
<tr class="codeline" data-linenumber="1026"><td class="num" id="LN1026">1026</td><td class="line"> <span class='comment'>* _READ variant is the highest number we know how to</span></td></tr>
<tr class="codeline" data-linenumber="1027"><td class="num" id="LN1027">1027</td><td class="line"> <span class='comment'>* handle.</span></td></tr>
<tr class="codeline" data-linenumber="1028"><td class="num" id="LN1028">1028</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1029"><td class="num" id="LN1029">1029</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_REPO_VERSION<span class='macro_popup'>0</span></span> 0</span></td></tr>
<tr class="codeline" data-linenumber="1030"><td class="num" id="LN1030">1030</td><td class="line"><span class='directive'>#define <span class='macro'>GIT_REPO_VERSION_READ<span class='macro_popup'>1</span></span> 1</span></td></tr>
<tr class="codeline" data-linenumber="1031"><td class="num" id="LN1031">1031</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> repository_format_precious_objects;</td></tr>
<tr class="codeline" data-linenumber="1032"><td class="num" id="LN1032">1032</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> repository_format_worktree_config;</td></tr>
<tr class="codeline" data-linenumber="1033"><td class="num" id="LN1033">1033</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1034"><td class="num" id="LN1034">1034</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1035"><td class="num" id="LN1035">1035</td><td class="line"> <span class='comment'>* You _have_ to initialize a `struct repository_format` using</span></td></tr>
<tr class="codeline" data-linenumber="1036"><td class="num" id="LN1036">1036</td><td class="line"> <span class='comment'>* `= REPOSITORY_FORMAT_INIT` before calling `read_repository_format()`.</span></td></tr>
<tr class="codeline" data-linenumber="1037"><td class="num" id="LN1037">1037</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1038"><td class="num" id="LN1038">1038</td><td class="line"><span class='keyword'>struct</span> repository_format {</td></tr>
<tr class="codeline" data-linenumber="1039"><td class="num" id="LN1039">1039</td><td class="line">	<span class='keyword'>int</span> version;</td></tr>
<tr class="codeline" data-linenumber="1040"><td class="num" id="LN1040">1040</td><td class="line">	<span class='keyword'>int</span> precious_objects;</td></tr>
<tr class="codeline" data-linenumber="1041"><td class="num" id="LN1041">1041</td><td class="line">	<span class='keyword'>char</span> *partial_clone; <span class='comment'>/* value of extensions.partialclone */</span></td></tr>
<tr class="codeline" data-linenumber="1042"><td class="num" id="LN1042">1042</td><td class="line">	<span class='keyword'>int</span> worktree_config;</td></tr>
<tr class="codeline" data-linenumber="1043"><td class="num" id="LN1043">1043</td><td class="line">	<span class='keyword'>int</span> is_bare;</td></tr>
<tr class="codeline" data-linenumber="1044"><td class="num" id="LN1044">1044</td><td class="line">	<span class='keyword'>int</span> hash_algo;</td></tr>
<tr class="codeline" data-linenumber="1045"><td class="num" id="LN1045">1045</td><td class="line">	<span class='keyword'>char</span> *work_tree;</td></tr>
<tr class="codeline" data-linenumber="1046"><td class="num" id="LN1046">1046</td><td class="line">	<span class='keyword'>struct</span> string_list unknown_extensions;</td></tr>
<tr class="codeline" data-linenumber="1047"><td class="num" id="LN1047">1047</td><td class="line">	<span class='keyword'>struct</span> string_list v1_only_extensions;</td></tr>
<tr class="codeline" data-linenumber="1048"><td class="num" id="LN1048">1048</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1049"><td class="num" id="LN1049">1049</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1050"><td class="num" id="LN1050">1050</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1051"><td class="num" id="LN1051">1051</td><td class="line"> <span class='comment'>* Always use this to initialize a `struct repository_format`</span></td></tr>
<tr class="codeline" data-linenumber="1052"><td class="num" id="LN1052">1052</td><td class="line"> <span class='comment'>* to a well-defined, default state before calling</span></td></tr>
<tr class="codeline" data-linenumber="1053"><td class="num" id="LN1053">1053</td><td class="line"> <span class='comment'>* `read_repository()`.</span></td></tr>
<tr class="codeline" data-linenumber="1054"><td class="num" id="LN1054">1054</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1055"><td class="num" id="LN1055">1055</td><td class="line"><span class='directive'>#define <span class='macro'>REPOSITORY_FORMAT_INIT<span class='macro_popup'>{ .version = -1, .is_bare = -1, .hash_algo = 1, .unknown_extensions<br> = { ((void*)0), 0, 0, 1, ((void*)0) }, .v1_only_extensions =<br> { ((void*)0), 0, 0, 1, ((void*)0) }, }</span></span> \</span></td></tr>
<tr class="codeline" data-linenumber="1056"><td class="num" id="LN1056">1056</td><td class="line"><span class='directive'>{ \</span></td></tr>
<tr class="codeline" data-linenumber="1057"><td class="num" id="LN1057">1057</td><td class="line">	<span class='directive'>.version = -1, \</span></td></tr>
<tr class="codeline" data-linenumber="1058"><td class="num" id="LN1058">1058</td><td class="line">	<span class='directive'>.is_bare = -1, \</span></td></tr>
<tr class="codeline" data-linenumber="1059"><td class="num" id="LN1059">1059</td><td class="line">	<span class='directive'>.hash_algo = <span class='macro'>GIT_HASH_SHA1<span class='macro_popup'>1</span></span>, \</span></td></tr>
<tr class="codeline" data-linenumber="1060"><td class="num" id="LN1060">1060</td><td class="line">	<span class='directive'>.unknown_extensions = <span class='macro'>STRING_LIST_INIT_DUP<span class='macro_popup'>{ ((void*)0), 0, 0, 1, ((void*)0) }</span></span>, \</span></td></tr>
<tr class="codeline" data-linenumber="1061"><td class="num" id="LN1061">1061</td><td class="line">	<span class='directive'>.v1_only_extensions = <span class='macro'>STRING_LIST_INIT_DUP<span class='macro_popup'>{ ((void*)0), 0, 0, 1, ((void*)0) }</span></span>, \</span></td></tr>
<tr class="codeline" data-linenumber="1062"><td class="num" id="LN1062">1062</td><td class="line"><span class='directive'>}</span></td></tr>
<tr class="codeline" data-linenumber="1063"><td class="num" id="LN1063">1063</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1064"><td class="num" id="LN1064">1064</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1065"><td class="num" id="LN1065">1065</td><td class="line"> <span class='comment'>* Read the repository format characteristics from the config file "path" into</span></td></tr>
<tr class="codeline" data-linenumber="1066"><td class="num" id="LN1066">1066</td><td class="line"> <span class='comment'>* "format" struct. Returns the numeric version. On error, or if no version is</span></td></tr>
<tr class="codeline" data-linenumber="1067"><td class="num" id="LN1067">1067</td><td class="line"> <span class='comment'>* found in the configuration, -1 is returned, format-&gt;version is set to -1,</span></td></tr>
<tr class="codeline" data-linenumber="1068"><td class="num" id="LN1068">1068</td><td class="line"> <span class='comment'>* and all other fields in the struct are set to the default configuration</span></td></tr>
<tr class="codeline" data-linenumber="1069"><td class="num" id="LN1069">1069</td><td class="line"> <span class='comment'>* (REPOSITORY_FORMAT_INIT). Always initialize the struct using</span></td></tr>
<tr class="codeline" data-linenumber="1070"><td class="num" id="LN1070">1070</td><td class="line"> <span class='comment'>* REPOSITORY_FORMAT_INIT before calling this function.</span></td></tr>
<tr class="codeline" data-linenumber="1071"><td class="num" id="LN1071">1071</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1072"><td class="num" id="LN1072">1072</td><td class="line"><span class='keyword'>int</span> read_repository_format(<span class='keyword'>struct</span> repository_format *format, <span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="1073"><td class="num" id="LN1073">1073</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1074"><td class="num" id="LN1074">1074</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1075"><td class="num" id="LN1075">1075</td><td class="line"> <span class='comment'>* Free the memory held onto by `format`, but not the struct itself.</span></td></tr>
<tr class="codeline" data-linenumber="1076"><td class="num" id="LN1076">1076</td><td class="line"> <span class='comment'>* (No need to use this after `read_repository_format()` fails.)</span></td></tr>
<tr class="codeline" data-linenumber="1077"><td class="num" id="LN1077">1077</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1078"><td class="num" id="LN1078">1078</td><td class="line"><span class='keyword'>void</span> clear_repository_format(<span class='keyword'>struct</span> repository_format *format);</td></tr>
<tr class="codeline" data-linenumber="1079"><td class="num" id="LN1079">1079</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1080"><td class="num" id="LN1080">1080</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1081"><td class="num" id="LN1081">1081</td><td class="line"> <span class='comment'>* Verify that the repository described by repository_format is something we</span></td></tr>
<tr class="codeline" data-linenumber="1082"><td class="num" id="LN1082">1082</td><td class="line"> <span class='comment'>* can read. If it is, return 0. Otherwise, return -1, and "err" will describe</span></td></tr>
<tr class="codeline" data-linenumber="1083"><td class="num" id="LN1083">1083</td><td class="line"> <span class='comment'>* any errors encountered.</span></td></tr>
<tr class="codeline" data-linenumber="1084"><td class="num" id="LN1084">1084</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1085"><td class="num" id="LN1085">1085</td><td class="line"><span class='keyword'>int</span> verify_repository_format(<span class='keyword'>const</span> <span class='keyword'>struct</span> repository_format *format,</td></tr>
<tr class="codeline" data-linenumber="1086"><td class="num" id="LN1086">1086</td><td class="line">			     <span class='keyword'>struct</span> strbuf *err);</td></tr>
<tr class="codeline" data-linenumber="1087"><td class="num" id="LN1087">1087</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1088"><td class="num" id="LN1088">1088</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1089"><td class="num" id="LN1089">1089</td><td class="line"> <span class='comment'>* Check the repository format version in the path found in get_git_dir(),</span></td></tr>
<tr class="codeline" data-linenumber="1090"><td class="num" id="LN1090">1090</td><td class="line"> <span class='comment'>* and die if it is a version we don't understand. Generally one would</span></td></tr>
<tr class="codeline" data-linenumber="1091"><td class="num" id="LN1091">1091</td><td class="line"> <span class='comment'>* set_git_dir() before calling this, and use it only for "are we in a valid</span></td></tr>
<tr class="codeline" data-linenumber="1092"><td class="num" id="LN1092">1092</td><td class="line"> <span class='comment'>* repo?".</span></td></tr>
<tr class="codeline" data-linenumber="1093"><td class="num" id="LN1093">1093</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1094"><td class="num" id="LN1094">1094</td><td class="line"> <span class='comment'>* If successful and fmt is not NULL, fill fmt with data.</span></td></tr>
<tr class="codeline" data-linenumber="1095"><td class="num" id="LN1095">1095</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1096"><td class="num" id="LN1096">1096</td><td class="line"><span class='keyword'>void</span> check_repository_format(<span class='keyword'>struct</span> repository_format *fmt);</td></tr>
<tr class="codeline" data-linenumber="1097"><td class="num" id="LN1097">1097</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1098"><td class="num" id="LN1098">1098</td><td class="line"><span class='directive'>#define <span class='macro'>MTIME_CHANGED<span class='macro_popup'>0x0001</span></span>	0x0001</span></td></tr>
<tr class="codeline" data-linenumber="1099"><td class="num" id="LN1099">1099</td><td class="line"><span class='directive'>#define <span class='macro'>CTIME_CHANGED<span class='macro_popup'>0x0002</span></span>	0x0002</span></td></tr>
<tr class="codeline" data-linenumber="1100"><td class="num" id="LN1100">1100</td><td class="line"><span class='directive'>#define <span class='macro'>OWNER_CHANGED<span class='macro_popup'>0x0004</span></span>	0x0004</span></td></tr>
<tr class="codeline" data-linenumber="1101"><td class="num" id="LN1101">1101</td><td class="line"><span class='directive'>#define <span class='macro'>MODE_CHANGED<span class='macro_popup'>0x0008</span></span>    0x0008</span></td></tr>
<tr class="codeline" data-linenumber="1102"><td class="num" id="LN1102">1102</td><td class="line"><span class='directive'>#define <span class='macro'>INODE_CHANGED<span class='macro_popup'>0x0010</span></span>   0x0010</span></td></tr>
<tr class="codeline" data-linenumber="1103"><td class="num" id="LN1103">1103</td><td class="line"><span class='directive'>#define <span class='macro'>DATA_CHANGED<span class='macro_popup'>0x0020</span></span>    0x0020</span></td></tr>
<tr class="codeline" data-linenumber="1104"><td class="num" id="LN1104">1104</td><td class="line"><span class='directive'>#define <span class='macro'>TYPE_CHANGED<span class='macro_popup'>0x0040</span></span>    0x0040</span></td></tr>
<tr class="codeline" data-linenumber="1105"><td class="num" id="LN1105">1105</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1106"><td class="num" id="LN1106">1106</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1107"><td class="num" id="LN1107">1107</td><td class="line"> <span class='comment'>* Return an abbreviated sha1 unique within this repository's object database.</span></td></tr>
<tr class="codeline" data-linenumber="1108"><td class="num" id="LN1108">1108</td><td class="line"> <span class='comment'>* The result will be at least `len` characters long, and will be NUL</span></td></tr>
<tr class="codeline" data-linenumber="1109"><td class="num" id="LN1109">1109</td><td class="line"> <span class='comment'>* terminated.</span></td></tr>
<tr class="codeline" data-linenumber="1110"><td class="num" id="LN1110">1110</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1111"><td class="num" id="LN1111">1111</td><td class="line"> <span class='comment'>* The non-`_r` version returns a static buffer which remains valid until 4</span></td></tr>
<tr class="codeline" data-linenumber="1112"><td class="num" id="LN1112">1112</td><td class="line"> <span class='comment'>* more calls to find_unique_abbrev are made.</span></td></tr>
<tr class="codeline" data-linenumber="1113"><td class="num" id="LN1113">1113</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1114"><td class="num" id="LN1114">1114</td><td class="line"> <span class='comment'>* The `_r` variant writes to a buffer supplied by the caller, which must be at</span></td></tr>
<tr class="codeline" data-linenumber="1115"><td class="num" id="LN1115">1115</td><td class="line"> <span class='comment'>* least `GIT_MAX_HEXSZ + 1` bytes. The return value is the number of bytes</span></td></tr>
<tr class="codeline" data-linenumber="1116"><td class="num" id="LN1116">1116</td><td class="line"> <span class='comment'>* written (excluding the NUL terminator).</span></td></tr>
<tr class="codeline" data-linenumber="1117"><td class="num" id="LN1117">1117</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1118"><td class="num" id="LN1118">1118</td><td class="line"> <span class='comment'>* Note that while this version avoids the static buffer, it is not fully</span></td></tr>
<tr class="codeline" data-linenumber="1119"><td class="num" id="LN1119">1119</td><td class="line"> <span class='comment'>* reentrant, as it calls into other non-reentrant git code.</span></td></tr>
<tr class="codeline" data-linenumber="1120"><td class="num" id="LN1120">1120</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1121"><td class="num" id="LN1121">1121</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *repo_find_unique_abbrev(<span class='keyword'>struct</span> repository *r, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid, <span class='keyword'>int</span> len);</td></tr>
<tr class="codeline" data-linenumber="1122"><td class="num" id="LN1122">1122</td><td class="line"><span class='directive'>#define <span class='macro'>find_unique_abbrev(oid, len)<span class='macro_popup'>repo_find_unique_abbrev(the_repository, oid, len)</span></span> repo_find_unique_abbrev(the_repository, oid, len)</span></td></tr>
<tr class="codeline" data-linenumber="1123"><td class="num" id="LN1123">1123</td><td class="line"><span class='keyword'>int</span> repo_find_unique_abbrev_r(<span class='keyword'>struct</span> repository *r, <span class='keyword'>char</span> *hex, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid, <span class='keyword'>int</span> len);</td></tr>
<tr class="codeline" data-linenumber="1124"><td class="num" id="LN1124">1124</td><td class="line"><span class='directive'>#define <span class='macro'>find_unique_abbrev_r(hex, oid, len)<span class='macro_popup'>repo_find_unique_abbrev_r(the_repository, hex, oid, len)</span></span> repo_find_unique_abbrev_r(the_repository, hex, oid, len)</span></td></tr>
<tr class="codeline" data-linenumber="1125"><td class="num" id="LN1125">1125</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1126"><td class="num" id="LN1126">1126</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id null_oid;</td></tr>
<tr class="codeline" data-linenumber="1127"><td class="num" id="LN1127">1127</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1128"><td class="num" id="LN1128">1128</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> hashcmp(<span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *sha1, <span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *sha2)</td></tr>
<tr class="codeline" data-linenumber="1129"><td class="num" id="LN1129">1129</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1130"><td class="num" id="LN1130">1130</td><td class="line">	<span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1131"><td class="num" id="LN1131">1131</td><td class="line">	 <span class='comment'>* Teach the compiler that there are only two possibilities of hash size</span></td></tr>
<tr class="codeline" data-linenumber="1132"><td class="num" id="LN1132">1132</td><td class="line">	 <span class='comment'>* here, so that it can optimize for this case as much as possible.</span></td></tr>
<tr class="codeline" data-linenumber="1133"><td class="num" id="LN1133">1133</td><td class="line">	 <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1134"><td class="num" id="LN1134">1134</td><td class="line">	<span class='keyword'>if</span> (<span class='macro'>the_hash_algo<span class='macro_popup'>the_repository-&gt;hash_algo</span></span>-&gt;rawsz == <span class='macro'>GIT_MAX_RAWSZ<span class='macro_popup'>32</span></span>)</td></tr>
<tr class="codeline" data-linenumber="1135"><td class="num" id="LN1135">1135</td><td class="line">		<span class='keyword'>return</span> memcmp(sha1, sha2, <span class='macro'>GIT_MAX_RAWSZ<span class='macro_popup'>32</span></span>);</td></tr>
<tr class="codeline" data-linenumber="1136"><td class="num" id="LN1136">1136</td><td class="line">	<span class='keyword'>return</span> memcmp(sha1, sha2, <span class='macro'>GIT_SHA1_RAWSZ<span class='macro_popup'>20</span></span>);</td></tr>
<tr class="codeline" data-linenumber="1137"><td class="num" id="LN1137">1137</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1138"><td class="num" id="LN1138">1138</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1139"><td class="num" id="LN1139">1139</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> oidcmp(<span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid1, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid2)</td></tr>
<tr class="codeline" data-linenumber="1140"><td class="num" id="LN1140">1140</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1141"><td class="num" id="LN1141">1141</td><td class="line">	<span class='keyword'>return</span> hashcmp(oid1-&gt;hash, oid2-&gt;hash);</td></tr>
<tr class="codeline" data-linenumber="1142"><td class="num" id="LN1142">1142</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1143"><td class="num" id="LN1143">1143</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1144"><td class="num" id="LN1144">1144</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> hasheq(<span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *sha1, <span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *sha2)</td></tr>
<tr class="codeline" data-linenumber="1145"><td class="num" id="LN1145">1145</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1146"><td class="num" id="LN1146">1146</td><td class="line">	<span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1147"><td class="num" id="LN1147">1147</td><td class="line">	 <span class='comment'>* We write this here instead of deferring to hashcmp so that the</span></td></tr>
<tr class="codeline" data-linenumber="1148"><td class="num" id="LN1148">1148</td><td class="line">	 <span class='comment'>* compiler can properly inline it and avoid calling memcmp.</span></td></tr>
<tr class="codeline" data-linenumber="1149"><td class="num" id="LN1149">1149</td><td class="line">	 <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1150"><td class="num" id="LN1150">1150</td><td class="line">	<span class='keyword'>if</span> (<span class='macro'>the_hash_algo<span class='macro_popup'>the_repository-&gt;hash_algo</span></span>-&gt;rawsz == <span class='macro'>GIT_MAX_RAWSZ<span class='macro_popup'>32</span></span>)</td></tr>
<tr class="codeline" data-linenumber="1151"><td class="num" id="LN1151">1151</td><td class="line">		<span class='keyword'>return</span> !memcmp(sha1, sha2, <span class='macro'>GIT_MAX_RAWSZ<span class='macro_popup'>32</span></span>);</td></tr>
<tr class="codeline" data-linenumber="1152"><td class="num" id="LN1152">1152</td><td class="line">	<span class='keyword'>return</span> !memcmp(sha1, sha2, <span class='macro'>GIT_SHA1_RAWSZ<span class='macro_popup'>20</span></span>);</td></tr>
<tr class="codeline" data-linenumber="1153"><td class="num" id="LN1153">1153</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1154"><td class="num" id="LN1154">1154</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1155"><td class="num" id="LN1155">1155</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> oideq(<span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid1, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid2)</td></tr>
<tr class="codeline" data-linenumber="1156"><td class="num" id="LN1156">1156</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1157"><td class="num" id="LN1157">1157</td><td class="line">	<span class='keyword'>return</span> hasheq(oid1-&gt;hash, oid2-&gt;hash);</td></tr>
<tr class="codeline" data-linenumber="1158"><td class="num" id="LN1158">1158</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1159"><td class="num" id="LN1159">1159</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1160"><td class="num" id="LN1160">1160</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> is_null_oid(<span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid)</td></tr>
<tr class="codeline" data-linenumber="1161"><td class="num" id="LN1161">1161</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1162"><td class="num" id="LN1162">1162</td><td class="line">	<span class='keyword'>return</span> oideq(oid, &amp;null_oid);</td></tr>
<tr class="codeline" data-linenumber="1163"><td class="num" id="LN1163">1163</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1164"><td class="num" id="LN1164">1164</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1165"><td class="num" id="LN1165">1165</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span> hashcpy(<span class='keyword'>unsigned</span> <span class='keyword'>char</span> *sha_dst, <span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *sha_src)</td></tr>
<tr class="codeline" data-linenumber="1166"><td class="num" id="LN1166">1166</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1167"><td class="num" id="LN1167">1167</td><td class="line">	<span class="mrange">memcpy</span>(sha_dst, sha_src, <span class='macro'>the_hash_algo<span class='macro_popup'>the_repository-&gt;hash_algo</span></span>-&gt;rawsz);</td></tr>
<tr><td class="num"></td><td class="line"><div id="EndPath" class="msg msgEvent" style="margin-left:9ex; max-width:58em">Call to function 'memcpy' is insecure as it does not provide security checks introduced in the C11 standard. Replace with analogous functions that support length arguments or provides boundary checks such as 'memcpy_s' in case of C11</div></td></tr>
<tr class="codeline" data-linenumber="1168"><td class="num" id="LN1168">1168</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1169"><td class="num" id="LN1169">1169</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1170"><td class="num" id="LN1170">1170</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span> oidcpy(<span class='keyword'>struct</span> object_id *dst, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *src)</td></tr>
<tr class="codeline" data-linenumber="1171"><td class="num" id="LN1171">1171</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1172"><td class="num" id="LN1172">1172</td><td class="line">	memcpy(dst-&gt;hash, src-&gt;hash, <span class='macro'>GIT_MAX_RAWSZ<span class='macro_popup'>32</span></span>);</td></tr>
<tr class="codeline" data-linenumber="1173"><td class="num" id="LN1173">1173</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1174"><td class="num" id="LN1174">1174</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1175"><td class="num" id="LN1175">1175</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>struct</span> object_id *oiddup(<span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *src)</td></tr>
<tr class="codeline" data-linenumber="1176"><td class="num" id="LN1176">1176</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1177"><td class="num" id="LN1177">1177</td><td class="line">	<span class='keyword'>struct</span> object_id *dst = xmalloc(<span class='keyword'>sizeof</span>(<span class='keyword'>struct</span> object_id));</td></tr>
<tr class="codeline" data-linenumber="1178"><td class="num" id="LN1178">1178</td><td class="line">	oidcpy(dst, src);</td></tr>
<tr class="codeline" data-linenumber="1179"><td class="num" id="LN1179">1179</td><td class="line">	<span class='keyword'>return</span> dst;</td></tr>
<tr class="codeline" data-linenumber="1180"><td class="num" id="LN1180">1180</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1181"><td class="num" id="LN1181">1181</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1182"><td class="num" id="LN1182">1182</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span> hashclr(<span class='keyword'>unsigned</span> <span class='keyword'>char</span> *hash)</td></tr>
<tr class="codeline" data-linenumber="1183"><td class="num" id="LN1183">1183</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1184"><td class="num" id="LN1184">1184</td><td class="line">	memset(hash, 0, <span class='macro'>the_hash_algo<span class='macro_popup'>the_repository-&gt;hash_algo</span></span>-&gt;rawsz);</td></tr>
<tr class="codeline" data-linenumber="1185"><td class="num" id="LN1185">1185</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1186"><td class="num" id="LN1186">1186</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1187"><td class="num" id="LN1187">1187</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span> oidclr(<span class='keyword'>struct</span> object_id *oid)</td></tr>
<tr class="codeline" data-linenumber="1188"><td class="num" id="LN1188">1188</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1189"><td class="num" id="LN1189">1189</td><td class="line">	memset(oid-&gt;hash, 0, <span class='macro'>GIT_MAX_RAWSZ<span class='macro_popup'>32</span></span>);</td></tr>
<tr class="codeline" data-linenumber="1190"><td class="num" id="LN1190">1190</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1191"><td class="num" id="LN1191">1191</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1192"><td class="num" id="LN1192">1192</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span> oidread(<span class='keyword'>struct</span> object_id *oid, <span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *hash)</td></tr>
<tr class="codeline" data-linenumber="1193"><td class="num" id="LN1193">1193</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1194"><td class="num" id="LN1194">1194</td><td class="line">	memcpy(oid-&gt;hash, hash, <span class='macro'>the_hash_algo<span class='macro_popup'>the_repository-&gt;hash_algo</span></span>-&gt;rawsz);</td></tr>
<tr class="codeline" data-linenumber="1195"><td class="num" id="LN1195">1195</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1196"><td class="num" id="LN1196">1196</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1197"><td class="num" id="LN1197">1197</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> is_empty_blob_sha1(<span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *sha1)</td></tr>
<tr class="codeline" data-linenumber="1198"><td class="num" id="LN1198">1198</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1199"><td class="num" id="LN1199">1199</td><td class="line">	<span class='keyword'>return</span> hasheq(sha1, <span class='macro'>the_hash_algo<span class='macro_popup'>the_repository-&gt;hash_algo</span></span>-&gt;empty_blob-&gt;hash);</td></tr>
<tr class="codeline" data-linenumber="1200"><td class="num" id="LN1200">1200</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1201"><td class="num" id="LN1201">1201</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1202"><td class="num" id="LN1202">1202</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> is_empty_blob_oid(<span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid)</td></tr>
<tr class="codeline" data-linenumber="1203"><td class="num" id="LN1203">1203</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1204"><td class="num" id="LN1204">1204</td><td class="line">	<span class='keyword'>return</span> oideq(oid, <span class='macro'>the_hash_algo<span class='macro_popup'>the_repository-&gt;hash_algo</span></span>-&gt;empty_blob);</td></tr>
<tr class="codeline" data-linenumber="1205"><td class="num" id="LN1205">1205</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1206"><td class="num" id="LN1206">1206</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1207"><td class="num" id="LN1207">1207</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> is_empty_tree_sha1(<span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *sha1)</td></tr>
<tr class="codeline" data-linenumber="1208"><td class="num" id="LN1208">1208</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1209"><td class="num" id="LN1209">1209</td><td class="line">	<span class='keyword'>return</span> hasheq(sha1, <span class='macro'>the_hash_algo<span class='macro_popup'>the_repository-&gt;hash_algo</span></span>-&gt;empty_tree-&gt;hash);</td></tr>
<tr class="codeline" data-linenumber="1210"><td class="num" id="LN1210">1210</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1211"><td class="num" id="LN1211">1211</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1212"><td class="num" id="LN1212">1212</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> is_empty_tree_oid(<span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid)</td></tr>
<tr class="codeline" data-linenumber="1213"><td class="num" id="LN1213">1213</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1214"><td class="num" id="LN1214">1214</td><td class="line">	<span class='keyword'>return</span> oideq(oid, <span class='macro'>the_hash_algo<span class='macro_popup'>the_repository-&gt;hash_algo</span></span>-&gt;empty_tree);</td></tr>
<tr class="codeline" data-linenumber="1215"><td class="num" id="LN1215">1215</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1216"><td class="num" id="LN1216">1216</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1217"><td class="num" id="LN1217">1217</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *empty_tree_oid_hex(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1218"><td class="num" id="LN1218">1218</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *empty_blob_oid_hex(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1219"><td class="num" id="LN1219">1219</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1220"><td class="num" id="LN1220">1220</td><td class="line"><span class='comment'>/* set default permissions by passing mode arguments to open(2) */</span></td></tr>
<tr class="codeline" data-linenumber="1221"><td class="num" id="LN1221">1221</td><td class="line"><span class='keyword'>int</span> git_mkstemps_mode(<span class='keyword'>char</span> *pattern, <span class='keyword'>int</span> suffix_len, <span class='keyword'>int</span> mode);</td></tr>
<tr class="codeline" data-linenumber="1222"><td class="num" id="LN1222">1222</td><td class="line"><span class='keyword'>int</span> git_mkstemp_mode(<span class='keyword'>char</span> *pattern, <span class='keyword'>int</span> mode);</td></tr>
<tr class="codeline" data-linenumber="1223"><td class="num" id="LN1223">1223</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1224"><td class="num" id="LN1224">1224</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1225"><td class="num" id="LN1225">1225</td><td class="line"> <span class='comment'>* NOTE NOTE NOTE!!</span></td></tr>
<tr class="codeline" data-linenumber="1226"><td class="num" id="LN1226">1226</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1227"><td class="num" id="LN1227">1227</td><td class="line"> <span class='comment'>* PERM_UMASK, OLD_PERM_GROUP and OLD_PERM_EVERYBODY enumerations must</span></td></tr>
<tr class="codeline" data-linenumber="1228"><td class="num" id="LN1228">1228</td><td class="line"> <span class='comment'>* not be changed. Old repositories have core.sharedrepository written in</span></td></tr>
<tr class="codeline" data-linenumber="1229"><td class="num" id="LN1229">1229</td><td class="line"> <span class='comment'>* numeric format, and therefore these values are preserved for compatibility</span></td></tr>
<tr class="codeline" data-linenumber="1230"><td class="num" id="LN1230">1230</td><td class="line"> <span class='comment'>* reasons.</span></td></tr>
<tr class="codeline" data-linenumber="1231"><td class="num" id="LN1231">1231</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1232"><td class="num" id="LN1232">1232</td><td class="line"><span class='keyword'>enum</span> sharedrepo {</td></tr>
<tr class="codeline" data-linenumber="1233"><td class="num" id="LN1233">1233</td><td class="line">	PERM_UMASK          = 0,</td></tr>
<tr class="codeline" data-linenumber="1234"><td class="num" id="LN1234">1234</td><td class="line">	OLD_PERM_GROUP      = 1,</td></tr>
<tr class="codeline" data-linenumber="1235"><td class="num" id="LN1235">1235</td><td class="line">	OLD_PERM_EVERYBODY  = 2,</td></tr>
<tr class="codeline" data-linenumber="1236"><td class="num" id="LN1236">1236</td><td class="line">	PERM_GROUP          = 0660,</td></tr>
<tr class="codeline" data-linenumber="1237"><td class="num" id="LN1237">1237</td><td class="line">	PERM_EVERYBODY      = 0664</td></tr>
<tr class="codeline" data-linenumber="1238"><td class="num" id="LN1238">1238</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1239"><td class="num" id="LN1239">1239</td><td class="line"><span class='keyword'>int</span> git_config_perm(<span class='keyword'>const</span> <span class='keyword'>char</span> *var, <span class='keyword'>const</span> <span class='keyword'>char</span> *value);</td></tr>
<tr class="codeline" data-linenumber="1240"><td class="num" id="LN1240">1240</td><td class="line"><span class='keyword'>int</span> adjust_shared_perm(<span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="1241"><td class="num" id="LN1241">1241</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1242"><td class="num" id="LN1242">1242</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1243"><td class="num" id="LN1243">1243</td><td class="line"> <span class='comment'>* Create the directory containing the named path, using care to be</span></td></tr>
<tr class="codeline" data-linenumber="1244"><td class="num" id="LN1244">1244</td><td class="line"> <span class='comment'>* somewhat safe against races. Return one of the scld_error values to</span></td></tr>
<tr class="codeline" data-linenumber="1245"><td class="num" id="LN1245">1245</td><td class="line"> <span class='comment'>* indicate success/failure. On error, set errno to describe the</span></td></tr>
<tr class="codeline" data-linenumber="1246"><td class="num" id="LN1246">1246</td><td class="line"> <span class='comment'>* problem.</span></td></tr>
<tr class="codeline" data-linenumber="1247"><td class="num" id="LN1247">1247</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1248"><td class="num" id="LN1248">1248</td><td class="line"> <span class='comment'>* SCLD_VANISHED indicates that one of the ancestor directories of the</span></td></tr>
<tr class="codeline" data-linenumber="1249"><td class="num" id="LN1249">1249</td><td class="line"> <span class='comment'>* path existed at one point during the function call and then</span></td></tr>
<tr class="codeline" data-linenumber="1250"><td class="num" id="LN1250">1250</td><td class="line"> <span class='comment'>* suddenly vanished, probably because another process pruned the</span></td></tr>
<tr class="codeline" data-linenumber="1251"><td class="num" id="LN1251">1251</td><td class="line"> <span class='comment'>* directory while we were working.  To be robust against this kind of</span></td></tr>
<tr class="codeline" data-linenumber="1252"><td class="num" id="LN1252">1252</td><td class="line"> <span class='comment'>* race, callers might want to try invoking the function again when it</span></td></tr>
<tr class="codeline" data-linenumber="1253"><td class="num" id="LN1253">1253</td><td class="line"> <span class='comment'>* returns SCLD_VANISHED.</span></td></tr>
<tr class="codeline" data-linenumber="1254"><td class="num" id="LN1254">1254</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1255"><td class="num" id="LN1255">1255</td><td class="line"> <span class='comment'>* safe_create_leading_directories() temporarily changes path while it</span></td></tr>
<tr class="codeline" data-linenumber="1256"><td class="num" id="LN1256">1256</td><td class="line"> <span class='comment'>* is working but restores it before returning.</span></td></tr>
<tr class="codeline" data-linenumber="1257"><td class="num" id="LN1257">1257</td><td class="line"> <span class='comment'>* safe_create_leading_directories_const() doesn't modify path, even</span></td></tr>
<tr class="codeline" data-linenumber="1258"><td class="num" id="LN1258">1258</td><td class="line"> <span class='comment'>* temporarily.</span></td></tr>
<tr class="codeline" data-linenumber="1259"><td class="num" id="LN1259">1259</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1260"><td class="num" id="LN1260">1260</td><td class="line"><span class='keyword'>enum</span> scld_error {</td></tr>
<tr class="codeline" data-linenumber="1261"><td class="num" id="LN1261">1261</td><td class="line">	SCLD_OK = 0,</td></tr>
<tr class="codeline" data-linenumber="1262"><td class="num" id="LN1262">1262</td><td class="line">	SCLD_FAILED = -1,</td></tr>
<tr class="codeline" data-linenumber="1263"><td class="num" id="LN1263">1263</td><td class="line">	SCLD_PERMS = -2,</td></tr>
<tr class="codeline" data-linenumber="1264"><td class="num" id="LN1264">1264</td><td class="line">	SCLD_EXISTS = -3,</td></tr>
<tr class="codeline" data-linenumber="1265"><td class="num" id="LN1265">1265</td><td class="line">	SCLD_VANISHED = -4</td></tr>
<tr class="codeline" data-linenumber="1266"><td class="num" id="LN1266">1266</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1267"><td class="num" id="LN1267">1267</td><td class="line"><span class='keyword'>enum</span> scld_error safe_create_leading_directories(<span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="1268"><td class="num" id="LN1268">1268</td><td class="line"><span class='keyword'>enum</span> scld_error safe_create_leading_directories_const(<span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="1269"><td class="num" id="LN1269">1269</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1270"><td class="num" id="LN1270">1270</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1271"><td class="num" id="LN1271">1271</td><td class="line"> <span class='comment'>* Callback function for raceproof_create_file(). This function is</span></td></tr>
<tr class="codeline" data-linenumber="1272"><td class="num" id="LN1272">1272</td><td class="line"> <span class='comment'>* expected to do something that makes dirname(path) permanent despite</span></td></tr>
<tr class="codeline" data-linenumber="1273"><td class="num" id="LN1273">1273</td><td class="line"> <span class='comment'>* the fact that other processes might be cleaning up empty</span></td></tr>
<tr class="codeline" data-linenumber="1274"><td class="num" id="LN1274">1274</td><td class="line"> <span class='comment'>* directories at the same time. Usually it will create a file named</span></td></tr>
<tr class="codeline" data-linenumber="1275"><td class="num" id="LN1275">1275</td><td class="line"> <span class='comment'>* path, but alternatively it could create another file in that</span></td></tr>
<tr class="codeline" data-linenumber="1276"><td class="num" id="LN1276">1276</td><td class="line"> <span class='comment'>* directory, or even chdir() into that directory. The function should</span></td></tr>
<tr class="codeline" data-linenumber="1277"><td class="num" id="LN1277">1277</td><td class="line"> <span class='comment'>* return 0 if the action was completed successfully. On error, it</span></td></tr>
<tr class="codeline" data-linenumber="1278"><td class="num" id="LN1278">1278</td><td class="line"> <span class='comment'>* should return a nonzero result and set errno.</span></td></tr>
<tr class="codeline" data-linenumber="1279"><td class="num" id="LN1279">1279</td><td class="line"> <span class='comment'>* raceproof_create_file() treats two errno values specially:</span></td></tr>
<tr class="codeline" data-linenumber="1280"><td class="num" id="LN1280">1280</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1281"><td class="num" id="LN1281">1281</td><td class="line"> <span class='comment'>* - ENOENT -- dirname(path) does not exist. In this case,</span></td></tr>
<tr class="codeline" data-linenumber="1282"><td class="num" id="LN1282">1282</td><td class="line"> <span class='comment'>*             raceproof_create_file() tries creating dirname(path)</span></td></tr>
<tr class="codeline" data-linenumber="1283"><td class="num" id="LN1283">1283</td><td class="line"> <span class='comment'>*             (and any parent directories, if necessary) and calls</span></td></tr>
<tr class="codeline" data-linenumber="1284"><td class="num" id="LN1284">1284</td><td class="line"> <span class='comment'>*             the function again.</span></td></tr>
<tr class="codeline" data-linenumber="1285"><td class="num" id="LN1285">1285</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1286"><td class="num" id="LN1286">1286</td><td class="line"> <span class='comment'>* - EISDIR -- the file already exists and is a directory. In this</span></td></tr>
<tr class="codeline" data-linenumber="1287"><td class="num" id="LN1287">1287</td><td class="line"> <span class='comment'>*             case, raceproof_create_file() removes the directory if</span></td></tr>
<tr class="codeline" data-linenumber="1288"><td class="num" id="LN1288">1288</td><td class="line"> <span class='comment'>*             it is empty (and recursively any empty directories that</span></td></tr>
<tr class="codeline" data-linenumber="1289"><td class="num" id="LN1289">1289</td><td class="line"> <span class='comment'>*             it contains) and calls the function again.</span></td></tr>
<tr class="codeline" data-linenumber="1290"><td class="num" id="LN1290">1290</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1291"><td class="num" id="LN1291">1291</td><td class="line"> <span class='comment'>* Any other errno causes raceproof_create_file() to fail with the</span></td></tr>
<tr class="codeline" data-linenumber="1292"><td class="num" id="LN1292">1292</td><td class="line"> <span class='comment'>* callback's return value and errno.</span></td></tr>
<tr class="codeline" data-linenumber="1293"><td class="num" id="LN1293">1293</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1294"><td class="num" id="LN1294">1294</td><td class="line"> <span class='comment'>* Obviously, this function should be OK with being called again if it</span></td></tr>
<tr class="codeline" data-linenumber="1295"><td class="num" id="LN1295">1295</td><td class="line"> <span class='comment'>* fails with ENOENT or EISDIR. In other scenarios it will not be</span></td></tr>
<tr class="codeline" data-linenumber="1296"><td class="num" id="LN1296">1296</td><td class="line"> <span class='comment'>* called again.</span></td></tr>
<tr class="codeline" data-linenumber="1297"><td class="num" id="LN1297">1297</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1298"><td class="num" id="LN1298">1298</td><td class="line"><span class='keyword'>typedef</span> <span class='keyword'>int</span> create_file_fn(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>void</span> *cb);</td></tr>
<tr class="codeline" data-linenumber="1299"><td class="num" id="LN1299">1299</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1300"><td class="num" id="LN1300">1300</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1301"><td class="num" id="LN1301">1301</td><td class="line"> <span class='comment'>* Create a file in dirname(path) by calling fn, creating leading</span></td></tr>
<tr class="codeline" data-linenumber="1302"><td class="num" id="LN1302">1302</td><td class="line"> <span class='comment'>* directories if necessary. Retry a few times in case we are racing</span></td></tr>
<tr class="codeline" data-linenumber="1303"><td class="num" id="LN1303">1303</td><td class="line"> <span class='comment'>* with another process that is trying to clean up the directory that</span></td></tr>
<tr class="codeline" data-linenumber="1304"><td class="num" id="LN1304">1304</td><td class="line"> <span class='comment'>* contains path. See the documentation for create_file_fn for more</span></td></tr>
<tr class="codeline" data-linenumber="1305"><td class="num" id="LN1305">1305</td><td class="line"> <span class='comment'>* details.</span></td></tr>
<tr class="codeline" data-linenumber="1306"><td class="num" id="LN1306">1306</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1307"><td class="num" id="LN1307">1307</td><td class="line"> <span class='comment'>* Return the value and set the errno that resulted from the most</span></td></tr>
<tr class="codeline" data-linenumber="1308"><td class="num" id="LN1308">1308</td><td class="line"> <span class='comment'>* recent call of fn. fn is always called at least once, and will be</span></td></tr>
<tr class="codeline" data-linenumber="1309"><td class="num" id="LN1309">1309</td><td class="line"> <span class='comment'>* called more than once if it returns ENOENT or EISDIR.</span></td></tr>
<tr class="codeline" data-linenumber="1310"><td class="num" id="LN1310">1310</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1311"><td class="num" id="LN1311">1311</td><td class="line"><span class='keyword'>int</span> raceproof_create_file(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, create_file_fn fn, <span class='keyword'>void</span> *cb);</td></tr>
<tr class="codeline" data-linenumber="1312"><td class="num" id="LN1312">1312</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1313"><td class="num" id="LN1313">1313</td><td class="line"><span class='keyword'>int</span> mkdir_in_gitdir(<span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="1314"><td class="num" id="LN1314">1314</td><td class="line"><span class='keyword'>char</span> *expand_user_path(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>int</span> real_home);</td></tr>
<tr class="codeline" data-linenumber="1315"><td class="num" id="LN1315">1315</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *enter_repo(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>int</span> strict);</td></tr>
<tr class="codeline" data-linenumber="1316"><td class="num" id="LN1316">1316</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> is_absolute_path(<span class='keyword'>const</span> <span class='keyword'>char</span> *path)</td></tr>
<tr class="codeline" data-linenumber="1317"><td class="num" id="LN1317">1317</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1318"><td class="num" id="LN1318">1318</td><td class="line">	<span class='keyword'>return</span> <span class='macro'>is_dir_sep<span class='macro_popup'>git_is_dir_sep</span></span>(path[0]) || <span class='macro'>has_dos_drive_prefix<span class='macro_popup'>git_has_dos_drive_prefix</span></span>(path);</td></tr>
<tr class="codeline" data-linenumber="1319"><td class="num" id="LN1319">1319</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1320"><td class="num" id="LN1320">1320</td><td class="line"><span class='keyword'>int</span> is_directory(<span class='keyword'>const</span> <span class='keyword'>char</span> *);</td></tr>
<tr class="codeline" data-linenumber="1321"><td class="num" id="LN1321">1321</td><td class="line"><span class='keyword'>char</span> *strbuf_realpath(<span class='keyword'>struct</span> strbuf *resolved, <span class='keyword'>const</span> <span class='keyword'>char</span> *path,</td></tr>
<tr class="codeline" data-linenumber="1322"><td class="num" id="LN1322">1322</td><td class="line">		      <span class='keyword'>int</span> die_on_error);</td></tr>
<tr class="codeline" data-linenumber="1323"><td class="num" id="LN1323">1323</td><td class="line"><span class='keyword'>char</span> *real_pathdup(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>int</span> die_on_error);</td></tr>
<tr class="codeline" data-linenumber="1324"><td class="num" id="LN1324">1324</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *absolute_path(<span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="1325"><td class="num" id="LN1325">1325</td><td class="line"><span class='keyword'>char</span> *absolute_pathdup(<span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="1326"><td class="num" id="LN1326">1326</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *remove_leading_path(<span class='keyword'>const</span> <span class='keyword'>char</span> *in, <span class='keyword'>const</span> <span class='keyword'>char</span> *prefix);</td></tr>
<tr class="codeline" data-linenumber="1327"><td class="num" id="LN1327">1327</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *relative_path(<span class='keyword'>const</span> <span class='keyword'>char</span> *in, <span class='keyword'>const</span> <span class='keyword'>char</span> *prefix, <span class='keyword'>struct</span> strbuf *sb);</td></tr>
<tr class="codeline" data-linenumber="1328"><td class="num" id="LN1328">1328</td><td class="line"><span class='keyword'>int</span> normalize_path_copy_len(<span class='keyword'>char</span> *dst, <span class='keyword'>const</span> <span class='keyword'>char</span> *src, <span class='keyword'>int</span> *prefix_len);</td></tr>
<tr class="codeline" data-linenumber="1329"><td class="num" id="LN1329">1329</td><td class="line"><span class='keyword'>int</span> normalize_path_copy(<span class='keyword'>char</span> *dst, <span class='keyword'>const</span> <span class='keyword'>char</span> *src);</td></tr>
<tr class="codeline" data-linenumber="1330"><td class="num" id="LN1330">1330</td><td class="line"><span class='keyword'>int</span> longest_ancestor_length(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>struct</span> string_list *prefixes);</td></tr>
<tr class="codeline" data-linenumber="1331"><td class="num" id="LN1331">1331</td><td class="line"><span class='keyword'>char</span> *strip_path_suffix(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>const</span> <span class='keyword'>char</span> *suffix);</td></tr>
<tr class="codeline" data-linenumber="1332"><td class="num" id="LN1332">1332</td><td class="line"><span class='keyword'>int</span> daemon_avoid_alias(<span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="1333"><td class="num" id="LN1333">1333</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1334"><td class="num" id="LN1334">1334</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1335"><td class="num" id="LN1335">1335</td><td class="line"> <span class='comment'>* These functions match their is_hfs_dotgit() counterparts; see utf8.h for</span></td></tr>
<tr class="codeline" data-linenumber="1336"><td class="num" id="LN1336">1336</td><td class="line"> <span class='comment'>* details.</span></td></tr>
<tr class="codeline" data-linenumber="1337"><td class="num" id="LN1337">1337</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1338"><td class="num" id="LN1338">1338</td><td class="line"><span class='keyword'>int</span> is_ntfs_dotgit(<span class='keyword'>const</span> <span class='keyword'>char</span> *name);</td></tr>
<tr class="codeline" data-linenumber="1339"><td class="num" id="LN1339">1339</td><td class="line"><span class='keyword'>int</span> is_ntfs_dotgitmodules(<span class='keyword'>const</span> <span class='keyword'>char</span> *name);</td></tr>
<tr class="codeline" data-linenumber="1340"><td class="num" id="LN1340">1340</td><td class="line"><span class='keyword'>int</span> is_ntfs_dotgitignore(<span class='keyword'>const</span> <span class='keyword'>char</span> *name);</td></tr>
<tr class="codeline" data-linenumber="1341"><td class="num" id="LN1341">1341</td><td class="line"><span class='keyword'>int</span> is_ntfs_dotgitattributes(<span class='keyword'>const</span> <span class='keyword'>char</span> *name);</td></tr>
<tr class="codeline" data-linenumber="1342"><td class="num" id="LN1342">1342</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1343"><td class="num" id="LN1343">1343</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1344"><td class="num" id="LN1344">1344</td><td class="line"> <span class='comment'>* Returns true iff "str" could be confused as a command-line option when</span></td></tr>
<tr class="codeline" data-linenumber="1345"><td class="num" id="LN1345">1345</td><td class="line"> <span class='comment'>* passed to a sub-program like "ssh". Note that this has nothing to do with</span></td></tr>
<tr class="codeline" data-linenumber="1346"><td class="num" id="LN1346">1346</td><td class="line"> <span class='comment'>* shell-quoting, which should be handled separately; we're assuming here that</span></td></tr>
<tr class="codeline" data-linenumber="1347"><td class="num" id="LN1347">1347</td><td class="line"> <span class='comment'>* the string makes it verbatim to the sub-program.</span></td></tr>
<tr class="codeline" data-linenumber="1348"><td class="num" id="LN1348">1348</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1349"><td class="num" id="LN1349">1349</td><td class="line"><span class='keyword'>int</span> looks_like_command_line_option(<span class='keyword'>const</span> <span class='keyword'>char</span> *str);</td></tr>
<tr class="codeline" data-linenumber="1350"><td class="num" id="LN1350">1350</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1351"><td class="num" id="LN1351">1351</td><td class="line"><span class='comment'>/**</span></td></tr>
<tr class="codeline" data-linenumber="1352"><td class="num" id="LN1352">1352</td><td class="line"> <span class='comment'>* Return a newly allocated string with the evaluation of</span></td></tr>
<tr class="codeline" data-linenumber="1353"><td class="num" id="LN1353">1353</td><td class="line"> <span class='comment'>* "$XDG_CONFIG_HOME/git/$filename" if $XDG_CONFIG_HOME is non-empty, otherwise</span></td></tr>
<tr class="codeline" data-linenumber="1354"><td class="num" id="LN1354">1354</td><td class="line"> <span class='comment'>* "$HOME/.config/git/$filename". Return NULL upon error.</span></td></tr>
<tr class="codeline" data-linenumber="1355"><td class="num" id="LN1355">1355</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1356"><td class="num" id="LN1356">1356</td><td class="line"><span class='keyword'>char</span> *xdg_config_home(<span class='keyword'>const</span> <span class='keyword'>char</span> *filename);</td></tr>
<tr class="codeline" data-linenumber="1357"><td class="num" id="LN1357">1357</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1358"><td class="num" id="LN1358">1358</td><td class="line"><span class='comment'>/**</span></td></tr>
<tr class="codeline" data-linenumber="1359"><td class="num" id="LN1359">1359</td><td class="line"> <span class='comment'>* Return a newly allocated string with the evaluation of</span></td></tr>
<tr class="codeline" data-linenumber="1360"><td class="num" id="LN1360">1360</td><td class="line"> <span class='comment'>* "$XDG_CACHE_HOME/git/$filename" if $XDG_CACHE_HOME is non-empty, otherwise</span></td></tr>
<tr class="codeline" data-linenumber="1361"><td class="num" id="LN1361">1361</td><td class="line"> <span class='comment'>* "$HOME/.cache/git/$filename". Return NULL upon error.</span></td></tr>
<tr class="codeline" data-linenumber="1362"><td class="num" id="LN1362">1362</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1363"><td class="num" id="LN1363">1363</td><td class="line"><span class='keyword'>char</span> *xdg_cache_home(<span class='keyword'>const</span> <span class='keyword'>char</span> *filename);</td></tr>
<tr class="codeline" data-linenumber="1364"><td class="num" id="LN1364">1364</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1365"><td class="num" id="LN1365">1365</td><td class="line"><span class='keyword'>int</span> git_open_cloexec(<span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>int</span> flags);</td></tr>
<tr class="codeline" data-linenumber="1366"><td class="num" id="LN1366">1366</td><td class="line"><span class='directive'>#define <span class='macro'>git_open(name)<span class='macro_popup'>git_open_cloexec(name, 00)</span></span> git_open_cloexec(name, <span class='macro'>O_RDONLY<span class='macro_popup'>00</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="1367"><td class="num" id="LN1367">1367</td><td class="line"><span class='keyword'>int</span> unpack_loose_header(git_zstream *stream, <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *map, <span class='keyword'>unsigned</span> <span class='keyword'>long</span> mapsize, <span class='keyword'>void</span> *buffer, <span class='keyword'>unsigned</span> <span class='keyword'>long</span> bufsiz);</td></tr>
<tr class="codeline" data-linenumber="1368"><td class="num" id="LN1368">1368</td><td class="line"><span class='keyword'>int</span> parse_loose_header(<span class='keyword'>const</span> <span class='keyword'>char</span> *hdr, <span class='keyword'>unsigned</span> <span class='keyword'>long</span> *sizep);</td></tr>
<tr class="codeline" data-linenumber="1369"><td class="num" id="LN1369">1369</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1370"><td class="num" id="LN1370">1370</td><td class="line"><span class='keyword'>int</span> check_object_signature(<span class='keyword'>struct</span> repository *r, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid,</td></tr>
<tr class="codeline" data-linenumber="1371"><td class="num" id="LN1371">1371</td><td class="line">			   <span class='keyword'>void</span> *buf, <span class='keyword'>unsigned</span> <span class='keyword'>long</span> size, <span class='keyword'>const</span> <span class='keyword'>char</span> *type);</td></tr>
<tr class="codeline" data-linenumber="1372"><td class="num" id="LN1372">1372</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1373"><td class="num" id="LN1373">1373</td><td class="line"><span class='keyword'>int</span> finalize_object_file(<span class='keyword'>const</span> <span class='keyword'>char</span> *tmpfile, <span class='keyword'>const</span> <span class='keyword'>char</span> *filename);</td></tr>
<tr class="codeline" data-linenumber="1374"><td class="num" id="LN1374">1374</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1375"><td class="num" id="LN1375">1375</td><td class="line"><span class='comment'>/* Helper to check and "touch" a file */</span></td></tr>
<tr class="codeline" data-linenumber="1376"><td class="num" id="LN1376">1376</td><td class="line"><span class='keyword'>int</span> check_and_freshen_file(<span class='keyword'>const</span> <span class='keyword'>char</span> *fn, <span class='keyword'>int</span> freshen);</td></tr>
<tr class="codeline" data-linenumber="1377"><td class="num" id="LN1377">1377</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1378"><td class="num" id="LN1378">1378</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>signed</span> <span class='keyword'>char</span> hexval_table[256];</td></tr>
<tr class="codeline" data-linenumber="1379"><td class="num" id="LN1379">1379</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>unsigned</span> <span class='keyword'>int</span> hexval(<span class='keyword'>unsigned</span> <span class='keyword'>char</span> c)</td></tr>
<tr class="codeline" data-linenumber="1380"><td class="num" id="LN1380">1380</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1381"><td class="num" id="LN1381">1381</td><td class="line">	<span class='keyword'>return</span> hexval_table[c];</td></tr>
<tr class="codeline" data-linenumber="1382"><td class="num" id="LN1382">1382</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1383"><td class="num" id="LN1383">1383</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1384"><td class="num" id="LN1384">1384</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1385"><td class="num" id="LN1385">1385</td><td class="line"> <span class='comment'>* Convert two consecutive hexadecimal digits into a char.  Return a</span></td></tr>
<tr class="codeline" data-linenumber="1386"><td class="num" id="LN1386">1386</td><td class="line"> <span class='comment'>* negative value on error.  Don't run over the end of short strings.</span></td></tr>
<tr class="codeline" data-linenumber="1387"><td class="num" id="LN1387">1387</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1388"><td class="num" id="LN1388">1388</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>int</span> hex2chr(<span class='keyword'>const</span> <span class='keyword'>char</span> *s)</td></tr>
<tr class="codeline" data-linenumber="1389"><td class="num" id="LN1389">1389</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1390"><td class="num" id="LN1390">1390</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> val = hexval(s[0]);</td></tr>
<tr class="codeline" data-linenumber="1391"><td class="num" id="LN1391">1391</td><td class="line">	<span class='keyword'>return</span> (val &amp; ~0xf) ? val : (val &lt;&lt; 4) | hexval(s[1]);</td></tr>
<tr class="codeline" data-linenumber="1392"><td class="num" id="LN1392">1392</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1393"><td class="num" id="LN1393">1393</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1394"><td class="num" id="LN1394">1394</td><td class="line"><span class='comment'>/* Convert to/from hex/sha1 representation */</span></td></tr>
<tr class="codeline" data-linenumber="1395"><td class="num" id="LN1395">1395</td><td class="line"><span class='directive'>#define <span class='macro'>MINIMUM_ABBREV<span class='macro_popup'>minimum_abbrev</span></span> minimum_abbrev</span></td></tr>
<tr class="codeline" data-linenumber="1396"><td class="num" id="LN1396">1396</td><td class="line"><span class='directive'>#define <span class='macro'>DEFAULT_ABBREV<span class='macro_popup'>default_abbrev</span></span> default_abbrev</span></td></tr>
<tr class="codeline" data-linenumber="1397"><td class="num" id="LN1397">1397</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1398"><td class="num" id="LN1398">1398</td><td class="line"><span class='comment'>/* used when the code does not know or care what the default abbrev is */</span></td></tr>
<tr class="codeline" data-linenumber="1399"><td class="num" id="LN1399">1399</td><td class="line"><span class='directive'>#define <span class='macro'>FALLBACK_DEFAULT_ABBREV<span class='macro_popup'>7</span></span> 7</span></td></tr>
<tr class="codeline" data-linenumber="1400"><td class="num" id="LN1400">1400</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1401"><td class="num" id="LN1401">1401</td><td class="line"><span class='keyword'>struct</span> object_context {</td></tr>
<tr class="codeline" data-linenumber="1402"><td class="num" id="LN1402">1402</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>short</span> mode;</td></tr>
<tr class="codeline" data-linenumber="1403"><td class="num" id="LN1403">1403</td><td class="line">	<span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1404"><td class="num" id="LN1404">1404</td><td class="line">	 <span class='comment'>* symlink_path is only used by get_tree_entry_follow_symlinks,</span></td></tr>
<tr class="codeline" data-linenumber="1405"><td class="num" id="LN1405">1405</td><td class="line">	 <span class='comment'>* and only for symlinks that point outside the repository.</span></td></tr>
<tr class="codeline" data-linenumber="1406"><td class="num" id="LN1406">1406</td><td class="line">	 <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1407"><td class="num" id="LN1407">1407</td><td class="line">	<span class='keyword'>struct</span> strbuf symlink_path;</td></tr>
<tr class="codeline" data-linenumber="1408"><td class="num" id="LN1408">1408</td><td class="line">	<span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1409"><td class="num" id="LN1409">1409</td><td class="line">	 <span class='comment'>* If GET_OID_RECORD_PATH is set, this will record path (if any)</span></td></tr>
<tr class="codeline" data-linenumber="1410"><td class="num" id="LN1410">1410</td><td class="line">	 <span class='comment'>* found when resolving the name. The caller is responsible for</span></td></tr>
<tr class="codeline" data-linenumber="1411"><td class="num" id="LN1411">1411</td><td class="line">	 <span class='comment'>* releasing the memory.</span></td></tr>
<tr class="codeline" data-linenumber="1412"><td class="num" id="LN1412">1412</td><td class="line">	 <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1413"><td class="num" id="LN1413">1413</td><td class="line">	<span class='keyword'>char</span> *path;</td></tr>
<tr class="codeline" data-linenumber="1414"><td class="num" id="LN1414">1414</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1415"><td class="num" id="LN1415">1415</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1416"><td class="num" id="LN1416">1416</td><td class="line"><span class='directive'>#define <span class='macro'>GET_OID_QUIETLY<span class='macro_popup'>01</span></span>           01</span></td></tr>
<tr class="codeline" data-linenumber="1417"><td class="num" id="LN1417">1417</td><td class="line"><span class='directive'>#define <span class='macro'>GET_OID_COMMIT<span class='macro_popup'>02</span></span>            02</span></td></tr>
<tr class="codeline" data-linenumber="1418"><td class="num" id="LN1418">1418</td><td class="line"><span class='directive'>#define <span class='macro'>GET_OID_COMMITTISH<span class='macro_popup'>04</span></span>        04</span></td></tr>
<tr class="codeline" data-linenumber="1419"><td class="num" id="LN1419">1419</td><td class="line"><span class='directive'>#define <span class='macro'>GET_OID_TREE<span class='macro_popup'>010</span></span>             010</span></td></tr>
<tr class="codeline" data-linenumber="1420"><td class="num" id="LN1420">1420</td><td class="line"><span class='directive'>#define <span class='macro'>GET_OID_TREEISH<span class='macro_popup'>020</span></span>          020</span></td></tr>
<tr class="codeline" data-linenumber="1421"><td class="num" id="LN1421">1421</td><td class="line"><span class='directive'>#define <span class='macro'>GET_OID_BLOB<span class='macro_popup'>040</span></span>             040</span></td></tr>
<tr class="codeline" data-linenumber="1422"><td class="num" id="LN1422">1422</td><td class="line"><span class='directive'>#define <span class='macro'>GET_OID_FOLLOW_SYMLINKS<span class='macro_popup'>0100</span></span> 0100</span></td></tr>
<tr class="codeline" data-linenumber="1423"><td class="num" id="LN1423">1423</td><td class="line"><span class='directive'>#define <span class='macro'>GET_OID_RECORD_PATH<span class='macro_popup'>0200</span></span>     0200</span></td></tr>
<tr class="codeline" data-linenumber="1424"><td class="num" id="LN1424">1424</td><td class="line"><span class='directive'>#define <span class='macro'>GET_OID_ONLY_TO_DIE<span class='macro_popup'>04000</span></span>    04000</span></td></tr>
<tr class="codeline" data-linenumber="1425"><td class="num" id="LN1425">1425</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1426"><td class="num" id="LN1426">1426</td><td class="line"><span class='directive'>#define <span class='macro'>GET_OID_DISAMBIGUATORS<span class='macro_popup'>(02 | 04 | 010 | 020 | 040)</span></span> \</span></td></tr>
<tr class="codeline" data-linenumber="1427"><td class="num" id="LN1427">1427</td><td class="line">	<span class='directive'>(<span class='macro'>GET_OID_COMMIT<span class='macro_popup'>02</span></span> | <span class='macro'>GET_OID_COMMITTISH<span class='macro_popup'>04</span></span> | \</span></td></tr>
<tr class="codeline" data-linenumber="1428"><td class="num" id="LN1428">1428</td><td class="line">	<span class='directive'><span class='macro'>GET_OID_TREE<span class='macro_popup'>010</span></span> | <span class='macro'>GET_OID_TREEISH<span class='macro_popup'>020</span></span> | \</span></td></tr>
<tr class="codeline" data-linenumber="1429"><td class="num" id="LN1429">1429</td><td class="line">	<span class='directive'><span class='macro'>GET_OID_BLOB<span class='macro_popup'>040</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="1430"><td class="num" id="LN1430">1430</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1431"><td class="num" id="LN1431">1431</td><td class="line"><span class='keyword'>enum</span> get_oid_result {</td></tr>
<tr class="codeline" data-linenumber="1432"><td class="num" id="LN1432">1432</td><td class="line">	FOUND = 0,</td></tr>
<tr class="codeline" data-linenumber="1433"><td class="num" id="LN1433">1433</td><td class="line">	MISSING_OBJECT = -1, <span class='comment'>/* The requested object is missing */</span></td></tr>
<tr class="codeline" data-linenumber="1434"><td class="num" id="LN1434">1434</td><td class="line">	SHORT_NAME_AMBIGUOUS = -2,</td></tr>
<tr class="codeline" data-linenumber="1435"><td class="num" id="LN1435">1435</td><td class="line">	<span class='comment'>/* The following only apply when symlinks are followed */</span></td></tr>
<tr class="codeline" data-linenumber="1436"><td class="num" id="LN1436">1436</td><td class="line">	DANGLING_SYMLINK = -4, <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1437"><td class="num" id="LN1437">1437</td><td class="line">				<span class='comment'>* The initial symlink is there, but</span></td></tr>
<tr class="codeline" data-linenumber="1438"><td class="num" id="LN1438">1438</td><td class="line">				<span class='comment'>* (transitively) points to a missing</span></td></tr>
<tr class="codeline" data-linenumber="1439"><td class="num" id="LN1439">1439</td><td class="line">				<span class='comment'>* in-tree file</span></td></tr>
<tr class="codeline" data-linenumber="1440"><td class="num" id="LN1440">1440</td><td class="line">				<span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1441"><td class="num" id="LN1441">1441</td><td class="line">	SYMLINK_LOOP = -5,</td></tr>
<tr class="codeline" data-linenumber="1442"><td class="num" id="LN1442">1442</td><td class="line">	NOT_DIR = -6, <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1443"><td class="num" id="LN1443">1443</td><td class="line">		       <span class='comment'>* Somewhere along the symlink chain, a path is</span></td></tr>
<tr class="codeline" data-linenumber="1444"><td class="num" id="LN1444">1444</td><td class="line">		       <span class='comment'>* requested which contains a file as a</span></td></tr>
<tr class="codeline" data-linenumber="1445"><td class="num" id="LN1445">1445</td><td class="line">		       <span class='comment'>* non-final element.</span></td></tr>
<tr class="codeline" data-linenumber="1446"><td class="num" id="LN1446">1446</td><td class="line">		       <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1447"><td class="num" id="LN1447">1447</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1448"><td class="num" id="LN1448">1448</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1449"><td class="num" id="LN1449">1449</td><td class="line"><span class='keyword'>int</span> repo_get_oid(<span class='keyword'>struct</span> repository *r, <span class='keyword'>const</span> <span class='keyword'>char</span> *str, <span class='keyword'>struct</span> object_id *oid);</td></tr>
<tr class="codeline" data-linenumber="1450"><td class="num" id="LN1450">1450</td><td class="line"><span class='keyword'>int</span> get_oidf(<span class='keyword'>struct</span> object_id *oid, <span class='keyword'>const</span> <span class='keyword'>char</span> *fmt, ...);</td></tr>
<tr class="codeline" data-linenumber="1451"><td class="num" id="LN1451">1451</td><td class="line"><span class='keyword'>int</span> repo_get_oid_commit(<span class='keyword'>struct</span> repository *r, <span class='keyword'>const</span> <span class='keyword'>char</span> *str, <span class='keyword'>struct</span> object_id *oid);</td></tr>
<tr class="codeline" data-linenumber="1452"><td class="num" id="LN1452">1452</td><td class="line"><span class='keyword'>int</span> repo_get_oid_committish(<span class='keyword'>struct</span> repository *r, <span class='keyword'>const</span> <span class='keyword'>char</span> *str, <span class='keyword'>struct</span> object_id *oid);</td></tr>
<tr class="codeline" data-linenumber="1453"><td class="num" id="LN1453">1453</td><td class="line"><span class='keyword'>int</span> repo_get_oid_tree(<span class='keyword'>struct</span> repository *r, <span class='keyword'>const</span> <span class='keyword'>char</span> *str, <span class='keyword'>struct</span> object_id *oid);</td></tr>
<tr class="codeline" data-linenumber="1454"><td class="num" id="LN1454">1454</td><td class="line"><span class='keyword'>int</span> repo_get_oid_treeish(<span class='keyword'>struct</span> repository *r, <span class='keyword'>const</span> <span class='keyword'>char</span> *str, <span class='keyword'>struct</span> object_id *oid);</td></tr>
<tr class="codeline" data-linenumber="1455"><td class="num" id="LN1455">1455</td><td class="line"><span class='keyword'>int</span> repo_get_oid_blob(<span class='keyword'>struct</span> repository *r, <span class='keyword'>const</span> <span class='keyword'>char</span> *str, <span class='keyword'>struct</span> object_id *oid);</td></tr>
<tr class="codeline" data-linenumber="1456"><td class="num" id="LN1456">1456</td><td class="line"><span class='keyword'>int</span> repo_get_oid_mb(<span class='keyword'>struct</span> repository *r, <span class='keyword'>const</span> <span class='keyword'>char</span> *str, <span class='keyword'>struct</span> object_id *oid);</td></tr>
<tr class="codeline" data-linenumber="1457"><td class="num" id="LN1457">1457</td><td class="line"><span class='keyword'>void</span> maybe_die_on_misspelt_object_name(<span class='keyword'>struct</span> repository *repo,</td></tr>
<tr class="codeline" data-linenumber="1458"><td class="num" id="LN1458">1458</td><td class="line">				       <span class='keyword'>const</span> <span class='keyword'>char</span> *name,</td></tr>
<tr class="codeline" data-linenumber="1459"><td class="num" id="LN1459">1459</td><td class="line">				       <span class='keyword'>const</span> <span class='keyword'>char</span> *prefix);</td></tr>
<tr class="codeline" data-linenumber="1460"><td class="num" id="LN1460">1460</td><td class="line"><span class='keyword'>enum</span> get_oid_result get_oid_with_context(<span class='keyword'>struct</span> repository *repo, <span class='keyword'>const</span> <span class='keyword'>char</span> *str,</td></tr>
<tr class="codeline" data-linenumber="1461"><td class="num" id="LN1461">1461</td><td class="line">					 <span class='keyword'>unsigned</span> flags, <span class='keyword'>struct</span> object_id *oid,</td></tr>
<tr class="codeline" data-linenumber="1462"><td class="num" id="LN1462">1462</td><td class="line">					 <span class='keyword'>struct</span> object_context *oc);</td></tr>
<tr class="codeline" data-linenumber="1463"><td class="num" id="LN1463">1463</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1464"><td class="num" id="LN1464">1464</td><td class="line"><span class='directive'>#define <span class='macro'>get_oid(str, oid)<span class='macro_popup'>repo_get_oid(the_repository, str, oid)</span></span>		repo_get_oid(the_repository, str, oid)</span></td></tr>
<tr class="codeline" data-linenumber="1465"><td class="num" id="LN1465">1465</td><td class="line"><span class='directive'>#define <span class='macro'>get_oid_commit(str, oid)<span class='macro_popup'>repo_get_oid_commit(the_repository, str, oid)</span></span>	repo_get_oid_commit(the_repository, str, oid)</span></td></tr>
<tr class="codeline" data-linenumber="1466"><td class="num" id="LN1466">1466</td><td class="line"><span class='directive'>#define <span class='macro'>get_oid_committish(str, oid)<span class='macro_popup'>repo_get_oid_committish(the_repository, str, oid)</span></span>	repo_get_oid_committish(the_repository, str, oid)</span></td></tr>
<tr class="codeline" data-linenumber="1467"><td class="num" id="LN1467">1467</td><td class="line"><span class='directive'>#define <span class='macro'>get_oid_tree(str, oid)<span class='macro_popup'>repo_get_oid_tree(the_repository, str, oid)</span></span>		repo_get_oid_tree(the_repository, str, oid)</span></td></tr>
<tr class="codeline" data-linenumber="1468"><td class="num" id="LN1468">1468</td><td class="line"><span class='directive'>#define <span class='macro'>get_oid_treeish(str, oid)<span class='macro_popup'>repo_get_oid_treeish(the_repository, str, oid)</span></span>	repo_get_oid_treeish(the_repository, str, oid)</span></td></tr>
<tr class="codeline" data-linenumber="1469"><td class="num" id="LN1469">1469</td><td class="line"><span class='directive'>#define <span class='macro'>get_oid_blob(str, oid)<span class='macro_popup'>repo_get_oid_blob(the_repository, str, oid)</span></span>		repo_get_oid_blob(the_repository, str, oid)</span></td></tr>
<tr class="codeline" data-linenumber="1470"><td class="num" id="LN1470">1470</td><td class="line"><span class='directive'>#define <span class='macro'>get_oid_mb(str, oid)<span class='macro_popup'>repo_get_oid_mb(the_repository, str, oid)</span></span> 		repo_get_oid_mb(the_repository, str, oid)</span></td></tr>
<tr class="codeline" data-linenumber="1471"><td class="num" id="LN1471">1471</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1472"><td class="num" id="LN1472">1472</td><td class="line"><span class='keyword'>typedef</span> <span class='keyword'>int</span> each_abbrev_fn(<span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid, <span class='keyword'>void</span> *);</td></tr>
<tr class="codeline" data-linenumber="1473"><td class="num" id="LN1473">1473</td><td class="line"><span class='keyword'>int</span> repo_for_each_abbrev(<span class='keyword'>struct</span> repository *r, <span class='keyword'>const</span> <span class='keyword'>char</span> *prefix, each_abbrev_fn, <span class='keyword'>void</span> *);</td></tr>
<tr class="codeline" data-linenumber="1474"><td class="num" id="LN1474">1474</td><td class="line"><span class='directive'>#define <span class='macro'>for_each_abbrev(prefix, fn, data)<span class='macro_popup'>repo_for_each_abbrev(the_repository, prefix, fn, data)</span></span> repo_for_each_abbrev(the_repository, prefix, fn, data)</span></td></tr>
<tr class="codeline" data-linenumber="1475"><td class="num" id="LN1475">1475</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1476"><td class="num" id="LN1476">1476</td><td class="line"><span class='keyword'>int</span> set_disambiguate_hint_config(<span class='keyword'>const</span> <span class='keyword'>char</span> *var, <span class='keyword'>const</span> <span class='keyword'>char</span> *value);</td></tr>
<tr class="codeline" data-linenumber="1477"><td class="num" id="LN1477">1477</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1478"><td class="num" id="LN1478">1478</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1479"><td class="num" id="LN1479">1479</td><td class="line"> <span class='comment'>* Try to read a SHA1 in hexadecimal format from the 40 characters</span></td></tr>
<tr class="codeline" data-linenumber="1480"><td class="num" id="LN1480">1480</td><td class="line"> <span class='comment'>* starting at hex.  Write the 20-byte result to sha1 in binary form.</span></td></tr>
<tr class="codeline" data-linenumber="1481"><td class="num" id="LN1481">1481</td><td class="line"> <span class='comment'>* Return 0 on success.  Reading stops if a NUL is encountered in the</span></td></tr>
<tr class="codeline" data-linenumber="1482"><td class="num" id="LN1482">1482</td><td class="line"> <span class='comment'>* input, so it is safe to pass this function an arbitrary</span></td></tr>
<tr class="codeline" data-linenumber="1483"><td class="num" id="LN1483">1483</td><td class="line"> <span class='comment'>* null-terminated string.</span></td></tr>
<tr class="codeline" data-linenumber="1484"><td class="num" id="LN1484">1484</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1485"><td class="num" id="LN1485">1485</td><td class="line"><span class='keyword'>int</span> get_sha1_hex(<span class='keyword'>const</span> <span class='keyword'>char</span> *hex, <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *sha1);</td></tr>
<tr class="codeline" data-linenumber="1486"><td class="num" id="LN1486">1486</td><td class="line"><span class='keyword'>int</span> get_oid_hex(<span class='keyword'>const</span> <span class='keyword'>char</span> *hex, <span class='keyword'>struct</span> object_id *sha1);</td></tr>
<tr class="codeline" data-linenumber="1487"><td class="num" id="LN1487">1487</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1488"><td class="num" id="LN1488">1488</td><td class="line"><span class='comment'>/* Like get_oid_hex, but for an arbitrary hash algorithm. */</span></td></tr>
<tr class="codeline" data-linenumber="1489"><td class="num" id="LN1489">1489</td><td class="line"><span class='keyword'>int</span> get_oid_hex_algop(<span class='keyword'>const</span> <span class='keyword'>char</span> *hex, <span class='keyword'>struct</span> object_id *oid, <span class='keyword'>const</span> <span class='keyword'>struct</span> git_hash_algo *algop);</td></tr>
<tr class="codeline" data-linenumber="1490"><td class="num" id="LN1490">1490</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1491"><td class="num" id="LN1491">1491</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1492"><td class="num" id="LN1492">1492</td><td class="line"> <span class='comment'>* Read `len` pairs of hexadecimal digits from `hex` and write the</span></td></tr>
<tr class="codeline" data-linenumber="1493"><td class="num" id="LN1493">1493</td><td class="line"> <span class='comment'>* values to `binary` as `len` bytes. Return 0 on success, or -1 if</span></td></tr>
<tr class="codeline" data-linenumber="1494"><td class="num" id="LN1494">1494</td><td class="line"> <span class='comment'>* the input does not consist of hex digits).</span></td></tr>
<tr class="codeline" data-linenumber="1495"><td class="num" id="LN1495">1495</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1496"><td class="num" id="LN1496">1496</td><td class="line"><span class='keyword'>int</span> hex_to_bytes(<span class='keyword'>unsigned</span> <span class='keyword'>char</span> *binary, <span class='keyword'>const</span> <span class='keyword'>char</span> *hex, size_t len);</td></tr>
<tr class="codeline" data-linenumber="1497"><td class="num" id="LN1497">1497</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1498"><td class="num" id="LN1498">1498</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1499"><td class="num" id="LN1499">1499</td><td class="line"> <span class='comment'>* Convert a binary hash in "unsigned char []" or an object name in</span></td></tr>
<tr class="codeline" data-linenumber="1500"><td class="num" id="LN1500">1500</td><td class="line"> <span class='comment'>* "struct object_id *" to its hex equivalent. The `_r` variant is reentrant,</span></td></tr>
<tr class="codeline" data-linenumber="1501"><td class="num" id="LN1501">1501</td><td class="line"> <span class='comment'>* and writes the NUL-terminated output to the buffer `out`, which must be at</span></td></tr>
<tr class="codeline" data-linenumber="1502"><td class="num" id="LN1502">1502</td><td class="line"> <span class='comment'>* least `GIT_MAX_HEXSZ + 1` bytes, and returns a pointer to out for</span></td></tr>
<tr class="codeline" data-linenumber="1503"><td class="num" id="LN1503">1503</td><td class="line"> <span class='comment'>* convenience.</span></td></tr>
<tr class="codeline" data-linenumber="1504"><td class="num" id="LN1504">1504</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1505"><td class="num" id="LN1505">1505</td><td class="line"> <span class='comment'>* The non-`_r` variant returns a static buffer, but uses a ring of 4</span></td></tr>
<tr class="codeline" data-linenumber="1506"><td class="num" id="LN1506">1506</td><td class="line"> <span class='comment'>* buffers, making it safe to make multiple calls for a single statement, like:</span></td></tr>
<tr class="codeline" data-linenumber="1507"><td class="num" id="LN1507">1507</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1508"><td class="num" id="LN1508">1508</td><td class="line"> <span class='comment'>*   printf("%s -&gt; %s", hash_to_hex(one), hash_to_hex(two));</span></td></tr>
<tr class="codeline" data-linenumber="1509"><td class="num" id="LN1509">1509</td><td class="line"> <span class='comment'>*   printf("%s -&gt; %s", oid_to_hex(one), oid_to_hex(two));</span></td></tr>
<tr class="codeline" data-linenumber="1510"><td class="num" id="LN1510">1510</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1511"><td class="num" id="LN1511">1511</td><td class="line"><span class='keyword'>char</span> *hash_to_hex_algop_r(<span class='keyword'>char</span> *buffer, <span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *hash, <span class='keyword'>const</span> <span class='keyword'>struct</span> git_hash_algo *);</td></tr>
<tr class="codeline" data-linenumber="1512"><td class="num" id="LN1512">1512</td><td class="line"><span class='keyword'>char</span> *oid_to_hex_r(<span class='keyword'>char</span> *out, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid);</td></tr>
<tr class="codeline" data-linenumber="1513"><td class="num" id="LN1513">1513</td><td class="line"><span class='keyword'>char</span> *hash_to_hex_algop(<span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *hash, <span class='keyword'>const</span> <span class='keyword'>struct</span> git_hash_algo *);	<span class='comment'>/* static buffer result! */</span></td></tr>
<tr class="codeline" data-linenumber="1514"><td class="num" id="LN1514">1514</td><td class="line"><span class='keyword'>char</span> *hash_to_hex(<span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *hash);						<span class='comment'>/* same static buffer */</span></td></tr>
<tr class="codeline" data-linenumber="1515"><td class="num" id="LN1515">1515</td><td class="line"><span class='keyword'>char</span> *oid_to_hex(<span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid);						<span class='comment'>/* same static buffer */</span></td></tr>
<tr class="codeline" data-linenumber="1516"><td class="num" id="LN1516">1516</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1517"><td class="num" id="LN1517">1517</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1518"><td class="num" id="LN1518">1518</td><td class="line"> <span class='comment'>* Parse a 40-character hexadecimal object ID starting from hex, updating the</span></td></tr>
<tr class="codeline" data-linenumber="1519"><td class="num" id="LN1519">1519</td><td class="line"> <span class='comment'>* pointer specified by end when parsing stops.  The resulting object ID is</span></td></tr>
<tr class="codeline" data-linenumber="1520"><td class="num" id="LN1520">1520</td><td class="line"> <span class='comment'>* stored in oid.  Returns 0 on success.  Parsing will stop on the first NUL or</span></td></tr>
<tr class="codeline" data-linenumber="1521"><td class="num" id="LN1521">1521</td><td class="line"> <span class='comment'>* other invalid character.  end is only updated on success; otherwise, it is</span></td></tr>
<tr class="codeline" data-linenumber="1522"><td class="num" id="LN1522">1522</td><td class="line"> <span class='comment'>* unmodified.</span></td></tr>
<tr class="codeline" data-linenumber="1523"><td class="num" id="LN1523">1523</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1524"><td class="num" id="LN1524">1524</td><td class="line"><span class='keyword'>int</span> parse_oid_hex(<span class='keyword'>const</span> <span class='keyword'>char</span> *hex, <span class='keyword'>struct</span> object_id *oid, <span class='keyword'>const</span> <span class='keyword'>char</span> **end);</td></tr>
<tr class="codeline" data-linenumber="1525"><td class="num" id="LN1525">1525</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1526"><td class="num" id="LN1526">1526</td><td class="line"><span class='comment'>/* Like parse_oid_hex, but for an arbitrary hash algorithm. */</span></td></tr>
<tr class="codeline" data-linenumber="1527"><td class="num" id="LN1527">1527</td><td class="line"><span class='keyword'>int</span> parse_oid_hex_algop(<span class='keyword'>const</span> <span class='keyword'>char</span> *hex, <span class='keyword'>struct</span> object_id *oid, <span class='keyword'>const</span> <span class='keyword'>char</span> **end,</td></tr>
<tr class="codeline" data-linenumber="1528"><td class="num" id="LN1528">1528</td><td class="line">			<span class='keyword'>const</span> <span class='keyword'>struct</span> git_hash_algo *algo);</td></tr>
<tr class="codeline" data-linenumber="1529"><td class="num" id="LN1529">1529</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1530"><td class="num" id="LN1530">1530</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1531"><td class="num" id="LN1531">1531</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1532"><td class="num" id="LN1532">1532</td><td class="line"> <span class='comment'>* These functions work like get_oid_hex and parse_oid_hex, but they will parse</span></td></tr>
<tr class="codeline" data-linenumber="1533"><td class="num" id="LN1533">1533</td><td class="line"> <span class='comment'>* a hex value for any algorithm. The algorithm is detected based on the length</span></td></tr>
<tr class="codeline" data-linenumber="1534"><td class="num" id="LN1534">1534</td><td class="line"> <span class='comment'>* and the algorithm in use is returned. If this is not a hex object ID in any</span></td></tr>
<tr class="codeline" data-linenumber="1535"><td class="num" id="LN1535">1535</td><td class="line"> <span class='comment'>* algorithm, returns GIT_HASH_UNKNOWN.</span></td></tr>
<tr class="codeline" data-linenumber="1536"><td class="num" id="LN1536">1536</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1537"><td class="num" id="LN1537">1537</td><td class="line"><span class='keyword'>int</span> get_oid_hex_any(<span class='keyword'>const</span> <span class='keyword'>char</span> *hex, <span class='keyword'>struct</span> object_id *oid);</td></tr>
<tr class="codeline" data-linenumber="1538"><td class="num" id="LN1538">1538</td><td class="line"><span class='keyword'>int</span> parse_oid_hex_any(<span class='keyword'>const</span> <span class='keyword'>char</span> *hex, <span class='keyword'>struct</span> object_id *oid, <span class='keyword'>const</span> <span class='keyword'>char</span> **end);</td></tr>
<tr class="codeline" data-linenumber="1539"><td class="num" id="LN1539">1539</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1540"><td class="num" id="LN1540">1540</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1541"><td class="num" id="LN1541">1541</td><td class="line"> <span class='comment'>* This reads short-hand syntax that not only evaluates to a commit</span></td></tr>
<tr class="codeline" data-linenumber="1542"><td class="num" id="LN1542">1542</td><td class="line"> <span class='comment'>* object name, but also can act as if the end user spelled the name</span></td></tr>
<tr class="codeline" data-linenumber="1543"><td class="num" id="LN1543">1543</td><td class="line"> <span class='comment'>* of the branch from the command line.</span></td></tr>
<tr class="codeline" data-linenumber="1544"><td class="num" id="LN1544">1544</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1545"><td class="num" id="LN1545">1545</td><td class="line"> <span class='comment'>* - "@{-N}" finds the name of the Nth previous branch we were on, and</span></td></tr>
<tr class="codeline" data-linenumber="1546"><td class="num" id="LN1546">1546</td><td class="line"> <span class='comment'>*   places the name of the branch in the given buf and returns the</span></td></tr>
<tr class="codeline" data-linenumber="1547"><td class="num" id="LN1547">1547</td><td class="line"> <span class='comment'>*   number of characters parsed if successful.</span></td></tr>
<tr class="codeline" data-linenumber="1548"><td class="num" id="LN1548">1548</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1549"><td class="num" id="LN1549">1549</td><td class="line"> <span class='comment'>* - "&lt;branch&gt;@{upstream}" finds the name of the other ref that</span></td></tr>
<tr class="codeline" data-linenumber="1550"><td class="num" id="LN1550">1550</td><td class="line"> <span class='comment'>*   &lt;branch&gt; is configured to merge with (missing &lt;branch&gt; defaults</span></td></tr>
<tr class="codeline" data-linenumber="1551"><td class="num" id="LN1551">1551</td><td class="line"> <span class='comment'>*   to the current branch), and places the name of the branch in the</span></td></tr>
<tr class="codeline" data-linenumber="1552"><td class="num" id="LN1552">1552</td><td class="line"> <span class='comment'>*   given buf and returns the number of characters parsed if</span></td></tr>
<tr class="codeline" data-linenumber="1553"><td class="num" id="LN1553">1553</td><td class="line"> <span class='comment'>*   successful.</span></td></tr>
<tr class="codeline" data-linenumber="1554"><td class="num" id="LN1554">1554</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1555"><td class="num" id="LN1555">1555</td><td class="line"> <span class='comment'>* If the input is not of the accepted format, it returns a negative</span></td></tr>
<tr class="codeline" data-linenumber="1556"><td class="num" id="LN1556">1556</td><td class="line"> <span class='comment'>* number to signal an error.</span></td></tr>
<tr class="codeline" data-linenumber="1557"><td class="num" id="LN1557">1557</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1558"><td class="num" id="LN1558">1558</td><td class="line"> <span class='comment'>* If the input was ok but there are not N branch switches in the</span></td></tr>
<tr class="codeline" data-linenumber="1559"><td class="num" id="LN1559">1559</td><td class="line"> <span class='comment'>* reflog, it returns 0.</span></td></tr>
<tr class="codeline" data-linenumber="1560"><td class="num" id="LN1560">1560</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1561"><td class="num" id="LN1561">1561</td><td class="line"><span class='directive'>#define <span class='macro'>INTERPRET_BRANCH_LOCAL<span class='macro_popup'>(1&lt;&lt;0)</span></span> (1&lt;&lt;0)</span></td></tr>
<tr class="codeline" data-linenumber="1562"><td class="num" id="LN1562">1562</td><td class="line"><span class='directive'>#define <span class='macro'>INTERPRET_BRANCH_REMOTE<span class='macro_popup'>(1&lt;&lt;1)</span></span> (1&lt;&lt;1)</span></td></tr>
<tr class="codeline" data-linenumber="1563"><td class="num" id="LN1563">1563</td><td class="line"><span class='directive'>#define <span class='macro'>INTERPRET_BRANCH_HEAD<span class='macro_popup'>(1&lt;&lt;2)</span></span> (1&lt;&lt;2)</span></td></tr>
<tr class="codeline" data-linenumber="1564"><td class="num" id="LN1564">1564</td><td class="line"><span class='keyword'>struct</span> interpret_branch_name_options {</td></tr>
<tr class="codeline" data-linenumber="1565"><td class="num" id="LN1565">1565</td><td class="line">	<span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1566"><td class="num" id="LN1566">1566</td><td class="line">	 <span class='comment'>* If "allowed" is non-zero, it is a treated as a bitfield of allowable</span></td></tr>
<tr class="codeline" data-linenumber="1567"><td class="num" id="LN1567">1567</td><td class="line">	 <span class='comment'>* expansions: local branches ("refs/heads/"), remote branches</span></td></tr>
<tr class="codeline" data-linenumber="1568"><td class="num" id="LN1568">1568</td><td class="line">	 <span class='comment'>* ("refs/remotes/"), or "HEAD". If no "allowed" bits are set, any expansion is</span></td></tr>
<tr class="codeline" data-linenumber="1569"><td class="num" id="LN1569">1569</td><td class="line">	 <span class='comment'>* allowed, even ones to refs outside of those namespaces.</span></td></tr>
<tr class="codeline" data-linenumber="1570"><td class="num" id="LN1570">1570</td><td class="line">	 <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1571"><td class="num" id="LN1571">1571</td><td class="line">	<span class='keyword'>unsigned</span> allowed;</td></tr>
<tr class="codeline" data-linenumber="1572"><td class="num" id="LN1572">1572</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1573"><td class="num" id="LN1573">1573</td><td class="line">	<span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1574"><td class="num" id="LN1574">1574</td><td class="line">	 <span class='comment'>* If ^{upstream} or ^{push} (or equivalent) is requested, and the</span></td></tr>
<tr class="codeline" data-linenumber="1575"><td class="num" id="LN1575">1575</td><td class="line">	 <span class='comment'>* branch in question does not have such a reference, return -1 instead</span></td></tr>
<tr class="codeline" data-linenumber="1576"><td class="num" id="LN1576">1576</td><td class="line">	 <span class='comment'>* of die()-ing.</span></td></tr>
<tr class="codeline" data-linenumber="1577"><td class="num" id="LN1577">1577</td><td class="line">	 <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1578"><td class="num" id="LN1578">1578</td><td class="line">	<span class='keyword'>unsigned</span> nonfatal_dangling_mark : 1;</td></tr>
<tr class="codeline" data-linenumber="1579"><td class="num" id="LN1579">1579</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1580"><td class="num" id="LN1580">1580</td><td class="line"><span class='keyword'>int</span> repo_interpret_branch_name(<span class='keyword'>struct</span> repository *r,</td></tr>
<tr class="codeline" data-linenumber="1581"><td class="num" id="LN1581">1581</td><td class="line">			       <span class='keyword'>const</span> <span class='keyword'>char</span> *str, <span class='keyword'>int</span> len,</td></tr>
<tr class="codeline" data-linenumber="1582"><td class="num" id="LN1582">1582</td><td class="line">			       <span class='keyword'>struct</span> strbuf *buf,</td></tr>
<tr class="codeline" data-linenumber="1583"><td class="num" id="LN1583">1583</td><td class="line">			       <span class='keyword'>const</span> <span class='keyword'>struct</span> interpret_branch_name_options *options);</td></tr>
<tr class="codeline" data-linenumber="1584"><td class="num" id="LN1584">1584</td><td class="line"><span class='directive'>#define <span class='macro'>interpret_branch_name(str, len, buf, options)<span class='macro_popup'>repo_interpret_branch_name(the_repository, str, len, buf, options<br>)</span></span> \</span></td></tr>
<tr class="codeline" data-linenumber="1585"><td class="num" id="LN1585">1585</td><td class="line">	<span class='directive'>repo_interpret_branch_name(the_repository, str, len, buf, options)</span></td></tr>
<tr class="codeline" data-linenumber="1586"><td class="num" id="LN1586">1586</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1587"><td class="num" id="LN1587">1587</td><td class="line"><span class='keyword'>int</span> validate_headref(<span class='keyword'>const</span> <span class='keyword'>char</span> *ref);</td></tr>
<tr class="codeline" data-linenumber="1588"><td class="num" id="LN1588">1588</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1589"><td class="num" id="LN1589">1589</td><td class="line"><span class='keyword'>int</span> base_name_compare(<span class='keyword'>const</span> <span class='keyword'>char</span> *name1, <span class='keyword'>int</span> len1, <span class='keyword'>int</span> mode1, <span class='keyword'>const</span> <span class='keyword'>char</span> *name2, <span class='keyword'>int</span> len2, <span class='keyword'>int</span> mode2);</td></tr>
<tr class="codeline" data-linenumber="1590"><td class="num" id="LN1590">1590</td><td class="line"><span class='keyword'>int</span> df_name_compare(<span class='keyword'>const</span> <span class='keyword'>char</span> *name1, <span class='keyword'>int</span> len1, <span class='keyword'>int</span> mode1, <span class='keyword'>const</span> <span class='keyword'>char</span> *name2, <span class='keyword'>int</span> len2, <span class='keyword'>int</span> mode2);</td></tr>
<tr class="codeline" data-linenumber="1591"><td class="num" id="LN1591">1591</td><td class="line"><span class='keyword'>int</span> name_compare(<span class='keyword'>const</span> <span class='keyword'>char</span> *name1, size_t len1, <span class='keyword'>const</span> <span class='keyword'>char</span> *name2, size_t len2);</td></tr>
<tr class="codeline" data-linenumber="1592"><td class="num" id="LN1592">1592</td><td class="line"><span class='keyword'>int</span> cache_name_stage_compare(<span class='keyword'>const</span> <span class='keyword'>char</span> *name1, <span class='keyword'>int</span> len1, <span class='keyword'>int</span> stage1, <span class='keyword'>const</span> <span class='keyword'>char</span> *name2, <span class='keyword'>int</span> len2, <span class='keyword'>int</span> stage2);</td></tr>
<tr class="codeline" data-linenumber="1593"><td class="num" id="LN1593">1593</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1594"><td class="num" id="LN1594">1594</td><td class="line"><span class='keyword'>void</span> *read_object_with_reference(<span class='keyword'>struct</span> repository *r,</td></tr>
<tr class="codeline" data-linenumber="1595"><td class="num" id="LN1595">1595</td><td class="line">				 <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *oid,</td></tr>
<tr class="codeline" data-linenumber="1596"><td class="num" id="LN1596">1596</td><td class="line">				 <span class='keyword'>const</span> <span class='keyword'>char</span> *required_type,</td></tr>
<tr class="codeline" data-linenumber="1597"><td class="num" id="LN1597">1597</td><td class="line">				 <span class='keyword'>unsigned</span> <span class='keyword'>long</span> *size,</td></tr>
<tr class="codeline" data-linenumber="1598"><td class="num" id="LN1598">1598</td><td class="line">				 <span class='keyword'>struct</span> object_id *oid_ret);</td></tr>
<tr class="codeline" data-linenumber="1599"><td class="num" id="LN1599">1599</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1600"><td class="num" id="LN1600">1600</td><td class="line"><span class='keyword'>struct</span> object *repo_peel_to_type(<span class='keyword'>struct</span> repository *r,</td></tr>
<tr class="codeline" data-linenumber="1601"><td class="num" id="LN1601">1601</td><td class="line">				 <span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>int</span> namelen,</td></tr>
<tr class="codeline" data-linenumber="1602"><td class="num" id="LN1602">1602</td><td class="line">				 <span class='keyword'>struct</span> object *o, <span class='keyword'>enum</span> object_type);</td></tr>
<tr class="codeline" data-linenumber="1603"><td class="num" id="LN1603">1603</td><td class="line"><span class='directive'>#define <span class='macro'>peel_to_type(name, namelen, obj, type)<span class='macro_popup'>repo_peel_to_type(the_repository, name, namelen, obj, type)</span></span> \</span></td></tr>
<tr class="codeline" data-linenumber="1604"><td class="num" id="LN1604">1604</td><td class="line">	<span class='directive'>repo_peel_to_type(the_repository, name, namelen, obj, type)</span></td></tr>
<tr class="codeline" data-linenumber="1605"><td class="num" id="LN1605">1605</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1606"><td class="num" id="LN1606">1606</td><td class="line"><span class='keyword'>enum</span> date_mode_type {</td></tr>
<tr class="codeline" data-linenumber="1607"><td class="num" id="LN1607">1607</td><td class="line">	DATE_NORMAL = 0,</td></tr>
<tr class="codeline" data-linenumber="1608"><td class="num" id="LN1608">1608</td><td class="line">	DATE_HUMAN,</td></tr>
<tr class="codeline" data-linenumber="1609"><td class="num" id="LN1609">1609</td><td class="line">	DATE_RELATIVE,</td></tr>
<tr class="codeline" data-linenumber="1610"><td class="num" id="LN1610">1610</td><td class="line">	DATE_SHORT,</td></tr>
<tr class="codeline" data-linenumber="1611"><td class="num" id="LN1611">1611</td><td class="line">	DATE_ISO8601,</td></tr>
<tr class="codeline" data-linenumber="1612"><td class="num" id="LN1612">1612</td><td class="line">	DATE_ISO8601_STRICT,</td></tr>
<tr class="codeline" data-linenumber="1613"><td class="num" id="LN1613">1613</td><td class="line">	DATE_RFC2822,</td></tr>
<tr class="codeline" data-linenumber="1614"><td class="num" id="LN1614">1614</td><td class="line">	DATE_STRFTIME,</td></tr>
<tr class="codeline" data-linenumber="1615"><td class="num" id="LN1615">1615</td><td class="line">	DATE_RAW,</td></tr>
<tr class="codeline" data-linenumber="1616"><td class="num" id="LN1616">1616</td><td class="line">	DATE_UNIX</td></tr>
<tr class="codeline" data-linenumber="1617"><td class="num" id="LN1617">1617</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1618"><td class="num" id="LN1618">1618</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1619"><td class="num" id="LN1619">1619</td><td class="line"><span class='keyword'>struct</span> date_mode {</td></tr>
<tr class="codeline" data-linenumber="1620"><td class="num" id="LN1620">1620</td><td class="line">	<span class='keyword'>enum</span> date_mode_type type;</td></tr>
<tr class="codeline" data-linenumber="1621"><td class="num" id="LN1621">1621</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *strftime_fmt;</td></tr>
<tr class="codeline" data-linenumber="1622"><td class="num" id="LN1622">1622</td><td class="line">	<span class='keyword'>int</span> local;</td></tr>
<tr class="codeline" data-linenumber="1623"><td class="num" id="LN1623">1623</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1624"><td class="num" id="LN1624">1624</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1625"><td class="num" id="LN1625">1625</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1626"><td class="num" id="LN1626">1626</td><td class="line"> <span class='comment'>* Convenience helper for passing a constant type, like:</span></td></tr>
<tr class="codeline" data-linenumber="1627"><td class="num" id="LN1627">1627</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1628"><td class="num" id="LN1628">1628</td><td class="line"> <span class='comment'>*   show_date(t, tz, DATE_MODE(NORMAL));</span></td></tr>
<tr class="codeline" data-linenumber="1629"><td class="num" id="LN1629">1629</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1630"><td class="num" id="LN1630">1630</td><td class="line"><span class='directive'>#define <span class='macro'>DATE_MODE(t)<span class='macro_popup'>date_mode_from_type(DATE_t)</span></span> date_mode_from_type(DATE_##t)</span></td></tr>
<tr class="codeline" data-linenumber="1631"><td class="num" id="LN1631">1631</td><td class="line"><span class='keyword'>struct</span> date_mode *date_mode_from_type(<span class='keyword'>enum</span> date_mode_type type);</td></tr>
<tr class="codeline" data-linenumber="1632"><td class="num" id="LN1632">1632</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1633"><td class="num" id="LN1633">1633</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *show_date(timestamp_t time, <span class='keyword'>int</span> timezone, <span class='keyword'>const</span> <span class='keyword'>struct</span> date_mode *mode);</td></tr>
<tr class="codeline" data-linenumber="1634"><td class="num" id="LN1634">1634</td><td class="line"><span class='keyword'>void</span> show_date_relative(timestamp_t time, <span class='keyword'>struct</span> strbuf *timebuf);</td></tr>
<tr class="codeline" data-linenumber="1635"><td class="num" id="LN1635">1635</td><td class="line"><span class='keyword'>void</span> show_date_human(timestamp_t time, <span class='keyword'>int</span> tz, <span class='keyword'>const</span> <span class='keyword'>struct</span> timeval *now,</td></tr>
<tr class="codeline" data-linenumber="1636"><td class="num" id="LN1636">1636</td><td class="line">			<span class='keyword'>struct</span> strbuf *timebuf);</td></tr>
<tr class="codeline" data-linenumber="1637"><td class="num" id="LN1637">1637</td><td class="line"><span class='keyword'>int</span> parse_date(<span class='keyword'>const</span> <span class='keyword'>char</span> *date, <span class='keyword'>struct</span> strbuf *out);</td></tr>
<tr class="codeline" data-linenumber="1638"><td class="num" id="LN1638">1638</td><td class="line"><span class='keyword'>int</span> parse_date_basic(<span class='keyword'>const</span> <span class='keyword'>char</span> *date, timestamp_t *timestamp, <span class='keyword'>int</span> *offset);</td></tr>
<tr class="codeline" data-linenumber="1639"><td class="num" id="LN1639">1639</td><td class="line"><span class='keyword'>int</span> parse_expiry_date(<span class='keyword'>const</span> <span class='keyword'>char</span> *date, timestamp_t *timestamp);</td></tr>
<tr class="codeline" data-linenumber="1640"><td class="num" id="LN1640">1640</td><td class="line"><span class='keyword'>void</span> datestamp(<span class='keyword'>struct</span> strbuf *out);</td></tr>
<tr class="codeline" data-linenumber="1641"><td class="num" id="LN1641">1641</td><td class="line"><span class='directive'>#define <span class='macro'>approxidate(s)<span class='macro_popup'>approxidate_careful((s), ((void*)0))</span></span> approxidate_careful((s), <span class='macro'>NULL<span class='macro_popup'>((void*)0)</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="1642"><td class="num" id="LN1642">1642</td><td class="line">timestamp_t approxidate_careful(<span class='keyword'>const</span> <span class='keyword'>char</span> *, <span class='keyword'>int</span> *);</td></tr>
<tr class="codeline" data-linenumber="1643"><td class="num" id="LN1643">1643</td><td class="line">timestamp_t approxidate_relative(<span class='keyword'>const</span> <span class='keyword'>char</span> *date);</td></tr>
<tr class="codeline" data-linenumber="1644"><td class="num" id="LN1644">1644</td><td class="line"><span class='keyword'>void</span> parse_date_format(<span class='keyword'>const</span> <span class='keyword'>char</span> *format, <span class='keyword'>struct</span> date_mode *mode);</td></tr>
<tr class="codeline" data-linenumber="1645"><td class="num" id="LN1645">1645</td><td class="line"><span class='keyword'>int</span> date_overflows(timestamp_t date);</td></tr>
<tr class="codeline" data-linenumber="1646"><td class="num" id="LN1646">1646</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1647"><td class="num" id="LN1647">1647</td><td class="line"><span class='directive'>#define <span class='macro'>IDENT_STRICT<span class='macro_popup'>1</span></span>	       1</span></td></tr>
<tr class="codeline" data-linenumber="1648"><td class="num" id="LN1648">1648</td><td class="line"><span class='directive'>#define <span class='macro'>IDENT_NO_DATE<span class='macro_popup'>2</span></span>	       2</span></td></tr>
<tr class="codeline" data-linenumber="1649"><td class="num" id="LN1649">1649</td><td class="line"><span class='directive'>#define <span class='macro'>IDENT_NO_NAME<span class='macro_popup'>4</span></span>	       4</span></td></tr>
<tr class="codeline" data-linenumber="1650"><td class="num" id="LN1650">1650</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1651"><td class="num" id="LN1651">1651</td><td class="line"><span class='keyword'>enum</span> want_ident {</td></tr>
<tr class="codeline" data-linenumber="1652"><td class="num" id="LN1652">1652</td><td class="line">	WANT_BLANK_IDENT,</td></tr>
<tr class="codeline" data-linenumber="1653"><td class="num" id="LN1653">1653</td><td class="line">	WANT_AUTHOR_IDENT,</td></tr>
<tr class="codeline" data-linenumber="1654"><td class="num" id="LN1654">1654</td><td class="line">	WANT_COMMITTER_IDENT</td></tr>
<tr class="codeline" data-linenumber="1655"><td class="num" id="LN1655">1655</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1656"><td class="num" id="LN1656">1656</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1657"><td class="num" id="LN1657">1657</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *git_author_info(<span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="1658"><td class="num" id="LN1658">1658</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *git_committer_info(<span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="1659"><td class="num" id="LN1659">1659</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *fmt_ident(<span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>const</span> <span class='keyword'>char</span> *email,</td></tr>
<tr class="codeline" data-linenumber="1660"><td class="num" id="LN1660">1660</td><td class="line">		      <span class='keyword'>enum</span> want_ident whose_ident,</td></tr>
<tr class="codeline" data-linenumber="1661"><td class="num" id="LN1661">1661</td><td class="line">		      <span class='keyword'>const</span> <span class='keyword'>char</span> *date_str, <span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="1662"><td class="num" id="LN1662">1662</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *fmt_name(<span class='keyword'>enum</span> want_ident);</td></tr>
<tr class="codeline" data-linenumber="1663"><td class="num" id="LN1663">1663</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *ident_default_name(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1664"><td class="num" id="LN1664">1664</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *ident_default_email(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1665"><td class="num" id="LN1665">1665</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *git_editor(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1666"><td class="num" id="LN1666">1666</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *git_sequence_editor(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1667"><td class="num" id="LN1667">1667</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *git_pager(<span class='keyword'>int</span> stdout_is_tty);</td></tr>
<tr class="codeline" data-linenumber="1668"><td class="num" id="LN1668">1668</td><td class="line"><span class='keyword'>int</span> is_terminal_dumb(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1669"><td class="num" id="LN1669">1669</td><td class="line"><span class='keyword'>int</span> git_ident_config(<span class='keyword'>const</span> <span class='keyword'>char</span> *, <span class='keyword'>const</span> <span class='keyword'>char</span> *, <span class='keyword'>void</span> *);</td></tr>
<tr class="codeline" data-linenumber="1670"><td class="num" id="LN1670">1670</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1671"><td class="num" id="LN1671">1671</td><td class="line"> <span class='comment'>* Prepare an ident to fall back on if the user didn't configure it.</span></td></tr>
<tr class="codeline" data-linenumber="1672"><td class="num" id="LN1672">1672</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1673"><td class="num" id="LN1673">1673</td><td class="line"><span class='keyword'>void</span> prepare_fallback_ident(<span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>const</span> <span class='keyword'>char</span> *email);</td></tr>
<tr class="codeline" data-linenumber="1674"><td class="num" id="LN1674">1674</td><td class="line"><span class='keyword'>void</span> reset_ident_date(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1675"><td class="num" id="LN1675">1675</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1676"><td class="num" id="LN1676">1676</td><td class="line"><span class='keyword'>struct</span> ident_split {</td></tr>
<tr class="codeline" data-linenumber="1677"><td class="num" id="LN1677">1677</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *name_begin;</td></tr>
<tr class="codeline" data-linenumber="1678"><td class="num" id="LN1678">1678</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *name_end;</td></tr>
<tr class="codeline" data-linenumber="1679"><td class="num" id="LN1679">1679</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *mail_begin;</td></tr>
<tr class="codeline" data-linenumber="1680"><td class="num" id="LN1680">1680</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *mail_end;</td></tr>
<tr class="codeline" data-linenumber="1681"><td class="num" id="LN1681">1681</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *date_begin;</td></tr>
<tr class="codeline" data-linenumber="1682"><td class="num" id="LN1682">1682</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *date_end;</td></tr>
<tr class="codeline" data-linenumber="1683"><td class="num" id="LN1683">1683</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *tz_begin;</td></tr>
<tr class="codeline" data-linenumber="1684"><td class="num" id="LN1684">1684</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *tz_end;</td></tr>
<tr class="codeline" data-linenumber="1685"><td class="num" id="LN1685">1685</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1686"><td class="num" id="LN1686">1686</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1687"><td class="num" id="LN1687">1687</td><td class="line"> <span class='comment'>* Signals an success with 0, but time part of the result may be NULL</span></td></tr>
<tr class="codeline" data-linenumber="1688"><td class="num" id="LN1688">1688</td><td class="line"> <span class='comment'>* if the input lacks timestamp and zone</span></td></tr>
<tr class="codeline" data-linenumber="1689"><td class="num" id="LN1689">1689</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1690"><td class="num" id="LN1690">1690</td><td class="line"><span class='keyword'>int</span> split_ident_line(<span class='keyword'>struct</span> ident_split *, <span class='keyword'>const</span> <span class='keyword'>char</span> *, <span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="1691"><td class="num" id="LN1691">1691</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1692"><td class="num" id="LN1692">1692</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1693"><td class="num" id="LN1693">1693</td><td class="line"> <span class='comment'>* Like show_date, but pull the timestamp and tz parameters from</span></td></tr>
<tr class="codeline" data-linenumber="1694"><td class="num" id="LN1694">1694</td><td class="line"> <span class='comment'>* the ident_split. It will also sanity-check the values and produce</span></td></tr>
<tr class="codeline" data-linenumber="1695"><td class="num" id="LN1695">1695</td><td class="line"> <span class='comment'>* a well-known sentinel date if they appear bogus.</span></td></tr>
<tr class="codeline" data-linenumber="1696"><td class="num" id="LN1696">1696</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1697"><td class="num" id="LN1697">1697</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *show_ident_date(<span class='keyword'>const</span> <span class='keyword'>struct</span> ident_split *id,</td></tr>
<tr class="codeline" data-linenumber="1698"><td class="num" id="LN1698">1698</td><td class="line">			    <span class='keyword'>const</span> <span class='keyword'>struct</span> date_mode *mode);</td></tr>
<tr class="codeline" data-linenumber="1699"><td class="num" id="LN1699">1699</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1700"><td class="num" id="LN1700">1700</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1701"><td class="num" id="LN1701">1701</td><td class="line"> <span class='comment'>* Compare split idents for equality or strict ordering. Note that we</span></td></tr>
<tr class="codeline" data-linenumber="1702"><td class="num" id="LN1702">1702</td><td class="line"> <span class='comment'>* compare only the ident part of the line, ignoring any timestamp.</span></td></tr>
<tr class="codeline" data-linenumber="1703"><td class="num" id="LN1703">1703</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1704"><td class="num" id="LN1704">1704</td><td class="line"> <span class='comment'>* Because there are two fields, we must choose one as the primary key; we</span></td></tr>
<tr class="codeline" data-linenumber="1705"><td class="num" id="LN1705">1705</td><td class="line"> <span class='comment'>* currently arbitrarily pick the email.</span></td></tr>
<tr class="codeline" data-linenumber="1706"><td class="num" id="LN1706">1706</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1707"><td class="num" id="LN1707">1707</td><td class="line"><span class='keyword'>int</span> ident_cmp(<span class='keyword'>const</span> <span class='keyword'>struct</span> ident_split *, <span class='keyword'>const</span> <span class='keyword'>struct</span> ident_split *);</td></tr>
<tr class="codeline" data-linenumber="1708"><td class="num" id="LN1708">1708</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1709"><td class="num" id="LN1709">1709</td><td class="line"><span class='keyword'>struct</span> checkout {</td></tr>
<tr class="codeline" data-linenumber="1710"><td class="num" id="LN1710">1710</td><td class="line">	<span class='keyword'>struct</span> index_state *istate;</td></tr>
<tr class="codeline" data-linenumber="1711"><td class="num" id="LN1711">1711</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *base_dir;</td></tr>
<tr class="codeline" data-linenumber="1712"><td class="num" id="LN1712">1712</td><td class="line">	<span class='keyword'>int</span> base_dir_len;</td></tr>
<tr class="codeline" data-linenumber="1713"><td class="num" id="LN1713">1713</td><td class="line">	<span class='keyword'>struct</span> delayed_checkout *delayed_checkout;</td></tr>
<tr class="codeline" data-linenumber="1714"><td class="num" id="LN1714">1714</td><td class="line">	<span class='keyword'>struct</span> checkout_metadata meta;</td></tr>
<tr class="codeline" data-linenumber="1715"><td class="num" id="LN1715">1715</td><td class="line">	<span class='keyword'>unsigned</span> force:1,</td></tr>
<tr class="codeline" data-linenumber="1716"><td class="num" id="LN1716">1716</td><td class="line">		 quiet:1,</td></tr>
<tr class="codeline" data-linenumber="1717"><td class="num" id="LN1717">1717</td><td class="line">		 not_new:1,</td></tr>
<tr class="codeline" data-linenumber="1718"><td class="num" id="LN1718">1718</td><td class="line">		 clone:1,</td></tr>
<tr class="codeline" data-linenumber="1719"><td class="num" id="LN1719">1719</td><td class="line">		 refresh_cache:1;</td></tr>
<tr class="codeline" data-linenumber="1720"><td class="num" id="LN1720">1720</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1721"><td class="num" id="LN1721">1721</td><td class="line"><span class='directive'>#define <span class='macro'>CHECKOUT_INIT<span class='macro_popup'>{ ((void*)0), "" }</span></span> { <span class='macro'>NULL<span class='macro_popup'>((void*)0)</span></span>, "" }</span></td></tr>
<tr class="codeline" data-linenumber="1722"><td class="num" id="LN1722">1722</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1723"><td class="num" id="LN1723">1723</td><td class="line"><span class='directive'>#define <span class='macro'>TEMPORARY_FILENAME_LENGTH<span class='macro_popup'>25</span></span> 25</span></td></tr>
<tr class="codeline" data-linenumber="1724"><td class="num" id="LN1724">1724</td><td class="line"><span class='keyword'>int</span> checkout_entry(<span class='keyword'>struct</span> cache_entry *ce, <span class='keyword'>const</span> <span class='keyword'>struct</span> checkout *state, <span class='keyword'>char</span> *topath, <span class='keyword'>int</span> *nr_checkouts);</td></tr>
<tr class="codeline" data-linenumber="1725"><td class="num" id="LN1725">1725</td><td class="line"><span class='keyword'>void</span> enable_delayed_checkout(<span class='keyword'>struct</span> checkout *state);</td></tr>
<tr class="codeline" data-linenumber="1726"><td class="num" id="LN1726">1726</td><td class="line"><span class='keyword'>int</span> finish_delayed_checkout(<span class='keyword'>struct</span> checkout *state, <span class='keyword'>int</span> *nr_checkouts);</td></tr>
<tr class="codeline" data-linenumber="1727"><td class="num" id="LN1727">1727</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1728"><td class="num" id="LN1728">1728</td><td class="line"> <span class='comment'>* Unlink the last component and schedule the leading directories for</span></td></tr>
<tr class="codeline" data-linenumber="1729"><td class="num" id="LN1729">1729</td><td class="line"> <span class='comment'>* removal, such that empty directories get removed.</span></td></tr>
<tr class="codeline" data-linenumber="1730"><td class="num" id="LN1730">1730</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1731"><td class="num" id="LN1731">1731</td><td class="line"><span class='keyword'>void</span> unlink_entry(<span class='keyword'>const</span> <span class='keyword'>struct</span> cache_entry *ce);</td></tr>
<tr class="codeline" data-linenumber="1732"><td class="num" id="LN1732">1732</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1733"><td class="num" id="LN1733">1733</td><td class="line"><span class='keyword'>struct</span> cache_def {</td></tr>
<tr class="codeline" data-linenumber="1734"><td class="num" id="LN1734">1734</td><td class="line">	<span class='keyword'>struct</span> strbuf path;</td></tr>
<tr class="codeline" data-linenumber="1735"><td class="num" id="LN1735">1735</td><td class="line">	<span class='keyword'>int</span> flags;</td></tr>
<tr class="codeline" data-linenumber="1736"><td class="num" id="LN1736">1736</td><td class="line">	<span class='keyword'>int</span> track_flags;</td></tr>
<tr class="codeline" data-linenumber="1737"><td class="num" id="LN1737">1737</td><td class="line">	<span class='keyword'>int</span> prefix_len_stat_func;</td></tr>
<tr class="codeline" data-linenumber="1738"><td class="num" id="LN1738">1738</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1739"><td class="num" id="LN1739">1739</td><td class="line"><span class='directive'>#define <span class='macro'>CACHE_DEF_INIT<span class='macro_popup'>{ { .alloc = 0, .len = 0, .buf = strbuf_slopbuf }, 0, 0, 0 }</span></span> { <span class='macro'>STRBUF_INIT<span class='macro_popup'>{ .alloc = 0, .len = 0, .buf = strbuf_slopbuf }</span></span>, 0, 0, 0 }</span></td></tr>
<tr class="codeline" data-linenumber="1740"><td class="num" id="LN1740">1740</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>void</span> cache_def_clear(<span class='keyword'>struct</span> cache_def *cache)</td></tr>
<tr class="codeline" data-linenumber="1741"><td class="num" id="LN1741">1741</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1742"><td class="num" id="LN1742">1742</td><td class="line">	strbuf_release(&amp;cache-&gt;path);</td></tr>
<tr class="codeline" data-linenumber="1743"><td class="num" id="LN1743">1743</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1744"><td class="num" id="LN1744">1744</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1745"><td class="num" id="LN1745">1745</td><td class="line"><span class='keyword'>int</span> has_symlink_leading_path(<span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>int</span> len);</td></tr>
<tr class="codeline" data-linenumber="1746"><td class="num" id="LN1746">1746</td><td class="line"><span class='keyword'>int</span> threaded_has_symlink_leading_path(<span class='keyword'>struct</span> cache_def *, <span class='keyword'>const</span> <span class='keyword'>char</span> *, <span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="1747"><td class="num" id="LN1747">1747</td><td class="line"><span class='keyword'>int</span> check_leading_path(<span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>int</span> len);</td></tr>
<tr class="codeline" data-linenumber="1748"><td class="num" id="LN1748">1748</td><td class="line"><span class='keyword'>int</span> has_dirs_only_path(<span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>int</span> len, <span class='keyword'>int</span> prefix_len);</td></tr>
<tr class="codeline" data-linenumber="1749"><td class="num" id="LN1749">1749</td><td class="line"><span class='keyword'>void</span> schedule_dir_for_removal(<span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>int</span> len);</td></tr>
<tr class="codeline" data-linenumber="1750"><td class="num" id="LN1750">1750</td><td class="line"><span class='keyword'>void</span> remove_scheduled_dirs(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1751"><td class="num" id="LN1751">1751</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1752"><td class="num" id="LN1752">1752</td><td class="line"><span class='keyword'>struct</span> pack_window {</td></tr>
<tr class="codeline" data-linenumber="1753"><td class="num" id="LN1753">1753</td><td class="line">	<span class='keyword'>struct</span> pack_window *next;</td></tr>
<tr class="codeline" data-linenumber="1754"><td class="num" id="LN1754">1754</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>char</span> *base;</td></tr>
<tr class="codeline" data-linenumber="1755"><td class="num" id="LN1755">1755</td><td class="line">	off_t offset;</td></tr>
<tr class="codeline" data-linenumber="1756"><td class="num" id="LN1756">1756</td><td class="line">	size_t len;</td></tr>
<tr class="codeline" data-linenumber="1757"><td class="num" id="LN1757">1757</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> last_used;</td></tr>
<tr class="codeline" data-linenumber="1758"><td class="num" id="LN1758">1758</td><td class="line">	<span class='keyword'>unsigned</span> <span class='keyword'>int</span> inuse_cnt;</td></tr>
<tr class="codeline" data-linenumber="1759"><td class="num" id="LN1759">1759</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1760"><td class="num" id="LN1760">1760</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1761"><td class="num" id="LN1761">1761</td><td class="line"><span class='keyword'>struct</span> pack_entry {</td></tr>
<tr class="codeline" data-linenumber="1762"><td class="num" id="LN1762">1762</td><td class="line">	off_t offset;</td></tr>
<tr class="codeline" data-linenumber="1763"><td class="num" id="LN1763">1763</td><td class="line">	<span class='keyword'>struct</span> packed_git *p;</td></tr>
<tr class="codeline" data-linenumber="1764"><td class="num" id="LN1764">1764</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1765"><td class="num" id="LN1765">1765</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1766"><td class="num" id="LN1766">1766</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1767"><td class="num" id="LN1767">1767</td><td class="line"> <span class='comment'>* Create a temporary file rooted in the object database directory, or</span></td></tr>
<tr class="codeline" data-linenumber="1768"><td class="num" id="LN1768">1768</td><td class="line"> <span class='comment'>* die on failure. The filename is taken from "pattern", which should have the</span></td></tr>
<tr class="codeline" data-linenumber="1769"><td class="num" id="LN1769">1769</td><td class="line"> <span class='comment'>* usual "XXXXXX" trailer, and the resulting filename is written into the</span></td></tr>
<tr class="codeline" data-linenumber="1770"><td class="num" id="LN1770">1770</td><td class="line"> <span class='comment'>* "template" buffer. Returns the open descriptor.</span></td></tr>
<tr class="codeline" data-linenumber="1771"><td class="num" id="LN1771">1771</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1772"><td class="num" id="LN1772">1772</td><td class="line"><span class='keyword'>int</span> odb_mkstemp(<span class='keyword'>struct</span> strbuf *temp_filename, <span class='keyword'>const</span> <span class='keyword'>char</span> *pattern);</td></tr>
<tr class="codeline" data-linenumber="1773"><td class="num" id="LN1773">1773</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1774"><td class="num" id="LN1774">1774</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1775"><td class="num" id="LN1775">1775</td><td class="line"> <span class='comment'>* Create a pack .keep file named "name" (which should generally be the output</span></td></tr>
<tr class="codeline" data-linenumber="1776"><td class="num" id="LN1776">1776</td><td class="line"> <span class='comment'>* of odb_pack_name). Returns a file descriptor opened for writing, or -1 on</span></td></tr>
<tr class="codeline" data-linenumber="1777"><td class="num" id="LN1777">1777</td><td class="line"> <span class='comment'>* error.</span></td></tr>
<tr class="codeline" data-linenumber="1778"><td class="num" id="LN1778">1778</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1779"><td class="num" id="LN1779">1779</td><td class="line"><span class='keyword'>int</span> odb_pack_keep(<span class='keyword'>const</span> <span class='keyword'>char</span> *name);</td></tr>
<tr class="codeline" data-linenumber="1780"><td class="num" id="LN1780">1780</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1781"><td class="num" id="LN1781">1781</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1782"><td class="num" id="LN1782">1782</td><td class="line"> <span class='comment'>* Set this to 0 to prevent oid_object_info_extended() from fetching missing</span></td></tr>
<tr class="codeline" data-linenumber="1783"><td class="num" id="LN1783">1783</td><td class="line"> <span class='comment'>* blobs. This has a difference only if extensions.partialClone is set.</span></td></tr>
<tr class="codeline" data-linenumber="1784"><td class="num" id="LN1784">1784</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1785"><td class="num" id="LN1785">1785</td><td class="line"> <span class='comment'>* Its default value is 1.</span></td></tr>
<tr class="codeline" data-linenumber="1786"><td class="num" id="LN1786">1786</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1787"><td class="num" id="LN1787">1787</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> fetch_if_missing;</td></tr>
<tr class="codeline" data-linenumber="1788"><td class="num" id="LN1788">1788</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1789"><td class="num" id="LN1789">1789</td><td class="line"><span class='comment'>/* Dumb servers support */</span></td></tr>
<tr class="codeline" data-linenumber="1790"><td class="num" id="LN1790">1790</td><td class="line"><span class='keyword'>int</span> update_server_info(<span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="1791"><td class="num" id="LN1791">1791</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1792"><td class="num" id="LN1792">1792</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *get_log_output_encoding(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1793"><td class="num" id="LN1793">1793</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *get_commit_output_encoding(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1794"><td class="num" id="LN1794">1794</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1795"><td class="num" id="LN1795">1795</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1796"><td class="num" id="LN1796">1796</td><td class="line"> <span class='comment'>* This is a hack for test programs like test-dump-untracked-cache to</span></td></tr>
<tr class="codeline" data-linenumber="1797"><td class="num" id="LN1797">1797</td><td class="line"> <span class='comment'>* ensure that they do not modify the untracked cache when reading it.</span></td></tr>
<tr class="codeline" data-linenumber="1798"><td class="num" id="LN1798">1798</td><td class="line"> <span class='comment'>* Do not use it otherwise!</span></td></tr>
<tr class="codeline" data-linenumber="1799"><td class="num" id="LN1799">1799</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1800"><td class="num" id="LN1800">1800</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> ignore_untracked_cache_config;</td></tr>
<tr class="codeline" data-linenumber="1801"><td class="num" id="LN1801">1801</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1802"><td class="num" id="LN1802">1802</td><td class="line"><span class='keyword'>int</span> committer_ident_sufficiently_given(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1803"><td class="num" id="LN1803">1803</td><td class="line"><span class='keyword'>int</span> author_ident_sufficiently_given(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1804"><td class="num" id="LN1804">1804</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1805"><td class="num" id="LN1805">1805</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> *git_commit_encoding;</td></tr>
<tr class="codeline" data-linenumber="1806"><td class="num" id="LN1806">1806</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> *git_log_output_encoding;</td></tr>
<tr class="codeline" data-linenumber="1807"><td class="num" id="LN1807">1807</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> *git_mailmap_file;</td></tr>
<tr class="codeline" data-linenumber="1808"><td class="num" id="LN1808">1808</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> *git_mailmap_blob;</td></tr>
<tr class="codeline" data-linenumber="1809"><td class="num" id="LN1809">1809</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1810"><td class="num" id="LN1810">1810</td><td class="line"><span class='comment'>/* IO helper functions */</span></td></tr>
<tr class="codeline" data-linenumber="1811"><td class="num" id="LN1811">1811</td><td class="line"><span class='keyword'>void</span> maybe_flush_or_die(FILE *, <span class='keyword'>const</span> <span class='keyword'>char</span> *);</td></tr>
<tr class="codeline" data-linenumber="1812"><td class="num" id="LN1812">1812</td><td class="line"><span class='keyword'>__attribute__</span>((format (printf, 2, 3)))</td></tr>
<tr class="codeline" data-linenumber="1813"><td class="num" id="LN1813">1813</td><td class="line"><span class='keyword'>void</span> fprintf_or_die(FILE *, <span class='keyword'>const</span> <span class='keyword'>char</span> *fmt, ...);</td></tr>
<tr class="codeline" data-linenumber="1814"><td class="num" id="LN1814">1814</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1815"><td class="num" id="LN1815">1815</td><td class="line"><span class='directive'>#define <span class='macro'>COPY_READ_ERROR<span class='macro_popup'>(-2)</span></span> (-2)</span></td></tr>
<tr class="codeline" data-linenumber="1816"><td class="num" id="LN1816">1816</td><td class="line"><span class='directive'>#define <span class='macro'>COPY_WRITE_ERROR<span class='macro_popup'>(-3)</span></span> (-3)</span></td></tr>
<tr class="codeline" data-linenumber="1817"><td class="num" id="LN1817">1817</td><td class="line"><span class='keyword'>int</span> copy_fd(<span class='keyword'>int</span> ifd, <span class='keyword'>int</span> ofd);</td></tr>
<tr class="codeline" data-linenumber="1818"><td class="num" id="LN1818">1818</td><td class="line"><span class='keyword'>int</span> copy_file(<span class='keyword'>const</span> <span class='keyword'>char</span> *dst, <span class='keyword'>const</span> <span class='keyword'>char</span> *src, <span class='keyword'>int</span> mode);</td></tr>
<tr class="codeline" data-linenumber="1819"><td class="num" id="LN1819">1819</td><td class="line"><span class='keyword'>int</span> copy_file_with_time(<span class='keyword'>const</span> <span class='keyword'>char</span> *dst, <span class='keyword'>const</span> <span class='keyword'>char</span> *src, <span class='keyword'>int</span> mode);</td></tr>
<tr class="codeline" data-linenumber="1820"><td class="num" id="LN1820">1820</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1821"><td class="num" id="LN1821">1821</td><td class="line"><span class='keyword'>void</span> write_or_die(<span class='keyword'>int</span> fd, <span class='keyword'>const</span> <span class='keyword'>void</span> *buf, size_t count);</td></tr>
<tr class="codeline" data-linenumber="1822"><td class="num" id="LN1822">1822</td><td class="line"><span class='keyword'>void</span> fsync_or_die(<span class='keyword'>int</span> fd, <span class='keyword'>const</span> <span class='keyword'>char</span> *);</td></tr>
<tr class="codeline" data-linenumber="1823"><td class="num" id="LN1823">1823</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1824"><td class="num" id="LN1824">1824</td><td class="line">ssize_t read_in_full(<span class='keyword'>int</span> fd, <span class='keyword'>void</span> *buf, size_t count);</td></tr>
<tr class="codeline" data-linenumber="1825"><td class="num" id="LN1825">1825</td><td class="line">ssize_t write_in_full(<span class='keyword'>int</span> fd, <span class='keyword'>const</span> <span class='keyword'>void</span> *buf, size_t count);</td></tr>
<tr class="codeline" data-linenumber="1826"><td class="num" id="LN1826">1826</td><td class="line">ssize_t pread_in_full(<span class='keyword'>int</span> fd, <span class='keyword'>void</span> *buf, size_t count, off_t offset);</td></tr>
<tr class="codeline" data-linenumber="1827"><td class="num" id="LN1827">1827</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1828"><td class="num" id="LN1828">1828</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> ssize_t write_str_in_full(<span class='keyword'>int</span> fd, <span class='keyword'>const</span> <span class='keyword'>char</span> *str)</td></tr>
<tr class="codeline" data-linenumber="1829"><td class="num" id="LN1829">1829</td><td class="line">{</td></tr>
<tr class="codeline" data-linenumber="1830"><td class="num" id="LN1830">1830</td><td class="line">	<span class='keyword'>return</span> write_in_full(fd, str, strlen(str));</td></tr>
<tr class="codeline" data-linenumber="1831"><td class="num" id="LN1831">1831</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1832"><td class="num" id="LN1832">1832</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1833"><td class="num" id="LN1833">1833</td><td class="line"><span class='comment'>/**</span></td></tr>
<tr class="codeline" data-linenumber="1834"><td class="num" id="LN1834">1834</td><td class="line"> <span class='comment'>* Open (and truncate) the file at path, write the contents of buf to it,</span></td></tr>
<tr class="codeline" data-linenumber="1835"><td class="num" id="LN1835">1835</td><td class="line"> <span class='comment'>* and close it. Dies if any errors are encountered.</span></td></tr>
<tr class="codeline" data-linenumber="1836"><td class="num" id="LN1836">1836</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1837"><td class="num" id="LN1837">1837</td><td class="line"><span class='keyword'>void</span> write_file_buf(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>const</span> <span class='keyword'>char</span> *buf, size_t len);</td></tr>
<tr class="codeline" data-linenumber="1838"><td class="num" id="LN1838">1838</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1839"><td class="num" id="LN1839">1839</td><td class="line"><span class='comment'>/**</span></td></tr>
<tr class="codeline" data-linenumber="1840"><td class="num" id="LN1840">1840</td><td class="line"> <span class='comment'>* Like write_file_buf(), but format the contents into a buffer first.</span></td></tr>
<tr class="codeline" data-linenumber="1841"><td class="num" id="LN1841">1841</td><td class="line"> <span class='comment'>* Additionally, write_file() will append a newline if one is not already</span></td></tr>
<tr class="codeline" data-linenumber="1842"><td class="num" id="LN1842">1842</td><td class="line"> <span class='comment'>* present, making it convenient to write text files:</span></td></tr>
<tr class="codeline" data-linenumber="1843"><td class="num" id="LN1843">1843</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1844"><td class="num" id="LN1844">1844</td><td class="line"> <span class='comment'>*   write_file(path, "counter: %d", ctr);</span></td></tr>
<tr class="codeline" data-linenumber="1845"><td class="num" id="LN1845">1845</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1846"><td class="num" id="LN1846">1846</td><td class="line"><span class='keyword'>__attribute__</span>((format (printf, 2, 3)))</td></tr>
<tr class="codeline" data-linenumber="1847"><td class="num" id="LN1847">1847</td><td class="line"><span class='keyword'>void</span> write_file(<span class='keyword'>const</span> <span class='keyword'>char</span> *path, <span class='keyword'>const</span> <span class='keyword'>char</span> *fmt, ...);</td></tr>
<tr class="codeline" data-linenumber="1848"><td class="num" id="LN1848">1848</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1849"><td class="num" id="LN1849">1849</td><td class="line"><span class='comment'>/* pager.c */</span></td></tr>
<tr class="codeline" data-linenumber="1850"><td class="num" id="LN1850">1850</td><td class="line"><span class='keyword'>void</span> setup_pager(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1851"><td class="num" id="LN1851">1851</td><td class="line"><span class='keyword'>int</span> pager_in_use(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1852"><td class="num" id="LN1852">1852</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> pager_use_color;</td></tr>
<tr class="codeline" data-linenumber="1853"><td class="num" id="LN1853">1853</td><td class="line"><span class='keyword'>int</span> term_columns(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1854"><td class="num" id="LN1854">1854</td><td class="line"><span class='keyword'>void</span> term_clear_line(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1855"><td class="num" id="LN1855">1855</td><td class="line"><span class='keyword'>int</span> decimal_width(uintmax_t);</td></tr>
<tr class="codeline" data-linenumber="1856"><td class="num" id="LN1856">1856</td><td class="line"><span class='keyword'>int</span> check_pager_config(<span class='keyword'>const</span> <span class='keyword'>char</span> *cmd);</td></tr>
<tr class="codeline" data-linenumber="1857"><td class="num" id="LN1857">1857</td><td class="line"><span class='keyword'>void</span> prepare_pager_args(<span class='keyword'>struct</span> child_process *, <span class='keyword'>const</span> <span class='keyword'>char</span> *pager);</td></tr>
<tr class="codeline" data-linenumber="1858"><td class="num" id="LN1858">1858</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1859"><td class="num" id="LN1859">1859</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> *editor_program;</td></tr>
<tr class="codeline" data-linenumber="1860"><td class="num" id="LN1860">1860</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> *askpass_program;</td></tr>
<tr class="codeline" data-linenumber="1861"><td class="num" id="LN1861">1861</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>const</span> <span class='keyword'>char</span> *excludes_file;</td></tr>
<tr class="codeline" data-linenumber="1862"><td class="num" id="LN1862">1862</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1863"><td class="num" id="LN1863">1863</td><td class="line"><span class='comment'>/* base85 */</span></td></tr>
<tr class="codeline" data-linenumber="1864"><td class="num" id="LN1864">1864</td><td class="line"><span class='keyword'>int</span> decode_85(<span class='keyword'>char</span> *dst, <span class='keyword'>const</span> <span class='keyword'>char</span> *line, <span class='keyword'>int</span> linelen);</td></tr>
<tr class="codeline" data-linenumber="1865"><td class="num" id="LN1865">1865</td><td class="line"><span class='keyword'>void</span> encode_85(<span class='keyword'>char</span> *buf, <span class='keyword'>const</span> <span class='keyword'>unsigned</span> <span class='keyword'>char</span> *data, <span class='keyword'>int</span> bytes);</td></tr>
<tr class="codeline" data-linenumber="1866"><td class="num" id="LN1866">1866</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1867"><td class="num" id="LN1867">1867</td><td class="line"><span class='comment'>/* pkt-line.c */</span></td></tr>
<tr class="codeline" data-linenumber="1868"><td class="num" id="LN1868">1868</td><td class="line"><span class='keyword'>void</span> packet_trace_identity(<span class='keyword'>const</span> <span class='keyword'>char</span> *prog);</td></tr>
<tr class="codeline" data-linenumber="1869"><td class="num" id="LN1869">1869</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1870"><td class="num" id="LN1870">1870</td><td class="line"><span class='comment'>/* add */</span></td></tr>
<tr class="codeline" data-linenumber="1871"><td class="num" id="LN1871">1871</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1872"><td class="num" id="LN1872">1872</td><td class="line"> <span class='comment'>* return 0 if success, 1 - if addition of a file failed and</span></td></tr>
<tr class="codeline" data-linenumber="1873"><td class="num" id="LN1873">1873</td><td class="line"> <span class='comment'>* ADD_FILES_IGNORE_ERRORS was specified in flags</span></td></tr>
<tr class="codeline" data-linenumber="1874"><td class="num" id="LN1874">1874</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1875"><td class="num" id="LN1875">1875</td><td class="line"><span class='keyword'>int</span> add_files_to_cache(<span class='keyword'>const</span> <span class='keyword'>char</span> *prefix, <span class='keyword'>const</span> <span class='keyword'>struct</span> pathspec *pathspec, <span class='keyword'>int</span> flags);</td></tr>
<tr class="codeline" data-linenumber="1876"><td class="num" id="LN1876">1876</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1877"><td class="num" id="LN1877">1877</td><td class="line"><span class='comment'>/* diff.c */</span></td></tr>
<tr class="codeline" data-linenumber="1878"><td class="num" id="LN1878">1878</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>int</span> diff_auto_refresh_index;</td></tr>
<tr class="codeline" data-linenumber="1879"><td class="num" id="LN1879">1879</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1880"><td class="num" id="LN1880">1880</td><td class="line"><span class='comment'>/* match-trees.c */</span></td></tr>
<tr class="codeline" data-linenumber="1881"><td class="num" id="LN1881">1881</td><td class="line"><span class='keyword'>void</span> shift_tree(<span class='keyword'>struct</span> repository *, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *, <span class='keyword'>struct</span> object_id *, <span class='keyword'>int</span>);</td></tr>
<tr class="codeline" data-linenumber="1882"><td class="num" id="LN1882">1882</td><td class="line"><span class='keyword'>void</span> shift_tree_by(<span class='keyword'>struct</span> repository *, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *, <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *, <span class='keyword'>struct</span> object_id *, <span class='keyword'>const</span> <span class='keyword'>char</span> *);</td></tr>
<tr class="codeline" data-linenumber="1883"><td class="num" id="LN1883">1883</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1884"><td class="num" id="LN1884">1884</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1885"><td class="num" id="LN1885">1885</td><td class="line"> <span class='comment'>* whitespace rules.</span></td></tr>
<tr class="codeline" data-linenumber="1886"><td class="num" id="LN1886">1886</td><td class="line"> <span class='comment'>* used by both diff and apply</span></td></tr>
<tr class="codeline" data-linenumber="1887"><td class="num" id="LN1887">1887</td><td class="line"> <span class='comment'>* last two digits are tab width</span></td></tr>
<tr class="codeline" data-linenumber="1888"><td class="num" id="LN1888">1888</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1889"><td class="num" id="LN1889">1889</td><td class="line"><span class='directive'>#define <span class='macro'>WS_BLANK_AT_EOL<span class='macro_popup'>0100</span></span>         0100</span></td></tr>
<tr class="codeline" data-linenumber="1890"><td class="num" id="LN1890">1890</td><td class="line"><span class='directive'>#define <span class='macro'>WS_SPACE_BEFORE_TAB<span class='macro_popup'>0200</span></span>     0200</span></td></tr>
<tr class="codeline" data-linenumber="1891"><td class="num" id="LN1891">1891</td><td class="line"><span class='directive'>#define <span class='macro'>WS_INDENT_WITH_NON_TAB<span class='macro_popup'>0400</span></span>  0400</span></td></tr>
<tr class="codeline" data-linenumber="1892"><td class="num" id="LN1892">1892</td><td class="line"><span class='directive'>#define <span class='macro'>WS_CR_AT_EOL<span class='macro_popup'>01000</span></span>           01000</span></td></tr>
<tr class="codeline" data-linenumber="1893"><td class="num" id="LN1893">1893</td><td class="line"><span class='directive'>#define <span class='macro'>WS_BLANK_AT_EOF<span class='macro_popup'>02000</span></span>        02000</span></td></tr>
<tr class="codeline" data-linenumber="1894"><td class="num" id="LN1894">1894</td><td class="line"><span class='directive'>#define <span class='macro'>WS_TAB_IN_INDENT<span class='macro_popup'>04000</span></span>       04000</span></td></tr>
<tr class="codeline" data-linenumber="1895"><td class="num" id="LN1895">1895</td><td class="line"><span class='directive'>#define <span class='macro'>WS_TRAILING_SPACE<span class='macro_popup'>(0100|02000)</span></span>      (<span class='macro'>WS_BLANK_AT_EOL<span class='macro_popup'>0100</span></span>|<span class='macro'>WS_BLANK_AT_EOF<span class='macro_popup'>02000</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="1896"><td class="num" id="LN1896">1896</td><td class="line"><span class='directive'>#define <span class='macro'>WS_DEFAULT_RULE<span class='macro_popup'>((0100|02000)|0200|8)</span></span> (<span class='macro'>WS_TRAILING_SPACE<span class='macro_popup'>(0100|02000)</span></span>|<span class='macro'>WS_SPACE_BEFORE_TAB<span class='macro_popup'>0200</span></span>|8)</span></td></tr>
<tr class="codeline" data-linenumber="1897"><td class="num" id="LN1897">1897</td><td class="line"><span class='directive'>#define <span class='macro'>WS_TAB_WIDTH_MASK<span class='macro_popup'>077</span></span>        077</span></td></tr>
<tr class="codeline" data-linenumber="1898"><td class="num" id="LN1898">1898</td><td class="line"><span class='comment'>/* All WS_* -- when extended, adapt diff.c emit_symbol */</span></td></tr>
<tr class="codeline" data-linenumber="1899"><td class="num" id="LN1899">1899</td><td class="line"><span class='directive'>#define <span class='macro'>WS_RULE_MASK<span class='macro_popup'>07777</span></span>           07777</span></td></tr>
<tr class="codeline" data-linenumber="1900"><td class="num" id="LN1900">1900</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>unsigned</span> whitespace_rule_cfg;</td></tr>
<tr class="codeline" data-linenumber="1901"><td class="num" id="LN1901">1901</td><td class="line"><span class='keyword'>unsigned</span> whitespace_rule(<span class='keyword'>struct</span> index_state *, <span class='keyword'>const</span> <span class='keyword'>char</span> *);</td></tr>
<tr class="codeline" data-linenumber="1902"><td class="num" id="LN1902">1902</td><td class="line"><span class='keyword'>unsigned</span> parse_whitespace_rule(<span class='keyword'>const</span> <span class='keyword'>char</span> *);</td></tr>
<tr class="codeline" data-linenumber="1903"><td class="num" id="LN1903">1903</td><td class="line"><span class='keyword'>unsigned</span> ws_check(<span class='keyword'>const</span> <span class='keyword'>char</span> *line, <span class='keyword'>int</span> len, <span class='keyword'>unsigned</span> ws_rule);</td></tr>
<tr class="codeline" data-linenumber="1904"><td class="num" id="LN1904">1904</td><td class="line"><span class='keyword'>void</span> ws_check_emit(<span class='keyword'>const</span> <span class='keyword'>char</span> *line, <span class='keyword'>int</span> len, <span class='keyword'>unsigned</span> ws_rule, FILE *stream, <span class='keyword'>const</span> <span class='keyword'>char</span> *set, <span class='keyword'>const</span> <span class='keyword'>char</span> *reset, <span class='keyword'>const</span> <span class='keyword'>char</span> *ws);</td></tr>
<tr class="codeline" data-linenumber="1905"><td class="num" id="LN1905">1905</td><td class="line"><span class='keyword'>char</span> *whitespace_error_string(<span class='keyword'>unsigned</span> ws);</td></tr>
<tr class="codeline" data-linenumber="1906"><td class="num" id="LN1906">1906</td><td class="line"><span class='keyword'>void</span> ws_fix_copy(<span class='keyword'>struct</span> strbuf *, <span class='keyword'>const</span> <span class='keyword'>char</span> *, <span class='keyword'>int</span>, <span class='keyword'>unsigned</span>, <span class='keyword'>int</span> *);</td></tr>
<tr class="codeline" data-linenumber="1907"><td class="num" id="LN1907">1907</td><td class="line"><span class='keyword'>int</span> ws_blank_line(<span class='keyword'>const</span> <span class='keyword'>char</span> *line, <span class='keyword'>int</span> len, <span class='keyword'>unsigned</span> ws_rule);</td></tr>
<tr class="codeline" data-linenumber="1908"><td class="num" id="LN1908">1908</td><td class="line"><span class='directive'>#define <span class='macro'>ws_tab_width(rule)<span class='macro_popup'>((rule) &amp; 077)</span></span>     ((rule) &amp; <span class='macro'>WS_TAB_WIDTH_MASK<span class='macro_popup'>077</span></span>)</span></td></tr>
<tr class="codeline" data-linenumber="1909"><td class="num" id="LN1909">1909</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1910"><td class="num" id="LN1910">1910</td><td class="line"><span class='comment'>/* ls-files */</span></td></tr>
<tr class="codeline" data-linenumber="1911"><td class="num" id="LN1911">1911</td><td class="line"><span class='keyword'>void</span> overlay_tree_on_index(<span class='keyword'>struct</span> index_state *istate,</td></tr>
<tr class="codeline" data-linenumber="1912"><td class="num" id="LN1912">1912</td><td class="line">			   <span class='keyword'>const</span> <span class='keyword'>char</span> *tree_name, <span class='keyword'>const</span> <span class='keyword'>char</span> *prefix);</td></tr>
<tr class="codeline" data-linenumber="1913"><td class="num" id="LN1913">1913</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1914"><td class="num" id="LN1914">1914</td><td class="line"><span class='comment'>/* setup.c */</span></td></tr>
<tr class="codeline" data-linenumber="1915"><td class="num" id="LN1915">1915</td><td class="line"><span class='keyword'>struct</span> startup_info {</td></tr>
<tr class="codeline" data-linenumber="1916"><td class="num" id="LN1916">1916</td><td class="line">	<span class='keyword'>int</span> have_repository;</td></tr>
<tr class="codeline" data-linenumber="1917"><td class="num" id="LN1917">1917</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *prefix;</td></tr>
<tr class="codeline" data-linenumber="1918"><td class="num" id="LN1918">1918</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1919"><td class="num" id="LN1919">1919</td><td class="line"><span class='keyword'>extern</span> <span class='keyword'>struct</span> startup_info *startup_info;</td></tr>
<tr class="codeline" data-linenumber="1920"><td class="num" id="LN1920">1920</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1921"><td class="num" id="LN1921">1921</td><td class="line"><span class='comment'>/* merge.c */</span></td></tr>
<tr class="codeline" data-linenumber="1922"><td class="num" id="LN1922">1922</td><td class="line"><span class='keyword'>struct</span> commit_list;</td></tr>
<tr class="codeline" data-linenumber="1923"><td class="num" id="LN1923">1923</td><td class="line"><span class='keyword'>int</span> try_merge_command(<span class='keyword'>struct</span> repository *r,</td></tr>
<tr class="codeline" data-linenumber="1924"><td class="num" id="LN1924">1924</td><td class="line">		<span class='keyword'>const</span> <span class='keyword'>char</span> *strategy, size_t xopts_nr,</td></tr>
<tr class="codeline" data-linenumber="1925"><td class="num" id="LN1925">1925</td><td class="line">		<span class='keyword'>const</span> <span class='keyword'>char</span> **xopts, <span class='keyword'>struct</span> commit_list *common,</td></tr>
<tr class="codeline" data-linenumber="1926"><td class="num" id="LN1926">1926</td><td class="line">		<span class='keyword'>const</span> <span class='keyword'>char</span> *head_arg, <span class='keyword'>struct</span> commit_list *remotes);</td></tr>
<tr class="codeline" data-linenumber="1927"><td class="num" id="LN1927">1927</td><td class="line"><span class='keyword'>int</span> checkout_fast_forward(<span class='keyword'>struct</span> repository *r,</td></tr>
<tr class="codeline" data-linenumber="1928"><td class="num" id="LN1928">1928</td><td class="line">			  <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *from,</td></tr>
<tr class="codeline" data-linenumber="1929"><td class="num" id="LN1929">1929</td><td class="line">			  <span class='keyword'>const</span> <span class='keyword'>struct</span> object_id *to,</td></tr>
<tr class="codeline" data-linenumber="1930"><td class="num" id="LN1930">1930</td><td class="line">			  <span class='keyword'>int</span> overwrite_ignore);</td></tr>
<tr class="codeline" data-linenumber="1931"><td class="num" id="LN1931">1931</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1932"><td class="num" id="LN1932">1932</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1933"><td class="num" id="LN1933">1933</td><td class="line"><span class='keyword'>int</span> sane_execvp(<span class='keyword'>const</span> <span class='keyword'>char</span> *file, <span class='keyword'>char</span> *<span class='keyword'>const</span> argv[]);</td></tr>
<tr class="codeline" data-linenumber="1934"><td class="num" id="LN1934">1934</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1935"><td class="num" id="LN1935">1935</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1936"><td class="num" id="LN1936">1936</td><td class="line"> <span class='comment'>* A struct to encapsulate the concept of whether a file has changed</span></td></tr>
<tr class="codeline" data-linenumber="1937"><td class="num" id="LN1937">1937</td><td class="line"> <span class='comment'>* since we last checked it. This uses criteria similar to those used</span></td></tr>
<tr class="codeline" data-linenumber="1938"><td class="num" id="LN1938">1938</td><td class="line"> <span class='comment'>* for the index.</span></td></tr>
<tr class="codeline" data-linenumber="1939"><td class="num" id="LN1939">1939</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1940"><td class="num" id="LN1940">1940</td><td class="line"><span class='keyword'>struct</span> stat_validity {</td></tr>
<tr class="codeline" data-linenumber="1941"><td class="num" id="LN1941">1941</td><td class="line">	<span class='keyword'>struct</span> stat_data *sd;</td></tr>
<tr class="codeline" data-linenumber="1942"><td class="num" id="LN1942">1942</td><td class="line">};</td></tr>
<tr class="codeline" data-linenumber="1943"><td class="num" id="LN1943">1943</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1944"><td class="num" id="LN1944">1944</td><td class="line"><span class='keyword'>void</span> stat_validity_clear(<span class='keyword'>struct</span> stat_validity *sv);</td></tr>
<tr class="codeline" data-linenumber="1945"><td class="num" id="LN1945">1945</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1946"><td class="num" id="LN1946">1946</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1947"><td class="num" id="LN1947">1947</td><td class="line"> <span class='comment'>* Returns 1 if the path is a regular file (or a symlink to a regular</span></td></tr>
<tr class="codeline" data-linenumber="1948"><td class="num" id="LN1948">1948</td><td class="line"> <span class='comment'>* file) and matches the saved stat_validity, 0 otherwise.  A missing</span></td></tr>
<tr class="codeline" data-linenumber="1949"><td class="num" id="LN1949">1949</td><td class="line"> <span class='comment'>* or inaccessible file is considered a match if the struct was just</span></td></tr>
<tr class="codeline" data-linenumber="1950"><td class="num" id="LN1950">1950</td><td class="line"> <span class='comment'>* initialized, or if the previous update found an inaccessible file.</span></td></tr>
<tr class="codeline" data-linenumber="1951"><td class="num" id="LN1951">1951</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1952"><td class="num" id="LN1952">1952</td><td class="line"><span class='keyword'>int</span> stat_validity_check(<span class='keyword'>struct</span> stat_validity *sv, <span class='keyword'>const</span> <span class='keyword'>char</span> *path);</td></tr>
<tr class="codeline" data-linenumber="1953"><td class="num" id="LN1953">1953</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1954"><td class="num" id="LN1954">1954</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1955"><td class="num" id="LN1955">1955</td><td class="line"> <span class='comment'>* Update the stat_validity from a file opened at descriptor fd. If</span></td></tr>
<tr class="codeline" data-linenumber="1956"><td class="num" id="LN1956">1956</td><td class="line"> <span class='comment'>* the file is missing, inaccessible, or not a regular file, then</span></td></tr>
<tr class="codeline" data-linenumber="1957"><td class="num" id="LN1957">1957</td><td class="line"> <span class='comment'>* future calls to stat_validity_check will match iff one of those</span></td></tr>
<tr class="codeline" data-linenumber="1958"><td class="num" id="LN1958">1958</td><td class="line"> <span class='comment'>* conditions continues to be true.</span></td></tr>
<tr class="codeline" data-linenumber="1959"><td class="num" id="LN1959">1959</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1960"><td class="num" id="LN1960">1960</td><td class="line"><span class='keyword'>void</span> stat_validity_update(<span class='keyword'>struct</span> stat_validity *sv, <span class='keyword'>int</span> fd);</td></tr>
<tr class="codeline" data-linenumber="1961"><td class="num" id="LN1961">1961</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1962"><td class="num" id="LN1962">1962</td><td class="line"><span class='keyword'>int</span> versioncmp(<span class='keyword'>const</span> <span class='keyword'>char</span> *s1, <span class='keyword'>const</span> <span class='keyword'>char</span> *s2);</td></tr>
<tr class="codeline" data-linenumber="1963"><td class="num" id="LN1963">1963</td><td class="line"><span class='keyword'>void</span> sleep_millisec(<span class='keyword'>int</span> millisec);</td></tr>
<tr class="codeline" data-linenumber="1964"><td class="num" id="LN1964">1964</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1965"><td class="num" id="LN1965">1965</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1966"><td class="num" id="LN1966">1966</td><td class="line"> <span class='comment'>* Create a directory and (if share is nonzero) adjust its permissions</span></td></tr>
<tr class="codeline" data-linenumber="1967"><td class="num" id="LN1967">1967</td><td class="line"> <span class='comment'>* according to the shared_repository setting. Only use this for</span></td></tr>
<tr class="codeline" data-linenumber="1968"><td class="num" id="LN1968">1968</td><td class="line"> <span class='comment'>* directories under $GIT_DIR.  Don't use it for working tree</span></td></tr>
<tr class="codeline" data-linenumber="1969"><td class="num" id="LN1969">1969</td><td class="line"> <span class='comment'>* directories.</span></td></tr>
<tr class="codeline" data-linenumber="1970"><td class="num" id="LN1970">1970</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1971"><td class="num" id="LN1971">1971</td><td class="line"><span class='keyword'>void</span> safe_create_dir(<span class='keyword'>const</span> <span class='keyword'>char</span> *dir, <span class='keyword'>int</span> share);</td></tr>
<tr class="codeline" data-linenumber="1972"><td class="num" id="LN1972">1972</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1973"><td class="num" id="LN1973">1973</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1974"><td class="num" id="LN1974">1974</td><td class="line"> <span class='comment'>* Should we print an ellipsis after an abbreviated SHA-1 value</span></td></tr>
<tr class="codeline" data-linenumber="1975"><td class="num" id="LN1975">1975</td><td class="line"> <span class='comment'>* when doing diff-raw output or indicating a detached HEAD?</span></td></tr>
<tr class="codeline" data-linenumber="1976"><td class="num" id="LN1976">1976</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1977"><td class="num" id="LN1977">1977</td><td class="line"><span class='keyword'>int</span> print_sha1_ellipsis(<span class='keyword'>void</span>);</td></tr>
<tr class="codeline" data-linenumber="1978"><td class="num" id="LN1978">1978</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1979"><td class="num" id="LN1979">1979</td><td class="line"><span class='comment'>/* Return 1 if the file is empty or does not exists, 0 otherwise. */</span></td></tr>
<tr class="codeline" data-linenumber="1980"><td class="num" id="LN1980">1980</td><td class="line"><span class='keyword'>int</span> is_empty_or_missing_file(<span class='keyword'>const</span> <span class='keyword'>char</span> *filename);</td></tr>
<tr class="codeline" data-linenumber="1981"><td class="num" id="LN1981">1981</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1982"><td class="num" id="LN1982">1982</td><td class="line"><span class='directive'>#endif /* CACHE_H */</span></td></tr>
</table></body></html>
