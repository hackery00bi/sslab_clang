<!doctype html>
<html>
<head>
<title>../deps/v8/src/base/ieee754.cc</title>

<style type="text/css">
body { color:#000000; background-color:#ffffff }
body { font-family:Helvetica, sans-serif; font-size:10pt }
h1 { font-size:14pt }
.FileName { margin-top: 5px; margin-bottom: 5px; display: inline; }
.FileNav { margin-left: 5px; margin-right: 5px; display: inline; }
.FileNav a { text-decoration:none; font-size: larger; }
.divider { margin-top: 30px; margin-bottom: 30px; height: 15px; }
.divider { background-color: gray; }
.code { border-collapse:collapse; width:100%; }
.code { font-family: "Monospace", monospace; font-size:10pt }
.code { line-height: 1.2em }
.comment { color: green; font-style: oblique }
.keyword { color: blue }
.string_literal { color: red }
.directive { color: darkmagenta }

/* Macros and variables could have pop-up notes hidden by default.
  - Macro pop-up:    expansion of the macro
  - Variable pop-up: value (table) of the variable */
.macro_popup, .variable_popup { display: none; }

/* Pop-up appears on mouse-hover event. */
.macro:hover .macro_popup, .variable:hover .variable_popup {
  display: block;
  padding: 2px;
  -webkit-border-radius:5px;
  -webkit-box-shadow:1px 1px 7px #000;
  border-radius:5px;
  box-shadow:1px 1px 7px #000;
  position: absolute;
  top: -1em;
  left:10em;
  z-index: 1
}

.macro_popup {
  border: 2px solid red;
  background-color:#FFF0F0;
  font-weight: normal;
}

.variable_popup {
  border: 2px solid blue;
  background-color:#F0F0FF;
  font-weight: bold;
  font-family: Helvetica, sans-serif;
  font-size: 9pt;
}

/* Pop-up notes needs a relative position as a base where they pops up. */
.macro, .variable {
  background-color: PaleGoldenRod;
  position: relative;
}
.macro { color: DarkMagenta; }

#tooltiphint {
  position: fixed;
  width: 50em;
  margin-left: -25em;
  left: 50%;
  padding: 10px;
  border: 1px solid #b0b0b0;
  border-radius: 2px;
  box-shadow: 1px 1px 7px black;
  background-color: #c0c0c0;
  z-index: 2;
}

.num { width:2.5em; padding-right:2ex; background-color:#eeeeee }
.num { text-align:right; font-size:8pt }
.num { color:#444444 }
.line { padding-left: 1ex; border-left: 3px solid #ccc }
.line { white-space: pre }
.msg { -webkit-box-shadow:1px 1px 7px #000 }
.msg { box-shadow:1px 1px 7px #000 }
.msg { -webkit-border-radius:5px }
.msg { border-radius:5px }
.msg { font-family:Helvetica, sans-serif; font-size:8pt }
.msg { float:left }
.msg { padding:0.25em 1ex 0.25em 1ex }
.msg { margin-top:10px; margin-bottom:10px }
.msg { font-weight:bold }
.msg { max-width:60em; word-wrap: break-word; white-space: pre-wrap }
.msgT { padding:0x; spacing:0x }
.msgEvent { background-color:#fff8b4; color:#000000 }
.msgControl { background-color:#bbbbbb; color:#000000 }
.msgNote { background-color:#ddeeff; color:#000000 }
.mrange { background-color:#dfddf3 }
.mrange { border-bottom:1px solid #6F9DBE }
.PathIndex { font-weight: bold; padding:0px 5px; margin-right:5px; }
.PathIndex { -webkit-border-radius:8px }
.PathIndex { border-radius:8px }
.PathIndexEvent { background-color:#bfba87 }
.PathIndexControl { background-color:#8c8c8c }
.PathIndexPopUp { background-color: #879abc; }
.PathNav a { text-decoration:none; font-size: larger }
.CodeInsertionHint { font-weight: bold; background-color: #10dd10 }
.CodeRemovalHint { background-color:#de1010 }
.CodeRemovalHint { border-bottom:1px solid #6F9DBE }
.selected{ background-color:orange !important; }

table.simpletable {
  padding: 5px;
  font-size:12pt;
  margin:20px;
  border-collapse: collapse; border-spacing: 0px;
}
td.rowname {
  text-align: right;
  vertical-align: top;
  font-weight: bold;
  color:#444444;
  padding-right:2ex;
}

/* Hidden text. */
input.spoilerhider + label {
  cursor: pointer;
  text-decoration: underline;
  display: block;
}
input.spoilerhider {
 display: none;
}
input.spoilerhider ~ .spoiler {
  overflow: hidden;
  margin: 10px auto 0;
  height: 0;
  opacity: 0;
}
input.spoilerhider:checked + label + .spoiler{
  height: auto;
  opacity: 1;
}
</style>
</head>
<body>
<!-- BUGDESC Assigned value is garbage or undefined -->

<!-- BUGTYPE Assigned value is garbage or undefined -->

<!-- BUGCATEGORY Logic error -->

<!-- BUGFILE /tmp/sslab_clang/cpp_node/node/out/../deps/v8/src/base/ieee754.cc -->

<!-- FILENAME ieee754.cc -->

<!-- FUNCTIONNAME __kernel_rem_pio2 -->

<!-- ISSUEHASHCONTENTOFLINEINCONTEXT 52bba43dc05df104ced172f8a36a6ba4 -->

<!-- BUGLINE 634 -->

<!-- BUGCOLUMN 14 -->

<!-- BUGPATHLENGTH 35 -->

<!-- BUGMETAEND -->
<!-- REPORTHEADER -->
<h3>Bug Summary</h3>
<table class="simpletable">
<tr><td class="rowname">File:</td><td>/tmp/sslab_clang/cpp_node/node/out/../deps/v8/src/base/ieee754.cc</td></tr>
<tr><td class="rowname">Warning:</td><td><a href="#EndPath">line 634, column 14</a><br />Assigned value is garbage or undefined</td></tr>

</table>
<!-- REPORTSUMMARYEXTRA -->
<h3>Annotated Source Code</h3>
<p>Press <a href="#" onclick="toggleHelp(); return false;">'?'</a>
   to see keyboard shortcuts</p>
<input type="checkbox" class="spoilerhider" id="showinvocation" />
<label for="showinvocation" >Show analyzer invocation</label>
<div class="spoiler">clang -cc1 -cc1 -triple x86_64-unknown-linux-gnu -analyze -disable-free -main-file-name ieee754.cc -analyzer-store=region -analyzer-opt-analyze-nested-blocks -analyzer-checker=core -analyzer-checker=apiModeling -analyzer-checker=unix -analyzer-checker=deadcode -analyzer-checker=cplusplus -analyzer-checker=security.insecureAPI.UncheckedReturn -analyzer-checker=security.insecureAPI.getpw -analyzer-checker=security.insecureAPI.gets -analyzer-checker=security.insecureAPI.mktemp -analyzer-checker=security.insecureAPI.mkstemp -analyzer-checker=security.insecureAPI.vfork -analyzer-checker=nullability.NullPassedToNonnull -analyzer-checker=nullability.NullReturnedFromNonnull -analyzer-output plist -w -setup-static-analyzer -mrelocation-model static -mframe-pointer=all -relaxed-aliasing -fmath-errno -fno-rounding-math -mconstructor-aliases -munwind-tables -target-cpu x86-64 -fno-split-dwarf-inlining -debugger-tuning=gdb -ffunction-sections -fdata-sections -resource-dir /llvm-project/build/lib/clang/12.0.0 -D V8_GYP_BUILD -D V8_TYPED_ARRAY_MAX_SIZE_IN_HEAP=64 -D __STDC_FORMAT_MACROS -D OPENSSL_NO_PINSHARED -D OPENSSL_THREADS -D V8_TARGET_ARCH_X64 -D V8_EMBEDDER_STRING="-node.17" -D ENABLE_DISASSEMBLER -D V8_PROMISE_INTERNAL_FIELD_COUNT=1 -D ENABLE_MINOR_MC -D OBJECT_PRINT -D V8_INTL_SUPPORT -D V8_CONCURRENT_MARKING -D V8_ENABLE_LAZY_SOURCE_POSITIONS -D V8_USE_SIPHASH -D DISABLE_UNTRUSTED_CODE_MITIGATIONS -D V8_WIN64_UNWINDING_INFO -D V8_ENABLE_REGEXP_INTERPRETER_THREADED_DISPATCH -D V8_SNAPSHOT_COMPRESSION -D BUILDING_V8_BASE_SHARED -I ../deps/v8 -I ../deps/v8/include -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/x86_64-linux-gnu/c++/7.5.0 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/x86_64-linux-gnu/c++/7.5.0 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/backward -internal-isystem /usr/local/include -internal-isystem /llvm-project/build/lib/clang/12.0.0/include -internal-externc-isystem /usr/include/x86_64-linux-gnu -internal-externc-isystem /include -internal-externc-isystem /usr/include -O3 -Wno-unused-parameter -Wno-return-type -std=gnu++1y -fdeprecated-macro -fdebug-compilation-dir /tmp/sslab_clang/cpp_node/node/out -ferror-limit 19 -fno-rtti -fgnuc-version=4.2.1 -vectorize-loops -vectorize-slp -analyzer-checker core -analyzer-checker cplusplus -analyzer-checker nullability -analyzer-checker optin -analyzer-checker security -analyzer-checker unix -analyzer-checker osx -analyzer-checker fuchsia -analyzer-checker webkit -analyzer-output=html -faddrsig -o /tmp/scan-build-2020-11-24-151156-25785-1 -x c++ ../deps/v8/src/base/ieee754.cc
</div>
<div id='tooltiphint' hidden="true">
  <p>Keyboard shortcuts: </p>
  <ul>
    <li>Use 'j/k' keys for keyboard navigation</li>
    <li>Use 'Shift+S' to show/hide relevant lines</li>
    <li>Use '?' to toggle this window</li>
  </ul>
  <a href="#" onclick="toggleHelp(); return false;">Close</a>
</div>
<script type='text/javascript'>
var relevant_lines = {"1": {"443": 1, "444": 1, "451": 1, "453": 1, "454": 1, "465": 1, "466": 1, "467": 1, "468": 1, "470": 1, "471": 1, "474": 1, "475": 1, "478": 1, "479": 1, "480": 1, "481": 1, "484": 1, "485": 1, "486": 1, "491": 1, "496": 1, "497": 1, "499": 1, "506": 1, "507": 1, "508": 1, "509": 1, "510": 1, "511": 1, "516": 1, "518": 1, "522": 1, "553": 1, "572": 1, "575": 1, "580": 1, "581": 1, "588": 1, "593": 1, "594": 1, "600": 1, "606": 1, "621": 1, "622": 1, "627": 1, "632": 1, "633": 1, "634": 1}};

var filterCounterexample = function (hide) {
  var tables = document.getElementsByClassName("code");
  for (var t=0; t<tables.length; t++) {
    var table = tables[t];
    var file_id = table.getAttribute("data-fileid");
    var lines_in_fid = relevant_lines[file_id];
    if (!lines_in_fid) {
      lines_in_fid = {};
    }
    var lines = table.getElementsByClassName("codeline");
    for (var i=0; i<lines.length; i++) {
        var el = lines[i];
        var lineNo = el.getAttribute("data-linenumber");
        if (!lines_in_fid[lineNo]) {
          if (hide) {
            el.setAttribute("hidden", "");
          } else {
            el.removeAttribute("hidden");
          }
        }
    }
  }
}

window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "S") {
    var checked = document.getElementsByName("showCounterexample")[0].checked;
    filterCounterexample(!checked);
    document.getElementsByName("showCounterexample")[0].checked = !checked;
  } else {
    return;
  }
  event.preventDefault();
}, true);

document.addEventListener("DOMContentLoaded", function() {
    document.querySelector('input[name="showCounterexample"]').onchange=
        function (event) {
      filterCounterexample(this.checked);
    };
});
</script>

<form>
    <input type="checkbox" name="showCounterexample" id="showCounterexample" />
    <label for="showCounterexample">
       Show only relevant lines
    </label>
</form>

<script type='text/javascript'>
var digitMatcher = new RegExp("[0-9]+");

var querySelectorAllArray = function(selector) {
  return Array.prototype.slice.call(
    document.querySelectorAll(selector));
}

document.addEventListener("DOMContentLoaded", function() {
    querySelectorAllArray(".PathNav > a").forEach(
        function(currentValue, currentIndex) {
            var hrefValue = currentValue.getAttribute("href");
            currentValue.onclick = function() {
                scrollTo(document.querySelector(hrefValue));
                return false;
            };
        });
});

var findNum = function() {
    var s = document.querySelector(".selected");
    if (!s || s.id == "EndPath") {
        return 0;
    }
    var out = parseInt(digitMatcher.exec(s.id)[0]);
    return out;
};

var scrollTo = function(el) {
    querySelectorAllArray(".selected").forEach(function(s) {
        s.classList.remove("selected");
    });
    el.classList.add("selected");
    window.scrollBy(0, el.getBoundingClientRect().top -
        (window.innerHeight / 2));
}

var move = function(num, up, numItems) {
  if (num == 1 && up || num == numItems - 1 && !up) {
    return 0;
  } else if (num == 0 && up) {
    return numItems - 1;
  } else if (num == 0 && !up) {
    return 1 % numItems;
  }
  return up ? num - 1 : num + 1;
}

var numToId = function(num) {
  if (num == 0) {
    return document.getElementById("EndPath")
  }
  return document.getElementById("Path" + num);
};

var navigateTo = function(up) {
  var numItems = document.querySelectorAll(
      ".line > .msgEvent, .line > .msgControl").length;
  var currentSelected = findNum();
  var newSelected = move(currentSelected, up, numItems);
  var newEl = numToId(newSelected, numItems);

  // Scroll element into center.
  scrollTo(newEl);
};

window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "j") {
    navigateTo(/*up=*/false);
  } else if (event.key == "k") {
    navigateTo(/*up=*/true);
  } else {
    return;
  }
  event.preventDefault();
}, true);
</script>
  
<script type='text/javascript'>

var toggleHelp = function() {
    var hint = document.querySelector("#tooltiphint");
    var attributeName = "hidden";
    if (hint.hasAttribute(attributeName)) {
      hint.removeAttribute(attributeName);
    } else {
      hint.setAttribute("hidden", "true");
    }
};
window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return;
  }
  if (event.key == "?") {
    toggleHelp();
  } else {
    return;
  }
  event.preventDefault();
});
</script>
<table class="code" data-fileid="1">
<tr class="codeline" data-linenumber="1"><td class="num" id="LN1">1</td><td class="line"><span class='comment'>// The following is adapted from fdlibm (http://www.netlib.org/fdlibm).</span></td></tr>
<tr class="codeline" data-linenumber="2"><td class="num" id="LN2">2</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="3"><td class="num" id="LN3">3</td><td class="line"><span class='comment'>// ====================================================</span></td></tr>
<tr class="codeline" data-linenumber="4"><td class="num" id="LN4">4</td><td class="line"><span class='comment'>// Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.</span></td></tr>
<tr class="codeline" data-linenumber="5"><td class="num" id="LN5">5</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="6"><td class="num" id="LN6">6</td><td class="line"><span class='comment'>// Developed at SunSoft, a Sun Microsystems, Inc. business.</span></td></tr>
<tr class="codeline" data-linenumber="7"><td class="num" id="LN7">7</td><td class="line"><span class='comment'>// Permission to use, copy, modify, and distribute this</span></td></tr>
<tr class="codeline" data-linenumber="8"><td class="num" id="LN8">8</td><td class="line"><span class='comment'>// software is freely granted, provided that this notice</span></td></tr>
<tr class="codeline" data-linenumber="9"><td class="num" id="LN9">9</td><td class="line"><span class='comment'>// is preserved.</span></td></tr>
<tr class="codeline" data-linenumber="10"><td class="num" id="LN10">10</td><td class="line"><span class='comment'>// ====================================================</span></td></tr>
<tr class="codeline" data-linenumber="11"><td class="num" id="LN11">11</td><td class="line"><span class='comment'>//</span></td></tr>
<tr class="codeline" data-linenumber="12"><td class="num" id="LN12">12</td><td class="line"><span class='comment'>// The original source code covered by the above license above has been</span></td></tr>
<tr class="codeline" data-linenumber="13"><td class="num" id="LN13">13</td><td class="line"><span class='comment'>// modified significantly by Google Inc.</span></td></tr>
<tr class="codeline" data-linenumber="14"><td class="num" id="LN14">14</td><td class="line"><span class='comment'>// Copyright 2016 the V8 project authors. All rights reserved.</span></td></tr>
<tr class="codeline" data-linenumber="15"><td class="num" id="LN15">15</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="16"><td class="num" id="LN16">16</td><td class="line"><span class='directive'>#include "src/base/ieee754.h"</span></td></tr>
<tr class="codeline" data-linenumber="17"><td class="num" id="LN17">17</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="18"><td class="num" id="LN18">18</td><td class="line"><span class='directive'>#include &lt;cmath&gt;</span></td></tr>
<tr class="codeline" data-linenumber="19"><td class="num" id="LN19">19</td><td class="line"><span class='directive'>#include &lt;limits&gt;</span></td></tr>
<tr class="codeline" data-linenumber="20"><td class="num" id="LN20">20</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="21"><td class="num" id="LN21">21</td><td class="line"><span class='directive'>#include "src/base/build_config.h"</span></td></tr>
<tr class="codeline" data-linenumber="22"><td class="num" id="LN22">22</td><td class="line"><span class='directive'>#include "src/base/macros.h"</span></td></tr>
<tr class="codeline" data-linenumber="23"><td class="num" id="LN23">23</td><td class="line"><span class='directive'>#include "src/base/overflowing-math.h"</span></td></tr>
<tr class="codeline" data-linenumber="24"><td class="num" id="LN24">24</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="25"><td class="num" id="LN25">25</td><td class="line"><span class='keyword'>namespace</span> v8 {</td></tr>
<tr class="codeline" data-linenumber="26"><td class="num" id="LN26">26</td><td class="line"><span class='keyword'>namespace</span> base {</td></tr>
<tr class="codeline" data-linenumber="27"><td class="num" id="LN27">27</td><td class="line"><span class='keyword'>namespace</span> ieee754 {</td></tr>
<tr class="codeline" data-linenumber="28"><td class="num" id="LN28">28</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="29"><td class="num" id="LN29">29</td><td class="line"><span class='keyword'>namespace</span> {</td></tr>
<tr class="codeline" data-linenumber="30"><td class="num" id="LN30">30</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="31"><td class="num" id="LN31">31</td><td class="line"><span class='comment'>/* Disable "potential divide by 0" warning in Visual Studio compiler. */</span></td></tr>
<tr class="codeline" data-linenumber="32"><td class="num" id="LN32">32</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="33"><td class="num" id="LN33">33</td><td class="line"><span class='directive'>#if V8_CC_MSVC</span></td></tr>
<tr class="codeline" data-linenumber="34"><td class="num" id="LN34">34</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="35"><td class="num" id="LN35">35</td><td class="line"><span class='directive'>#pragma warning(disable : 4723)</span></td></tr>
<tr class="codeline" data-linenumber="36"><td class="num" id="LN36">36</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="37"><td class="num" id="LN37">37</td><td class="line"><span class='directive'>#endif</span></td></tr>
<tr class="codeline" data-linenumber="38"><td class="num" id="LN38">38</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="39"><td class="num" id="LN39">39</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="40"><td class="num" id="LN40">40</td><td class="line"> <span class='comment'>* The original fdlibm code used statements like:</span></td></tr>
<tr class="codeline" data-linenumber="41"><td class="num" id="LN41">41</td><td class="line"> <span class='comment'>*  n0 = ((*(int*)&amp;one)&gt;&gt;29)^1;   * index of high word *</span></td></tr>
<tr class="codeline" data-linenumber="42"><td class="num" id="LN42">42</td><td class="line"> <span class='comment'>*  ix0 = *(n0+(int*)&amp;x);     * high word of x *</span></td></tr>
<tr class="codeline" data-linenumber="43"><td class="num" id="LN43">43</td><td class="line"> <span class='comment'>*  ix1 = *((1-n0)+(int*)&amp;x);   * low word of x *</span></td></tr>
<tr class="codeline" data-linenumber="44"><td class="num" id="LN44">44</td><td class="line"> <span class='comment'>* to dig two 32 bit words out of the 64 bit IEEE floating point</span></td></tr>
<tr class="codeline" data-linenumber="45"><td class="num" id="LN45">45</td><td class="line"> <span class='comment'>* value.  That is non-ANSI, and, moreover, the gcc instruction</span></td></tr>
<tr class="codeline" data-linenumber="46"><td class="num" id="LN46">46</td><td class="line"> <span class='comment'>* scheduler gets it wrong.  We instead use the following macros.</span></td></tr>
<tr class="codeline" data-linenumber="47"><td class="num" id="LN47">47</td><td class="line"> <span class='comment'>* Unlike the original code, we determine the endianness at compile</span></td></tr>
<tr class="codeline" data-linenumber="48"><td class="num" id="LN48">48</td><td class="line"> <span class='comment'>* time, not at run time; I don't see much benefit to selecting</span></td></tr>
<tr class="codeline" data-linenumber="49"><td class="num" id="LN49">49</td><td class="line"> <span class='comment'>* endianness at run time.</span></td></tr>
<tr class="codeline" data-linenumber="50"><td class="num" id="LN50">50</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="51"><td class="num" id="LN51">51</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="52"><td class="num" id="LN52">52</td><td class="line"><span class='comment'>/* Get two 32 bit ints from a double.  */</span></td></tr>
<tr class="codeline" data-linenumber="53"><td class="num" id="LN53">53</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="54"><td class="num" id="LN54">54</td><td class="line"><span class='directive'>#define EXTRACT_WORDS(ix0, ix1, d)         \</span></td></tr>
<tr class="codeline" data-linenumber="55"><td class="num" id="LN55">55</td><td class="line">  <span class='directive'>do {                                     \</span></td></tr>
<tr class="codeline" data-linenumber="56"><td class="num" id="LN56">56</td><td class="line">    <span class='directive'>uint64_t bits = bit_cast&lt;uint64_t&gt;(d); \</span></td></tr>
<tr class="codeline" data-linenumber="57"><td class="num" id="LN57">57</td><td class="line">    <span class='directive'>(ix0) = bits &gt;&gt; 32;                    \</span></td></tr>
<tr class="codeline" data-linenumber="58"><td class="num" id="LN58">58</td><td class="line">    <span class='directive'>(ix1) = bits &amp; 0xFFFFFFFFu;            \</span></td></tr>
<tr class="codeline" data-linenumber="59"><td class="num" id="LN59">59</td><td class="line">  <span class='directive'>} while (false)</span></td></tr>
<tr class="codeline" data-linenumber="60"><td class="num" id="LN60">60</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="61"><td class="num" id="LN61">61</td><td class="line"><span class='comment'>/* Get the more significant 32 bit int from a double.  */</span></td></tr>
<tr class="codeline" data-linenumber="62"><td class="num" id="LN62">62</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="63"><td class="num" id="LN63">63</td><td class="line"><span class='directive'>#define GET_HIGH_WORD(i, d)                \</span></td></tr>
<tr class="codeline" data-linenumber="64"><td class="num" id="LN64">64</td><td class="line">  <span class='directive'>do {                                     \</span></td></tr>
<tr class="codeline" data-linenumber="65"><td class="num" id="LN65">65</td><td class="line">    <span class='directive'>uint64_t bits = bit_cast&lt;uint64_t&gt;(d); \</span></td></tr>
<tr class="codeline" data-linenumber="66"><td class="num" id="LN66">66</td><td class="line">    <span class='directive'>(i) = bits &gt;&gt; 32;                      \</span></td></tr>
<tr class="codeline" data-linenumber="67"><td class="num" id="LN67">67</td><td class="line">  <span class='directive'>} while (false)</span></td></tr>
<tr class="codeline" data-linenumber="68"><td class="num" id="LN68">68</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="69"><td class="num" id="LN69">69</td><td class="line"><span class='comment'>/* Get the less significant 32 bit int from a double.  */</span></td></tr>
<tr class="codeline" data-linenumber="70"><td class="num" id="LN70">70</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="71"><td class="num" id="LN71">71</td><td class="line"><span class='directive'>#define GET_LOW_WORD(i, d)                 \</span></td></tr>
<tr class="codeline" data-linenumber="72"><td class="num" id="LN72">72</td><td class="line">  <span class='directive'>do {                                     \</span></td></tr>
<tr class="codeline" data-linenumber="73"><td class="num" id="LN73">73</td><td class="line">    <span class='directive'>uint64_t bits = bit_cast&lt;uint64_t&gt;(d); \</span></td></tr>
<tr class="codeline" data-linenumber="74"><td class="num" id="LN74">74</td><td class="line">    <span class='directive'>(i) = bits &amp; 0xFFFFFFFFu;              \</span></td></tr>
<tr class="codeline" data-linenumber="75"><td class="num" id="LN75">75</td><td class="line">  <span class='directive'>} while (false)</span></td></tr>
<tr class="codeline" data-linenumber="76"><td class="num" id="LN76">76</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="77"><td class="num" id="LN77">77</td><td class="line"><span class='comment'>/* Set a double from two 32 bit ints.  */</span></td></tr>
<tr class="codeline" data-linenumber="78"><td class="num" id="LN78">78</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="79"><td class="num" id="LN79">79</td><td class="line"><span class='directive'>#define INSERT_WORDS(d, ix0, ix1)             \</span></td></tr>
<tr class="codeline" data-linenumber="80"><td class="num" id="LN80">80</td><td class="line">  <span class='directive'>do {                                        \</span></td></tr>
<tr class="codeline" data-linenumber="81"><td class="num" id="LN81">81</td><td class="line">    <span class='directive'>uint64_t bits = 0;                        \</span></td></tr>
<tr class="codeline" data-linenumber="82"><td class="num" id="LN82">82</td><td class="line">    <span class='directive'>bits |= static_cast&lt;uint64_t&gt;(ix0) &lt;&lt; 32; \</span></td></tr>
<tr class="codeline" data-linenumber="83"><td class="num" id="LN83">83</td><td class="line">    <span class='directive'>bits |= static_cast&lt;uint32_t&gt;(ix1);       \</span></td></tr>
<tr class="codeline" data-linenumber="84"><td class="num" id="LN84">84</td><td class="line">    <span class='directive'>(d) = bit_cast&lt;double&gt;(bits);             \</span></td></tr>
<tr class="codeline" data-linenumber="85"><td class="num" id="LN85">85</td><td class="line">  <span class='directive'>} while (false)</span></td></tr>
<tr class="codeline" data-linenumber="86"><td class="num" id="LN86">86</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="87"><td class="num" id="LN87">87</td><td class="line"><span class='comment'>/* Set the more significant 32 bits of a double from an int.  */</span></td></tr>
<tr class="codeline" data-linenumber="88"><td class="num" id="LN88">88</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="89"><td class="num" id="LN89">89</td><td class="line"><span class='directive'>#define SET_HIGH_WORD(d, v)                 \</span></td></tr>
<tr class="codeline" data-linenumber="90"><td class="num" id="LN90">90</td><td class="line">  <span class='directive'>do {                                      \</span></td></tr>
<tr class="codeline" data-linenumber="91"><td class="num" id="LN91">91</td><td class="line">    <span class='directive'>uint64_t bits = bit_cast&lt;uint64_t&gt;(d);  \</span></td></tr>
<tr class="codeline" data-linenumber="92"><td class="num" id="LN92">92</td><td class="line">    <span class='directive'>bits &amp;= 0x0000'0000'FFFF'FFFF;          \</span></td></tr>
<tr class="codeline" data-linenumber="93"><td class="num" id="LN93">93</td><td class="line">    <span class='directive'>bits |= static_cast&lt;uint64_t&gt;(v) &lt;&lt; 32; \</span></td></tr>
<tr class="codeline" data-linenumber="94"><td class="num" id="LN94">94</td><td class="line">    <span class='directive'>(d) = bit_cast&lt;double&gt;(bits);           \</span></td></tr>
<tr class="codeline" data-linenumber="95"><td class="num" id="LN95">95</td><td class="line">  <span class='directive'>} while (false)</span></td></tr>
<tr class="codeline" data-linenumber="96"><td class="num" id="LN96">96</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="97"><td class="num" id="LN97">97</td><td class="line"><span class='comment'>/* Set the less significant 32 bits of a double from an int.  */</span></td></tr>
<tr class="codeline" data-linenumber="98"><td class="num" id="LN98">98</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="99"><td class="num" id="LN99">99</td><td class="line"><span class='directive'>#define SET_LOW_WORD(d, v)                 \</span></td></tr>
<tr class="codeline" data-linenumber="100"><td class="num" id="LN100">100</td><td class="line">  <span class='directive'>do {                                     \</span></td></tr>
<tr class="codeline" data-linenumber="101"><td class="num" id="LN101">101</td><td class="line">    <span class='directive'>uint64_t bits = bit_cast&lt;uint64_t&gt;(d); \</span></td></tr>
<tr class="codeline" data-linenumber="102"><td class="num" id="LN102">102</td><td class="line">    <span class='directive'>bits &amp;= 0xFFFF'FFFF'0000'0000;         \</span></td></tr>
<tr class="codeline" data-linenumber="103"><td class="num" id="LN103">103</td><td class="line">    <span class='directive'>bits |= static_cast&lt;uint32_t&gt;(v);      \</span></td></tr>
<tr class="codeline" data-linenumber="104"><td class="num" id="LN104">104</td><td class="line">    <span class='directive'>(d) = bit_cast&lt;double&gt;(bits);          \</span></td></tr>
<tr class="codeline" data-linenumber="105"><td class="num" id="LN105">105</td><td class="line">  <span class='directive'>} while (false)</span></td></tr>
<tr class="codeline" data-linenumber="106"><td class="num" id="LN106">106</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="107"><td class="num" id="LN107">107</td><td class="line">int32_t __ieee754_rem_pio2(<span class='keyword'>double</span> x, <span class='keyword'>double</span>* y) <span class='macro'>V8_WARN_UNUSED_RESULT<span class='macro_popup'>__attribute__((warn_unused_result))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="108"><td class="num" id="LN108">108</td><td class="line"><span class='keyword'>double</span> __kernel_cos(<span class='keyword'>double</span> x, <span class='keyword'>double</span> y) <span class='macro'>V8_WARN_UNUSED_RESULT<span class='macro_popup'>__attribute__((warn_unused_result))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="109"><td class="num" id="LN109">109</td><td class="line"><span class='keyword'>int</span> __kernel_rem_pio2(<span class='keyword'>double</span>* x, <span class='keyword'>double</span>* y, <span class='keyword'>int</span> e0, <span class='keyword'>int</span> nx, <span class='keyword'>int</span> prec,</td></tr>
<tr class="codeline" data-linenumber="110"><td class="num" id="LN110">110</td><td class="line">                      <span class='keyword'>const</span> int32_t* ipio2) <span class='macro'>V8_WARN_UNUSED_RESULT<span class='macro_popup'>__attribute__((warn_unused_result))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="111"><td class="num" id="LN111">111</td><td class="line"><span class='keyword'>double</span> __kernel_sin(<span class='keyword'>double</span> x, <span class='keyword'>double</span> y, <span class='keyword'>int</span> iy) <span class='macro'>V8_WARN_UNUSED_RESULT<span class='macro_popup'>__attribute__((warn_unused_result))</span></span>;</td></tr>
<tr class="codeline" data-linenumber="112"><td class="num" id="LN112">112</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="113"><td class="num" id="LN113">113</td><td class="line"><span class='comment'>/* __ieee754_rem_pio2(x,y)</span></td></tr>
<tr class="codeline" data-linenumber="114"><td class="num" id="LN114">114</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="115"><td class="num" id="LN115">115</td><td class="line"> <span class='comment'>* return the remainder of x rem pi/2 in y[0]+y[1]</span></td></tr>
<tr class="codeline" data-linenumber="116"><td class="num" id="LN116">116</td><td class="line"> <span class='comment'>* use __kernel_rem_pio2()</span></td></tr>
<tr class="codeline" data-linenumber="117"><td class="num" id="LN117">117</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="118"><td class="num" id="LN118">118</td><td class="line">int32_t __ieee754_rem_pio2(<span class='keyword'>double</span> x, <span class='keyword'>double</span> *y) {</td></tr>
<tr class="codeline" data-linenumber="119"><td class="num" id="LN119">119</td><td class="line">  <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="120"><td class="num" id="LN120">120</td><td class="line">   <span class='comment'>* Table of constants for 2/pi, 396 Hex digits (476 decimal) of 2/pi</span></td></tr>
<tr class="codeline" data-linenumber="121"><td class="num" id="LN121">121</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="122"><td class="num" id="LN122">122</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> int32_t two_over_pi[] = {</td></tr>
<tr class="codeline" data-linenumber="123"><td class="num" id="LN123">123</td><td class="line">      0xA2F983, 0x6E4E44, 0x1529FC, 0x2757D1, 0xF534DD, 0xC0DB62, 0x95993C,</td></tr>
<tr class="codeline" data-linenumber="124"><td class="num" id="LN124">124</td><td class="line">      0x439041, 0xFE5163, 0xABDEBB, 0xC561B7, 0x246E3A, 0x424DD2, 0xE00649,</td></tr>
<tr class="codeline" data-linenumber="125"><td class="num" id="LN125">125</td><td class="line">      0x2EEA09, 0xD1921C, 0xFE1DEB, 0x1CB129, 0xA73EE8, 0x8235F5, 0x2EBB44,</td></tr>
<tr class="codeline" data-linenumber="126"><td class="num" id="LN126">126</td><td class="line">      0x84E99C, 0x7026B4, 0x5F7E41, 0x3991D6, 0x398353, 0x39F49C, 0x845F8B,</td></tr>
<tr class="codeline" data-linenumber="127"><td class="num" id="LN127">127</td><td class="line">      0xBDF928, 0x3B1FF8, 0x97FFDE, 0x05980F, 0xEF2F11, 0x8B5A0A, 0x6D1F6D,</td></tr>
<tr class="codeline" data-linenumber="128"><td class="num" id="LN128">128</td><td class="line">      0x367ECF, 0x27CB09, 0xB74F46, 0x3F669E, 0x5FEA2D, 0x7527BA, 0xC7EBE5,</td></tr>
<tr class="codeline" data-linenumber="129"><td class="num" id="LN129">129</td><td class="line">      0xF17B3D, 0x0739F7, 0x8A5292, 0xEA6BFB, 0x5FB11F, 0x8D5D08, 0x560330,</td></tr>
<tr class="codeline" data-linenumber="130"><td class="num" id="LN130">130</td><td class="line">      0x46FC7B, 0x6BABF0, 0xCFBC20, 0x9AF436, 0x1DA9E3, 0x91615E, 0xE61B08,</td></tr>
<tr class="codeline" data-linenumber="131"><td class="num" id="LN131">131</td><td class="line">      0x659985, 0x5F14A0, 0x68408D, 0xFFD880, 0x4D7327, 0x310606, 0x1556CA,</td></tr>
<tr class="codeline" data-linenumber="132"><td class="num" id="LN132">132</td><td class="line">      0x73A8C9, 0x60E27B, 0xC08C6B,</td></tr>
<tr class="codeline" data-linenumber="133"><td class="num" id="LN133">133</td><td class="line">  };</td></tr>
<tr class="codeline" data-linenumber="134"><td class="num" id="LN134">134</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="135"><td class="num" id="LN135">135</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> int32_t npio2_hw[] = {</td></tr>
<tr class="codeline" data-linenumber="136"><td class="num" id="LN136">136</td><td class="line">      0x3FF921FB, 0x400921FB, 0x4012D97C, 0x401921FB, 0x401F6A7A, 0x4022D97C,</td></tr>
<tr class="codeline" data-linenumber="137"><td class="num" id="LN137">137</td><td class="line">      0x4025FDBB, 0x402921FB, 0x402C463A, 0x402F6A7A, 0x4031475C, 0x4032D97C,</td></tr>
<tr class="codeline" data-linenumber="138"><td class="num" id="LN138">138</td><td class="line">      0x40346B9C, 0x4035FDBB, 0x40378FDB, 0x403921FB, 0x403AB41B, 0x403C463A,</td></tr>
<tr class="codeline" data-linenumber="139"><td class="num" id="LN139">139</td><td class="line">      0x403DD85A, 0x403F6A7A, 0x40407E4C, 0x4041475C, 0x4042106C, 0x4042D97C,</td></tr>
<tr class="codeline" data-linenumber="140"><td class="num" id="LN140">140</td><td class="line">      0x4043A28C, 0x40446B9C, 0x404534AC, 0x4045FDBB, 0x4046C6CB, 0x40478FDB,</td></tr>
<tr class="codeline" data-linenumber="141"><td class="num" id="LN141">141</td><td class="line">      0x404858EB, 0x404921FB,</td></tr>
<tr class="codeline" data-linenumber="142"><td class="num" id="LN142">142</td><td class="line">  };</td></tr>
<tr class="codeline" data-linenumber="143"><td class="num" id="LN143">143</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="144"><td class="num" id="LN144">144</td><td class="line">  <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="145"><td class="num" id="LN145">145</td><td class="line">   <span class='comment'>* invpio2:  53 bits of 2/pi</span></td></tr>
<tr class="codeline" data-linenumber="146"><td class="num" id="LN146">146</td><td class="line">   <span class='comment'>* pio2_1:   first  33 bit of pi/2</span></td></tr>
<tr class="codeline" data-linenumber="147"><td class="num" id="LN147">147</td><td class="line">   <span class='comment'>* pio2_1t:  pi/2 - pio2_1</span></td></tr>
<tr class="codeline" data-linenumber="148"><td class="num" id="LN148">148</td><td class="line">   <span class='comment'>* pio2_2:   second 33 bit of pi/2</span></td></tr>
<tr class="codeline" data-linenumber="149"><td class="num" id="LN149">149</td><td class="line">   <span class='comment'>* pio2_2t:  pi/2 - (pio2_1+pio2_2)</span></td></tr>
<tr class="codeline" data-linenumber="150"><td class="num" id="LN150">150</td><td class="line">   <span class='comment'>* pio2_3:   third  33 bit of pi/2</span></td></tr>
<tr class="codeline" data-linenumber="151"><td class="num" id="LN151">151</td><td class="line">   <span class='comment'>* pio2_3t:  pi/2 - (pio2_1+pio2_2+pio2_3)</span></td></tr>
<tr class="codeline" data-linenumber="152"><td class="num" id="LN152">152</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="153"><td class="num" id="LN153">153</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="154"><td class="num" id="LN154">154</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="155"><td class="num" id="LN155">155</td><td class="line">      zero = 0.00000000000000000000e+00,    <span class='comment'>/* 0x00000000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="156"><td class="num" id="LN156">156</td><td class="line">      half = 5.00000000000000000000e-01,    <span class='comment'>/* 0x3FE00000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="157"><td class="num" id="LN157">157</td><td class="line">      two24 = 1.67772160000000000000e+07,   <span class='comment'>/* 0x41700000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="158"><td class="num" id="LN158">158</td><td class="line">      invpio2 = 6.36619772367581382433e-01, <span class='comment'>/* 0x3FE45F30, 0x6DC9C883 */</span></td></tr>
<tr class="codeline" data-linenumber="159"><td class="num" id="LN159">159</td><td class="line">      pio2_1 = 1.57079632673412561417e+00,  <span class='comment'>/* 0x3FF921FB, 0x54400000 */</span></td></tr>
<tr class="codeline" data-linenumber="160"><td class="num" id="LN160">160</td><td class="line">      pio2_1t = 6.07710050650619224932e-11, <span class='comment'>/* 0x3DD0B461, 0x1A626331 */</span></td></tr>
<tr class="codeline" data-linenumber="161"><td class="num" id="LN161">161</td><td class="line">      pio2_2 = 6.07710050630396597660e-11,  <span class='comment'>/* 0x3DD0B461, 0x1A600000 */</span></td></tr>
<tr class="codeline" data-linenumber="162"><td class="num" id="LN162">162</td><td class="line">      pio2_2t = 2.02226624879595063154e-21, <span class='comment'>/* 0x3BA3198A, 0x2E037073 */</span></td></tr>
<tr class="codeline" data-linenumber="163"><td class="num" id="LN163">163</td><td class="line">      pio2_3 = 2.02226624871116645580e-21,  <span class='comment'>/* 0x3BA3198A, 0x2E000000 */</span></td></tr>
<tr class="codeline" data-linenumber="164"><td class="num" id="LN164">164</td><td class="line">      pio2_3t = 8.47842766036889956997e-32; <span class='comment'>/* 0x397B839A, 0x252049C1 */</span></td></tr>
<tr class="codeline" data-linenumber="165"><td class="num" id="LN165">165</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="166"><td class="num" id="LN166">166</td><td class="line">  <span class='keyword'>double</span> z, w, t, r, fn;</td></tr>
<tr class="codeline" data-linenumber="167"><td class="num" id="LN167">167</td><td class="line">  <span class='keyword'>double</span> tx[3];</td></tr>
<tr class="codeline" data-linenumber="168"><td class="num" id="LN168">168</td><td class="line">  int32_t e0, i, j, nx, n, ix, hx;</td></tr>
<tr class="codeline" data-linenumber="169"><td class="num" id="LN169">169</td><td class="line">  uint32_t low;</td></tr>
<tr class="codeline" data-linenumber="170"><td class="num" id="LN170">170</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="171"><td class="num" id="LN171">171</td><td class="line">  z = 0;</td></tr>
<tr class="codeline" data-linenumber="172"><td class="num" id="LN172">172</td><td class="line">  GET_HIGH_WORD(hx, x); <span class='comment'>/* high word of x */</span></td></tr>
<tr class="codeline" data-linenumber="173"><td class="num" id="LN173">173</td><td class="line">  ix = hx &amp; 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="174"><td class="num" id="LN174">174</td><td class="line">  <span class='keyword'>if</span> (ix &lt;= 0x3FE921FB) { <span class='comment'>/* |x| ~&lt;= pi/4 , no need for reduction */</span></td></tr>
<tr class="codeline" data-linenumber="175"><td class="num" id="LN175">175</td><td class="line">    y[0] = x;</td></tr>
<tr class="codeline" data-linenumber="176"><td class="num" id="LN176">176</td><td class="line">    y[1] = 0;</td></tr>
<tr class="codeline" data-linenumber="177"><td class="num" id="LN177">177</td><td class="line">    <span class='keyword'>return</span> 0;</td></tr>
<tr class="codeline" data-linenumber="178"><td class="num" id="LN178">178</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="179"><td class="num" id="LN179">179</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x4002D97C) { <span class='comment'>/* |x| &lt; 3pi/4, special case with n=+-1 */</span></td></tr>
<tr class="codeline" data-linenumber="180"><td class="num" id="LN180">180</td><td class="line">    <span class='keyword'>if</span> (hx &gt; 0) {</td></tr>
<tr class="codeline" data-linenumber="181"><td class="num" id="LN181">181</td><td class="line">      z = x - pio2_1;</td></tr>
<tr class="codeline" data-linenumber="182"><td class="num" id="LN182">182</td><td class="line">      <span class='keyword'>if</span> (ix != 0x3FF921FB) { <span class='comment'>/* 33+53 bit pi is good enough */</span></td></tr>
<tr class="codeline" data-linenumber="183"><td class="num" id="LN183">183</td><td class="line">        y[0] = z - pio2_1t;</td></tr>
<tr class="codeline" data-linenumber="184"><td class="num" id="LN184">184</td><td class="line">        y[1] = (z - y[0]) - pio2_1t;</td></tr>
<tr class="codeline" data-linenumber="185"><td class="num" id="LN185">185</td><td class="line">      } <span class='keyword'>else</span> { <span class='comment'>/* near pi/2, use 33+33+53 bit pi */</span></td></tr>
<tr class="codeline" data-linenumber="186"><td class="num" id="LN186">186</td><td class="line">        z -= pio2_2;</td></tr>
<tr class="codeline" data-linenumber="187"><td class="num" id="LN187">187</td><td class="line">        y[0] = z - pio2_2t;</td></tr>
<tr class="codeline" data-linenumber="188"><td class="num" id="LN188">188</td><td class="line">        y[1] = (z - y[0]) - pio2_2t;</td></tr>
<tr class="codeline" data-linenumber="189"><td class="num" id="LN189">189</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="190"><td class="num" id="LN190">190</td><td class="line">      <span class='keyword'>return</span> 1;</td></tr>
<tr class="codeline" data-linenumber="191"><td class="num" id="LN191">191</td><td class="line">    } <span class='keyword'>else</span> { <span class='comment'>/* negative x */</span></td></tr>
<tr class="codeline" data-linenumber="192"><td class="num" id="LN192">192</td><td class="line">      z = x + pio2_1;</td></tr>
<tr class="codeline" data-linenumber="193"><td class="num" id="LN193">193</td><td class="line">      <span class='keyword'>if</span> (ix != 0x3FF921FB) { <span class='comment'>/* 33+53 bit pi is good enough */</span></td></tr>
<tr class="codeline" data-linenumber="194"><td class="num" id="LN194">194</td><td class="line">        y[0] = z + pio2_1t;</td></tr>
<tr class="codeline" data-linenumber="195"><td class="num" id="LN195">195</td><td class="line">        y[1] = (z - y[0]) + pio2_1t;</td></tr>
<tr class="codeline" data-linenumber="196"><td class="num" id="LN196">196</td><td class="line">      } <span class='keyword'>else</span> { <span class='comment'>/* near pi/2, use 33+33+53 bit pi */</span></td></tr>
<tr class="codeline" data-linenumber="197"><td class="num" id="LN197">197</td><td class="line">        z += pio2_2;</td></tr>
<tr class="codeline" data-linenumber="198"><td class="num" id="LN198">198</td><td class="line">        y[0] = z + pio2_2t;</td></tr>
<tr class="codeline" data-linenumber="199"><td class="num" id="LN199">199</td><td class="line">        y[1] = (z - y[0]) + pio2_2t;</td></tr>
<tr class="codeline" data-linenumber="200"><td class="num" id="LN200">200</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="201"><td class="num" id="LN201">201</td><td class="line">      <span class='keyword'>return</span> -1;</td></tr>
<tr class="codeline" data-linenumber="202"><td class="num" id="LN202">202</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="203"><td class="num" id="LN203">203</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="204"><td class="num" id="LN204">204</td><td class="line">  <span class='keyword'>if</span> (ix &lt;= 0x413921FB) { <span class='comment'>/* |x| ~&lt;= 2^19*(pi/2), medium size */</span></td></tr>
<tr class="codeline" data-linenumber="205"><td class="num" id="LN205">205</td><td class="line">    t = fabs(x);</td></tr>
<tr class="codeline" data-linenumber="206"><td class="num" id="LN206">206</td><td class="line">    n = <span class='keyword'>static_cast</span>&lt;int32_t&gt;(t * invpio2 + half);</td></tr>
<tr class="codeline" data-linenumber="207"><td class="num" id="LN207">207</td><td class="line">    fn = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(n);</td></tr>
<tr class="codeline" data-linenumber="208"><td class="num" id="LN208">208</td><td class="line">    r = t - fn * pio2_1;</td></tr>
<tr class="codeline" data-linenumber="209"><td class="num" id="LN209">209</td><td class="line">    w = fn * pio2_1t; <span class='comment'>/* 1st round good to 85 bit */</span></td></tr>
<tr class="codeline" data-linenumber="210"><td class="num" id="LN210">210</td><td class="line">    <span class='keyword'>if</span> (n &lt; 32 &amp;&amp; ix != npio2_hw[n - 1]) {</td></tr>
<tr class="codeline" data-linenumber="211"><td class="num" id="LN211">211</td><td class="line">      y[0] = r - w; <span class='comment'>/* quick check no cancellation */</span></td></tr>
<tr class="codeline" data-linenumber="212"><td class="num" id="LN212">212</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="213"><td class="num" id="LN213">213</td><td class="line">      uint32_t high;</td></tr>
<tr class="codeline" data-linenumber="214"><td class="num" id="LN214">214</td><td class="line">      j = ix &gt;&gt; 20;</td></tr>
<tr class="codeline" data-linenumber="215"><td class="num" id="LN215">215</td><td class="line">      y[0] = r - w;</td></tr>
<tr class="codeline" data-linenumber="216"><td class="num" id="LN216">216</td><td class="line">      GET_HIGH_WORD(high, y[0]);</td></tr>
<tr class="codeline" data-linenumber="217"><td class="num" id="LN217">217</td><td class="line">      i = j - ((high &gt;&gt; 20) &amp; 0x7FF);</td></tr>
<tr class="codeline" data-linenumber="218"><td class="num" id="LN218">218</td><td class="line">      <span class='keyword'>if</span> (i &gt; 16) { <span class='comment'>/* 2nd iteration needed, good to 118 */</span></td></tr>
<tr class="codeline" data-linenumber="219"><td class="num" id="LN219">219</td><td class="line">        t = r;</td></tr>
<tr class="codeline" data-linenumber="220"><td class="num" id="LN220">220</td><td class="line">        w = fn * pio2_2;</td></tr>
<tr class="codeline" data-linenumber="221"><td class="num" id="LN221">221</td><td class="line">        r = t - w;</td></tr>
<tr class="codeline" data-linenumber="222"><td class="num" id="LN222">222</td><td class="line">        w = fn * pio2_2t - ((t - r) - w);</td></tr>
<tr class="codeline" data-linenumber="223"><td class="num" id="LN223">223</td><td class="line">        y[0] = r - w;</td></tr>
<tr class="codeline" data-linenumber="224"><td class="num" id="LN224">224</td><td class="line">        GET_HIGH_WORD(high, y[0]);</td></tr>
<tr class="codeline" data-linenumber="225"><td class="num" id="LN225">225</td><td class="line">        i = j - ((high &gt;&gt; 20) &amp; 0x7FF);</td></tr>
<tr class="codeline" data-linenumber="226"><td class="num" id="LN226">226</td><td class="line">        <span class='keyword'>if</span> (i &gt; 49) { <span class='comment'>/* 3rd iteration need, 151 bits acc */</span></td></tr>
<tr class="codeline" data-linenumber="227"><td class="num" id="LN227">227</td><td class="line">          t = r;      <span class='comment'>/* will cover all possible cases */</span></td></tr>
<tr class="codeline" data-linenumber="228"><td class="num" id="LN228">228</td><td class="line">          w = fn * pio2_3;</td></tr>
<tr class="codeline" data-linenumber="229"><td class="num" id="LN229">229</td><td class="line">          r = t - w;</td></tr>
<tr class="codeline" data-linenumber="230"><td class="num" id="LN230">230</td><td class="line">          w = fn * pio2_3t - ((t - r) - w);</td></tr>
<tr class="codeline" data-linenumber="231"><td class="num" id="LN231">231</td><td class="line">          y[0] = r - w;</td></tr>
<tr class="codeline" data-linenumber="232"><td class="num" id="LN232">232</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="233"><td class="num" id="LN233">233</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="234"><td class="num" id="LN234">234</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="235"><td class="num" id="LN235">235</td><td class="line">    y[1] = (r - y[0]) - w;</td></tr>
<tr class="codeline" data-linenumber="236"><td class="num" id="LN236">236</td><td class="line">    <span class='keyword'>if</span> (hx &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="237"><td class="num" id="LN237">237</td><td class="line">      y[0] = -y[0];</td></tr>
<tr class="codeline" data-linenumber="238"><td class="num" id="LN238">238</td><td class="line">      y[1] = -y[1];</td></tr>
<tr class="codeline" data-linenumber="239"><td class="num" id="LN239">239</td><td class="line">      <span class='keyword'>return</span> -n;</td></tr>
<tr class="codeline" data-linenumber="240"><td class="num" id="LN240">240</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="241"><td class="num" id="LN241">241</td><td class="line">      <span class='keyword'>return</span> n;</td></tr>
<tr class="codeline" data-linenumber="242"><td class="num" id="LN242">242</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="243"><td class="num" id="LN243">243</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="244"><td class="num" id="LN244">244</td><td class="line">  <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="245"><td class="num" id="LN245">245</td><td class="line">   <span class='comment'>* all other (large) arguments</span></td></tr>
<tr class="codeline" data-linenumber="246"><td class="num" id="LN246">246</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="247"><td class="num" id="LN247">247</td><td class="line">  <span class='keyword'>if</span> (ix &gt;= 0x7FF00000) { <span class='comment'>/* x is inf or NaN */</span></td></tr>
<tr class="codeline" data-linenumber="248"><td class="num" id="LN248">248</td><td class="line">    y[0] = y[1] = x - x;</td></tr>
<tr class="codeline" data-linenumber="249"><td class="num" id="LN249">249</td><td class="line">    <span class='keyword'>return</span> 0;</td></tr>
<tr class="codeline" data-linenumber="250"><td class="num" id="LN250">250</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="251"><td class="num" id="LN251">251</td><td class="line">  <span class='comment'>/* set z = scalbn(|x|,ilogb(x)-23) */</span></td></tr>
<tr class="codeline" data-linenumber="252"><td class="num" id="LN252">252</td><td class="line">  GET_LOW_WORD(low, x);</td></tr>
<tr class="codeline" data-linenumber="253"><td class="num" id="LN253">253</td><td class="line">  SET_LOW_WORD(z, low);</td></tr>
<tr class="codeline" data-linenumber="254"><td class="num" id="LN254">254</td><td class="line">  e0 = (ix &gt;&gt; 20) - 1046; <span class='comment'>/* e0 = ilogb(z)-23; */</span></td></tr>
<tr class="codeline" data-linenumber="255"><td class="num" id="LN255">255</td><td class="line">  SET_HIGH_WORD(z, ix - <span class='keyword'>static_cast</span>&lt;int32_t&gt;(<span class='keyword'>static_cast</span>&lt;uint32_t&gt;(e0) &lt;&lt; 20));</td></tr>
<tr class="codeline" data-linenumber="256"><td class="num" id="LN256">256</td><td class="line">  <span class='keyword'>for</span> (i = 0; i &lt; 2; i++) {</td></tr>
<tr class="codeline" data-linenumber="257"><td class="num" id="LN257">257</td><td class="line">    tx[i] = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(<span class='keyword'>static_cast</span>&lt;int32_t&gt;(z));</td></tr>
<tr class="codeline" data-linenumber="258"><td class="num" id="LN258">258</td><td class="line">    z = (z - tx[i]) * two24;</td></tr>
<tr class="codeline" data-linenumber="259"><td class="num" id="LN259">259</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="260"><td class="num" id="LN260">260</td><td class="line">  tx[2] = z;</td></tr>
<tr class="codeline" data-linenumber="261"><td class="num" id="LN261">261</td><td class="line">  nx = 3;</td></tr>
<tr class="codeline" data-linenumber="262"><td class="num" id="LN262">262</td><td class="line">  <span class='keyword'>while</span> (tx[nx - 1] == zero) nx--; <span class='comment'>/* skip zero term */</span></td></tr>
<tr class="codeline" data-linenumber="263"><td class="num" id="LN263">263</td><td class="line">  n = __kernel_rem_pio2(tx, y, e0, nx, 2, two_over_pi);</td></tr>
<tr class="codeline" data-linenumber="264"><td class="num" id="LN264">264</td><td class="line">  <span class='keyword'>if</span> (hx &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="265"><td class="num" id="LN265">265</td><td class="line">    y[0] = -y[0];</td></tr>
<tr class="codeline" data-linenumber="266"><td class="num" id="LN266">266</td><td class="line">    y[1] = -y[1];</td></tr>
<tr class="codeline" data-linenumber="267"><td class="num" id="LN267">267</td><td class="line">    <span class='keyword'>return</span> -n;</td></tr>
<tr class="codeline" data-linenumber="268"><td class="num" id="LN268">268</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="269"><td class="num" id="LN269">269</td><td class="line">  <span class='keyword'>return</span> n;</td></tr>
<tr class="codeline" data-linenumber="270"><td class="num" id="LN270">270</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="271"><td class="num" id="LN271">271</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="272"><td class="num" id="LN272">272</td><td class="line"><span class='comment'>/* __kernel_cos( x,  y )</span></td></tr>
<tr class="codeline" data-linenumber="273"><td class="num" id="LN273">273</td><td class="line"> <span class='comment'>* kernel cos function on [-pi/4, pi/4], pi/4 ~ 0.785398164</span></td></tr>
<tr class="codeline" data-linenumber="274"><td class="num" id="LN274">274</td><td class="line"> <span class='comment'>* Input x is assumed to be bounded by ~pi/4 in magnitude.</span></td></tr>
<tr class="codeline" data-linenumber="275"><td class="num" id="LN275">275</td><td class="line"> <span class='comment'>* Input y is the tail of x.</span></td></tr>
<tr class="codeline" data-linenumber="276"><td class="num" id="LN276">276</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="277"><td class="num" id="LN277">277</td><td class="line"> <span class='comment'>* Algorithm</span></td></tr>
<tr class="codeline" data-linenumber="278"><td class="num" id="LN278">278</td><td class="line"> <span class='comment'>*      1. Since cos(-x) = cos(x), we need only to consider positive x.</span></td></tr>
<tr class="codeline" data-linenumber="279"><td class="num" id="LN279">279</td><td class="line"> <span class='comment'>*      2. if x &lt; 2^-27 (hx&lt;0x3E400000 0), return 1 with inexact if x!=0.</span></td></tr>
<tr class="codeline" data-linenumber="280"><td class="num" id="LN280">280</td><td class="line"> <span class='comment'>*      3. cos(x) is approximated by a polynomial of degree 14 on</span></td></tr>
<tr class="codeline" data-linenumber="281"><td class="num" id="LN281">281</td><td class="line"> <span class='comment'>*         [0,pi/4]</span></td></tr>
<tr class="codeline" data-linenumber="282"><td class="num" id="LN282">282</td><td class="line"> <span class='comment'>*                                       4            14</span></td></tr>
<tr class="codeline" data-linenumber="283"><td class="num" id="LN283">283</td><td class="line"> <span class='comment'>*              cos(x) ~ 1 - x*x/2 + C1*x + ... + C6*x</span></td></tr>
<tr class="codeline" data-linenumber="284"><td class="num" id="LN284">284</td><td class="line"> <span class='comment'>*         where the remez error is</span></td></tr>
<tr class="codeline" data-linenumber="285"><td class="num" id="LN285">285</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="286"><td class="num" id="LN286">286</td><td class="line"> <span class='comment'>*      |              2     4     6     8     10    12     14 |     -58</span></td></tr>
<tr class="codeline" data-linenumber="287"><td class="num" id="LN287">287</td><td class="line"> <span class='comment'>*      |cos(x)-(1-.5*x +C1*x +C2*x +C3*x +C4*x +C5*x  +C6*x  )| &lt;= 2</span></td></tr>
<tr class="codeline" data-linenumber="288"><td class="num" id="LN288">288</td><td class="line"> <span class='comment'>*      |                                                      |</span></td></tr>
<tr class="codeline" data-linenumber="289"><td class="num" id="LN289">289</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="290"><td class="num" id="LN290">290</td><td class="line"> <span class='comment'>*                     4     6     8     10    12     14</span></td></tr>
<tr class="codeline" data-linenumber="291"><td class="num" id="LN291">291</td><td class="line"> <span class='comment'>*      4. let r = C1*x +C2*x +C3*x +C4*x +C5*x  +C6*x  , then</span></td></tr>
<tr class="codeline" data-linenumber="292"><td class="num" id="LN292">292</td><td class="line"> <span class='comment'>*             cos(x) = 1 - x*x/2 + r</span></td></tr>
<tr class="codeline" data-linenumber="293"><td class="num" id="LN293">293</td><td class="line"> <span class='comment'>*         since cos(x+y) ~ cos(x) - sin(x)*y</span></td></tr>
<tr class="codeline" data-linenumber="294"><td class="num" id="LN294">294</td><td class="line"> <span class='comment'>*                        ~ cos(x) - x*y,</span></td></tr>
<tr class="codeline" data-linenumber="295"><td class="num" id="LN295">295</td><td class="line"> <span class='comment'>*         a correction term is necessary in cos(x) and hence</span></td></tr>
<tr class="codeline" data-linenumber="296"><td class="num" id="LN296">296</td><td class="line"> <span class='comment'>*              cos(x+y) = 1 - (x*x/2 - (r - x*y))</span></td></tr>
<tr class="codeline" data-linenumber="297"><td class="num" id="LN297">297</td><td class="line"> <span class='comment'>*         For better accuracy when x &gt; 0.3, let qx = |x|/4 with</span></td></tr>
<tr class="codeline" data-linenumber="298"><td class="num" id="LN298">298</td><td class="line"> <span class='comment'>*         the last 32 bits mask off, and if x &gt; 0.78125, let qx = 0.28125.</span></td></tr>
<tr class="codeline" data-linenumber="299"><td class="num" id="LN299">299</td><td class="line"> <span class='comment'>*         Then</span></td></tr>
<tr class="codeline" data-linenumber="300"><td class="num" id="LN300">300</td><td class="line"> <span class='comment'>*              cos(x+y) = (1-qx) - ((x*x/2-qx) - (r-x*y)).</span></td></tr>
<tr class="codeline" data-linenumber="301"><td class="num" id="LN301">301</td><td class="line"> <span class='comment'>*         Note that 1-qx and (x*x/2-qx) is EXACT here, and the</span></td></tr>
<tr class="codeline" data-linenumber="302"><td class="num" id="LN302">302</td><td class="line"> <span class='comment'>*         magnitude of the latter is at least a quarter of x*x/2,</span></td></tr>
<tr class="codeline" data-linenumber="303"><td class="num" id="LN303">303</td><td class="line"> <span class='comment'>*         thus, reducing the rounding error in the subtraction.</span></td></tr>
<tr class="codeline" data-linenumber="304"><td class="num" id="LN304">304</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="305"><td class="num" id="LN305">305</td><td class="line"><span class='macro'>V8_INLINE<span class='macro_popup'>inline __attribute__((always_inline))</span></span> <span class='keyword'>double</span> __kernel_cos(<span class='keyword'>double</span> x, <span class='keyword'>double</span> y) {</td></tr>
<tr class="codeline" data-linenumber="306"><td class="num" id="LN306">306</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="307"><td class="num" id="LN307">307</td><td class="line">      one = 1.00000000000000000000e+00, <span class='comment'>/* 0x3FF00000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="308"><td class="num" id="LN308">308</td><td class="line">      C1 = 4.16666666666666019037e-02,  <span class='comment'>/* 0x3FA55555, 0x5555554C */</span></td></tr>
<tr class="codeline" data-linenumber="309"><td class="num" id="LN309">309</td><td class="line">      C2 = -1.38888888888741095749e-03, <span class='comment'>/* 0xBF56C16C, 0x16C15177 */</span></td></tr>
<tr class="codeline" data-linenumber="310"><td class="num" id="LN310">310</td><td class="line">      C3 = 2.48015872894767294178e-05,  <span class='comment'>/* 0x3EFA01A0, 0x19CB1590 */</span></td></tr>
<tr class="codeline" data-linenumber="311"><td class="num" id="LN311">311</td><td class="line">      C4 = -2.75573143513906633035e-07, <span class='comment'>/* 0xBE927E4F, 0x809C52AD */</span></td></tr>
<tr class="codeline" data-linenumber="312"><td class="num" id="LN312">312</td><td class="line">      C5 = 2.08757232129817482790e-09,  <span class='comment'>/* 0x3E21EE9E, 0xBDB4B1C4 */</span></td></tr>
<tr class="codeline" data-linenumber="313"><td class="num" id="LN313">313</td><td class="line">      C6 = -1.13596475577881948265e-11; <span class='comment'>/* 0xBDA8FAE9, 0xBE8838D4 */</span></td></tr>
<tr class="codeline" data-linenumber="314"><td class="num" id="LN314">314</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="315"><td class="num" id="LN315">315</td><td class="line">  <span class='keyword'>double</span> a, iz, z, r, qx;</td></tr>
<tr class="codeline" data-linenumber="316"><td class="num" id="LN316">316</td><td class="line">  int32_t ix;</td></tr>
<tr class="codeline" data-linenumber="317"><td class="num" id="LN317">317</td><td class="line">  GET_HIGH_WORD(ix, x);</td></tr>
<tr class="codeline" data-linenumber="318"><td class="num" id="LN318">318</td><td class="line">  ix &amp;= 0x7FFFFFFF;                           <span class='comment'>/* ix = |x|'s high word*/</span></td></tr>
<tr class="codeline" data-linenumber="319"><td class="num" id="LN319">319</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x3E400000) {                      <span class='comment'>/* if x &lt; 2**27 */</span></td></tr>
<tr class="codeline" data-linenumber="320"><td class="num" id="LN320">320</td><td class="line">    <span class='keyword'>if</span> (<span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(x) == 0) <span class='keyword'>return</span> one; <span class='comment'>/* generate inexact */</span></td></tr>
<tr class="codeline" data-linenumber="321"><td class="num" id="LN321">321</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="322"><td class="num" id="LN322">322</td><td class="line">  z = x * x;</td></tr>
<tr class="codeline" data-linenumber="323"><td class="num" id="LN323">323</td><td class="line">  r = z * (C1 + z * (C2 + z * (C3 + z * (C4 + z * (C5 + z * C6)))));</td></tr>
<tr class="codeline" data-linenumber="324"><td class="num" id="LN324">324</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x3FD33333) { <span class='comment'>/* if |x| &lt; 0.3 */</span></td></tr>
<tr class="codeline" data-linenumber="325"><td class="num" id="LN325">325</td><td class="line">    <span class='keyword'>return</span> one - (0.5 * z - (z * r - x * y));</td></tr>
<tr class="codeline" data-linenumber="326"><td class="num" id="LN326">326</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="327"><td class="num" id="LN327">327</td><td class="line">    <span class='keyword'>if</span> (ix &gt; 0x3FE90000) { <span class='comment'>/* x &gt; 0.78125 */</span></td></tr>
<tr class="codeline" data-linenumber="328"><td class="num" id="LN328">328</td><td class="line">      qx = 0.28125;</td></tr>
<tr class="codeline" data-linenumber="329"><td class="num" id="LN329">329</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="330"><td class="num" id="LN330">330</td><td class="line">      INSERT_WORDS(qx, ix - 0x00200000, 0); <span class='comment'>/* x/4 */</span></td></tr>
<tr class="codeline" data-linenumber="331"><td class="num" id="LN331">331</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="332"><td class="num" id="LN332">332</td><td class="line">    iz = 0.5 * z - qx;</td></tr>
<tr class="codeline" data-linenumber="333"><td class="num" id="LN333">333</td><td class="line">    a = one - qx;</td></tr>
<tr class="codeline" data-linenumber="334"><td class="num" id="LN334">334</td><td class="line">    <span class='keyword'>return</span> a - (iz - (z * r - x * y));</td></tr>
<tr class="codeline" data-linenumber="335"><td class="num" id="LN335">335</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="336"><td class="num" id="LN336">336</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="337"><td class="num" id="LN337">337</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="338"><td class="num" id="LN338">338</td><td class="line"><span class='comment'>/* __kernel_rem_pio2(x,y,e0,nx,prec,ipio2)</span></td></tr>
<tr class="codeline" data-linenumber="339"><td class="num" id="LN339">339</td><td class="line"> <span class='comment'>* double x[],y[]; int e0,nx,prec; int ipio2[];</span></td></tr>
<tr class="codeline" data-linenumber="340"><td class="num" id="LN340">340</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="341"><td class="num" id="LN341">341</td><td class="line"> <span class='comment'>* __kernel_rem_pio2 return the last three digits of N with</span></td></tr>
<tr class="codeline" data-linenumber="342"><td class="num" id="LN342">342</td><td class="line"> <span class='comment'>*              y = x - N*pi/2</span></td></tr>
<tr class="codeline" data-linenumber="343"><td class="num" id="LN343">343</td><td class="line"> <span class='comment'>* so that |y| &lt; pi/2.</span></td></tr>
<tr class="codeline" data-linenumber="344"><td class="num" id="LN344">344</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="345"><td class="num" id="LN345">345</td><td class="line"> <span class='comment'>* The method is to compute the integer (mod 8) and fraction parts of</span></td></tr>
<tr class="codeline" data-linenumber="346"><td class="num" id="LN346">346</td><td class="line"> <span class='comment'>* (2/pi)*x without doing the full multiplication. In general we</span></td></tr>
<tr class="codeline" data-linenumber="347"><td class="num" id="LN347">347</td><td class="line"> <span class='comment'>* skip the part of the product that are known to be a huge integer (</span></td></tr>
<tr class="codeline" data-linenumber="348"><td class="num" id="LN348">348</td><td class="line"> <span class='comment'>* more accurately, = 0 mod 8 ). Thus the number of operations are</span></td></tr>
<tr class="codeline" data-linenumber="349"><td class="num" id="LN349">349</td><td class="line"> <span class='comment'>* independent of the exponent of the input.</span></td></tr>
<tr class="codeline" data-linenumber="350"><td class="num" id="LN350">350</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="351"><td class="num" id="LN351">351</td><td class="line"> <span class='comment'>* (2/pi) is represented by an array of 24-bit integers in ipio2[].</span></td></tr>
<tr class="codeline" data-linenumber="352"><td class="num" id="LN352">352</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="353"><td class="num" id="LN353">353</td><td class="line"> <span class='comment'>* Input parameters:</span></td></tr>
<tr class="codeline" data-linenumber="354"><td class="num" id="LN354">354</td><td class="line"> <span class='comment'>*      x[]     The input value (must be positive) is broken into nx</span></td></tr>
<tr class="codeline" data-linenumber="355"><td class="num" id="LN355">355</td><td class="line"> <span class='comment'>*              pieces of 24-bit integers in double precision format.</span></td></tr>
<tr class="codeline" data-linenumber="356"><td class="num" id="LN356">356</td><td class="line"> <span class='comment'>*              x[i] will be the i-th 24 bit of x. The scaled exponent</span></td></tr>
<tr class="codeline" data-linenumber="357"><td class="num" id="LN357">357</td><td class="line"> <span class='comment'>*              of x[0] is given in input parameter e0 (i.e., x[0]*2^e0</span></td></tr>
<tr class="codeline" data-linenumber="358"><td class="num" id="LN358">358</td><td class="line"> <span class='comment'>*              match x's up to 24 bits.</span></td></tr>
<tr class="codeline" data-linenumber="359"><td class="num" id="LN359">359</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="360"><td class="num" id="LN360">360</td><td class="line"> <span class='comment'>*              Example of breaking a double positive z into x[0]+x[1]+x[2]:</span></td></tr>
<tr class="codeline" data-linenumber="361"><td class="num" id="LN361">361</td><td class="line"> <span class='comment'>*                      e0 = ilogb(z)-23</span></td></tr>
<tr class="codeline" data-linenumber="362"><td class="num" id="LN362">362</td><td class="line"> <span class='comment'>*                      z  = scalbn(z,-e0)</span></td></tr>
<tr class="codeline" data-linenumber="363"><td class="num" id="LN363">363</td><td class="line"> <span class='comment'>*              for i = 0,1,2</span></td></tr>
<tr class="codeline" data-linenumber="364"><td class="num" id="LN364">364</td><td class="line"> <span class='comment'>*                      x[i] = floor(z)</span></td></tr>
<tr class="codeline" data-linenumber="365"><td class="num" id="LN365">365</td><td class="line"> <span class='comment'>*                      z    = (z-x[i])*2**24</span></td></tr>
<tr class="codeline" data-linenumber="366"><td class="num" id="LN366">366</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="367"><td class="num" id="LN367">367</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="368"><td class="num" id="LN368">368</td><td class="line"> <span class='comment'>*      y[]     output result in an array of double precision numbers.</span></td></tr>
<tr class="codeline" data-linenumber="369"><td class="num" id="LN369">369</td><td class="line"> <span class='comment'>*              The dimension of y[] is:</span></td></tr>
<tr class="codeline" data-linenumber="370"><td class="num" id="LN370">370</td><td class="line"> <span class='comment'>*                      24-bit  precision       1</span></td></tr>
<tr class="codeline" data-linenumber="371"><td class="num" id="LN371">371</td><td class="line"> <span class='comment'>*                      53-bit  precision       2</span></td></tr>
<tr class="codeline" data-linenumber="372"><td class="num" id="LN372">372</td><td class="line"> <span class='comment'>*                      64-bit  precision       2</span></td></tr>
<tr class="codeline" data-linenumber="373"><td class="num" id="LN373">373</td><td class="line"> <span class='comment'>*                      113-bit precision       3</span></td></tr>
<tr class="codeline" data-linenumber="374"><td class="num" id="LN374">374</td><td class="line"> <span class='comment'>*              The actual value is the sum of them. Thus for 113-bit</span></td></tr>
<tr class="codeline" data-linenumber="375"><td class="num" id="LN375">375</td><td class="line"> <span class='comment'>*              precison, one may have to do something like:</span></td></tr>
<tr class="codeline" data-linenumber="376"><td class="num" id="LN376">376</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="377"><td class="num" id="LN377">377</td><td class="line"> <span class='comment'>*              long double t,w,r_head, r_tail;</span></td></tr>
<tr class="codeline" data-linenumber="378"><td class="num" id="LN378">378</td><td class="line"> <span class='comment'>*              t = (long double)y[2] + (long double)y[1];</span></td></tr>
<tr class="codeline" data-linenumber="379"><td class="num" id="LN379">379</td><td class="line"> <span class='comment'>*              w = (long double)y[0];</span></td></tr>
<tr class="codeline" data-linenumber="380"><td class="num" id="LN380">380</td><td class="line"> <span class='comment'>*              r_head = t+w;</span></td></tr>
<tr class="codeline" data-linenumber="381"><td class="num" id="LN381">381</td><td class="line"> <span class='comment'>*              r_tail = w - (r_head - t);</span></td></tr>
<tr class="codeline" data-linenumber="382"><td class="num" id="LN382">382</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="383"><td class="num" id="LN383">383</td><td class="line"> <span class='comment'>*      e0      The exponent of x[0]</span></td></tr>
<tr class="codeline" data-linenumber="384"><td class="num" id="LN384">384</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="385"><td class="num" id="LN385">385</td><td class="line"> <span class='comment'>*      nx      dimension of x[]</span></td></tr>
<tr class="codeline" data-linenumber="386"><td class="num" id="LN386">386</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="387"><td class="num" id="LN387">387</td><td class="line"> <span class='comment'>*      prec    an integer indicating the precision:</span></td></tr>
<tr class="codeline" data-linenumber="388"><td class="num" id="LN388">388</td><td class="line"> <span class='comment'>*                      0       24  bits (single)</span></td></tr>
<tr class="codeline" data-linenumber="389"><td class="num" id="LN389">389</td><td class="line"> <span class='comment'>*                      1       53  bits (double)</span></td></tr>
<tr class="codeline" data-linenumber="390"><td class="num" id="LN390">390</td><td class="line"> <span class='comment'>*                      2       64  bits (extended)</span></td></tr>
<tr class="codeline" data-linenumber="391"><td class="num" id="LN391">391</td><td class="line"> <span class='comment'>*                      3       113 bits (quad)</span></td></tr>
<tr class="codeline" data-linenumber="392"><td class="num" id="LN392">392</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="393"><td class="num" id="LN393">393</td><td class="line"> <span class='comment'>*      ipio2[]</span></td></tr>
<tr class="codeline" data-linenumber="394"><td class="num" id="LN394">394</td><td class="line"> <span class='comment'>*              integer array, contains the (24*i)-th to (24*i+23)-th</span></td></tr>
<tr class="codeline" data-linenumber="395"><td class="num" id="LN395">395</td><td class="line"> <span class='comment'>*              bit of 2/pi after binary point. The corresponding</span></td></tr>
<tr class="codeline" data-linenumber="396"><td class="num" id="LN396">396</td><td class="line"> <span class='comment'>*              floating value is</span></td></tr>
<tr class="codeline" data-linenumber="397"><td class="num" id="LN397">397</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="398"><td class="num" id="LN398">398</td><td class="line"> <span class='comment'>*                      ipio2[i] * 2^(-24(i+1)).</span></td></tr>
<tr class="codeline" data-linenumber="399"><td class="num" id="LN399">399</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="400"><td class="num" id="LN400">400</td><td class="line"> <span class='comment'>* External function:</span></td></tr>
<tr class="codeline" data-linenumber="401"><td class="num" id="LN401">401</td><td class="line"> <span class='comment'>*      double scalbn(), floor();</span></td></tr>
<tr class="codeline" data-linenumber="402"><td class="num" id="LN402">402</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="403"><td class="num" id="LN403">403</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="404"><td class="num" id="LN404">404</td><td class="line"> <span class='comment'>* Here is the description of some local variables:</span></td></tr>
<tr class="codeline" data-linenumber="405"><td class="num" id="LN405">405</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="406"><td class="num" id="LN406">406</td><td class="line"> <span class='comment'>*      jk      jk+1 is the initial number of terms of ipio2[] needed</span></td></tr>
<tr class="codeline" data-linenumber="407"><td class="num" id="LN407">407</td><td class="line"> <span class='comment'>*              in the computation. The recommended value is 2,3,4,</span></td></tr>
<tr class="codeline" data-linenumber="408"><td class="num" id="LN408">408</td><td class="line"> <span class='comment'>*              6 for single, double, extended,and quad.</span></td></tr>
<tr class="codeline" data-linenumber="409"><td class="num" id="LN409">409</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="410"><td class="num" id="LN410">410</td><td class="line"> <span class='comment'>*      jz      local integer variable indicating the number of</span></td></tr>
<tr class="codeline" data-linenumber="411"><td class="num" id="LN411">411</td><td class="line"> <span class='comment'>*              terms of ipio2[] used.</span></td></tr>
<tr class="codeline" data-linenumber="412"><td class="num" id="LN412">412</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="413"><td class="num" id="LN413">413</td><td class="line"> <span class='comment'>*      jx      nx - 1</span></td></tr>
<tr class="codeline" data-linenumber="414"><td class="num" id="LN414">414</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="415"><td class="num" id="LN415">415</td><td class="line"> <span class='comment'>*      jv      index for pointing to the suitable ipio2[] for the</span></td></tr>
<tr class="codeline" data-linenumber="416"><td class="num" id="LN416">416</td><td class="line"> <span class='comment'>*              computation. In general, we want</span></td></tr>
<tr class="codeline" data-linenumber="417"><td class="num" id="LN417">417</td><td class="line"> <span class='comment'>*                      ( 2^e0*x[0] * ipio2[jv-1]*2^(-24jv) )/8</span></td></tr>
<tr class="codeline" data-linenumber="418"><td class="num" id="LN418">418</td><td class="line"> <span class='comment'>*              is an integer. Thus</span></td></tr>
<tr class="codeline" data-linenumber="419"><td class="num" id="LN419">419</td><td class="line"> <span class='comment'>*                      e0-3-24*jv &gt;= 0 or (e0-3)/24 &gt;= jv</span></td></tr>
<tr class="codeline" data-linenumber="420"><td class="num" id="LN420">420</td><td class="line"> <span class='comment'>*              Hence jv = max(0,(e0-3)/24).</span></td></tr>
<tr class="codeline" data-linenumber="421"><td class="num" id="LN421">421</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="422"><td class="num" id="LN422">422</td><td class="line"> <span class='comment'>*      jp      jp+1 is the number of terms in PIo2[] needed, jp = jk.</span></td></tr>
<tr class="codeline" data-linenumber="423"><td class="num" id="LN423">423</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="424"><td class="num" id="LN424">424</td><td class="line"> <span class='comment'>*      q[]     double array with integral value, representing the</span></td></tr>
<tr class="codeline" data-linenumber="425"><td class="num" id="LN425">425</td><td class="line"> <span class='comment'>*              24-bits chunk of the product of x and 2/pi.</span></td></tr>
<tr class="codeline" data-linenumber="426"><td class="num" id="LN426">426</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="427"><td class="num" id="LN427">427</td><td class="line"> <span class='comment'>*      q0      the corresponding exponent of q[0]. Note that the</span></td></tr>
<tr class="codeline" data-linenumber="428"><td class="num" id="LN428">428</td><td class="line"> <span class='comment'>*              exponent for q[i] would be q0-24*i.</span></td></tr>
<tr class="codeline" data-linenumber="429"><td class="num" id="LN429">429</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="430"><td class="num" id="LN430">430</td><td class="line"> <span class='comment'>*      PIo2[]  double precision array, obtained by cutting pi/2</span></td></tr>
<tr class="codeline" data-linenumber="431"><td class="num" id="LN431">431</td><td class="line"> <span class='comment'>*              into 24 bits chunks.</span></td></tr>
<tr class="codeline" data-linenumber="432"><td class="num" id="LN432">432</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="433"><td class="num" id="LN433">433</td><td class="line"> <span class='comment'>*      f[]     ipio2[] in floating point</span></td></tr>
<tr class="codeline" data-linenumber="434"><td class="num" id="LN434">434</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="435"><td class="num" id="LN435">435</td><td class="line"> <span class='comment'>*      iq[]    integer array by breaking up q[] in 24-bits chunk.</span></td></tr>
<tr class="codeline" data-linenumber="436"><td class="num" id="LN436">436</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="437"><td class="num" id="LN437">437</td><td class="line"> <span class='comment'>*      fq[]    final product of x*(2/pi) in fq[0],..,fq[jk]</span></td></tr>
<tr class="codeline" data-linenumber="438"><td class="num" id="LN438">438</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="439"><td class="num" id="LN439">439</td><td class="line"> <span class='comment'>*      ih      integer. If &gt;0 it indicates q[] is &gt;= 0.5, hence</span></td></tr>
<tr class="codeline" data-linenumber="440"><td class="num" id="LN440">440</td><td class="line"> <span class='comment'>*              it also indicates the *sign* of the result.</span></td></tr>
<tr class="codeline" data-linenumber="441"><td class="num" id="LN441">441</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="442"><td class="num" id="LN442">442</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="443"><td class="num" id="LN443">443</td><td class="line"><span class='keyword'>int</span> __kernel_rem_pio2(<span class='keyword'>double</span> *x, <span class='keyword'>double</span> *y, <span class='keyword'>int</span> e0, <span class='keyword'>int</span> nx, <span class='keyword'>int</span> prec,</td></tr>
<tr class="codeline" data-linenumber="444"><td class="num" id="LN444">444</td><td class="line">                      <span class='keyword'>const</span> int32_t *ipio2) {</td></tr>
<tr class="codeline" data-linenumber="445"><td class="num" id="LN445">445</td><td class="line">  <span class='comment'>/* Constants:</span></td></tr>
<tr class="codeline" data-linenumber="446"><td class="num" id="LN446">446</td><td class="line">   <span class='comment'>* The hexadecimal values are the intended ones for the following</span></td></tr>
<tr class="codeline" data-linenumber="447"><td class="num" id="LN447">447</td><td class="line">   <span class='comment'>* constants. The decimal values may be used, provided that the</span></td></tr>
<tr class="codeline" data-linenumber="448"><td class="num" id="LN448">448</td><td class="line">   <span class='comment'>* compiler will convert from decimal to binary accurately enough</span></td></tr>
<tr class="codeline" data-linenumber="449"><td class="num" id="LN449">449</td><td class="line">   <span class='comment'>* to produce the hexadecimal values shown.</span></td></tr>
<tr class="codeline" data-linenumber="450"><td class="num" id="LN450">450</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="451"><td class="num" id="LN451">451</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>int</span> init_jk[] = {2, 3, 4, 6}; <span class='comment'>/* initial value for jk */</span></td></tr>
<tr class="codeline" data-linenumber="452"><td class="num" id="LN452">452</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="453"><td class="num" id="LN453">453</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> PIo2[] = {</td></tr>
<tr class="codeline" data-linenumber="454"><td class="num" id="LN454">454</td><td class="line">      1.57079625129699707031e+00, <span class='comment'>/* 0x3FF921FB, 0x40000000 */</span></td></tr>
<tr class="codeline" data-linenumber="455"><td class="num" id="LN455">455</td><td class="line">      7.54978941586159635335e-08, <span class='comment'>/* 0x3E74442D, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="456"><td class="num" id="LN456">456</td><td class="line">      5.39030252995776476554e-15, <span class='comment'>/* 0x3CF84698, 0x80000000 */</span></td></tr>
<tr class="codeline" data-linenumber="457"><td class="num" id="LN457">457</td><td class="line">      3.28200341580791294123e-22, <span class='comment'>/* 0x3B78CC51, 0x60000000 */</span></td></tr>
<tr class="codeline" data-linenumber="458"><td class="num" id="LN458">458</td><td class="line">      1.27065575308067607349e-29, <span class='comment'>/* 0x39F01B83, 0x80000000 */</span></td></tr>
<tr class="codeline" data-linenumber="459"><td class="num" id="LN459">459</td><td class="line">      1.22933308981111328932e-36, <span class='comment'>/* 0x387A2520, 0x40000000 */</span></td></tr>
<tr class="codeline" data-linenumber="460"><td class="num" id="LN460">460</td><td class="line">      2.73370053816464559624e-44, <span class='comment'>/* 0x36E38222, 0x80000000 */</span></td></tr>
<tr class="codeline" data-linenumber="461"><td class="num" id="LN461">461</td><td class="line">      2.16741683877804819444e-51, <span class='comment'>/* 0x3569F31D, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="462"><td class="num" id="LN462">462</td><td class="line">  };</td></tr>
<tr class="codeline" data-linenumber="463"><td class="num" id="LN463">463</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="464"><td class="num" id="LN464">464</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="465"><td class="num" id="LN465">465</td><td class="line">      zero = 0.0,</td></tr>
<tr class="codeline" data-linenumber="466"><td class="num" id="LN466">466</td><td class="line">      one = 1.0,</td></tr>
<tr class="codeline" data-linenumber="467"><td class="num" id="LN467">467</td><td class="line">      two24 = 1.67772160000000000000e+07,  <span class='comment'>/* 0x41700000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="468"><td class="num" id="LN468">468</td><td class="line">      twon24 = 5.96046447753906250000e-08; <span class='comment'>/* 0x3E700000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="469"><td class="num" id="LN469">469</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="470"><td class="num" id="LN470">470</td><td class="line">  int32_t jz, jx, jv, jp, jk, carry, n, iq[20], i, j, k, m, q0, ih;</td></tr>
<tr class="codeline" data-linenumber="471"><td class="num" id="LN471">471</td><td class="line">  <span class='keyword'>double</span> z, fw, f[20], fq[20], q[20];</td></tr>
<tr class="codeline" data-linenumber="472"><td class="num" id="LN472">472</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="473"><td class="num" id="LN473">473</td><td class="line">  <span class='comment'>/* initialize jk*/</span></td></tr>
<tr class="codeline" data-linenumber="474"><td class="num" id="LN474">474</td><td class="line">  jk = init_jk[prec];</td></tr>
<tr class="codeline" data-linenumber="475"><td class="num" id="LN475">475</td><td class="line">  jp = jk;</td></tr>
<tr class="codeline" data-linenumber="476"><td class="num" id="LN476">476</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="477"><td class="num" id="LN477">477</td><td class="line">  <span class='comment'>/* determine jx,jv,q0, note that 3&gt;q0 */</span></td></tr>
<tr class="codeline" data-linenumber="478"><td class="num" id="LN478">478</td><td class="line">  jx = nx - 1;</td></tr>
<tr class="codeline" data-linenumber="479"><td class="num" id="LN479">479</td><td class="line">  jv = (e0 - 3) / 24;</td></tr>
<tr class="codeline" data-linenumber="480"><td class="num" id="LN480">480</td><td class="line">  <span class='keyword'>if</span> (<span class="mrange">jv &lt; 0</span>) jv = 0;</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path1" class="msg msgEvent" style="margin-left:7ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">1</div></td><td>Assuming 'jv' is &gt;= 0</td><td><div class="PathNav"><a href="#Path2" title="Next event (2)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path2" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">2</div></td><td><div class="PathNav"><a href="#Path1" title="Previous event (1)">&#x2190;</a></div></td><td>Taking false branch</td><td><div class="PathNav"><a href="#Path3" title="Next event (3)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="481"><td class="num" id="LN481">481</td><td class="line">  q0 = e0 - 24 * (jv + 1);</td></tr>
<tr class="codeline" data-linenumber="482"><td class="num" id="LN482">482</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="483"><td class="num" id="LN483">483</td><td class="line">  <span class='comment'>/* set up f[0] to f[jx+jk] where f[jx+jk] = ipio2[jv+jk] */</span></td></tr>
<tr class="codeline" data-linenumber="484"><td class="num" id="LN484">484</td><td class="line">  j = jv - jx;</td></tr>
<tr class="codeline" data-linenumber="485"><td class="num" id="LN485">485</td><td class="line">  m = jx + jk;</td></tr>
<tr class="codeline" data-linenumber="486"><td class="num" id="LN486">486</td><td class="line">  <span class='keyword'>for</span> (i = 0; <span class="mrange">i &lt;= m</span>; i++, j++) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path3" class="msg msgEvent" style="margin-left:15ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">3</div></td><td><div class="PathNav"><a href="#Path2" title="Previous event (2)">&#x2190;</a></div></td><td>Assuming 'i' is &gt; 'm'</td><td><div class="PathNav"><a href="#Path4" title="Next event (4)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path4" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">4</div></td><td><div class="PathNav"><a href="#Path3" title="Previous event (3)">&#x2190;</a></div></td><td>Loop condition is false. Execution continues on line 491</td><td><div class="PathNav"><a href="#Path5" title="Next event (5)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="487"><td class="num" id="LN487">487</td><td class="line">    f[i] = (j &lt; 0) ? zero : <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(ipio2[j]);</td></tr>
<tr class="codeline" data-linenumber="488"><td class="num" id="LN488">488</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="489"><td class="num" id="LN489">489</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="490"><td class="num" id="LN490">490</td><td class="line">  <span class='comment'>/* compute q[0],q[1],...q[jk] */</span></td></tr>
<tr class="codeline" data-linenumber="491"><td class="num" id="LN491">491</td><td class="line">  <span class='keyword'>for</span> (i = 0; <span class="mrange">i &lt;= jk</span>; i++) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path5" class="msg msgEvent" style="margin-left:15ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">5</div></td><td><div class="PathNav"><a href="#Path4" title="Previous event (4)">&#x2190;</a></div></td><td>Assuming 'i' is &gt; 'jk'</td><td><div class="PathNav"><a href="#Path6" title="Next event (6)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path6" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">6</div></td><td><div class="PathNav"><a href="#Path5" title="Previous event (5)">&#x2190;</a></div></td><td>Loop condition is false. Execution continues on line 496</td><td><div class="PathNav"><a href="#Path7" title="Next event (7)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="492"><td class="num" id="LN492">492</td><td class="line">    <span class='keyword'>for</span> (j = 0, fw = 0.0; j &lt;= jx; j++) fw += x[j] * f[jx + i - j];</td></tr>
<tr class="codeline" data-linenumber="493"><td class="num" id="LN493">493</td><td class="line">    q[i] = fw;</td></tr>
<tr class="codeline" data-linenumber="494"><td class="num" id="LN494">494</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="495"><td class="num" id="LN495">495</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="496"><td class="num" id="LN496">496</td><td class="line">  jz = jk;</td></tr>
<tr class="codeline" data-linenumber="497"><td class="num" id="LN497">497</td><td class="line">recompute:</td></tr>
<tr class="codeline" data-linenumber="498"><td class="num" id="LN498">498</td><td class="line">  <span class='comment'>/* distill q[] into iq[] reversingly */</span></td></tr>
<tr class="codeline" data-linenumber="499"><td class="num" id="LN499">499</td><td class="line">  <span class='keyword'>for</span> (i = 0, j = jz, z = q[jz]; <span class='variable'>j<table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>6.1</div></td><td>'j' is <= 0</td></tr></tbody></table></span> &gt; 0; i++, j--) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path7" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">7</div></td><td><div class="PathNav"><a href="#Path6" title="Previous event (6)">&#x2190;</a></div></td><td>Loop condition is false. Execution continues on line 506</td><td><div class="PathNav"><a href="#Path8" title="Next event (8)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="500"><td class="num" id="LN500">500</td><td class="line">    fw = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(<span class='keyword'>static_cast</span>&lt;int32_t&gt;(twon24 * z));</td></tr>
<tr class="codeline" data-linenumber="501"><td class="num" id="LN501">501</td><td class="line">    iq[i] = <span class='keyword'>static_cast</span>&lt;int32_t&gt;(z - two24 * fw);</td></tr>
<tr class="codeline" data-linenumber="502"><td class="num" id="LN502">502</td><td class="line">    z = q[j - 1] + fw;</td></tr>
<tr class="codeline" data-linenumber="503"><td class="num" id="LN503">503</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="504"><td class="num" id="LN504">504</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="505"><td class="num" id="LN505">505</td><td class="line">  <span class='comment'>/* compute n */</span></td></tr>
<tr class="codeline" data-linenumber="506"><td class="num" id="LN506">506</td><td class="line">  z = scalbn(z, q0);           <span class='comment'>/* actual value of z */</span></td></tr>
<tr class="codeline" data-linenumber="507"><td class="num" id="LN507">507</td><td class="line">  z -= 8.0 * floor(z * 0.125); <span class='comment'>/* trim off integer &gt;= 8 */</span></td></tr>
<tr class="codeline" data-linenumber="508"><td class="num" id="LN508">508</td><td class="line">  n = <span class='keyword'>static_cast</span>&lt;int32_t&gt;(z);</td></tr>
<tr class="codeline" data-linenumber="509"><td class="num" id="LN509">509</td><td class="line">  z -= <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(n);</td></tr>
<tr class="codeline" data-linenumber="510"><td class="num" id="LN510">510</td><td class="line">  ih = 0;</td></tr>
<tr class="codeline" data-linenumber="511"><td class="num" id="LN511">511</td><td class="line">  <span class='keyword'>if</span> (<span class="mrange">q0 &gt; 0</span>) { <span class='comment'>/* need iq[jz-1] to determine n */</span></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path8" class="msg msgEvent" style="margin-left:7ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">8</div></td><td><div class="PathNav"><a href="#Path7" title="Previous event (7)">&#x2190;</a></div></td><td>Assuming 'q0' is &lt;= 0</td><td><div class="PathNav"><a href="#Path9" title="Next event (9)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path9" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">9</div></td><td><div class="PathNav"><a href="#Path8" title="Previous event (8)">&#x2190;</a></div></td><td>Taking false branch</td><td><div class="PathNav"><a href="#Path10" title="Next event (10)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="512"><td class="num" id="LN512">512</td><td class="line">    i = (iq[jz - 1] &gt;&gt; (24 - q0));</td></tr>
<tr class="codeline" data-linenumber="513"><td class="num" id="LN513">513</td><td class="line">    n += i;</td></tr>
<tr class="codeline" data-linenumber="514"><td class="num" id="LN514">514</td><td class="line">    iq[jz - 1] -= i &lt;&lt; (24 - q0);</td></tr>
<tr class="codeline" data-linenumber="515"><td class="num" id="LN515">515</td><td class="line">    ih = iq[jz - 1] &gt;&gt; (23 - q0);</td></tr>
<tr class="codeline" data-linenumber="516"><td class="num" id="LN516">516</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (<span class="mrange">q0 == 0</span>) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path10" class="msg msgEvent" style="margin-left:14ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">10</div></td><td><div class="PathNav"><a href="#Path9" title="Previous event (9)">&#x2190;</a></div></td><td>Assuming 'q0' is not equal to 0</td><td><div class="PathNav"><a href="#Path11" title="Next event (11)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path11" class="msg msgControl" style="margin-left:10ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">11</div></td><td><div class="PathNav"><a href="#Path10" title="Previous event (10)">&#x2190;</a></div></td><td>Taking false branch</td><td><div class="PathNav"><a href="#Path12" title="Next event (12)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="517"><td class="num" id="LN517">517</td><td class="line">    ih = iq[jz - 1] &gt;&gt; 23;</td></tr>
<tr class="codeline" data-linenumber="518"><td class="num" id="LN518">518</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (<span class="mrange">z &gt;= 0.5</span>) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path12" class="msg msgEvent" style="margin-left:14ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">12</div></td><td><div class="PathNav"><a href="#Path11" title="Previous event (11)">&#x2190;</a></div></td><td>Assuming the condition is false</td><td><div class="PathNav"><a href="#Path13" title="Next event (13)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path13" class="msg msgControl" style="margin-left:10ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">13</div></td><td><div class="PathNav"><a href="#Path12" title="Previous event (12)">&#x2190;</a></div></td><td>Taking false branch</td><td><div class="PathNav"><a href="#Path14" title="Next event (14)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="519"><td class="num" id="LN519">519</td><td class="line">    ih = 2;</td></tr>
<tr class="codeline" data-linenumber="520"><td class="num" id="LN520">520</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="521"><td class="num" id="LN521">521</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="522"><td class="num" id="LN522">522</td><td class="line">  <span class='keyword'>if</span> (<span class='variable'>ih<table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>13.1</div></td><td>'ih' is <= 0</td></tr></tbody></table></span> &gt; 0) { <span class='comment'>/* q &gt; 0.5 */</span></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path14" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">14</div></td><td><div class="PathNav"><a href="#Path13" title="Previous event (13)">&#x2190;</a></div></td><td>Taking false branch</td><td><div class="PathNav"><a href="#Path15" title="Next event (15)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="523"><td class="num" id="LN523">523</td><td class="line">    n += 1;</td></tr>
<tr class="codeline" data-linenumber="524"><td class="num" id="LN524">524</td><td class="line">    carry = 0;</td></tr>
<tr class="codeline" data-linenumber="525"><td class="num" id="LN525">525</td><td class="line">    <span class='keyword'>for</span> (i = 0; i &lt; jz; i++) { <span class='comment'>/* compute 1-q */</span></td></tr>
<tr class="codeline" data-linenumber="526"><td class="num" id="LN526">526</td><td class="line">      j = iq[i];</td></tr>
<tr class="codeline" data-linenumber="527"><td class="num" id="LN527">527</td><td class="line">      <span class='keyword'>if</span> (carry == 0) {</td></tr>
<tr class="codeline" data-linenumber="528"><td class="num" id="LN528">528</td><td class="line">        <span class='keyword'>if</span> (j != 0) {</td></tr>
<tr class="codeline" data-linenumber="529"><td class="num" id="LN529">529</td><td class="line">          carry = 1;</td></tr>
<tr class="codeline" data-linenumber="530"><td class="num" id="LN530">530</td><td class="line">          iq[i] = 0x1000000 - j;</td></tr>
<tr class="codeline" data-linenumber="531"><td class="num" id="LN531">531</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="532"><td class="num" id="LN532">532</td><td class="line">      } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="533"><td class="num" id="LN533">533</td><td class="line">        iq[i] = 0xFFFFFF - j;</td></tr>
<tr class="codeline" data-linenumber="534"><td class="num" id="LN534">534</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="535"><td class="num" id="LN535">535</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="536"><td class="num" id="LN536">536</td><td class="line">    <span class='keyword'>if</span> (q0 &gt; 0) { <span class='comment'>/* rare case: chance is 1 in 12 */</span></td></tr>
<tr class="codeline" data-linenumber="537"><td class="num" id="LN537">537</td><td class="line">      <span class='keyword'>switch</span> (q0) {</td></tr>
<tr class="codeline" data-linenumber="538"><td class="num" id="LN538">538</td><td class="line">        <span class='keyword'>case</span> 1:</td></tr>
<tr class="codeline" data-linenumber="539"><td class="num" id="LN539">539</td><td class="line">          iq[jz - 1] &amp;= 0x7FFFFF;</td></tr>
<tr class="codeline" data-linenumber="540"><td class="num" id="LN540">540</td><td class="line">          <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="541"><td class="num" id="LN541">541</td><td class="line">        <span class='keyword'>case</span> 2:</td></tr>
<tr class="codeline" data-linenumber="542"><td class="num" id="LN542">542</td><td class="line">          iq[jz - 1] &amp;= 0x3FFFFF;</td></tr>
<tr class="codeline" data-linenumber="543"><td class="num" id="LN543">543</td><td class="line">          <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="544"><td class="num" id="LN544">544</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="545"><td class="num" id="LN545">545</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="546"><td class="num" id="LN546">546</td><td class="line">    <span class='keyword'>if</span> (ih == 2) {</td></tr>
<tr class="codeline" data-linenumber="547"><td class="num" id="LN547">547</td><td class="line">      z = one - z;</td></tr>
<tr class="codeline" data-linenumber="548"><td class="num" id="LN548">548</td><td class="line">      <span class='keyword'>if</span> (carry != 0) z -= scalbn(one, q0);</td></tr>
<tr class="codeline" data-linenumber="549"><td class="num" id="LN549">549</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="550"><td class="num" id="LN550">550</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="551"><td class="num" id="LN551">551</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="552"><td class="num" id="LN552">552</td><td class="line">  <span class='comment'>/* check if recomputation is needed */</span></td></tr>
<tr class="codeline" data-linenumber="553"><td class="num" id="LN553">553</td><td class="line">  <span class='keyword'>if</span> (<span class="mrange">z == zero</span>) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path15" class="msg msgEvent" style="margin-left:7ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">15</div></td><td><div class="PathNav"><a href="#Path14" title="Previous event (14)">&#x2190;</a></div></td><td>Assuming 'z' is not equal to 'zero'</td><td><div class="PathNav"><a href="#Path16" title="Next event (16)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path16" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">16</div></td><td><div class="PathNav"><a href="#Path15" title="Previous event (15)">&#x2190;</a></div></td><td>Taking false branch</td><td><div class="PathNav"><a href="#Path17" title="Next event (17)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="554"><td class="num" id="LN554">554</td><td class="line">    j = 0;</td></tr>
<tr class="codeline" data-linenumber="555"><td class="num" id="LN555">555</td><td class="line">    <span class='keyword'>for</span> (i = jz - 1; i &gt;= jk; i--) j |= iq[i];</td></tr>
<tr class="codeline" data-linenumber="556"><td class="num" id="LN556">556</td><td class="line">    <span class='keyword'>if</span> (j == 0) { <span class='comment'>/* need recomputation */</span></td></tr>
<tr class="codeline" data-linenumber="557"><td class="num" id="LN557">557</td><td class="line">      <span class='keyword'>for</span> (k = 1; jk &gt;= k &amp;&amp; iq[jk - k] == 0; k++) {</td></tr>
<tr class="codeline" data-linenumber="558"><td class="num" id="LN558">558</td><td class="line">        <span class='comment'>/* k = no. of terms needed */</span></td></tr>
<tr class="codeline" data-linenumber="559"><td class="num" id="LN559">559</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="560"><td class="num" id="LN560">560</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="561"><td class="num" id="LN561">561</td><td class="line">      <span class='keyword'>for</span> (i = jz + 1; i &lt;= jz + k; i++) { <span class='comment'>/* add q[jz+1] to q[jz+k] */</span></td></tr>
<tr class="codeline" data-linenumber="562"><td class="num" id="LN562">562</td><td class="line">        f[jx + i] = ipio2[jv + i];</td></tr>
<tr class="codeline" data-linenumber="563"><td class="num" id="LN563">563</td><td class="line">        <span class='keyword'>for</span> (j = 0, fw = 0.0; j &lt;= jx; j++) fw += x[j] * f[jx + i - j];</td></tr>
<tr class="codeline" data-linenumber="564"><td class="num" id="LN564">564</td><td class="line">        q[i] = fw;</td></tr>
<tr class="codeline" data-linenumber="565"><td class="num" id="LN565">565</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="566"><td class="num" id="LN566">566</td><td class="line">      jz += k;</td></tr>
<tr class="codeline" data-linenumber="567"><td class="num" id="LN567">567</td><td class="line">      <span class='keyword'>goto</span> recompute;</td></tr>
<tr class="codeline" data-linenumber="568"><td class="num" id="LN568">568</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="569"><td class="num" id="LN569">569</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="570"><td class="num" id="LN570">570</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="571"><td class="num" id="LN571">571</td><td class="line">  <span class='comment'>/* chop off zero terms */</span></td></tr>
<tr class="codeline" data-linenumber="572"><td class="num" id="LN572">572</td><td class="line">  <span class='keyword'>if</span> (<span class="mrange">z == 0.0</span>) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path17" class="msg msgEvent" style="margin-left:7ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">17</div></td><td><div class="PathNav"><a href="#Path16" title="Previous event (16)">&#x2190;</a></div></td><td>Assuming the condition is true</td><td><div class="PathNav"><a href="#Path18" title="Next event (18)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path18" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">18</div></td><td><div class="PathNav"><a href="#Path17" title="Previous event (17)">&#x2190;</a></div></td><td>Taking true branch</td><td><div class="PathNav"><a href="#Path19" title="Next event (19)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="573"><td class="num" id="LN573">573</td><td class="line">    jz -= 1;</td></tr>
<tr class="codeline" data-linenumber="574"><td class="num" id="LN574">574</td><td class="line">    q0 -= 24;</td></tr>
<tr class="codeline" data-linenumber="575"><td class="num" id="LN575">575</td><td class="line">    <span class='keyword'>while</span> (iq[jz] == 0) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path19" class="msg msgControl" style="margin-left:5ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">19</div></td><td><div class="PathNav"><a href="#Path18" title="Previous event (18)">&#x2190;</a></div></td><td>Loop condition is false. Execution continues on line 593</td><td><div class="PathNav"><a href="#Path20" title="Next event (20)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="576"><td class="num" id="LN576">576</td><td class="line">      jz--;</td></tr>
<tr class="codeline" data-linenumber="577"><td class="num" id="LN577">577</td><td class="line">      q0 -= 24;</td></tr>
<tr class="codeline" data-linenumber="578"><td class="num" id="LN578">578</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="579"><td class="num" id="LN579">579</td><td class="line">  } <span class='keyword'>else</span> { <span class='comment'>/* break z into 24-bit if necessary */</span></td></tr>
<tr class="codeline" data-linenumber="580"><td class="num" id="LN580">580</td><td class="line">    z = scalbn(z, -q0);</td></tr>
<tr class="codeline" data-linenumber="581"><td class="num" id="LN581">581</td><td class="line">    <span class='keyword'>if</span> (z &gt;= two24) {</td></tr>
<tr class="codeline" data-linenumber="582"><td class="num" id="LN582">582</td><td class="line">      fw = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(<span class='keyword'>static_cast</span>&lt;int32_t&gt;(twon24 * z));</td></tr>
<tr class="codeline" data-linenumber="583"><td class="num" id="LN583">583</td><td class="line">      iq[jz] = z - two24 * fw;</td></tr>
<tr class="codeline" data-linenumber="584"><td class="num" id="LN584">584</td><td class="line">      jz += 1;</td></tr>
<tr class="codeline" data-linenumber="585"><td class="num" id="LN585">585</td><td class="line">      q0 += 24;</td></tr>
<tr class="codeline" data-linenumber="586"><td class="num" id="LN586">586</td><td class="line">      iq[jz] = fw;</td></tr>
<tr class="codeline" data-linenumber="587"><td class="num" id="LN587">587</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="588"><td class="num" id="LN588">588</td><td class="line">      iq[jz] = z;</td></tr>
<tr class="codeline" data-linenumber="589"><td class="num" id="LN589">589</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="590"><td class="num" id="LN590">590</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="591"><td class="num" id="LN591">591</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="592"><td class="num" id="LN592">592</td><td class="line">  <span class='comment'>/* convert integer "bit" chunk to floating-point value */</span></td></tr>
<tr class="codeline" data-linenumber="593"><td class="num" id="LN593">593</td><td class="line">  fw = scalbn(one, q0);</td></tr>
<tr class="codeline" data-linenumber="594"><td class="num" id="LN594">594</td><td class="line">  <span class='keyword'>for</span> (i = jz; <span class="mrange">i &gt;= 0</span>; i--) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path20" class="msg msgEvent" style="margin-left:16ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">20</div></td><td><div class="PathNav"><a href="#Path19" title="Previous event (19)">&#x2190;</a></div></td><td>Assuming 'i' is &lt; 0</td><td><div class="PathNav"><a href="#Path21" title="Next event (21)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path21" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">21</div></td><td><div class="PathNav"><a href="#Path20" title="Previous event (20)">&#x2190;</a></div></td><td>Loop condition is false. Execution continues on line 600</td><td><div class="PathNav"><a href="#Path22" title="Next event (22)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="595"><td class="num" id="LN595">595</td><td class="line">    q[i] = fw * iq[i];</td></tr>
<tr class="codeline" data-linenumber="596"><td class="num" id="LN596">596</td><td class="line">    fw *= twon24;</td></tr>
<tr class="codeline" data-linenumber="597"><td class="num" id="LN597">597</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="598"><td class="num" id="LN598">598</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="599"><td class="num" id="LN599">599</td><td class="line">  <span class='comment'>/* compute PIo2[0,...,jp]*q[jz,...,0] */</span></td></tr>
<tr class="codeline" data-linenumber="600"><td class="num" id="LN600">600</td><td class="line">  <span class='keyword'>for</span> (i = jz; <span class='variable'>i<table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>21.1</div></td><td>'i' is < 0</td></tr></tbody></table></span> &gt;= 0; i--) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path22" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">22</div></td><td><div class="PathNav"><a href="#Path21" title="Previous event (21)">&#x2190;</a></div></td><td>Loop condition is false. Execution continues on line 606</td><td><div class="PathNav"><a href="#Path23" title="Next event (23)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="601"><td class="num" id="LN601">601</td><td class="line">    <span class='keyword'>for</span> (fw = 0.0, k = 0; k &lt;= jp &amp;&amp; k &lt;= jz - i; k++) fw += PIo2[k] * q[i + k];</td></tr>
<tr class="codeline" data-linenumber="602"><td class="num" id="LN602">602</td><td class="line">    fq[jz - i] = fw;</td></tr>
<tr class="codeline" data-linenumber="603"><td class="num" id="LN603">603</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="604"><td class="num" id="LN604">604</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="605"><td class="num" id="LN605">605</td><td class="line">  <span class='comment'>/* compress fq[] into y[] */</span></td></tr>
<tr class="codeline" data-linenumber="606"><td class="num" id="LN606">606</td><td class="line">  <span class='keyword'>switch</span> (prec) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path23" class="msg msgControl" style="margin-left:3ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">23</div></td><td><div class="PathNav"><a href="#Path22" title="Previous event (22)">&#x2190;</a></div></td><td>Control jumps to 'case 3:'  at line 621</td><td><div class="PathNav"><a href="#Path24" title="Next event (24)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="607"><td class="num" id="LN607">607</td><td class="line">    <span class='keyword'>case</span> 0:</td></tr>
<tr class="codeline" data-linenumber="608"><td class="num" id="LN608">608</td><td class="line">      fw = 0.0;</td></tr>
<tr class="codeline" data-linenumber="609"><td class="num" id="LN609">609</td><td class="line">      <span class='keyword'>for</span> (i = jz; i &gt;= 0; i--) fw += fq[i];</td></tr>
<tr class="codeline" data-linenumber="610"><td class="num" id="LN610">610</td><td class="line">      y[0] = (ih == 0) ? fw : -fw;</td></tr>
<tr class="codeline" data-linenumber="611"><td class="num" id="LN611">611</td><td class="line">      <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="612"><td class="num" id="LN612">612</td><td class="line">    <span class='keyword'>case</span> 1:</td></tr>
<tr class="codeline" data-linenumber="613"><td class="num" id="LN613">613</td><td class="line">    <span class='keyword'>case</span> 2:</td></tr>
<tr class="codeline" data-linenumber="614"><td class="num" id="LN614">614</td><td class="line">      fw = 0.0;</td></tr>
<tr class="codeline" data-linenumber="615"><td class="num" id="LN615">615</td><td class="line">      <span class='keyword'>for</span> (i = jz; i &gt;= 0; i--) fw += fq[i];</td></tr>
<tr class="codeline" data-linenumber="616"><td class="num" id="LN616">616</td><td class="line">      y[0] = (ih == 0) ? fw : -fw;</td></tr>
<tr class="codeline" data-linenumber="617"><td class="num" id="LN617">617</td><td class="line">      fw = fq[0] - fw;</td></tr>
<tr class="codeline" data-linenumber="618"><td class="num" id="LN618">618</td><td class="line">      <span class='keyword'>for</span> (i = 1; i &lt;= jz; i++) fw += fq[i];</td></tr>
<tr class="codeline" data-linenumber="619"><td class="num" id="LN619">619</td><td class="line">      y[1] = (ih == 0) ? fw : -fw;</td></tr>
<tr class="codeline" data-linenumber="620"><td class="num" id="LN620">620</td><td class="line">      <span class='keyword'>break</span>;</td></tr>
<tr class="codeline" data-linenumber="621"><td class="num" id="LN621">621</td><td class="line">    <span class='keyword'>case</span> 3: <span class='comment'>/* painful */</span></td></tr>
<tr class="codeline" data-linenumber="622"><td class="num" id="LN622">622</td><td class="line">      <span class='keyword'>for</span> (i = jz; <span class='variable'>i<table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>23.1</div></td><td>'i' is <= 0</td></tr></tbody></table></span> &gt; 0; i--) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path24" class="msg msgControl" style="margin-left:7ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">24</div></td><td><div class="PathNav"><a href="#Path23" title="Previous event (23)">&#x2190;</a></div></td><td>Loop condition is false. Execution continues on line 627</td><td><div class="PathNav"><a href="#Path25" title="Next event (25)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="623"><td class="num" id="LN623">623</td><td class="line">        fw = fq[i - 1] + fq[i];</td></tr>
<tr class="codeline" data-linenumber="624"><td class="num" id="LN624">624</td><td class="line">        fq[i] += fq[i - 1] - fw;</td></tr>
<tr class="codeline" data-linenumber="625"><td class="num" id="LN625">625</td><td class="line">        fq[i - 1] = fw;</td></tr>
<tr class="codeline" data-linenumber="626"><td class="num" id="LN626">626</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="627"><td class="num" id="LN627">627</td><td class="line">      <span class='keyword'>for</span> (i = jz; <span class='variable'>i<table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>24.1</div></td><td>'i' is <= 1</td></tr></tbody></table></span> &gt; 1; i--) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path25" class="msg msgControl" style="margin-left:7ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">25</div></td><td><div class="PathNav"><a href="#Path24" title="Previous event (24)">&#x2190;</a></div></td><td>Loop condition is false. Execution continues on line 632</td><td><div class="PathNav"><a href="#Path26" title="Next event (26)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="628"><td class="num" id="LN628">628</td><td class="line">        fw = fq[i - 1] + fq[i];</td></tr>
<tr class="codeline" data-linenumber="629"><td class="num" id="LN629">629</td><td class="line">        fq[i] += fq[i - 1] - fw;</td></tr>
<tr class="codeline" data-linenumber="630"><td class="num" id="LN630">630</td><td class="line">        fq[i - 1] = fw;</td></tr>
<tr class="codeline" data-linenumber="631"><td class="num" id="LN631">631</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="632"><td class="num" id="LN632">632</td><td class="line">      <span class='keyword'>for</span> (fw = 0.0, i = jz; <span class='variable'>i<table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>25.1</div></td><td>'i' is < 2</td></tr></tbody></table></span> &gt;= 2; i--) fw += fq[i];</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path26" class="msg msgControl" style="margin-left:7ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">26</div></td><td><div class="PathNav"><a href="#Path25" title="Previous event (25)">&#x2190;</a></div></td><td>Loop condition is false. Execution continues on line 633</td><td><div class="PathNav"><a href="#Path27" title="Next event (27)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="633"><td class="num" id="LN633">633</td><td class="line">      <span class='keyword'>if</span> (<span class='variable'>ih<table class='variable_popup'><tbody><tr><td valign='top'><div class='PathIndex PathIndexPopUp'>26.1</div></td><td>'ih' is equal to 0</td></tr></tbody></table></span> == 0) {</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path27" class="msg msgControl" style="margin-left:7ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">27</div></td><td><div class="PathNav"><a href="#Path26" title="Previous event (26)">&#x2190;</a></div></td><td>Taking true branch</td><td><div class="PathNav"><a href="#EndPath" title="Next event (28)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="634"><td class="num" id="LN634">634</td><td class="line">        y[0] = <span class="mrange">fq[0]</span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="EndPath" class="msg msgEvent" style="margin-left:14ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">28</div></td><td><div class="PathNav"><a href="#Path27" title="Previous event (27)">&#x2190;</a></div></td><td>Assigned value is garbage or undefined</td></tr></table></div></td></tr>
<tr class="codeline" data-linenumber="635"><td class="num" id="LN635">635</td><td class="line">        y[1] = fq[1];</td></tr>
<tr class="codeline" data-linenumber="636"><td class="num" id="LN636">636</td><td class="line">        y[2] = fw;</td></tr>
<tr class="codeline" data-linenumber="637"><td class="num" id="LN637">637</td><td class="line">      } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="638"><td class="num" id="LN638">638</td><td class="line">        y[0] = -fq[0];</td></tr>
<tr class="codeline" data-linenumber="639"><td class="num" id="LN639">639</td><td class="line">        y[1] = -fq[1];</td></tr>
<tr class="codeline" data-linenumber="640"><td class="num" id="LN640">640</td><td class="line">        y[2] = -fw;</td></tr>
<tr class="codeline" data-linenumber="641"><td class="num" id="LN641">641</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="642"><td class="num" id="LN642">642</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="643"><td class="num" id="LN643">643</td><td class="line">  <span class='keyword'>return</span> n &amp; 7;</td></tr>
<tr class="codeline" data-linenumber="644"><td class="num" id="LN644">644</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="645"><td class="num" id="LN645">645</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="646"><td class="num" id="LN646">646</td><td class="line"><span class='comment'>/* __kernel_sin( x, y, iy)</span></td></tr>
<tr class="codeline" data-linenumber="647"><td class="num" id="LN647">647</td><td class="line"> <span class='comment'>* kernel sin function on [-pi/4, pi/4], pi/4 ~ 0.7854</span></td></tr>
<tr class="codeline" data-linenumber="648"><td class="num" id="LN648">648</td><td class="line"> <span class='comment'>* Input x is assumed to be bounded by ~pi/4 in magnitude.</span></td></tr>
<tr class="codeline" data-linenumber="649"><td class="num" id="LN649">649</td><td class="line"> <span class='comment'>* Input y is the tail of x.</span></td></tr>
<tr class="codeline" data-linenumber="650"><td class="num" id="LN650">650</td><td class="line"> <span class='comment'>* Input iy indicates whether y is 0. (if iy=0, y assume to be 0).</span></td></tr>
<tr class="codeline" data-linenumber="651"><td class="num" id="LN651">651</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="652"><td class="num" id="LN652">652</td><td class="line"> <span class='comment'>* Algorithm</span></td></tr>
<tr class="codeline" data-linenumber="653"><td class="num" id="LN653">653</td><td class="line"> <span class='comment'>*      1. Since sin(-x) = -sin(x), we need only to consider positive x.</span></td></tr>
<tr class="codeline" data-linenumber="654"><td class="num" id="LN654">654</td><td class="line"> <span class='comment'>*      2. if x &lt; 2^-27 (hx&lt;0x3E400000 0), return x with inexact if x!=0.</span></td></tr>
<tr class="codeline" data-linenumber="655"><td class="num" id="LN655">655</td><td class="line"> <span class='comment'>*      3. sin(x) is approximated by a polynomial of degree 13 on</span></td></tr>
<tr class="codeline" data-linenumber="656"><td class="num" id="LN656">656</td><td class="line"> <span class='comment'>*         [0,pi/4]</span></td></tr>
<tr class="codeline" data-linenumber="657"><td class="num" id="LN657">657</td><td class="line"> <span class='comment'>*                               3            13</span></td></tr>
<tr class="codeline" data-linenumber="658"><td class="num" id="LN658">658</td><td class="line"> <span class='comment'>*              sin(x) ~ x + S1*x + ... + S6*x</span></td></tr>
<tr class="codeline" data-linenumber="659"><td class="num" id="LN659">659</td><td class="line"> <span class='comment'>*         where</span></td></tr>
<tr class="codeline" data-linenumber="660"><td class="num" id="LN660">660</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="661"><td class="num" id="LN661">661</td><td class="line"> <span class='comment'>*      |sin(x)         2     4     6     8     10     12  |     -58</span></td></tr>
<tr class="codeline" data-linenumber="662"><td class="num" id="LN662">662</td><td class="line"> <span class='comment'>*      |----- - (1+S1*x +S2*x +S3*x +S4*x +S5*x  +S6*x   )| &lt;= 2</span></td></tr>
<tr class="codeline" data-linenumber="663"><td class="num" id="LN663">663</td><td class="line"> <span class='comment'>*      |  x                                               |</span></td></tr>
<tr class="codeline" data-linenumber="664"><td class="num" id="LN664">664</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="665"><td class="num" id="LN665">665</td><td class="line"> <span class='comment'>*      4. sin(x+y) = sin(x) + sin'(x')*y</span></td></tr>
<tr class="codeline" data-linenumber="666"><td class="num" id="LN666">666</td><td class="line"> <span class='comment'>*                  ~ sin(x) + (1-x*x/2)*y</span></td></tr>
<tr class="codeline" data-linenumber="667"><td class="num" id="LN667">667</td><td class="line"> <span class='comment'>*         For better accuracy, let</span></td></tr>
<tr class="codeline" data-linenumber="668"><td class="num" id="LN668">668</td><td class="line"> <span class='comment'>*                   3      2      2      2      2</span></td></tr>
<tr class="codeline" data-linenumber="669"><td class="num" id="LN669">669</td><td class="line"> <span class='comment'>*              r = x *(S2+x *(S3+x *(S4+x *(S5+x *S6))))</span></td></tr>
<tr class="codeline" data-linenumber="670"><td class="num" id="LN670">670</td><td class="line"> <span class='comment'>*         then                   3    2</span></td></tr>
<tr class="codeline" data-linenumber="671"><td class="num" id="LN671">671</td><td class="line"> <span class='comment'>*              sin(x) = x + (S1*x + (x *(r-y/2)+y))</span></td></tr>
<tr class="codeline" data-linenumber="672"><td class="num" id="LN672">672</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="673"><td class="num" id="LN673">673</td><td class="line"><span class='macro'>V8_INLINE<span class='macro_popup'>inline __attribute__((always_inline))</span></span> <span class='keyword'>double</span> __kernel_sin(<span class='keyword'>double</span> x, <span class='keyword'>double</span> y, <span class='keyword'>int</span> iy) {</td></tr>
<tr class="codeline" data-linenumber="674"><td class="num" id="LN674">674</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="675"><td class="num" id="LN675">675</td><td class="line">      half = 5.00000000000000000000e-01, <span class='comment'>/* 0x3FE00000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="676"><td class="num" id="LN676">676</td><td class="line">      S1 = -1.66666666666666324348e-01,  <span class='comment'>/* 0xBFC55555, 0x55555549 */</span></td></tr>
<tr class="codeline" data-linenumber="677"><td class="num" id="LN677">677</td><td class="line">      S2 = 8.33333333332248946124e-03,   <span class='comment'>/* 0x3F811111, 0x1110F8A6 */</span></td></tr>
<tr class="codeline" data-linenumber="678"><td class="num" id="LN678">678</td><td class="line">      S3 = -1.98412698298579493134e-04,  <span class='comment'>/* 0xBF2A01A0, 0x19C161D5 */</span></td></tr>
<tr class="codeline" data-linenumber="679"><td class="num" id="LN679">679</td><td class="line">      S4 = 2.75573137070700676789e-06,   <span class='comment'>/* 0x3EC71DE3, 0x57B1FE7D */</span></td></tr>
<tr class="codeline" data-linenumber="680"><td class="num" id="LN680">680</td><td class="line">      S5 = -2.50507602534068634195e-08,  <span class='comment'>/* 0xBE5AE5E6, 0x8A2B9CEB */</span></td></tr>
<tr class="codeline" data-linenumber="681"><td class="num" id="LN681">681</td><td class="line">      S6 = 1.58969099521155010221e-10;   <span class='comment'>/* 0x3DE5D93A, 0x5ACFD57C */</span></td></tr>
<tr class="codeline" data-linenumber="682"><td class="num" id="LN682">682</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="683"><td class="num" id="LN683">683</td><td class="line">  <span class='keyword'>double</span> z, r, v;</td></tr>
<tr class="codeline" data-linenumber="684"><td class="num" id="LN684">684</td><td class="line">  int32_t ix;</td></tr>
<tr class="codeline" data-linenumber="685"><td class="num" id="LN685">685</td><td class="line">  GET_HIGH_WORD(ix, x);</td></tr>
<tr class="codeline" data-linenumber="686"><td class="num" id="LN686">686</td><td class="line">  ix &amp;= 0x7FFFFFFF;      <span class='comment'>/* high word of x */</span></td></tr>
<tr class="codeline" data-linenumber="687"><td class="num" id="LN687">687</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x3E400000) { <span class='comment'>/* |x| &lt; 2**-27 */</span></td></tr>
<tr class="codeline" data-linenumber="688"><td class="num" id="LN688">688</td><td class="line">    <span class='keyword'>if</span> (<span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(x) == 0) <span class='keyword'>return</span> x;</td></tr>
<tr class="codeline" data-linenumber="689"><td class="num" id="LN689">689</td><td class="line">  } <span class='comment'>/* generate inexact */</span></td></tr>
<tr class="codeline" data-linenumber="690"><td class="num" id="LN690">690</td><td class="line">  z = x * x;</td></tr>
<tr class="codeline" data-linenumber="691"><td class="num" id="LN691">691</td><td class="line">  v = z * x;</td></tr>
<tr class="codeline" data-linenumber="692"><td class="num" id="LN692">692</td><td class="line">  r = S2 + z * (S3 + z * (S4 + z * (S5 + z * S6)));</td></tr>
<tr class="codeline" data-linenumber="693"><td class="num" id="LN693">693</td><td class="line">  <span class='keyword'>if</span> (iy == 0) {</td></tr>
<tr class="codeline" data-linenumber="694"><td class="num" id="LN694">694</td><td class="line">    <span class='keyword'>return</span> x + v * (S1 + z * r);</td></tr>
<tr class="codeline" data-linenumber="695"><td class="num" id="LN695">695</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="696"><td class="num" id="LN696">696</td><td class="line">    <span class='keyword'>return</span> x - ((z * (half * y - v * r) - y) - v * S1);</td></tr>
<tr class="codeline" data-linenumber="697"><td class="num" id="LN697">697</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="698"><td class="num" id="LN698">698</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="699"><td class="num" id="LN699">699</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="700"><td class="num" id="LN700">700</td><td class="line"><span class='comment'>/* __kernel_tan( x, y, k )</span></td></tr>
<tr class="codeline" data-linenumber="701"><td class="num" id="LN701">701</td><td class="line"> <span class='comment'>* kernel tan function on [-pi/4, pi/4], pi/4 ~ 0.7854</span></td></tr>
<tr class="codeline" data-linenumber="702"><td class="num" id="LN702">702</td><td class="line"> <span class='comment'>* Input x is assumed to be bounded by ~pi/4 in magnitude.</span></td></tr>
<tr class="codeline" data-linenumber="703"><td class="num" id="LN703">703</td><td class="line"> <span class='comment'>* Input y is the tail of x.</span></td></tr>
<tr class="codeline" data-linenumber="704"><td class="num" id="LN704">704</td><td class="line"> <span class='comment'>* Input k indicates whether tan (if k=1) or</span></td></tr>
<tr class="codeline" data-linenumber="705"><td class="num" id="LN705">705</td><td class="line"> <span class='comment'>* -1/tan (if k= -1) is returned.</span></td></tr>
<tr class="codeline" data-linenumber="706"><td class="num" id="LN706">706</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="707"><td class="num" id="LN707">707</td><td class="line"> <span class='comment'>* Algorithm</span></td></tr>
<tr class="codeline" data-linenumber="708"><td class="num" id="LN708">708</td><td class="line"> <span class='comment'>*      1. Since tan(-x) = -tan(x), we need only to consider positive x.</span></td></tr>
<tr class="codeline" data-linenumber="709"><td class="num" id="LN709">709</td><td class="line"> <span class='comment'>*      2. if x &lt; 2^-28 (hx&lt;0x3E300000 0), return x with inexact if x!=0.</span></td></tr>
<tr class="codeline" data-linenumber="710"><td class="num" id="LN710">710</td><td class="line"> <span class='comment'>*      3. tan(x) is approximated by a odd polynomial of degree 27 on</span></td></tr>
<tr class="codeline" data-linenumber="711"><td class="num" id="LN711">711</td><td class="line"> <span class='comment'>*         [0,0.67434]</span></td></tr>
<tr class="codeline" data-linenumber="712"><td class="num" id="LN712">712</td><td class="line"> <span class='comment'>*                               3             27</span></td></tr>
<tr class="codeline" data-linenumber="713"><td class="num" id="LN713">713</td><td class="line"> <span class='comment'>*              tan(x) ~ x + T1*x + ... + T13*x</span></td></tr>
<tr class="codeline" data-linenumber="714"><td class="num" id="LN714">714</td><td class="line"> <span class='comment'>*         where</span></td></tr>
<tr class="codeline" data-linenumber="715"><td class="num" id="LN715">715</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="716"><td class="num" id="LN716">716</td><td class="line"> <span class='comment'>*              |tan(x)         2     4            26   |     -59.2</span></td></tr>
<tr class="codeline" data-linenumber="717"><td class="num" id="LN717">717</td><td class="line"> <span class='comment'>*              |----- - (1+T1*x +T2*x +.... +T13*x    )| &lt;= 2</span></td></tr>
<tr class="codeline" data-linenumber="718"><td class="num" id="LN718">718</td><td class="line"> <span class='comment'>*              |  x                                    |</span></td></tr>
<tr class="codeline" data-linenumber="719"><td class="num" id="LN719">719</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="720"><td class="num" id="LN720">720</td><td class="line"> <span class='comment'>*         Note: tan(x+y) = tan(x) + tan'(x)*y</span></td></tr>
<tr class="codeline" data-linenumber="721"><td class="num" id="LN721">721</td><td class="line"> <span class='comment'>*                        ~ tan(x) + (1+x*x)*y</span></td></tr>
<tr class="codeline" data-linenumber="722"><td class="num" id="LN722">722</td><td class="line"> <span class='comment'>*         Therefore, for better accuracy in computing tan(x+y), let</span></td></tr>
<tr class="codeline" data-linenumber="723"><td class="num" id="LN723">723</td><td class="line"> <span class='comment'>*                   3      2      2       2       2</span></td></tr>
<tr class="codeline" data-linenumber="724"><td class="num" id="LN724">724</td><td class="line"> <span class='comment'>*              r = x *(T2+x *(T3+x *(...+x *(T12+x *T13))))</span></td></tr>
<tr class="codeline" data-linenumber="725"><td class="num" id="LN725">725</td><td class="line"> <span class='comment'>*         then</span></td></tr>
<tr class="codeline" data-linenumber="726"><td class="num" id="LN726">726</td><td class="line"> <span class='comment'>*                                  3    2</span></td></tr>
<tr class="codeline" data-linenumber="727"><td class="num" id="LN727">727</td><td class="line"> <span class='comment'>*              tan(x+y) = x + (T1*x + (x *(r+y)+y))</span></td></tr>
<tr class="codeline" data-linenumber="728"><td class="num" id="LN728">728</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="729"><td class="num" id="LN729">729</td><td class="line"> <span class='comment'>*      4. For x in [0.67434,pi/4],  let y = pi/4 - x, then</span></td></tr>
<tr class="codeline" data-linenumber="730"><td class="num" id="LN730">730</td><td class="line"> <span class='comment'>*              tan(x) = tan(pi/4-y) = (1-tan(y))/(1+tan(y))</span></td></tr>
<tr class="codeline" data-linenumber="731"><td class="num" id="LN731">731</td><td class="line"> <span class='comment'>*                     = 1 - 2*(tan(y) - (tan(y)^2)/(1+tan(y)))</span></td></tr>
<tr class="codeline" data-linenumber="732"><td class="num" id="LN732">732</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="733"><td class="num" id="LN733">733</td><td class="line"><span class='keyword'>double</span> __kernel_tan(<span class='keyword'>double</span> x, <span class='keyword'>double</span> y, <span class='keyword'>int</span> iy) {</td></tr>
<tr class="codeline" data-linenumber="734"><td class="num" id="LN734">734</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> xxx[] = {</td></tr>
<tr class="codeline" data-linenumber="735"><td class="num" id="LN735">735</td><td class="line">      3.33333333333334091986e-01,             <span class='comment'>/* 3FD55555, 55555563 */</span></td></tr>
<tr class="codeline" data-linenumber="736"><td class="num" id="LN736">736</td><td class="line">      1.33333333333201242699e-01,             <span class='comment'>/* 3FC11111, 1110FE7A */</span></td></tr>
<tr class="codeline" data-linenumber="737"><td class="num" id="LN737">737</td><td class="line">      5.39682539762260521377e-02,             <span class='comment'>/* 3FABA1BA, 1BB341FE */</span></td></tr>
<tr class="codeline" data-linenumber="738"><td class="num" id="LN738">738</td><td class="line">      2.18694882948595424599e-02,             <span class='comment'>/* 3F9664F4, 8406D637 */</span></td></tr>
<tr class="codeline" data-linenumber="739"><td class="num" id="LN739">739</td><td class="line">      8.86323982359930005737e-03,             <span class='comment'>/* 3F8226E3, E96E8493 */</span></td></tr>
<tr class="codeline" data-linenumber="740"><td class="num" id="LN740">740</td><td class="line">      3.59207910759131235356e-03,             <span class='comment'>/* 3F6D6D22, C9560328 */</span></td></tr>
<tr class="codeline" data-linenumber="741"><td class="num" id="LN741">741</td><td class="line">      1.45620945432529025516e-03,             <span class='comment'>/* 3F57DBC8, FEE08315 */</span></td></tr>
<tr class="codeline" data-linenumber="742"><td class="num" id="LN742">742</td><td class="line">      5.88041240820264096874e-04,             <span class='comment'>/* 3F4344D8, F2F26501 */</span></td></tr>
<tr class="codeline" data-linenumber="743"><td class="num" id="LN743">743</td><td class="line">      2.46463134818469906812e-04,             <span class='comment'>/* 3F3026F7, 1A8D1068 */</span></td></tr>
<tr class="codeline" data-linenumber="744"><td class="num" id="LN744">744</td><td class="line">      7.81794442939557092300e-05,             <span class='comment'>/* 3F147E88, A03792A6 */</span></td></tr>
<tr class="codeline" data-linenumber="745"><td class="num" id="LN745">745</td><td class="line">      7.14072491382608190305e-05,             <span class='comment'>/* 3F12B80F, 32F0A7E9 */</span></td></tr>
<tr class="codeline" data-linenumber="746"><td class="num" id="LN746">746</td><td class="line">      -1.85586374855275456654e-05,            <span class='comment'>/* BEF375CB, DB605373 */</span></td></tr>
<tr class="codeline" data-linenumber="747"><td class="num" id="LN747">747</td><td class="line">      2.59073051863633712884e-05,             <span class='comment'>/* 3EFB2A70, 74BF7AD4 */</span></td></tr>
<tr class="codeline" data-linenumber="748"><td class="num" id="LN748">748</td><td class="line">      <span class='comment'>/* one */</span> 1.00000000000000000000e+00,   <span class='comment'>/* 3FF00000, 00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="749"><td class="num" id="LN749">749</td><td class="line">      <span class='comment'>/* pio4 */</span> 7.85398163397448278999e-01,  <span class='comment'>/* 3FE921FB, 54442D18 */</span></td></tr>
<tr class="codeline" data-linenumber="750"><td class="num" id="LN750">750</td><td class="line">      <span class='comment'>/* pio4lo */</span> 3.06161699786838301793e-17 <span class='comment'>/* 3C81A626, 33145C07 */</span></td></tr>
<tr class="codeline" data-linenumber="751"><td class="num" id="LN751">751</td><td class="line">  };</td></tr>
<tr class="codeline" data-linenumber="752"><td class="num" id="LN752">752</td><td class="line"><span class='directive'>#define one xxx[13]</span></td></tr>
<tr class="codeline" data-linenumber="753"><td class="num" id="LN753">753</td><td class="line"><span class='directive'>#define pio4 xxx[14]</span></td></tr>
<tr class="codeline" data-linenumber="754"><td class="num" id="LN754">754</td><td class="line"><span class='directive'>#define pio4lo xxx[15]</span></td></tr>
<tr class="codeline" data-linenumber="755"><td class="num" id="LN755">755</td><td class="line"><span class='directive'>#define T xxx</span></td></tr>
<tr class="codeline" data-linenumber="756"><td class="num" id="LN756">756</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="757"><td class="num" id="LN757">757</td><td class="line">  <span class='keyword'>double</span> z, r, v, w, s;</td></tr>
<tr class="codeline" data-linenumber="758"><td class="num" id="LN758">758</td><td class="line">  int32_t ix, hx;</td></tr>
<tr class="codeline" data-linenumber="759"><td class="num" id="LN759">759</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="760"><td class="num" id="LN760">760</td><td class="line">  GET_HIGH_WORD(hx, x);             <span class='comment'>/* high word of x */</span></td></tr>
<tr class="codeline" data-linenumber="761"><td class="num" id="LN761">761</td><td class="line">  ix = hx &amp; 0x7FFFFFFF;             <span class='comment'>/* high word of |x| */</span></td></tr>
<tr class="codeline" data-linenumber="762"><td class="num" id="LN762">762</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x3E300000) {            <span class='comment'>/* x &lt; 2**-28 */</span></td></tr>
<tr class="codeline" data-linenumber="763"><td class="num" id="LN763">763</td><td class="line">    <span class='keyword'>if</span> (<span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(x) == 0) { <span class='comment'>/* generate inexact */</span></td></tr>
<tr class="codeline" data-linenumber="764"><td class="num" id="LN764">764</td><td class="line">      uint32_t low;</td></tr>
<tr class="codeline" data-linenumber="765"><td class="num" id="LN765">765</td><td class="line">      GET_LOW_WORD(low, x);</td></tr>
<tr class="codeline" data-linenumber="766"><td class="num" id="LN766">766</td><td class="line">      <span class='keyword'>if</span> (((ix | low) | (iy + 1)) == 0) {</td></tr>
<tr class="codeline" data-linenumber="767"><td class="num" id="LN767">767</td><td class="line">        <span class='keyword'>return</span> one / fabs(x);</td></tr>
<tr class="codeline" data-linenumber="768"><td class="num" id="LN768">768</td><td class="line">      } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="769"><td class="num" id="LN769">769</td><td class="line">        <span class='keyword'>if</span> (iy == 1) {</td></tr>
<tr class="codeline" data-linenumber="770"><td class="num" id="LN770">770</td><td class="line">          <span class='keyword'>return</span> x;</td></tr>
<tr class="codeline" data-linenumber="771"><td class="num" id="LN771">771</td><td class="line">        } <span class='keyword'>else</span> { <span class='comment'>/* compute -1 / (x+y) carefully */</span></td></tr>
<tr class="codeline" data-linenumber="772"><td class="num" id="LN772">772</td><td class="line">          <span class='keyword'>double</span> a, t;</td></tr>
<tr class="codeline" data-linenumber="773"><td class="num" id="LN773">773</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="774"><td class="num" id="LN774">774</td><td class="line">          z = w = x + y;</td></tr>
<tr class="codeline" data-linenumber="775"><td class="num" id="LN775">775</td><td class="line">          SET_LOW_WORD(z, 0);</td></tr>
<tr class="codeline" data-linenumber="776"><td class="num" id="LN776">776</td><td class="line">          v = y - (z - x);</td></tr>
<tr class="codeline" data-linenumber="777"><td class="num" id="LN777">777</td><td class="line">          t = a = -one / w;</td></tr>
<tr class="codeline" data-linenumber="778"><td class="num" id="LN778">778</td><td class="line">          SET_LOW_WORD(t, 0);</td></tr>
<tr class="codeline" data-linenumber="779"><td class="num" id="LN779">779</td><td class="line">          s = one + t * z;</td></tr>
<tr class="codeline" data-linenumber="780"><td class="num" id="LN780">780</td><td class="line">          <span class='keyword'>return</span> t + a * (s + t * v);</td></tr>
<tr class="codeline" data-linenumber="781"><td class="num" id="LN781">781</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="782"><td class="num" id="LN782">782</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="783"><td class="num" id="LN783">783</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="784"><td class="num" id="LN784">784</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="785"><td class="num" id="LN785">785</td><td class="line">  <span class='keyword'>if</span> (ix &gt;= 0x3FE59428) { <span class='comment'>/* |x| &gt;= 0.6744 */</span></td></tr>
<tr class="codeline" data-linenumber="786"><td class="num" id="LN786">786</td><td class="line">    <span class='keyword'>if</span> (hx &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="787"><td class="num" id="LN787">787</td><td class="line">      x = -x;</td></tr>
<tr class="codeline" data-linenumber="788"><td class="num" id="LN788">788</td><td class="line">      y = -y;</td></tr>
<tr class="codeline" data-linenumber="789"><td class="num" id="LN789">789</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="790"><td class="num" id="LN790">790</td><td class="line">    z = pio4 - x;</td></tr>
<tr class="codeline" data-linenumber="791"><td class="num" id="LN791">791</td><td class="line">    w = pio4lo - y;</td></tr>
<tr class="codeline" data-linenumber="792"><td class="num" id="LN792">792</td><td class="line">    x = z + w;</td></tr>
<tr class="codeline" data-linenumber="793"><td class="num" id="LN793">793</td><td class="line">    y = 0.0;</td></tr>
<tr class="codeline" data-linenumber="794"><td class="num" id="LN794">794</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="795"><td class="num" id="LN795">795</td><td class="line">  z = x * x;</td></tr>
<tr class="codeline" data-linenumber="796"><td class="num" id="LN796">796</td><td class="line">  w = z * z;</td></tr>
<tr class="codeline" data-linenumber="797"><td class="num" id="LN797">797</td><td class="line">  <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="798"><td class="num" id="LN798">798</td><td class="line">   <span class='comment'>* Break x^5*(T[1]+x^2*T[2]+...) into</span></td></tr>
<tr class="codeline" data-linenumber="799"><td class="num" id="LN799">799</td><td class="line">   <span class='comment'>* x^5(T[1]+x^4*T[3]+...+x^20*T[11]) +</span></td></tr>
<tr class="codeline" data-linenumber="800"><td class="num" id="LN800">800</td><td class="line">   <span class='comment'>* x^5(x^2*(T[2]+x^4*T[4]+...+x^22*[T12]))</span></td></tr>
<tr class="codeline" data-linenumber="801"><td class="num" id="LN801">801</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="802"><td class="num" id="LN802">802</td><td class="line">  r = T[1] + w * (T[3] + w * (T[5] + w * (T[7] + w * (T[9] + w * T[11]))));</td></tr>
<tr class="codeline" data-linenumber="803"><td class="num" id="LN803">803</td><td class="line">  v = z *</td></tr>
<tr class="codeline" data-linenumber="804"><td class="num" id="LN804">804</td><td class="line">      (T[2] + w * (T[4] + w * (T[6] + w * (T[8] + w * (T[10] + w * T[12])))));</td></tr>
<tr class="codeline" data-linenumber="805"><td class="num" id="LN805">805</td><td class="line">  s = z * x;</td></tr>
<tr class="codeline" data-linenumber="806"><td class="num" id="LN806">806</td><td class="line">  r = y + z * (s * (r + v) + y);</td></tr>
<tr class="codeline" data-linenumber="807"><td class="num" id="LN807">807</td><td class="line">  r += T[0] * s;</td></tr>
<tr class="codeline" data-linenumber="808"><td class="num" id="LN808">808</td><td class="line">  w = x + r;</td></tr>
<tr class="codeline" data-linenumber="809"><td class="num" id="LN809">809</td><td class="line">  <span class='keyword'>if</span> (ix &gt;= 0x3FE59428) {</td></tr>
<tr class="codeline" data-linenumber="810"><td class="num" id="LN810">810</td><td class="line">    v = iy;</td></tr>
<tr class="codeline" data-linenumber="811"><td class="num" id="LN811">811</td><td class="line">    <span class='keyword'>return</span> (1 - ((hx &gt;&gt; 30) &amp; 2)) * (v - 2.0 * (x - (w * w / (w + v) - r)));</td></tr>
<tr class="codeline" data-linenumber="812"><td class="num" id="LN812">812</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="813"><td class="num" id="LN813">813</td><td class="line">  <span class='keyword'>if</span> (iy == 1) {</td></tr>
<tr class="codeline" data-linenumber="814"><td class="num" id="LN814">814</td><td class="line">    <span class='keyword'>return</span> w;</td></tr>
<tr class="codeline" data-linenumber="815"><td class="num" id="LN815">815</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="816"><td class="num" id="LN816">816</td><td class="line">    <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="817"><td class="num" id="LN817">817</td><td class="line">     <span class='comment'>* if allow error up to 2 ulp, simply return</span></td></tr>
<tr class="codeline" data-linenumber="818"><td class="num" id="LN818">818</td><td class="line">     <span class='comment'>* -1.0 / (x+r) here</span></td></tr>
<tr class="codeline" data-linenumber="819"><td class="num" id="LN819">819</td><td class="line">     <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="820"><td class="num" id="LN820">820</td><td class="line">    <span class='comment'>/* compute -1.0 / (x+r) accurately */</span></td></tr>
<tr class="codeline" data-linenumber="821"><td class="num" id="LN821">821</td><td class="line">    <span class='keyword'>double</span> a, t;</td></tr>
<tr class="codeline" data-linenumber="822"><td class="num" id="LN822">822</td><td class="line">    z = w;</td></tr>
<tr class="codeline" data-linenumber="823"><td class="num" id="LN823">823</td><td class="line">    SET_LOW_WORD(z, 0);</td></tr>
<tr class="codeline" data-linenumber="824"><td class="num" id="LN824">824</td><td class="line">    v = r - (z - x);  <span class='comment'>/* z+v = r+x */</span></td></tr>
<tr class="codeline" data-linenumber="825"><td class="num" id="LN825">825</td><td class="line">    t = a = -1.0 / w; <span class='comment'>/* a = -1.0/w */</span></td></tr>
<tr class="codeline" data-linenumber="826"><td class="num" id="LN826">826</td><td class="line">    SET_LOW_WORD(t, 0);</td></tr>
<tr class="codeline" data-linenumber="827"><td class="num" id="LN827">827</td><td class="line">    s = 1.0 + t * z;</td></tr>
<tr class="codeline" data-linenumber="828"><td class="num" id="LN828">828</td><td class="line">    <span class='keyword'>return</span> t + a * (s + t * v);</td></tr>
<tr class="codeline" data-linenumber="829"><td class="num" id="LN829">829</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="830"><td class="num" id="LN830">830</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="831"><td class="num" id="LN831">831</td><td class="line"><span class='directive'>#undef one</span></td></tr>
<tr class="codeline" data-linenumber="832"><td class="num" id="LN832">832</td><td class="line"><span class='directive'>#undef pio4</span></td></tr>
<tr class="codeline" data-linenumber="833"><td class="num" id="LN833">833</td><td class="line"><span class='directive'>#undef pio4lo</span></td></tr>
<tr class="codeline" data-linenumber="834"><td class="num" id="LN834">834</td><td class="line"><span class='directive'>#undef T</span></td></tr>
<tr class="codeline" data-linenumber="835"><td class="num" id="LN835">835</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="836"><td class="num" id="LN836">836</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="837"><td class="num" id="LN837">837</td><td class="line">}  <span class='comment'>// namespace</span></td></tr>
<tr class="codeline" data-linenumber="838"><td class="num" id="LN838">838</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="839"><td class="num" id="LN839">839</td><td class="line"><span class='comment'>/* acos(x)</span></td></tr>
<tr class="codeline" data-linenumber="840"><td class="num" id="LN840">840</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="841"><td class="num" id="LN841">841</td><td class="line"> <span class='comment'>*      acos(x)  = pi/2 - asin(x)</span></td></tr>
<tr class="codeline" data-linenumber="842"><td class="num" id="LN842">842</td><td class="line"> <span class='comment'>*      acos(-x) = pi/2 + asin(x)</span></td></tr>
<tr class="codeline" data-linenumber="843"><td class="num" id="LN843">843</td><td class="line"> <span class='comment'>* For |x|&lt;=0.5</span></td></tr>
<tr class="codeline" data-linenumber="844"><td class="num" id="LN844">844</td><td class="line"> <span class='comment'>*      acos(x) = pi/2 - (x + x*x^2*R(x^2))     (see asin.c)</span></td></tr>
<tr class="codeline" data-linenumber="845"><td class="num" id="LN845">845</td><td class="line"> <span class='comment'>* For x&gt;0.5</span></td></tr>
<tr class="codeline" data-linenumber="846"><td class="num" id="LN846">846</td><td class="line"> <span class='comment'>*      acos(x) = pi/2 - (pi/2 - 2asin(sqrt((1-x)/2)))</span></td></tr>
<tr class="codeline" data-linenumber="847"><td class="num" id="LN847">847</td><td class="line"> <span class='comment'>*              = 2asin(sqrt((1-x)/2))</span></td></tr>
<tr class="codeline" data-linenumber="848"><td class="num" id="LN848">848</td><td class="line"> <span class='comment'>*              = 2s + 2s*z*R(z)        ...z=(1-x)/2, s=sqrt(z)</span></td></tr>
<tr class="codeline" data-linenumber="849"><td class="num" id="LN849">849</td><td class="line"> <span class='comment'>*              = 2f + (2c + 2s*z*R(z))</span></td></tr>
<tr class="codeline" data-linenumber="850"><td class="num" id="LN850">850</td><td class="line"> <span class='comment'>*     where f=hi part of s, and c = (z-f*f)/(s+f) is the correction term</span></td></tr>
<tr class="codeline" data-linenumber="851"><td class="num" id="LN851">851</td><td class="line"> <span class='comment'>*     for f so that f+c ~ sqrt(z).</span></td></tr>
<tr class="codeline" data-linenumber="852"><td class="num" id="LN852">852</td><td class="line"> <span class='comment'>* For x&lt;-0.5</span></td></tr>
<tr class="codeline" data-linenumber="853"><td class="num" id="LN853">853</td><td class="line"> <span class='comment'>*      acos(x) = pi - 2asin(sqrt((1-|x|)/2))</span></td></tr>
<tr class="codeline" data-linenumber="854"><td class="num" id="LN854">854</td><td class="line"> <span class='comment'>*              = pi - 0.5*(s+s*z*R(z)), where z=(1-|x|)/2,s=sqrt(z)</span></td></tr>
<tr class="codeline" data-linenumber="855"><td class="num" id="LN855">855</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="856"><td class="num" id="LN856">856</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="857"><td class="num" id="LN857">857</td><td class="line"> <span class='comment'>*      if x is NaN, return x itself;</span></td></tr>
<tr class="codeline" data-linenumber="858"><td class="num" id="LN858">858</td><td class="line"> <span class='comment'>*      if |x|&gt;1, return NaN with invalid signal.</span></td></tr>
<tr class="codeline" data-linenumber="859"><td class="num" id="LN859">859</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="860"><td class="num" id="LN860">860</td><td class="line"> <span class='comment'>* Function needed: sqrt</span></td></tr>
<tr class="codeline" data-linenumber="861"><td class="num" id="LN861">861</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="862"><td class="num" id="LN862">862</td><td class="line"><span class='keyword'>double</span> acos(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="863"><td class="num" id="LN863">863</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="864"><td class="num" id="LN864">864</td><td class="line">      one = 1.00000000000000000000e+00,     <span class='comment'>/* 0x3FF00000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="865"><td class="num" id="LN865">865</td><td class="line">      pi = 3.14159265358979311600e+00,      <span class='comment'>/* 0x400921FB, 0x54442D18 */</span></td></tr>
<tr class="codeline" data-linenumber="866"><td class="num" id="LN866">866</td><td class="line">      pio2_hi = 1.57079632679489655800e+00, <span class='comment'>/* 0x3FF921FB, 0x54442D18 */</span></td></tr>
<tr class="codeline" data-linenumber="867"><td class="num" id="LN867">867</td><td class="line">      pio2_lo = 6.12323399573676603587e-17, <span class='comment'>/* 0x3C91A626, 0x33145C07 */</span></td></tr>
<tr class="codeline" data-linenumber="868"><td class="num" id="LN868">868</td><td class="line">      pS0 = 1.66666666666666657415e-01,     <span class='comment'>/* 0x3FC55555, 0x55555555 */</span></td></tr>
<tr class="codeline" data-linenumber="869"><td class="num" id="LN869">869</td><td class="line">      pS1 = -3.25565818622400915405e-01,    <span class='comment'>/* 0xBFD4D612, 0x03EB6F7D */</span></td></tr>
<tr class="codeline" data-linenumber="870"><td class="num" id="LN870">870</td><td class="line">      pS2 = 2.01212532134862925881e-01,     <span class='comment'>/* 0x3FC9C155, 0x0E884455 */</span></td></tr>
<tr class="codeline" data-linenumber="871"><td class="num" id="LN871">871</td><td class="line">      pS3 = -4.00555345006794114027e-02,    <span class='comment'>/* 0xBFA48228, 0xB5688F3B */</span></td></tr>
<tr class="codeline" data-linenumber="872"><td class="num" id="LN872">872</td><td class="line">      pS4 = 7.91534994289814532176e-04,     <span class='comment'>/* 0x3F49EFE0, 0x7501B288 */</span></td></tr>
<tr class="codeline" data-linenumber="873"><td class="num" id="LN873">873</td><td class="line">      pS5 = 3.47933107596021167570e-05,     <span class='comment'>/* 0x3F023DE1, 0x0DFDF709 */</span></td></tr>
<tr class="codeline" data-linenumber="874"><td class="num" id="LN874">874</td><td class="line">      qS1 = -2.40339491173441421878e+00,    <span class='comment'>/* 0xC0033A27, 0x1C8A2D4B */</span></td></tr>
<tr class="codeline" data-linenumber="875"><td class="num" id="LN875">875</td><td class="line">      qS2 = 2.02094576023350569471e+00,     <span class='comment'>/* 0x40002AE5, 0x9C598AC8 */</span></td></tr>
<tr class="codeline" data-linenumber="876"><td class="num" id="LN876">876</td><td class="line">      qS3 = -6.88283971605453293030e-01,    <span class='comment'>/* 0xBFE6066C, 0x1B8D0159 */</span></td></tr>
<tr class="codeline" data-linenumber="877"><td class="num" id="LN877">877</td><td class="line">      qS4 = 7.70381505559019352791e-02;     <span class='comment'>/* 0x3FB3B8C5, 0xB12E9282 */</span></td></tr>
<tr class="codeline" data-linenumber="878"><td class="num" id="LN878">878</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="879"><td class="num" id="LN879">879</td><td class="line">  <span class='keyword'>double</span> z, p, q, r, w, s, c, df;</td></tr>
<tr class="codeline" data-linenumber="880"><td class="num" id="LN880">880</td><td class="line">  int32_t hx, ix;</td></tr>
<tr class="codeline" data-linenumber="881"><td class="num" id="LN881">881</td><td class="line">  GET_HIGH_WORD(hx, x);</td></tr>
<tr class="codeline" data-linenumber="882"><td class="num" id="LN882">882</td><td class="line">  ix = hx &amp; 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="883"><td class="num" id="LN883">883</td><td class="line">  <span class='keyword'>if</span> (ix &gt;= 0x3FF00000) { <span class='comment'>/* |x| &gt;= 1 */</span></td></tr>
<tr class="codeline" data-linenumber="884"><td class="num" id="LN884">884</td><td class="line">    uint32_t lx;</td></tr>
<tr class="codeline" data-linenumber="885"><td class="num" id="LN885">885</td><td class="line">    GET_LOW_WORD(lx, x);</td></tr>
<tr class="codeline" data-linenumber="886"><td class="num" id="LN886">886</td><td class="line">    <span class='keyword'>if</span> (((ix - 0x3FF00000) | lx) == 0) { <span class='comment'>/* |x|==1 */</span></td></tr>
<tr class="codeline" data-linenumber="887"><td class="num" id="LN887">887</td><td class="line">      <span class='keyword'>if</span> (hx &gt; 0)</td></tr>
<tr class="codeline" data-linenumber="888"><td class="num" id="LN888">888</td><td class="line">        <span class='keyword'>return</span> 0.0; <span class='comment'>/* acos(1) = 0  */</span></td></tr>
<tr class="codeline" data-linenumber="889"><td class="num" id="LN889">889</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="890"><td class="num" id="LN890">890</td><td class="line">        <span class='keyword'>return</span> pi + 2.0 * pio2_lo; <span class='comment'>/* acos(-1)= pi */</span></td></tr>
<tr class="codeline" data-linenumber="891"><td class="num" id="LN891">891</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="892"><td class="num" id="LN892">892</td><td class="line">    <span class='keyword'>return</span> std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::signaling_NaN();  <span class='comment'>// acos(|x|&gt;1) is NaN</span></td></tr>
<tr class="codeline" data-linenumber="893"><td class="num" id="LN893">893</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="894"><td class="num" id="LN894">894</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x3FE00000) {                            <span class='comment'>/* |x| &lt; 0.5 */</span></td></tr>
<tr class="codeline" data-linenumber="895"><td class="num" id="LN895">895</td><td class="line">    <span class='keyword'>if</span> (ix &lt;= 0x3C600000) <span class='keyword'>return</span> pio2_hi + pio2_lo; <span class='comment'>/*if|x|&lt;2**-57*/</span></td></tr>
<tr class="codeline" data-linenumber="896"><td class="num" id="LN896">896</td><td class="line">    z = x * x;</td></tr>
<tr class="codeline" data-linenumber="897"><td class="num" id="LN897">897</td><td class="line">    p = z * (pS0 + z * (pS1 + z * (pS2 + z * (pS3 + z * (pS4 + z * pS5)))));</td></tr>
<tr class="codeline" data-linenumber="898"><td class="num" id="LN898">898</td><td class="line">    q = one + z * (qS1 + z * (qS2 + z * (qS3 + z * qS4)));</td></tr>
<tr class="codeline" data-linenumber="899"><td class="num" id="LN899">899</td><td class="line">    r = p / q;</td></tr>
<tr class="codeline" data-linenumber="900"><td class="num" id="LN900">900</td><td class="line">    <span class='keyword'>return</span> pio2_hi - (x - (pio2_lo - x * r));</td></tr>
<tr class="codeline" data-linenumber="901"><td class="num" id="LN901">901</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (hx &lt; 0) { <span class='comment'>/* x &lt; -0.5 */</span></td></tr>
<tr class="codeline" data-linenumber="902"><td class="num" id="LN902">902</td><td class="line">    z = (one + x) * 0.5;</td></tr>
<tr class="codeline" data-linenumber="903"><td class="num" id="LN903">903</td><td class="line">    p = z * (pS0 + z * (pS1 + z * (pS2 + z * (pS3 + z * (pS4 + z * pS5)))));</td></tr>
<tr class="codeline" data-linenumber="904"><td class="num" id="LN904">904</td><td class="line">    q = one + z * (qS1 + z * (qS2 + z * (qS3 + z * qS4)));</td></tr>
<tr class="codeline" data-linenumber="905"><td class="num" id="LN905">905</td><td class="line">    s = sqrt(z);</td></tr>
<tr class="codeline" data-linenumber="906"><td class="num" id="LN906">906</td><td class="line">    r = p / q;</td></tr>
<tr class="codeline" data-linenumber="907"><td class="num" id="LN907">907</td><td class="line">    w = r * s - pio2_lo;</td></tr>
<tr class="codeline" data-linenumber="908"><td class="num" id="LN908">908</td><td class="line">    <span class='keyword'>return</span> pi - 2.0 * (s + w);</td></tr>
<tr class="codeline" data-linenumber="909"><td class="num" id="LN909">909</td><td class="line">  } <span class='keyword'>else</span> { <span class='comment'>/* x &gt; 0.5 */</span></td></tr>
<tr class="codeline" data-linenumber="910"><td class="num" id="LN910">910</td><td class="line">    z = (one - x) * 0.5;</td></tr>
<tr class="codeline" data-linenumber="911"><td class="num" id="LN911">911</td><td class="line">    s = sqrt(z);</td></tr>
<tr class="codeline" data-linenumber="912"><td class="num" id="LN912">912</td><td class="line">    df = s;</td></tr>
<tr class="codeline" data-linenumber="913"><td class="num" id="LN913">913</td><td class="line">    SET_LOW_WORD(df, 0);</td></tr>
<tr class="codeline" data-linenumber="914"><td class="num" id="LN914">914</td><td class="line">    c = (z - df * df) / (s + df);</td></tr>
<tr class="codeline" data-linenumber="915"><td class="num" id="LN915">915</td><td class="line">    p = z * (pS0 + z * (pS1 + z * (pS2 + z * (pS3 + z * (pS4 + z * pS5)))));</td></tr>
<tr class="codeline" data-linenumber="916"><td class="num" id="LN916">916</td><td class="line">    q = one + z * (qS1 + z * (qS2 + z * (qS3 + z * qS4)));</td></tr>
<tr class="codeline" data-linenumber="917"><td class="num" id="LN917">917</td><td class="line">    r = p / q;</td></tr>
<tr class="codeline" data-linenumber="918"><td class="num" id="LN918">918</td><td class="line">    w = r * s + c;</td></tr>
<tr class="codeline" data-linenumber="919"><td class="num" id="LN919">919</td><td class="line">    <span class='keyword'>return</span> 2.0 * (df + w);</td></tr>
<tr class="codeline" data-linenumber="920"><td class="num" id="LN920">920</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="921"><td class="num" id="LN921">921</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="922"><td class="num" id="LN922">922</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="923"><td class="num" id="LN923">923</td><td class="line"><span class='comment'>/* acosh(x)</span></td></tr>
<tr class="codeline" data-linenumber="924"><td class="num" id="LN924">924</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="925"><td class="num" id="LN925">925</td><td class="line"> <span class='comment'>*      Based on</span></td></tr>
<tr class="codeline" data-linenumber="926"><td class="num" id="LN926">926</td><td class="line"> <span class='comment'>*              acosh(x) = log [ x + sqrt(x*x-1) ]</span></td></tr>
<tr class="codeline" data-linenumber="927"><td class="num" id="LN927">927</td><td class="line"> <span class='comment'>*      we have</span></td></tr>
<tr class="codeline" data-linenumber="928"><td class="num" id="LN928">928</td><td class="line"> <span class='comment'>*              acosh(x) := log(x)+ln2, if x is large; else</span></td></tr>
<tr class="codeline" data-linenumber="929"><td class="num" id="LN929">929</td><td class="line"> <span class='comment'>*              acosh(x) := log(2x-1/(sqrt(x*x-1)+x)) if x&gt;2; else</span></td></tr>
<tr class="codeline" data-linenumber="930"><td class="num" id="LN930">930</td><td class="line"> <span class='comment'>*              acosh(x) := log1p(t+sqrt(2.0*t+t*t)); where t=x-1.</span></td></tr>
<tr class="codeline" data-linenumber="931"><td class="num" id="LN931">931</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="932"><td class="num" id="LN932">932</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="933"><td class="num" id="LN933">933</td><td class="line"> <span class='comment'>*      acosh(x) is NaN with signal if x&lt;1.</span></td></tr>
<tr class="codeline" data-linenumber="934"><td class="num" id="LN934">934</td><td class="line"> <span class='comment'>*      acosh(NaN) is NaN without signal.</span></td></tr>
<tr class="codeline" data-linenumber="935"><td class="num" id="LN935">935</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="936"><td class="num" id="LN936">936</td><td class="line"><span class='keyword'>double</span> acosh(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="937"><td class="num" id="LN937">937</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="938"><td class="num" id="LN938">938</td><td class="line">      one = 1.0,</td></tr>
<tr class="codeline" data-linenumber="939"><td class="num" id="LN939">939</td><td class="line">      ln2 = 6.93147180559945286227e-01; <span class='comment'>/* 0x3FE62E42, 0xFEFA39EF */</span></td></tr>
<tr class="codeline" data-linenumber="940"><td class="num" id="LN940">940</td><td class="line">  <span class='keyword'>double</span> t;</td></tr>
<tr class="codeline" data-linenumber="941"><td class="num" id="LN941">941</td><td class="line">  int32_t hx;</td></tr>
<tr class="codeline" data-linenumber="942"><td class="num" id="LN942">942</td><td class="line">  uint32_t lx;</td></tr>
<tr class="codeline" data-linenumber="943"><td class="num" id="LN943">943</td><td class="line">  EXTRACT_WORDS(hx, lx, x);</td></tr>
<tr class="codeline" data-linenumber="944"><td class="num" id="LN944">944</td><td class="line">  <span class='keyword'>if</span> (hx &lt; 0x3FF00000) { <span class='comment'>/* x &lt; 1 */</span></td></tr>
<tr class="codeline" data-linenumber="945"><td class="num" id="LN945">945</td><td class="line">    <span class='keyword'>return</span> std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::signaling_NaN();</td></tr>
<tr class="codeline" data-linenumber="946"><td class="num" id="LN946">946</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (hx &gt;= 0x41B00000) { <span class='comment'>/* x &gt; 2**28 */</span></td></tr>
<tr class="codeline" data-linenumber="947"><td class="num" id="LN947">947</td><td class="line">    <span class='keyword'>if</span> (hx &gt;= 0x7FF00000) {      <span class='comment'>/* x is inf of NaN */</span></td></tr>
<tr class="codeline" data-linenumber="948"><td class="num" id="LN948">948</td><td class="line">      <span class='keyword'>return</span> x + x;</td></tr>
<tr class="codeline" data-linenumber="949"><td class="num" id="LN949">949</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="950"><td class="num" id="LN950">950</td><td class="line">      <span class='keyword'>return</span> log(x) + ln2; <span class='comment'>/* acosh(huge)=log(2x) */</span></td></tr>
<tr class="codeline" data-linenumber="951"><td class="num" id="LN951">951</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="952"><td class="num" id="LN952">952</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (((hx - 0x3FF00000) | lx) == 0) {</td></tr>
<tr class="codeline" data-linenumber="953"><td class="num" id="LN953">953</td><td class="line">    <span class='keyword'>return</span> 0.0;                 <span class='comment'>/* acosh(1) = 0 */</span></td></tr>
<tr class="codeline" data-linenumber="954"><td class="num" id="LN954">954</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (hx &gt; 0x40000000) { <span class='comment'>/* 2**28 &gt; x &gt; 2 */</span></td></tr>
<tr class="codeline" data-linenumber="955"><td class="num" id="LN955">955</td><td class="line">    t = x * x;</td></tr>
<tr class="codeline" data-linenumber="956"><td class="num" id="LN956">956</td><td class="line">    <span class='keyword'>return</span> log(2.0 * x - one / (x + sqrt(t - one)));</td></tr>
<tr class="codeline" data-linenumber="957"><td class="num" id="LN957">957</td><td class="line">  } <span class='keyword'>else</span> { <span class='comment'>/* 1&lt;x&lt;2 */</span></td></tr>
<tr class="codeline" data-linenumber="958"><td class="num" id="LN958">958</td><td class="line">    t = x - one;</td></tr>
<tr class="codeline" data-linenumber="959"><td class="num" id="LN959">959</td><td class="line">    <span class='keyword'>return</span> log1p(t + sqrt(2.0 * t + t * t));</td></tr>
<tr class="codeline" data-linenumber="960"><td class="num" id="LN960">960</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="961"><td class="num" id="LN961">961</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="962"><td class="num" id="LN962">962</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="963"><td class="num" id="LN963">963</td><td class="line"><span class='comment'>/* asin(x)</span></td></tr>
<tr class="codeline" data-linenumber="964"><td class="num" id="LN964">964</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="965"><td class="num" id="LN965">965</td><td class="line"> <span class='comment'>*      Since  asin(x) = x + x^3/6 + x^5*3/40 + x^7*15/336 + ...</span></td></tr>
<tr class="codeline" data-linenumber="966"><td class="num" id="LN966">966</td><td class="line"> <span class='comment'>*      we approximate asin(x) on [0,0.5] by</span></td></tr>
<tr class="codeline" data-linenumber="967"><td class="num" id="LN967">967</td><td class="line"> <span class='comment'>*              asin(x) = x + x*x^2*R(x^2)</span></td></tr>
<tr class="codeline" data-linenumber="968"><td class="num" id="LN968">968</td><td class="line"> <span class='comment'>*      where</span></td></tr>
<tr class="codeline" data-linenumber="969"><td class="num" id="LN969">969</td><td class="line"> <span class='comment'>*              R(x^2) is a rational approximation of (asin(x)-x)/x^3</span></td></tr>
<tr class="codeline" data-linenumber="970"><td class="num" id="LN970">970</td><td class="line"> <span class='comment'>*      and its remez error is bounded by</span></td></tr>
<tr class="codeline" data-linenumber="971"><td class="num" id="LN971">971</td><td class="line"> <span class='comment'>*              |(asin(x)-x)/x^3 - R(x^2)| &lt; 2^(-58.75)</span></td></tr>
<tr class="codeline" data-linenumber="972"><td class="num" id="LN972">972</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="973"><td class="num" id="LN973">973</td><td class="line"> <span class='comment'>*      For x in [0.5,1]</span></td></tr>
<tr class="codeline" data-linenumber="974"><td class="num" id="LN974">974</td><td class="line"> <span class='comment'>*              asin(x) = pi/2-2*asin(sqrt((1-x)/2))</span></td></tr>
<tr class="codeline" data-linenumber="975"><td class="num" id="LN975">975</td><td class="line"> <span class='comment'>*      Let y = (1-x), z = y/2, s := sqrt(z), and pio2_hi+pio2_lo=pi/2;</span></td></tr>
<tr class="codeline" data-linenumber="976"><td class="num" id="LN976">976</td><td class="line"> <span class='comment'>*      then for x&gt;0.98</span></td></tr>
<tr class="codeline" data-linenumber="977"><td class="num" id="LN977">977</td><td class="line"> <span class='comment'>*              asin(x) = pi/2 - 2*(s+s*z*R(z))</span></td></tr>
<tr class="codeline" data-linenumber="978"><td class="num" id="LN978">978</td><td class="line"> <span class='comment'>*                      = pio2_hi - (2*(s+s*z*R(z)) - pio2_lo)</span></td></tr>
<tr class="codeline" data-linenumber="979"><td class="num" id="LN979">979</td><td class="line"> <span class='comment'>*      For x&lt;=0.98, let pio4_hi = pio2_hi/2, then</span></td></tr>
<tr class="codeline" data-linenumber="980"><td class="num" id="LN980">980</td><td class="line"> <span class='comment'>*              f = hi part of s;</span></td></tr>
<tr class="codeline" data-linenumber="981"><td class="num" id="LN981">981</td><td class="line"> <span class='comment'>*              c = sqrt(z) - f = (z-f*f)/(s+f)         ...f+c=sqrt(z)</span></td></tr>
<tr class="codeline" data-linenumber="982"><td class="num" id="LN982">982</td><td class="line"> <span class='comment'>*      and</span></td></tr>
<tr class="codeline" data-linenumber="983"><td class="num" id="LN983">983</td><td class="line"> <span class='comment'>*              asin(x) = pi/2 - 2*(s+s*z*R(z))</span></td></tr>
<tr class="codeline" data-linenumber="984"><td class="num" id="LN984">984</td><td class="line"> <span class='comment'>*                      = pio4_hi+(pio4-2s)-(2s*z*R(z)-pio2_lo)</span></td></tr>
<tr class="codeline" data-linenumber="985"><td class="num" id="LN985">985</td><td class="line"> <span class='comment'>*                      = pio4_hi+(pio4-2f)-(2s*z*R(z)-(pio2_lo+2c))</span></td></tr>
<tr class="codeline" data-linenumber="986"><td class="num" id="LN986">986</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="987"><td class="num" id="LN987">987</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="988"><td class="num" id="LN988">988</td><td class="line"> <span class='comment'>*      if x is NaN, return x itself;</span></td></tr>
<tr class="codeline" data-linenumber="989"><td class="num" id="LN989">989</td><td class="line"> <span class='comment'>*      if |x|&gt;1, return NaN with invalid signal.</span></td></tr>
<tr class="codeline" data-linenumber="990"><td class="num" id="LN990">990</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="991"><td class="num" id="LN991">991</td><td class="line"><span class='keyword'>double</span> asin(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="992"><td class="num" id="LN992">992</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="993"><td class="num" id="LN993">993</td><td class="line">      one = 1.00000000000000000000e+00, <span class='comment'>/* 0x3FF00000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="994"><td class="num" id="LN994">994</td><td class="line">      huge = 1.000e+300,</td></tr>
<tr class="codeline" data-linenumber="995"><td class="num" id="LN995">995</td><td class="line">      pio2_hi = 1.57079632679489655800e+00, <span class='comment'>/* 0x3FF921FB, 0x54442D18 */</span></td></tr>
<tr class="codeline" data-linenumber="996"><td class="num" id="LN996">996</td><td class="line">      pio2_lo = 6.12323399573676603587e-17, <span class='comment'>/* 0x3C91A626, 0x33145C07 */</span></td></tr>
<tr class="codeline" data-linenumber="997"><td class="num" id="LN997">997</td><td class="line">      pio4_hi = 7.85398163397448278999e-01, <span class='comment'>/* 0x3FE921FB, 0x54442D18 */</span></td></tr>
<tr class="codeline" data-linenumber="998"><td class="num" id="LN998">998</td><td class="line">                                            <span class='comment'>/* coefficient for R(x^2) */</span></td></tr>
<tr class="codeline" data-linenumber="999"><td class="num" id="LN999">999</td><td class="line">      pS0 = 1.66666666666666657415e-01,     <span class='comment'>/* 0x3FC55555, 0x55555555 */</span></td></tr>
<tr class="codeline" data-linenumber="1000"><td class="num" id="LN1000">1000</td><td class="line">      pS1 = -3.25565818622400915405e-01,    <span class='comment'>/* 0xBFD4D612, 0x03EB6F7D */</span></td></tr>
<tr class="codeline" data-linenumber="1001"><td class="num" id="LN1001">1001</td><td class="line">      pS2 = 2.01212532134862925881e-01,     <span class='comment'>/* 0x3FC9C155, 0x0E884455 */</span></td></tr>
<tr class="codeline" data-linenumber="1002"><td class="num" id="LN1002">1002</td><td class="line">      pS3 = -4.00555345006794114027e-02,    <span class='comment'>/* 0xBFA48228, 0xB5688F3B */</span></td></tr>
<tr class="codeline" data-linenumber="1003"><td class="num" id="LN1003">1003</td><td class="line">      pS4 = 7.91534994289814532176e-04,     <span class='comment'>/* 0x3F49EFE0, 0x7501B288 */</span></td></tr>
<tr class="codeline" data-linenumber="1004"><td class="num" id="LN1004">1004</td><td class="line">      pS5 = 3.47933107596021167570e-05,     <span class='comment'>/* 0x3F023DE1, 0x0DFDF709 */</span></td></tr>
<tr class="codeline" data-linenumber="1005"><td class="num" id="LN1005">1005</td><td class="line">      qS1 = -2.40339491173441421878e+00,    <span class='comment'>/* 0xC0033A27, 0x1C8A2D4B */</span></td></tr>
<tr class="codeline" data-linenumber="1006"><td class="num" id="LN1006">1006</td><td class="line">      qS2 = 2.02094576023350569471e+00,     <span class='comment'>/* 0x40002AE5, 0x9C598AC8 */</span></td></tr>
<tr class="codeline" data-linenumber="1007"><td class="num" id="LN1007">1007</td><td class="line">      qS3 = -6.88283971605453293030e-01,    <span class='comment'>/* 0xBFE6066C, 0x1B8D0159 */</span></td></tr>
<tr class="codeline" data-linenumber="1008"><td class="num" id="LN1008">1008</td><td class="line">      qS4 = 7.70381505559019352791e-02;     <span class='comment'>/* 0x3FB3B8C5, 0xB12E9282 */</span></td></tr>
<tr class="codeline" data-linenumber="1009"><td class="num" id="LN1009">1009</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1010"><td class="num" id="LN1010">1010</td><td class="line">  <span class='keyword'>double</span> t, w, p, q, c, r, s;</td></tr>
<tr class="codeline" data-linenumber="1011"><td class="num" id="LN1011">1011</td><td class="line">  int32_t hx, ix;</td></tr>
<tr class="codeline" data-linenumber="1012"><td class="num" id="LN1012">1012</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1013"><td class="num" id="LN1013">1013</td><td class="line">  t = 0;</td></tr>
<tr class="codeline" data-linenumber="1014"><td class="num" id="LN1014">1014</td><td class="line">  GET_HIGH_WORD(hx, x);</td></tr>
<tr class="codeline" data-linenumber="1015"><td class="num" id="LN1015">1015</td><td class="line">  ix = hx &amp; 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="1016"><td class="num" id="LN1016">1016</td><td class="line">  <span class='keyword'>if</span> (ix &gt;= 0x3FF00000) { <span class='comment'>/* |x|&gt;= 1 */</span></td></tr>
<tr class="codeline" data-linenumber="1017"><td class="num" id="LN1017">1017</td><td class="line">    uint32_t lx;</td></tr>
<tr class="codeline" data-linenumber="1018"><td class="num" id="LN1018">1018</td><td class="line">    GET_LOW_WORD(lx, x);</td></tr>
<tr class="codeline" data-linenumber="1019"><td class="num" id="LN1019">1019</td><td class="line">    <span class='keyword'>if</span> (((ix - 0x3FF00000) | lx) == 0) { <span class='comment'>/* asin(1)=+-pi/2 with inexact */</span></td></tr>
<tr class="codeline" data-linenumber="1020"><td class="num" id="LN1020">1020</td><td class="line">      <span class='keyword'>return</span> x * pio2_hi + x * pio2_lo;</td></tr>
<tr class="codeline" data-linenumber="1021"><td class="num" id="LN1021">1021</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1022"><td class="num" id="LN1022">1022</td><td class="line">    <span class='keyword'>return</span> std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::signaling_NaN();  <span class='comment'>// asin(|x|&gt;1) is NaN</span></td></tr>
<tr class="codeline" data-linenumber="1023"><td class="num" id="LN1023">1023</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (ix &lt; 0x3FE00000) {     <span class='comment'>/* |x|&lt;0.5 */</span></td></tr>
<tr class="codeline" data-linenumber="1024"><td class="num" id="LN1024">1024</td><td class="line">    <span class='keyword'>if</span> (ix &lt; 0x3E400000) {          <span class='comment'>/* if |x| &lt; 2**-27 */</span></td></tr>
<tr class="codeline" data-linenumber="1025"><td class="num" id="LN1025">1025</td><td class="line">      <span class='keyword'>if</span> (huge + x &gt; one) <span class='keyword'>return</span> x; <span class='comment'>/* return x with inexact if x!=0*/</span></td></tr>
<tr class="codeline" data-linenumber="1026"><td class="num" id="LN1026">1026</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1027"><td class="num" id="LN1027">1027</td><td class="line">      t = x * x;</td></tr>
<tr class="codeline" data-linenumber="1028"><td class="num" id="LN1028">1028</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1029"><td class="num" id="LN1029">1029</td><td class="line">    p = t * (pS0 + t * (pS1 + t * (pS2 + t * (pS3 + t * (pS4 + t * pS5)))));</td></tr>
<tr class="codeline" data-linenumber="1030"><td class="num" id="LN1030">1030</td><td class="line">    q = one + t * (qS1 + t * (qS2 + t * (qS3 + t * qS4)));</td></tr>
<tr class="codeline" data-linenumber="1031"><td class="num" id="LN1031">1031</td><td class="line">    w = p / q;</td></tr>
<tr class="codeline" data-linenumber="1032"><td class="num" id="LN1032">1032</td><td class="line">    <span class='keyword'>return</span> x + x * w;</td></tr>
<tr class="codeline" data-linenumber="1033"><td class="num" id="LN1033">1033</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1034"><td class="num" id="LN1034">1034</td><td class="line">  <span class='comment'>/* 1&gt; |x|&gt;= 0.5 */</span></td></tr>
<tr class="codeline" data-linenumber="1035"><td class="num" id="LN1035">1035</td><td class="line">  w = one - fabs(x);</td></tr>
<tr class="codeline" data-linenumber="1036"><td class="num" id="LN1036">1036</td><td class="line">  t = w * 0.5;</td></tr>
<tr class="codeline" data-linenumber="1037"><td class="num" id="LN1037">1037</td><td class="line">  p = t * (pS0 + t * (pS1 + t * (pS2 + t * (pS3 + t * (pS4 + t * pS5)))));</td></tr>
<tr class="codeline" data-linenumber="1038"><td class="num" id="LN1038">1038</td><td class="line">  q = one + t * (qS1 + t * (qS2 + t * (qS3 + t * qS4)));</td></tr>
<tr class="codeline" data-linenumber="1039"><td class="num" id="LN1039">1039</td><td class="line">  s = sqrt(t);</td></tr>
<tr class="codeline" data-linenumber="1040"><td class="num" id="LN1040">1040</td><td class="line">  <span class='keyword'>if</span> (ix &gt;= 0x3FEF3333) { <span class='comment'>/* if |x| &gt; 0.975 */</span></td></tr>
<tr class="codeline" data-linenumber="1041"><td class="num" id="LN1041">1041</td><td class="line">    w = p / q;</td></tr>
<tr class="codeline" data-linenumber="1042"><td class="num" id="LN1042">1042</td><td class="line">    t = pio2_hi - (2.0 * (s + s * w) - pio2_lo);</td></tr>
<tr class="codeline" data-linenumber="1043"><td class="num" id="LN1043">1043</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1044"><td class="num" id="LN1044">1044</td><td class="line">    w = s;</td></tr>
<tr class="codeline" data-linenumber="1045"><td class="num" id="LN1045">1045</td><td class="line">    SET_LOW_WORD(w, 0);</td></tr>
<tr class="codeline" data-linenumber="1046"><td class="num" id="LN1046">1046</td><td class="line">    c = (t - w * w) / (s + w);</td></tr>
<tr class="codeline" data-linenumber="1047"><td class="num" id="LN1047">1047</td><td class="line">    r = p / q;</td></tr>
<tr class="codeline" data-linenumber="1048"><td class="num" id="LN1048">1048</td><td class="line">    p = 2.0 * s * r - (pio2_lo - 2.0 * c);</td></tr>
<tr class="codeline" data-linenumber="1049"><td class="num" id="LN1049">1049</td><td class="line">    q = pio4_hi - 2.0 * w;</td></tr>
<tr class="codeline" data-linenumber="1050"><td class="num" id="LN1050">1050</td><td class="line">    t = pio4_hi - (p - q);</td></tr>
<tr class="codeline" data-linenumber="1051"><td class="num" id="LN1051">1051</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1052"><td class="num" id="LN1052">1052</td><td class="line">  <span class='keyword'>if</span> (hx &gt; 0)</td></tr>
<tr class="codeline" data-linenumber="1053"><td class="num" id="LN1053">1053</td><td class="line">    <span class='keyword'>return</span> t;</td></tr>
<tr class="codeline" data-linenumber="1054"><td class="num" id="LN1054">1054</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="1055"><td class="num" id="LN1055">1055</td><td class="line">    <span class='keyword'>return</span> -t;</td></tr>
<tr class="codeline" data-linenumber="1056"><td class="num" id="LN1056">1056</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1057"><td class="num" id="LN1057">1057</td><td class="line"><span class='comment'>/* asinh(x)</span></td></tr>
<tr class="codeline" data-linenumber="1058"><td class="num" id="LN1058">1058</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="1059"><td class="num" id="LN1059">1059</td><td class="line"> <span class='comment'>*      Based on</span></td></tr>
<tr class="codeline" data-linenumber="1060"><td class="num" id="LN1060">1060</td><td class="line"> <span class='comment'>*              asinh(x) = sign(x) * log [ |x| + sqrt(x*x+1) ]</span></td></tr>
<tr class="codeline" data-linenumber="1061"><td class="num" id="LN1061">1061</td><td class="line"> <span class='comment'>*      we have</span></td></tr>
<tr class="codeline" data-linenumber="1062"><td class="num" id="LN1062">1062</td><td class="line"> <span class='comment'>*      asinh(x) := x  if  1+x*x=1,</span></td></tr>
<tr class="codeline" data-linenumber="1063"><td class="num" id="LN1063">1063</td><td class="line"> <span class='comment'>*               := sign(x)*(log(x)+ln2)) for large |x|, else</span></td></tr>
<tr class="codeline" data-linenumber="1064"><td class="num" id="LN1064">1064</td><td class="line"> <span class='comment'>*               := sign(x)*log(2|x|+1/(|x|+sqrt(x*x+1))) if|x|&gt;2, else</span></td></tr>
<tr class="codeline" data-linenumber="1065"><td class="num" id="LN1065">1065</td><td class="line"> <span class='comment'>*               := sign(x)*log1p(|x| + x^2/(1 + sqrt(1+x^2)))</span></td></tr>
<tr class="codeline" data-linenumber="1066"><td class="num" id="LN1066">1066</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1067"><td class="num" id="LN1067">1067</td><td class="line"><span class='keyword'>double</span> asinh(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="1068"><td class="num" id="LN1068">1068</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="1069"><td class="num" id="LN1069">1069</td><td class="line">      one = 1.00000000000000000000e+00, <span class='comment'>/* 0x3FF00000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="1070"><td class="num" id="LN1070">1070</td><td class="line">      ln2 = 6.93147180559945286227e-01, <span class='comment'>/* 0x3FE62E42, 0xFEFA39EF */</span></td></tr>
<tr class="codeline" data-linenumber="1071"><td class="num" id="LN1071">1071</td><td class="line">      huge = 1.00000000000000000000e+300;</td></tr>
<tr class="codeline" data-linenumber="1072"><td class="num" id="LN1072">1072</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1073"><td class="num" id="LN1073">1073</td><td class="line">  <span class='keyword'>double</span> t, w;</td></tr>
<tr class="codeline" data-linenumber="1074"><td class="num" id="LN1074">1074</td><td class="line">  int32_t hx, ix;</td></tr>
<tr class="codeline" data-linenumber="1075"><td class="num" id="LN1075">1075</td><td class="line">  GET_HIGH_WORD(hx, x);</td></tr>
<tr class="codeline" data-linenumber="1076"><td class="num" id="LN1076">1076</td><td class="line">  ix = hx &amp; 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="1077"><td class="num" id="LN1077">1077</td><td class="line">  <span class='keyword'>if</span> (ix &gt;= 0x7FF00000) <span class='keyword'>return</span> x + x; <span class='comment'>/* x is inf or NaN */</span></td></tr>
<tr class="codeline" data-linenumber="1078"><td class="num" id="LN1078">1078</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x3E300000) {              <span class='comment'>/* |x|&lt;2**-28 */</span></td></tr>
<tr class="codeline" data-linenumber="1079"><td class="num" id="LN1079">1079</td><td class="line">    <span class='keyword'>if</span> (huge + x &gt; one) <span class='keyword'>return</span> x;     <span class='comment'>/* return x inexact except 0 */</span></td></tr>
<tr class="codeline" data-linenumber="1080"><td class="num" id="LN1080">1080</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1081"><td class="num" id="LN1081">1081</td><td class="line">  <span class='keyword'>if</span> (ix &gt; 0x41B00000) { <span class='comment'>/* |x| &gt; 2**28 */</span></td></tr>
<tr class="codeline" data-linenumber="1082"><td class="num" id="LN1082">1082</td><td class="line">    w = log(fabs(x)) + ln2;</td></tr>
<tr class="codeline" data-linenumber="1083"><td class="num" id="LN1083">1083</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (ix &gt; 0x40000000) { <span class='comment'>/* 2**28 &gt; |x| &gt; 2.0 */</span></td></tr>
<tr class="codeline" data-linenumber="1084"><td class="num" id="LN1084">1084</td><td class="line">    t = fabs(x);</td></tr>
<tr class="codeline" data-linenumber="1085"><td class="num" id="LN1085">1085</td><td class="line">    w = log(2.0 * t + one / (sqrt(x * x + one) + t));</td></tr>
<tr class="codeline" data-linenumber="1086"><td class="num" id="LN1086">1086</td><td class="line">  } <span class='keyword'>else</span> { <span class='comment'>/* 2.0 &gt; |x| &gt; 2**-28 */</span></td></tr>
<tr class="codeline" data-linenumber="1087"><td class="num" id="LN1087">1087</td><td class="line">    t = x * x;</td></tr>
<tr class="codeline" data-linenumber="1088"><td class="num" id="LN1088">1088</td><td class="line">    w = log1p(fabs(x) + t / (one + sqrt(one + t)));</td></tr>
<tr class="codeline" data-linenumber="1089"><td class="num" id="LN1089">1089</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1090"><td class="num" id="LN1090">1090</td><td class="line">  <span class='keyword'>if</span> (hx &gt; 0) {</td></tr>
<tr class="codeline" data-linenumber="1091"><td class="num" id="LN1091">1091</td><td class="line">    <span class='keyword'>return</span> w;</td></tr>
<tr class="codeline" data-linenumber="1092"><td class="num" id="LN1092">1092</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1093"><td class="num" id="LN1093">1093</td><td class="line">    <span class='keyword'>return</span> -w;</td></tr>
<tr class="codeline" data-linenumber="1094"><td class="num" id="LN1094">1094</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1095"><td class="num" id="LN1095">1095</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1096"><td class="num" id="LN1096">1096</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1097"><td class="num" id="LN1097">1097</td><td class="line"><span class='comment'>/* atan(x)</span></td></tr>
<tr class="codeline" data-linenumber="1098"><td class="num" id="LN1098">1098</td><td class="line"> <span class='comment'>* Method</span></td></tr>
<tr class="codeline" data-linenumber="1099"><td class="num" id="LN1099">1099</td><td class="line"> <span class='comment'>*   1. Reduce x to positive by atan(x) = -atan(-x).</span></td></tr>
<tr class="codeline" data-linenumber="1100"><td class="num" id="LN1100">1100</td><td class="line"> <span class='comment'>*   2. According to the integer k=4t+0.25 chopped, t=x, the argument</span></td></tr>
<tr class="codeline" data-linenumber="1101"><td class="num" id="LN1101">1101</td><td class="line"> <span class='comment'>*      is further reduced to one of the following intervals and the</span></td></tr>
<tr class="codeline" data-linenumber="1102"><td class="num" id="LN1102">1102</td><td class="line"> <span class='comment'>*      arctangent of t is evaluated by the corresponding formula:</span></td></tr>
<tr class="codeline" data-linenumber="1103"><td class="num" id="LN1103">1103</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1104"><td class="num" id="LN1104">1104</td><td class="line"> <span class='comment'>*      [0,7/16]      atan(x) = t-t^3*(a1+t^2*(a2+...(a10+t^2*a11)...)</span></td></tr>
<tr class="codeline" data-linenumber="1105"><td class="num" id="LN1105">1105</td><td class="line"> <span class='comment'>*      [7/16,11/16]  atan(x) = atan(1/2) + atan( (t-0.5)/(1+t/2) )</span></td></tr>
<tr class="codeline" data-linenumber="1106"><td class="num" id="LN1106">1106</td><td class="line"> <span class='comment'>*      [11/16.19/16] atan(x) = atan( 1 ) + atan( (t-1)/(1+t) )</span></td></tr>
<tr class="codeline" data-linenumber="1107"><td class="num" id="LN1107">1107</td><td class="line"> <span class='comment'>*      [19/16,39/16] atan(x) = atan(3/2) + atan( (t-1.5)/(1+1.5t) )</span></td></tr>
<tr class="codeline" data-linenumber="1108"><td class="num" id="LN1108">1108</td><td class="line"> <span class='comment'>*      [39/16,INF]   atan(x) = atan(INF) + atan( -1/t )</span></td></tr>
<tr class="codeline" data-linenumber="1109"><td class="num" id="LN1109">1109</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1110"><td class="num" id="LN1110">1110</td><td class="line"> <span class='comment'>* Constants:</span></td></tr>
<tr class="codeline" data-linenumber="1111"><td class="num" id="LN1111">1111</td><td class="line"> <span class='comment'>* The hexadecimal values are the intended ones for the following</span></td></tr>
<tr class="codeline" data-linenumber="1112"><td class="num" id="LN1112">1112</td><td class="line"> <span class='comment'>* constants. The decimal values may be used, provided that the</span></td></tr>
<tr class="codeline" data-linenumber="1113"><td class="num" id="LN1113">1113</td><td class="line"> <span class='comment'>* compiler will convert from decimal to binary accurately enough</span></td></tr>
<tr class="codeline" data-linenumber="1114"><td class="num" id="LN1114">1114</td><td class="line"> <span class='comment'>* to produce the hexadecimal values shown.</span></td></tr>
<tr class="codeline" data-linenumber="1115"><td class="num" id="LN1115">1115</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1116"><td class="num" id="LN1116">1116</td><td class="line"><span class='keyword'>double</span> atan(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="1117"><td class="num" id="LN1117">1117</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> atanhi[] = {</td></tr>
<tr class="codeline" data-linenumber="1118"><td class="num" id="LN1118">1118</td><td class="line">      4.63647609000806093515e-01, <span class='comment'>/* atan(0.5)hi 0x3FDDAC67, 0x0561BB4F */</span></td></tr>
<tr class="codeline" data-linenumber="1119"><td class="num" id="LN1119">1119</td><td class="line">      7.85398163397448278999e-01, <span class='comment'>/* atan(1.0)hi 0x3FE921FB, 0x54442D18 */</span></td></tr>
<tr class="codeline" data-linenumber="1120"><td class="num" id="LN1120">1120</td><td class="line">      9.82793723247329054082e-01, <span class='comment'>/* atan(1.5)hi 0x3FEF730B, 0xD281F69B */</span></td></tr>
<tr class="codeline" data-linenumber="1121"><td class="num" id="LN1121">1121</td><td class="line">      1.57079632679489655800e+00, <span class='comment'>/* atan(inf)hi 0x3FF921FB, 0x54442D18 */</span></td></tr>
<tr class="codeline" data-linenumber="1122"><td class="num" id="LN1122">1122</td><td class="line">  };</td></tr>
<tr class="codeline" data-linenumber="1123"><td class="num" id="LN1123">1123</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1124"><td class="num" id="LN1124">1124</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> atanlo[] = {</td></tr>
<tr class="codeline" data-linenumber="1125"><td class="num" id="LN1125">1125</td><td class="line">      2.26987774529616870924e-17, <span class='comment'>/* atan(0.5)lo 0x3C7A2B7F, 0x222F65E2 */</span></td></tr>
<tr class="codeline" data-linenumber="1126"><td class="num" id="LN1126">1126</td><td class="line">      3.06161699786838301793e-17, <span class='comment'>/* atan(1.0)lo 0x3C81A626, 0x33145C07 */</span></td></tr>
<tr class="codeline" data-linenumber="1127"><td class="num" id="LN1127">1127</td><td class="line">      1.39033110312309984516e-17, <span class='comment'>/* atan(1.5)lo 0x3C700788, 0x7AF0CBBD */</span></td></tr>
<tr class="codeline" data-linenumber="1128"><td class="num" id="LN1128">1128</td><td class="line">      6.12323399573676603587e-17, <span class='comment'>/* atan(inf)lo 0x3C91A626, 0x33145C07 */</span></td></tr>
<tr class="codeline" data-linenumber="1129"><td class="num" id="LN1129">1129</td><td class="line">  };</td></tr>
<tr class="codeline" data-linenumber="1130"><td class="num" id="LN1130">1130</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1131"><td class="num" id="LN1131">1131</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> aT[] = {</td></tr>
<tr class="codeline" data-linenumber="1132"><td class="num" id="LN1132">1132</td><td class="line">      3.33333333333329318027e-01,  <span class='comment'>/* 0x3FD55555, 0x5555550D */</span></td></tr>
<tr class="codeline" data-linenumber="1133"><td class="num" id="LN1133">1133</td><td class="line">      -1.99999999998764832476e-01, <span class='comment'>/* 0xBFC99999, 0x9998EBC4 */</span></td></tr>
<tr class="codeline" data-linenumber="1134"><td class="num" id="LN1134">1134</td><td class="line">      1.42857142725034663711e-01,  <span class='comment'>/* 0x3FC24924, 0x920083FF */</span></td></tr>
<tr class="codeline" data-linenumber="1135"><td class="num" id="LN1135">1135</td><td class="line">      -1.11111104054623557880e-01, <span class='comment'>/* 0xBFBC71C6, 0xFE231671 */</span></td></tr>
<tr class="codeline" data-linenumber="1136"><td class="num" id="LN1136">1136</td><td class="line">      9.09088713343650656196e-02,  <span class='comment'>/* 0x3FB745CD, 0xC54C206E */</span></td></tr>
<tr class="codeline" data-linenumber="1137"><td class="num" id="LN1137">1137</td><td class="line">      -7.69187620504482999495e-02, <span class='comment'>/* 0xBFB3B0F2, 0xAF749A6D */</span></td></tr>
<tr class="codeline" data-linenumber="1138"><td class="num" id="LN1138">1138</td><td class="line">      6.66107313738753120669e-02,  <span class='comment'>/* 0x3FB10D66, 0xA0D03D51 */</span></td></tr>
<tr class="codeline" data-linenumber="1139"><td class="num" id="LN1139">1139</td><td class="line">      -5.83357013379057348645e-02, <span class='comment'>/* 0xBFADDE2D, 0x52DEFD9A */</span></td></tr>
<tr class="codeline" data-linenumber="1140"><td class="num" id="LN1140">1140</td><td class="line">      4.97687799461593236017e-02,  <span class='comment'>/* 0x3FA97B4B, 0x24760DEB */</span></td></tr>
<tr class="codeline" data-linenumber="1141"><td class="num" id="LN1141">1141</td><td class="line">      -3.65315727442169155270e-02, <span class='comment'>/* 0xBFA2B444, 0x2C6A6C2F */</span></td></tr>
<tr class="codeline" data-linenumber="1142"><td class="num" id="LN1142">1142</td><td class="line">      1.62858201153657823623e-02,  <span class='comment'>/* 0x3F90AD3A, 0xE322DA11 */</span></td></tr>
<tr class="codeline" data-linenumber="1143"><td class="num" id="LN1143">1143</td><td class="line">  };</td></tr>
<tr class="codeline" data-linenumber="1144"><td class="num" id="LN1144">1144</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1145"><td class="num" id="LN1145">1145</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> one = 1.0, huge = 1.0e300;</td></tr>
<tr class="codeline" data-linenumber="1146"><td class="num" id="LN1146">1146</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1147"><td class="num" id="LN1147">1147</td><td class="line">  <span class='keyword'>double</span> w, s1, s2, z;</td></tr>
<tr class="codeline" data-linenumber="1148"><td class="num" id="LN1148">1148</td><td class="line">  int32_t ix, hx, id;</td></tr>
<tr class="codeline" data-linenumber="1149"><td class="num" id="LN1149">1149</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1150"><td class="num" id="LN1150">1150</td><td class="line">  GET_HIGH_WORD(hx, x);</td></tr>
<tr class="codeline" data-linenumber="1151"><td class="num" id="LN1151">1151</td><td class="line">  ix = hx &amp; 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="1152"><td class="num" id="LN1152">1152</td><td class="line">  <span class='keyword'>if</span> (ix &gt;= 0x44100000) { <span class='comment'>/* if |x| &gt;= 2^66 */</span></td></tr>
<tr class="codeline" data-linenumber="1153"><td class="num" id="LN1153">1153</td><td class="line">    uint32_t low;</td></tr>
<tr class="codeline" data-linenumber="1154"><td class="num" id="LN1154">1154</td><td class="line">    GET_LOW_WORD(low, x);</td></tr>
<tr class="codeline" data-linenumber="1155"><td class="num" id="LN1155">1155</td><td class="line">    <span class='keyword'>if</span> (ix &gt; 0x7FF00000 || (ix == 0x7FF00000 &amp;&amp; (low != 0)))</td></tr>
<tr class="codeline" data-linenumber="1156"><td class="num" id="LN1156">1156</td><td class="line">      <span class='keyword'>return</span> x + x; <span class='comment'>/* NaN */</span></td></tr>
<tr class="codeline" data-linenumber="1157"><td class="num" id="LN1157">1157</td><td class="line">    <span class='keyword'>if</span> (hx &gt; 0)</td></tr>
<tr class="codeline" data-linenumber="1158"><td class="num" id="LN1158">1158</td><td class="line">      <span class='keyword'>return</span> atanhi[3] + *<span class='keyword'>const_cast</span>&lt;<span class='keyword'>volatile</span> <span class='keyword'>double</span>*&gt;(&amp;atanlo[3]);</td></tr>
<tr class="codeline" data-linenumber="1159"><td class="num" id="LN1159">1159</td><td class="line">    <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="1160"><td class="num" id="LN1160">1160</td><td class="line">      <span class='keyword'>return</span> -atanhi[3] - *<span class='keyword'>const_cast</span>&lt;<span class='keyword'>volatile</span> <span class='keyword'>double</span>*&gt;(&amp;atanlo[3]);</td></tr>
<tr class="codeline" data-linenumber="1161"><td class="num" id="LN1161">1161</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1162"><td class="num" id="LN1162">1162</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x3FDC0000) {            <span class='comment'>/* |x| &lt; 0.4375 */</span></td></tr>
<tr class="codeline" data-linenumber="1163"><td class="num" id="LN1163">1163</td><td class="line">    <span class='keyword'>if</span> (ix &lt; 0x3E400000) {          <span class='comment'>/* |x| &lt; 2^-27 */</span></td></tr>
<tr class="codeline" data-linenumber="1164"><td class="num" id="LN1164">1164</td><td class="line">      <span class='keyword'>if</span> (huge + x &gt; one) <span class='keyword'>return</span> x; <span class='comment'>/* raise inexact */</span></td></tr>
<tr class="codeline" data-linenumber="1165"><td class="num" id="LN1165">1165</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1166"><td class="num" id="LN1166">1166</td><td class="line">    id = -1;</td></tr>
<tr class="codeline" data-linenumber="1167"><td class="num" id="LN1167">1167</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1168"><td class="num" id="LN1168">1168</td><td class="line">    x = fabs(x);</td></tr>
<tr class="codeline" data-linenumber="1169"><td class="num" id="LN1169">1169</td><td class="line">    <span class='keyword'>if</span> (ix &lt; 0x3FF30000) {   <span class='comment'>/* |x| &lt; 1.1875 */</span></td></tr>
<tr class="codeline" data-linenumber="1170"><td class="num" id="LN1170">1170</td><td class="line">      <span class='keyword'>if</span> (ix &lt; 0x3FE60000) { <span class='comment'>/* 7/16 &lt;=|x|&lt;11/16 */</span></td></tr>
<tr class="codeline" data-linenumber="1171"><td class="num" id="LN1171">1171</td><td class="line">        id = 0;</td></tr>
<tr class="codeline" data-linenumber="1172"><td class="num" id="LN1172">1172</td><td class="line">        x = (2.0 * x - one) / (2.0 + x);</td></tr>
<tr class="codeline" data-linenumber="1173"><td class="num" id="LN1173">1173</td><td class="line">      } <span class='keyword'>else</span> { <span class='comment'>/* 11/16&lt;=|x|&lt; 19/16 */</span></td></tr>
<tr class="codeline" data-linenumber="1174"><td class="num" id="LN1174">1174</td><td class="line">        id = 1;</td></tr>
<tr class="codeline" data-linenumber="1175"><td class="num" id="LN1175">1175</td><td class="line">        x = (x - one) / (x + one);</td></tr>
<tr class="codeline" data-linenumber="1176"><td class="num" id="LN1176">1176</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="1177"><td class="num" id="LN1177">1177</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1178"><td class="num" id="LN1178">1178</td><td class="line">      <span class='keyword'>if</span> (ix &lt; 0x40038000) { <span class='comment'>/* |x| &lt; 2.4375 */</span></td></tr>
<tr class="codeline" data-linenumber="1179"><td class="num" id="LN1179">1179</td><td class="line">        id = 2;</td></tr>
<tr class="codeline" data-linenumber="1180"><td class="num" id="LN1180">1180</td><td class="line">        x = (x - 1.5) / (one + 1.5 * x);</td></tr>
<tr class="codeline" data-linenumber="1181"><td class="num" id="LN1181">1181</td><td class="line">      } <span class='keyword'>else</span> { <span class='comment'>/* 2.4375 &lt;= |x| &lt; 2^66 */</span></td></tr>
<tr class="codeline" data-linenumber="1182"><td class="num" id="LN1182">1182</td><td class="line">        id = 3;</td></tr>
<tr class="codeline" data-linenumber="1183"><td class="num" id="LN1183">1183</td><td class="line">        x = -1.0 / x;</td></tr>
<tr class="codeline" data-linenumber="1184"><td class="num" id="LN1184">1184</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="1185"><td class="num" id="LN1185">1185</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1186"><td class="num" id="LN1186">1186</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1187"><td class="num" id="LN1187">1187</td><td class="line">  <span class='comment'>/* end of argument reduction */</span></td></tr>
<tr class="codeline" data-linenumber="1188"><td class="num" id="LN1188">1188</td><td class="line">  z = x * x;</td></tr>
<tr class="codeline" data-linenumber="1189"><td class="num" id="LN1189">1189</td><td class="line">  w = z * z;</td></tr>
<tr class="codeline" data-linenumber="1190"><td class="num" id="LN1190">1190</td><td class="line">  <span class='comment'>/* break sum from i=0 to 10 aT[i]z**(i+1) into odd and even poly */</span></td></tr>
<tr class="codeline" data-linenumber="1191"><td class="num" id="LN1191">1191</td><td class="line">  s1 = z * (aT[0] +</td></tr>
<tr class="codeline" data-linenumber="1192"><td class="num" id="LN1192">1192</td><td class="line">            w * (aT[2] + w * (aT[4] + w * (aT[6] + w * (aT[8] + w * aT[10])))));</td></tr>
<tr class="codeline" data-linenumber="1193"><td class="num" id="LN1193">1193</td><td class="line">  s2 = w * (aT[1] + w * (aT[3] + w * (aT[5] + w * (aT[7] + w * aT[9]))));</td></tr>
<tr class="codeline" data-linenumber="1194"><td class="num" id="LN1194">1194</td><td class="line">  <span class='keyword'>if</span> (id &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="1195"><td class="num" id="LN1195">1195</td><td class="line">    <span class='keyword'>return</span> x - x * (s1 + s2);</td></tr>
<tr class="codeline" data-linenumber="1196"><td class="num" id="LN1196">1196</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1197"><td class="num" id="LN1197">1197</td><td class="line">    z = atanhi[id] - ((x * (s1 + s2) - atanlo[id]) - x);</td></tr>
<tr class="codeline" data-linenumber="1198"><td class="num" id="LN1198">1198</td><td class="line">    <span class='keyword'>return</span> (hx &lt; 0) ? -z : z;</td></tr>
<tr class="codeline" data-linenumber="1199"><td class="num" id="LN1199">1199</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1200"><td class="num" id="LN1200">1200</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1201"><td class="num" id="LN1201">1201</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1202"><td class="num" id="LN1202">1202</td><td class="line"><span class='comment'>/* atan2(y,x)</span></td></tr>
<tr class="codeline" data-linenumber="1203"><td class="num" id="LN1203">1203</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="1204"><td class="num" id="LN1204">1204</td><td class="line"> <span class='comment'>*  1. Reduce y to positive by atan2(y,x)=-atan2(-y,x).</span></td></tr>
<tr class="codeline" data-linenumber="1205"><td class="num" id="LN1205">1205</td><td class="line"> <span class='comment'>*  2. Reduce x to positive by (if x and y are unexceptional):</span></td></tr>
<tr class="codeline" data-linenumber="1206"><td class="num" id="LN1206">1206</td><td class="line"> <span class='comment'>*    ARG (x+iy) = arctan(y/x)       ... if x &gt; 0,</span></td></tr>
<tr class="codeline" data-linenumber="1207"><td class="num" id="LN1207">1207</td><td class="line"> <span class='comment'>*    ARG (x+iy) = pi - arctan[y/(-x)]   ... if x &lt; 0,</span></td></tr>
<tr class="codeline" data-linenumber="1208"><td class="num" id="LN1208">1208</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1209"><td class="num" id="LN1209">1209</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="1210"><td class="num" id="LN1210">1210</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1211"><td class="num" id="LN1211">1211</td><td class="line"> <span class='comment'>*  ATAN2((anything), NaN ) is NaN;</span></td></tr>
<tr class="codeline" data-linenumber="1212"><td class="num" id="LN1212">1212</td><td class="line"> <span class='comment'>*  ATAN2(NAN , (anything) ) is NaN;</span></td></tr>
<tr class="codeline" data-linenumber="1213"><td class="num" id="LN1213">1213</td><td class="line"> <span class='comment'>*  ATAN2(+-0, +(anything but NaN)) is +-0  ;</span></td></tr>
<tr class="codeline" data-linenumber="1214"><td class="num" id="LN1214">1214</td><td class="line"> <span class='comment'>*  ATAN2(+-0, -(anything but NaN)) is +-pi ;</span></td></tr>
<tr class="codeline" data-linenumber="1215"><td class="num" id="LN1215">1215</td><td class="line"> <span class='comment'>*  ATAN2(+-(anything but 0 and NaN), 0) is +-pi/2;</span></td></tr>
<tr class="codeline" data-linenumber="1216"><td class="num" id="LN1216">1216</td><td class="line"> <span class='comment'>*  ATAN2(+-(anything but INF and NaN), +INF) is +-0 ;</span></td></tr>
<tr class="codeline" data-linenumber="1217"><td class="num" id="LN1217">1217</td><td class="line"> <span class='comment'>*  ATAN2(+-(anything but INF and NaN), -INF) is +-pi;</span></td></tr>
<tr class="codeline" data-linenumber="1218"><td class="num" id="LN1218">1218</td><td class="line"> <span class='comment'>*  ATAN2(+-INF,+INF ) is +-pi/4 ;</span></td></tr>
<tr class="codeline" data-linenumber="1219"><td class="num" id="LN1219">1219</td><td class="line"> <span class='comment'>*  ATAN2(+-INF,-INF ) is +-3pi/4;</span></td></tr>
<tr class="codeline" data-linenumber="1220"><td class="num" id="LN1220">1220</td><td class="line"> <span class='comment'>*  ATAN2(+-INF, (anything but,0,NaN, and INF)) is +-pi/2;</span></td></tr>
<tr class="codeline" data-linenumber="1221"><td class="num" id="LN1221">1221</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1222"><td class="num" id="LN1222">1222</td><td class="line"> <span class='comment'>* Constants:</span></td></tr>
<tr class="codeline" data-linenumber="1223"><td class="num" id="LN1223">1223</td><td class="line"> <span class='comment'>* The hexadecimal values are the intended ones for the following</span></td></tr>
<tr class="codeline" data-linenumber="1224"><td class="num" id="LN1224">1224</td><td class="line"> <span class='comment'>* constants. The decimal values may be used, provided that the</span></td></tr>
<tr class="codeline" data-linenumber="1225"><td class="num" id="LN1225">1225</td><td class="line"> <span class='comment'>* compiler will convert from decimal to binary accurately enough</span></td></tr>
<tr class="codeline" data-linenumber="1226"><td class="num" id="LN1226">1226</td><td class="line"> <span class='comment'>* to produce the hexadecimal values shown.</span></td></tr>
<tr class="codeline" data-linenumber="1227"><td class="num" id="LN1227">1227</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1228"><td class="num" id="LN1228">1228</td><td class="line"><span class='keyword'>double</span> atan2(<span class='keyword'>double</span> y, <span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="1229"><td class="num" id="LN1229">1229</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>volatile</span> <span class='keyword'>double</span> tiny = 1.0e-300;</td></tr>
<tr class="codeline" data-linenumber="1230"><td class="num" id="LN1230">1230</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="1231"><td class="num" id="LN1231">1231</td><td class="line">      zero = 0.0,</td></tr>
<tr class="codeline" data-linenumber="1232"><td class="num" id="LN1232">1232</td><td class="line">      pi_o_4 = 7.8539816339744827900E-01, <span class='comment'>/* 0x3FE921FB, 0x54442D18 */</span></td></tr>
<tr class="codeline" data-linenumber="1233"><td class="num" id="LN1233">1233</td><td class="line">      pi_o_2 = 1.5707963267948965580E+00, <span class='comment'>/* 0x3FF921FB, 0x54442D18 */</span></td></tr>
<tr class="codeline" data-linenumber="1234"><td class="num" id="LN1234">1234</td><td class="line">      pi = 3.1415926535897931160E+00;     <span class='comment'>/* 0x400921FB, 0x54442D18 */</span></td></tr>
<tr class="codeline" data-linenumber="1235"><td class="num" id="LN1235">1235</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>volatile</span> <span class='keyword'>double</span> pi_lo =</td></tr>
<tr class="codeline" data-linenumber="1236"><td class="num" id="LN1236">1236</td><td class="line">      1.2246467991473531772E-16; <span class='comment'>/* 0x3CA1A626, 0x33145C07 */</span></td></tr>
<tr class="codeline" data-linenumber="1237"><td class="num" id="LN1237">1237</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1238"><td class="num" id="LN1238">1238</td><td class="line">  <span class='keyword'>double</span> z;</td></tr>
<tr class="codeline" data-linenumber="1239"><td class="num" id="LN1239">1239</td><td class="line">  int32_t k, m, hx, hy, ix, iy;</td></tr>
<tr class="codeline" data-linenumber="1240"><td class="num" id="LN1240">1240</td><td class="line">  uint32_t lx, ly;</td></tr>
<tr class="codeline" data-linenumber="1241"><td class="num" id="LN1241">1241</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1242"><td class="num" id="LN1242">1242</td><td class="line">  EXTRACT_WORDS(hx, lx, x);</td></tr>
<tr class="codeline" data-linenumber="1243"><td class="num" id="LN1243">1243</td><td class="line">  ix = hx &amp; 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="1244"><td class="num" id="LN1244">1244</td><td class="line">  EXTRACT_WORDS(hy, ly, y);</td></tr>
<tr class="codeline" data-linenumber="1245"><td class="num" id="LN1245">1245</td><td class="line">  iy = hy &amp; 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="1246"><td class="num" id="LN1246">1246</td><td class="line">  <span class='keyword'>if</span> (((ix | ((lx | NegateWithWraparound&lt;int32_t&gt;(lx)) &gt;&gt; 31)) &gt; 0x7FF00000) ||</td></tr>
<tr class="codeline" data-linenumber="1247"><td class="num" id="LN1247">1247</td><td class="line">      ((iy | ((ly | NegateWithWraparound&lt;int32_t&gt;(ly)) &gt;&gt; 31)) &gt; 0x7FF00000)) {</td></tr>
<tr class="codeline" data-linenumber="1248"><td class="num" id="LN1248">1248</td><td class="line">    <span class='keyword'>return</span> x + y; <span class='comment'>/* x or y is NaN */</span></td></tr>
<tr class="codeline" data-linenumber="1249"><td class="num" id="LN1249">1249</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1250"><td class="num" id="LN1250">1250</td><td class="line">  <span class='keyword'>if</span> ((SubWithWraparound(hx, 0x3FF00000) | lx) == 0) {</td></tr>
<tr class="codeline" data-linenumber="1251"><td class="num" id="LN1251">1251</td><td class="line">    <span class='keyword'>return</span> atan(y); <span class='comment'>/* x=1.0 */</span></td></tr>
<tr class="codeline" data-linenumber="1252"><td class="num" id="LN1252">1252</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1253"><td class="num" id="LN1253">1253</td><td class="line">  m = ((hy &gt;&gt; 31) &amp; 1) | ((hx &gt;&gt; 30) &amp; 2);           <span class='comment'>/* 2*sign(x)+sign(y) */</span></td></tr>
<tr class="codeline" data-linenumber="1254"><td class="num" id="LN1254">1254</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1255"><td class="num" id="LN1255">1255</td><td class="line">  <span class='comment'>/* when y = 0 */</span></td></tr>
<tr class="codeline" data-linenumber="1256"><td class="num" id="LN1256">1256</td><td class="line">  <span class='keyword'>if</span> ((iy | ly) == 0) {</td></tr>
<tr class="codeline" data-linenumber="1257"><td class="num" id="LN1257">1257</td><td class="line">    <span class='keyword'>switch</span> (m) {</td></tr>
<tr class="codeline" data-linenumber="1258"><td class="num" id="LN1258">1258</td><td class="line">      <span class='keyword'>case</span> 0:</td></tr>
<tr class="codeline" data-linenumber="1259"><td class="num" id="LN1259">1259</td><td class="line">      <span class='keyword'>case</span> 1:</td></tr>
<tr class="codeline" data-linenumber="1260"><td class="num" id="LN1260">1260</td><td class="line">        <span class='keyword'>return</span> y; <span class='comment'>/* atan(+-0,+anything)=+-0 */</span></td></tr>
<tr class="codeline" data-linenumber="1261"><td class="num" id="LN1261">1261</td><td class="line">      <span class='keyword'>case</span> 2:</td></tr>
<tr class="codeline" data-linenumber="1262"><td class="num" id="LN1262">1262</td><td class="line">        <span class='keyword'>return</span> pi + tiny; <span class='comment'>/* atan(+0,-anything) = pi */</span></td></tr>
<tr class="codeline" data-linenumber="1263"><td class="num" id="LN1263">1263</td><td class="line">      <span class='keyword'>case</span> 3:</td></tr>
<tr class="codeline" data-linenumber="1264"><td class="num" id="LN1264">1264</td><td class="line">        <span class='keyword'>return</span> -pi - tiny; <span class='comment'>/* atan(-0,-anything) =-pi */</span></td></tr>
<tr class="codeline" data-linenumber="1265"><td class="num" id="LN1265">1265</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1266"><td class="num" id="LN1266">1266</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1267"><td class="num" id="LN1267">1267</td><td class="line">  <span class='comment'>/* when x = 0 */</span></td></tr>
<tr class="codeline" data-linenumber="1268"><td class="num" id="LN1268">1268</td><td class="line">  <span class='keyword'>if</span> ((ix | lx) == 0) <span class='keyword'>return</span> (hy &lt; 0) ? -pi_o_2 - tiny : pi_o_2 + tiny;</td></tr>
<tr class="codeline" data-linenumber="1269"><td class="num" id="LN1269">1269</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1270"><td class="num" id="LN1270">1270</td><td class="line">  <span class='comment'>/* when x is INF */</span></td></tr>
<tr class="codeline" data-linenumber="1271"><td class="num" id="LN1271">1271</td><td class="line">  <span class='keyword'>if</span> (ix == 0x7FF00000) {</td></tr>
<tr class="codeline" data-linenumber="1272"><td class="num" id="LN1272">1272</td><td class="line">    <span class='keyword'>if</span> (iy == 0x7FF00000) {</td></tr>
<tr class="codeline" data-linenumber="1273"><td class="num" id="LN1273">1273</td><td class="line">      <span class='keyword'>switch</span> (m) {</td></tr>
<tr class="codeline" data-linenumber="1274"><td class="num" id="LN1274">1274</td><td class="line">        <span class='keyword'>case</span> 0:</td></tr>
<tr class="codeline" data-linenumber="1275"><td class="num" id="LN1275">1275</td><td class="line">          <span class='keyword'>return</span> pi_o_4 + tiny; <span class='comment'>/* atan(+INF,+INF) */</span></td></tr>
<tr class="codeline" data-linenumber="1276"><td class="num" id="LN1276">1276</td><td class="line">        <span class='keyword'>case</span> 1:</td></tr>
<tr class="codeline" data-linenumber="1277"><td class="num" id="LN1277">1277</td><td class="line">          <span class='keyword'>return</span> -pi_o_4 - tiny; <span class='comment'>/* atan(-INF,+INF) */</span></td></tr>
<tr class="codeline" data-linenumber="1278"><td class="num" id="LN1278">1278</td><td class="line">        <span class='keyword'>case</span> 2:</td></tr>
<tr class="codeline" data-linenumber="1279"><td class="num" id="LN1279">1279</td><td class="line">          <span class='keyword'>return</span> 3.0 * pi_o_4 + tiny; <span class='comment'>/*atan(+INF,-INF)*/</span></td></tr>
<tr class="codeline" data-linenumber="1280"><td class="num" id="LN1280">1280</td><td class="line">        <span class='keyword'>case</span> 3:</td></tr>
<tr class="codeline" data-linenumber="1281"><td class="num" id="LN1281">1281</td><td class="line">          <span class='keyword'>return</span> -3.0 * pi_o_4 - tiny; <span class='comment'>/*atan(-INF,-INF)*/</span></td></tr>
<tr class="codeline" data-linenumber="1282"><td class="num" id="LN1282">1282</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="1283"><td class="num" id="LN1283">1283</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1284"><td class="num" id="LN1284">1284</td><td class="line">      <span class='keyword'>switch</span> (m) {</td></tr>
<tr class="codeline" data-linenumber="1285"><td class="num" id="LN1285">1285</td><td class="line">        <span class='keyword'>case</span> 0:</td></tr>
<tr class="codeline" data-linenumber="1286"><td class="num" id="LN1286">1286</td><td class="line">          <span class='keyword'>return</span> zero; <span class='comment'>/* atan(+...,+INF) */</span></td></tr>
<tr class="codeline" data-linenumber="1287"><td class="num" id="LN1287">1287</td><td class="line">        <span class='keyword'>case</span> 1:</td></tr>
<tr class="codeline" data-linenumber="1288"><td class="num" id="LN1288">1288</td><td class="line">          <span class='keyword'>return</span> -zero; <span class='comment'>/* atan(-...,+INF) */</span></td></tr>
<tr class="codeline" data-linenumber="1289"><td class="num" id="LN1289">1289</td><td class="line">        <span class='keyword'>case</span> 2:</td></tr>
<tr class="codeline" data-linenumber="1290"><td class="num" id="LN1290">1290</td><td class="line">          <span class='keyword'>return</span> pi + tiny; <span class='comment'>/* atan(+...,-INF) */</span></td></tr>
<tr class="codeline" data-linenumber="1291"><td class="num" id="LN1291">1291</td><td class="line">        <span class='keyword'>case</span> 3:</td></tr>
<tr class="codeline" data-linenumber="1292"><td class="num" id="LN1292">1292</td><td class="line">          <span class='keyword'>return</span> -pi - tiny; <span class='comment'>/* atan(-...,-INF) */</span></td></tr>
<tr class="codeline" data-linenumber="1293"><td class="num" id="LN1293">1293</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="1294"><td class="num" id="LN1294">1294</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1295"><td class="num" id="LN1295">1295</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1296"><td class="num" id="LN1296">1296</td><td class="line">  <span class='comment'>/* when y is INF */</span></td></tr>
<tr class="codeline" data-linenumber="1297"><td class="num" id="LN1297">1297</td><td class="line">  <span class='keyword'>if</span> (iy == 0x7FF00000) <span class='keyword'>return</span> (hy &lt; 0) ? -pi_o_2 - tiny : pi_o_2 + tiny;</td></tr>
<tr class="codeline" data-linenumber="1298"><td class="num" id="LN1298">1298</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1299"><td class="num" id="LN1299">1299</td><td class="line">  <span class='comment'>/* compute y/x */</span></td></tr>
<tr class="codeline" data-linenumber="1300"><td class="num" id="LN1300">1300</td><td class="line">  k = (iy - ix) &gt;&gt; 20;</td></tr>
<tr class="codeline" data-linenumber="1301"><td class="num" id="LN1301">1301</td><td class="line">  <span class='keyword'>if</span> (k &gt; 60) { <span class='comment'>/* |y/x| &gt;  2**60 */</span></td></tr>
<tr class="codeline" data-linenumber="1302"><td class="num" id="LN1302">1302</td><td class="line">    z = pi_o_2 + 0.5 * pi_lo;</td></tr>
<tr class="codeline" data-linenumber="1303"><td class="num" id="LN1303">1303</td><td class="line">    m &amp;= 1;</td></tr>
<tr class="codeline" data-linenumber="1304"><td class="num" id="LN1304">1304</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (hx &lt; 0 &amp;&amp; k &lt; -60) {</td></tr>
<tr class="codeline" data-linenumber="1305"><td class="num" id="LN1305">1305</td><td class="line">    z = 0.0; <span class='comment'>/* 0 &gt; |y|/x &gt; -2**-60 */</span></td></tr>
<tr class="codeline" data-linenumber="1306"><td class="num" id="LN1306">1306</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1307"><td class="num" id="LN1307">1307</td><td class="line">    z = atan(fabs(y / x)); <span class='comment'>/* safe to do y/x */</span></td></tr>
<tr class="codeline" data-linenumber="1308"><td class="num" id="LN1308">1308</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1309"><td class="num" id="LN1309">1309</td><td class="line">  <span class='keyword'>switch</span> (m) {</td></tr>
<tr class="codeline" data-linenumber="1310"><td class="num" id="LN1310">1310</td><td class="line">    <span class='keyword'>case</span> 0:</td></tr>
<tr class="codeline" data-linenumber="1311"><td class="num" id="LN1311">1311</td><td class="line">      <span class='keyword'>return</span> z; <span class='comment'>/* atan(+,+) */</span></td></tr>
<tr class="codeline" data-linenumber="1312"><td class="num" id="LN1312">1312</td><td class="line">    <span class='keyword'>case</span> 1:</td></tr>
<tr class="codeline" data-linenumber="1313"><td class="num" id="LN1313">1313</td><td class="line">      <span class='keyword'>return</span> -z; <span class='comment'>/* atan(-,+) */</span></td></tr>
<tr class="codeline" data-linenumber="1314"><td class="num" id="LN1314">1314</td><td class="line">    <span class='keyword'>case</span> 2:</td></tr>
<tr class="codeline" data-linenumber="1315"><td class="num" id="LN1315">1315</td><td class="line">      <span class='keyword'>return</span> pi - (z - pi_lo); <span class='comment'>/* atan(+,-) */</span></td></tr>
<tr class="codeline" data-linenumber="1316"><td class="num" id="LN1316">1316</td><td class="line">    <span class='keyword'>default</span>:                   <span class='comment'>/* case 3 */</span></td></tr>
<tr class="codeline" data-linenumber="1317"><td class="num" id="LN1317">1317</td><td class="line">      <span class='keyword'>return</span> (z - pi_lo) - pi; <span class='comment'>/* atan(-,-) */</span></td></tr>
<tr class="codeline" data-linenumber="1318"><td class="num" id="LN1318">1318</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1319"><td class="num" id="LN1319">1319</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1320"><td class="num" id="LN1320">1320</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1321"><td class="num" id="LN1321">1321</td><td class="line"><span class='comment'>/* cos(x)</span></td></tr>
<tr class="codeline" data-linenumber="1322"><td class="num" id="LN1322">1322</td><td class="line"> <span class='comment'>* Return cosine function of x.</span></td></tr>
<tr class="codeline" data-linenumber="1323"><td class="num" id="LN1323">1323</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1324"><td class="num" id="LN1324">1324</td><td class="line"> <span class='comment'>* kernel function:</span></td></tr>
<tr class="codeline" data-linenumber="1325"><td class="num" id="LN1325">1325</td><td class="line"> <span class='comment'>*      __kernel_sin            ... sine function on [-pi/4,pi/4]</span></td></tr>
<tr class="codeline" data-linenumber="1326"><td class="num" id="LN1326">1326</td><td class="line"> <span class='comment'>*      __kernel_cos            ... cosine function on [-pi/4,pi/4]</span></td></tr>
<tr class="codeline" data-linenumber="1327"><td class="num" id="LN1327">1327</td><td class="line"> <span class='comment'>*      __ieee754_rem_pio2      ... argument reduction routine</span></td></tr>
<tr class="codeline" data-linenumber="1328"><td class="num" id="LN1328">1328</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1329"><td class="num" id="LN1329">1329</td><td class="line"> <span class='comment'>* Method.</span></td></tr>
<tr class="codeline" data-linenumber="1330"><td class="num" id="LN1330">1330</td><td class="line"> <span class='comment'>*      Let S,C and T denote the sin, cos and tan respectively on</span></td></tr>
<tr class="codeline" data-linenumber="1331"><td class="num" id="LN1331">1331</td><td class="line"> <span class='comment'>*      [-PI/4, +PI/4]. Reduce the argument x to y1+y2 = x-k*pi/2</span></td></tr>
<tr class="codeline" data-linenumber="1332"><td class="num" id="LN1332">1332</td><td class="line"> <span class='comment'>*      in [-pi/4 , +pi/4], and let n = k mod 4.</span></td></tr>
<tr class="codeline" data-linenumber="1333"><td class="num" id="LN1333">1333</td><td class="line"> <span class='comment'>*      We have</span></td></tr>
<tr class="codeline" data-linenumber="1334"><td class="num" id="LN1334">1334</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1335"><td class="num" id="LN1335">1335</td><td class="line"> <span class='comment'>*          n        sin(x)      cos(x)        tan(x)</span></td></tr>
<tr class="codeline" data-linenumber="1336"><td class="num" id="LN1336">1336</td><td class="line"> <span class='comment'>*     ----------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="1337"><td class="num" id="LN1337">1337</td><td class="line"> <span class='comment'>*          0          S           C             T</span></td></tr>
<tr class="codeline" data-linenumber="1338"><td class="num" id="LN1338">1338</td><td class="line"> <span class='comment'>*          1          C          -S            -1/T</span></td></tr>
<tr class="codeline" data-linenumber="1339"><td class="num" id="LN1339">1339</td><td class="line"> <span class='comment'>*          2         -S          -C             T</span></td></tr>
<tr class="codeline" data-linenumber="1340"><td class="num" id="LN1340">1340</td><td class="line"> <span class='comment'>*          3         -C           S            -1/T</span></td></tr>
<tr class="codeline" data-linenumber="1341"><td class="num" id="LN1341">1341</td><td class="line"> <span class='comment'>*     ----------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="1342"><td class="num" id="LN1342">1342</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1343"><td class="num" id="LN1343">1343</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="1344"><td class="num" id="LN1344">1344</td><td class="line"> <span class='comment'>*      Let trig be any of sin, cos, or tan.</span></td></tr>
<tr class="codeline" data-linenumber="1345"><td class="num" id="LN1345">1345</td><td class="line"> <span class='comment'>*      trig(+-INF)  is NaN, with signals;</span></td></tr>
<tr class="codeline" data-linenumber="1346"><td class="num" id="LN1346">1346</td><td class="line"> <span class='comment'>*      trig(NaN)    is that NaN;</span></td></tr>
<tr class="codeline" data-linenumber="1347"><td class="num" id="LN1347">1347</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1348"><td class="num" id="LN1348">1348</td><td class="line"> <span class='comment'>* Accuracy:</span></td></tr>
<tr class="codeline" data-linenumber="1349"><td class="num" id="LN1349">1349</td><td class="line"> <span class='comment'>*      TRIG(x) returns trig(x) nearly rounded</span></td></tr>
<tr class="codeline" data-linenumber="1350"><td class="num" id="LN1350">1350</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1351"><td class="num" id="LN1351">1351</td><td class="line"><span class='keyword'>double</span> cos(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="1352"><td class="num" id="LN1352">1352</td><td class="line">  <span class='keyword'>double</span> y[2], z = 0.0;</td></tr>
<tr class="codeline" data-linenumber="1353"><td class="num" id="LN1353">1353</td><td class="line">  int32_t n, ix;</td></tr>
<tr class="codeline" data-linenumber="1354"><td class="num" id="LN1354">1354</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1355"><td class="num" id="LN1355">1355</td><td class="line">  <span class='comment'>/* High word of x. */</span></td></tr>
<tr class="codeline" data-linenumber="1356"><td class="num" id="LN1356">1356</td><td class="line">  GET_HIGH_WORD(ix, x);</td></tr>
<tr class="codeline" data-linenumber="1357"><td class="num" id="LN1357">1357</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1358"><td class="num" id="LN1358">1358</td><td class="line">  <span class='comment'>/* |x| ~&lt; pi/4 */</span></td></tr>
<tr class="codeline" data-linenumber="1359"><td class="num" id="LN1359">1359</td><td class="line">  ix &amp;= 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="1360"><td class="num" id="LN1360">1360</td><td class="line">  <span class='keyword'>if</span> (ix &lt;= 0x3FE921FB) {</td></tr>
<tr class="codeline" data-linenumber="1361"><td class="num" id="LN1361">1361</td><td class="line">    <span class='keyword'>return</span> __kernel_cos(x, z);</td></tr>
<tr class="codeline" data-linenumber="1362"><td class="num" id="LN1362">1362</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (ix &gt;= 0x7FF00000) {</td></tr>
<tr class="codeline" data-linenumber="1363"><td class="num" id="LN1363">1363</td><td class="line">    <span class='comment'>/* cos(Inf or NaN) is NaN */</span></td></tr>
<tr class="codeline" data-linenumber="1364"><td class="num" id="LN1364">1364</td><td class="line">    <span class='keyword'>return</span> x - x;</td></tr>
<tr class="codeline" data-linenumber="1365"><td class="num" id="LN1365">1365</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1366"><td class="num" id="LN1366">1366</td><td class="line">    <span class='comment'>/* argument reduction needed */</span></td></tr>
<tr class="codeline" data-linenumber="1367"><td class="num" id="LN1367">1367</td><td class="line">    n = __ieee754_rem_pio2(x, y);</td></tr>
<tr class="codeline" data-linenumber="1368"><td class="num" id="LN1368">1368</td><td class="line">    <span class='keyword'>switch</span> (n &amp; 3) {</td></tr>
<tr class="codeline" data-linenumber="1369"><td class="num" id="LN1369">1369</td><td class="line">      <span class='keyword'>case</span> 0:</td></tr>
<tr class="codeline" data-linenumber="1370"><td class="num" id="LN1370">1370</td><td class="line">        <span class='keyword'>return</span> __kernel_cos(y[0], y[1]);</td></tr>
<tr class="codeline" data-linenumber="1371"><td class="num" id="LN1371">1371</td><td class="line">      <span class='keyword'>case</span> 1:</td></tr>
<tr class="codeline" data-linenumber="1372"><td class="num" id="LN1372">1372</td><td class="line">        <span class='keyword'>return</span> -__kernel_sin(y[0], y[1], 1);</td></tr>
<tr class="codeline" data-linenumber="1373"><td class="num" id="LN1373">1373</td><td class="line">      <span class='keyword'>case</span> 2:</td></tr>
<tr class="codeline" data-linenumber="1374"><td class="num" id="LN1374">1374</td><td class="line">        <span class='keyword'>return</span> -__kernel_cos(y[0], y[1]);</td></tr>
<tr class="codeline" data-linenumber="1375"><td class="num" id="LN1375">1375</td><td class="line">      <span class='keyword'>default</span>:</td></tr>
<tr class="codeline" data-linenumber="1376"><td class="num" id="LN1376">1376</td><td class="line">        <span class='keyword'>return</span> __kernel_sin(y[0], y[1], 1);</td></tr>
<tr class="codeline" data-linenumber="1377"><td class="num" id="LN1377">1377</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1378"><td class="num" id="LN1378">1378</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1379"><td class="num" id="LN1379">1379</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1380"><td class="num" id="LN1380">1380</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1381"><td class="num" id="LN1381">1381</td><td class="line"><span class='comment'>/* exp(x)</span></td></tr>
<tr class="codeline" data-linenumber="1382"><td class="num" id="LN1382">1382</td><td class="line"> <span class='comment'>* Returns the exponential of x.</span></td></tr>
<tr class="codeline" data-linenumber="1383"><td class="num" id="LN1383">1383</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1384"><td class="num" id="LN1384">1384</td><td class="line"> <span class='comment'>* Method</span></td></tr>
<tr class="codeline" data-linenumber="1385"><td class="num" id="LN1385">1385</td><td class="line"> <span class='comment'>*   1. Argument reduction:</span></td></tr>
<tr class="codeline" data-linenumber="1386"><td class="num" id="LN1386">1386</td><td class="line"> <span class='comment'>*      Reduce x to an r so that |r| &lt;= 0.5*ln2 ~ 0.34658.</span></td></tr>
<tr class="codeline" data-linenumber="1387"><td class="num" id="LN1387">1387</td><td class="line"> <span class='comment'>*      Given x, find r and integer k such that</span></td></tr>
<tr class="codeline" data-linenumber="1388"><td class="num" id="LN1388">1388</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1389"><td class="num" id="LN1389">1389</td><td class="line"> <span class='comment'>*               x = k*ln2 + r,  |r| &lt;= 0.5*ln2.</span></td></tr>
<tr class="codeline" data-linenumber="1390"><td class="num" id="LN1390">1390</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1391"><td class="num" id="LN1391">1391</td><td class="line"> <span class='comment'>*      Here r will be represented as r = hi-lo for better</span></td></tr>
<tr class="codeline" data-linenumber="1392"><td class="num" id="LN1392">1392</td><td class="line"> <span class='comment'>*      accuracy.</span></td></tr>
<tr class="codeline" data-linenumber="1393"><td class="num" id="LN1393">1393</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1394"><td class="num" id="LN1394">1394</td><td class="line"> <span class='comment'>*   2. Approximation of exp(r) by a special rational function on</span></td></tr>
<tr class="codeline" data-linenumber="1395"><td class="num" id="LN1395">1395</td><td class="line"> <span class='comment'>*      the interval [0,0.34658]:</span></td></tr>
<tr class="codeline" data-linenumber="1396"><td class="num" id="LN1396">1396</td><td class="line"> <span class='comment'>*      Write</span></td></tr>
<tr class="codeline" data-linenumber="1397"><td class="num" id="LN1397">1397</td><td class="line"> <span class='comment'>*          R(r**2) = r*(exp(r)+1)/(exp(r)-1) = 2 + r*r/6 - r**4/360 + ...</span></td></tr>
<tr class="codeline" data-linenumber="1398"><td class="num" id="LN1398">1398</td><td class="line"> <span class='comment'>*      We use a special Remes algorithm on [0,0.34658] to generate</span></td></tr>
<tr class="codeline" data-linenumber="1399"><td class="num" id="LN1399">1399</td><td class="line"> <span class='comment'>*      a polynomial of degree 5 to approximate R. The maximum error</span></td></tr>
<tr class="codeline" data-linenumber="1400"><td class="num" id="LN1400">1400</td><td class="line"> <span class='comment'>*      of this polynomial approximation is bounded by 2**-59. In</span></td></tr>
<tr class="codeline" data-linenumber="1401"><td class="num" id="LN1401">1401</td><td class="line"> <span class='comment'>*      other words,</span></td></tr>
<tr class="codeline" data-linenumber="1402"><td class="num" id="LN1402">1402</td><td class="line"> <span class='comment'>*          R(z) ~ 2.0 + P1*z + P2*z**2 + P3*z**3 + P4*z**4 + P5*z**5</span></td></tr>
<tr class="codeline" data-linenumber="1403"><td class="num" id="LN1403">1403</td><td class="line"> <span class='comment'>*      (where z=r*r, and the values of P1 to P5 are listed below)</span></td></tr>
<tr class="codeline" data-linenumber="1404"><td class="num" id="LN1404">1404</td><td class="line"> <span class='comment'>*      and</span></td></tr>
<tr class="codeline" data-linenumber="1405"><td class="num" id="LN1405">1405</td><td class="line"> <span class='comment'>*          |                  5          |     -59</span></td></tr>
<tr class="codeline" data-linenumber="1406"><td class="num" id="LN1406">1406</td><td class="line"> <span class='comment'>*          | 2.0+P1*z+...+P5*z   -  R(z) | &lt;= 2</span></td></tr>
<tr class="codeline" data-linenumber="1407"><td class="num" id="LN1407">1407</td><td class="line"> <span class='comment'>*          |                             |</span></td></tr>
<tr class="codeline" data-linenumber="1408"><td class="num" id="LN1408">1408</td><td class="line"> <span class='comment'>*      The computation of exp(r) thus becomes</span></td></tr>
<tr class="codeline" data-linenumber="1409"><td class="num" id="LN1409">1409</td><td class="line"> <span class='comment'>*                             2*r</span></td></tr>
<tr class="codeline" data-linenumber="1410"><td class="num" id="LN1410">1410</td><td class="line"> <span class='comment'>*              exp(r) = 1 + -------</span></td></tr>
<tr class="codeline" data-linenumber="1411"><td class="num" id="LN1411">1411</td><td class="line"> <span class='comment'>*                            R - r</span></td></tr>
<tr class="codeline" data-linenumber="1412"><td class="num" id="LN1412">1412</td><td class="line"> <span class='comment'>*                                 r*R1(r)</span></td></tr>
<tr class="codeline" data-linenumber="1413"><td class="num" id="LN1413">1413</td><td class="line"> <span class='comment'>*                     = 1 + r + ----------- (for better accuracy)</span></td></tr>
<tr class="codeline" data-linenumber="1414"><td class="num" id="LN1414">1414</td><td class="line"> <span class='comment'>*                                2 - R1(r)</span></td></tr>
<tr class="codeline" data-linenumber="1415"><td class="num" id="LN1415">1415</td><td class="line"> <span class='comment'>*      where</span></td></tr>
<tr class="codeline" data-linenumber="1416"><td class="num" id="LN1416">1416</td><td class="line"> <span class='comment'>*                               2       4             10</span></td></tr>
<tr class="codeline" data-linenumber="1417"><td class="num" id="LN1417">1417</td><td class="line"> <span class='comment'>*              R1(r) = r - (P1*r  + P2*r  + ... + P5*r   ).</span></td></tr>
<tr class="codeline" data-linenumber="1418"><td class="num" id="LN1418">1418</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1419"><td class="num" id="LN1419">1419</td><td class="line"> <span class='comment'>*   3. Scale back to obtain exp(x):</span></td></tr>
<tr class="codeline" data-linenumber="1420"><td class="num" id="LN1420">1420</td><td class="line"> <span class='comment'>*      From step 1, we have</span></td></tr>
<tr class="codeline" data-linenumber="1421"><td class="num" id="LN1421">1421</td><td class="line"> <span class='comment'>*         exp(x) = 2^k * exp(r)</span></td></tr>
<tr class="codeline" data-linenumber="1422"><td class="num" id="LN1422">1422</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1423"><td class="num" id="LN1423">1423</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="1424"><td class="num" id="LN1424">1424</td><td class="line"> <span class='comment'>*      exp(INF) is INF, exp(NaN) is NaN;</span></td></tr>
<tr class="codeline" data-linenumber="1425"><td class="num" id="LN1425">1425</td><td class="line"> <span class='comment'>*      exp(-INF) is 0, and</span></td></tr>
<tr class="codeline" data-linenumber="1426"><td class="num" id="LN1426">1426</td><td class="line"> <span class='comment'>*      for finite argument, only exp(0)=1 is exact.</span></td></tr>
<tr class="codeline" data-linenumber="1427"><td class="num" id="LN1427">1427</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1428"><td class="num" id="LN1428">1428</td><td class="line"> <span class='comment'>* Accuracy:</span></td></tr>
<tr class="codeline" data-linenumber="1429"><td class="num" id="LN1429">1429</td><td class="line"> <span class='comment'>*      according to an error analysis, the error is always less than</span></td></tr>
<tr class="codeline" data-linenumber="1430"><td class="num" id="LN1430">1430</td><td class="line"> <span class='comment'>*      1 ulp (unit in the last place).</span></td></tr>
<tr class="codeline" data-linenumber="1431"><td class="num" id="LN1431">1431</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1432"><td class="num" id="LN1432">1432</td><td class="line"> <span class='comment'>* Misc. info.</span></td></tr>
<tr class="codeline" data-linenumber="1433"><td class="num" id="LN1433">1433</td><td class="line"> <span class='comment'>*      For IEEE double</span></td></tr>
<tr class="codeline" data-linenumber="1434"><td class="num" id="LN1434">1434</td><td class="line"> <span class='comment'>*          if x &gt;  7.09782712893383973096e+02 then exp(x) overflow</span></td></tr>
<tr class="codeline" data-linenumber="1435"><td class="num" id="LN1435">1435</td><td class="line"> <span class='comment'>*          if x &lt; -7.45133219101941108420e+02 then exp(x) underflow</span></td></tr>
<tr class="codeline" data-linenumber="1436"><td class="num" id="LN1436">1436</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1437"><td class="num" id="LN1437">1437</td><td class="line"> <span class='comment'>* Constants:</span></td></tr>
<tr class="codeline" data-linenumber="1438"><td class="num" id="LN1438">1438</td><td class="line"> <span class='comment'>* The hexadecimal values are the intended ones for the following</span></td></tr>
<tr class="codeline" data-linenumber="1439"><td class="num" id="LN1439">1439</td><td class="line"> <span class='comment'>* constants. The decimal values may be used, provided that the</span></td></tr>
<tr class="codeline" data-linenumber="1440"><td class="num" id="LN1440">1440</td><td class="line"> <span class='comment'>* compiler will convert from decimal to binary accurately enough</span></td></tr>
<tr class="codeline" data-linenumber="1441"><td class="num" id="LN1441">1441</td><td class="line"> <span class='comment'>* to produce the hexadecimal values shown.</span></td></tr>
<tr class="codeline" data-linenumber="1442"><td class="num" id="LN1442">1442</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1443"><td class="num" id="LN1443">1443</td><td class="line"><span class='keyword'>double</span> exp(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="1444"><td class="num" id="LN1444">1444</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="1445"><td class="num" id="LN1445">1445</td><td class="line">      one = 1.0,</td></tr>
<tr class="codeline" data-linenumber="1446"><td class="num" id="LN1446">1446</td><td class="line">      halF[2] = {0.5, -0.5},</td></tr>
<tr class="codeline" data-linenumber="1447"><td class="num" id="LN1447">1447</td><td class="line">      o_threshold = 7.09782712893383973096e+02,  <span class='comment'>/* 0x40862E42, 0xFEFA39EF */</span></td></tr>
<tr class="codeline" data-linenumber="1448"><td class="num" id="LN1448">1448</td><td class="line">      u_threshold = -7.45133219101941108420e+02, <span class='comment'>/* 0xC0874910, 0xD52D3051 */</span></td></tr>
<tr class="codeline" data-linenumber="1449"><td class="num" id="LN1449">1449</td><td class="line">      ln2HI[2] = {6.93147180369123816490e-01,    <span class='comment'>/* 0x3FE62E42, 0xFEE00000 */</span></td></tr>
<tr class="codeline" data-linenumber="1450"><td class="num" id="LN1450">1450</td><td class="line">                  -6.93147180369123816490e-01},  <span class='comment'>/* 0xBFE62E42, 0xFEE00000 */</span></td></tr>
<tr class="codeline" data-linenumber="1451"><td class="num" id="LN1451">1451</td><td class="line">      ln2LO[2] = {1.90821492927058770002e-10,    <span class='comment'>/* 0x3DEA39EF, 0x35793C76 */</span></td></tr>
<tr class="codeline" data-linenumber="1452"><td class="num" id="LN1452">1452</td><td class="line">                  -1.90821492927058770002e-10},  <span class='comment'>/* 0xBDEA39EF, 0x35793C76 */</span></td></tr>
<tr class="codeline" data-linenumber="1453"><td class="num" id="LN1453">1453</td><td class="line">      invln2 = 1.44269504088896338700e+00,       <span class='comment'>/* 0x3FF71547, 0x652B82FE */</span></td></tr>
<tr class="codeline" data-linenumber="1454"><td class="num" id="LN1454">1454</td><td class="line">      P1 = 1.66666666666666019037e-01,           <span class='comment'>/* 0x3FC55555, 0x5555553E */</span></td></tr>
<tr class="codeline" data-linenumber="1455"><td class="num" id="LN1455">1455</td><td class="line">      P2 = -2.77777777770155933842e-03,          <span class='comment'>/* 0xBF66C16C, 0x16BEBD93 */</span></td></tr>
<tr class="codeline" data-linenumber="1456"><td class="num" id="LN1456">1456</td><td class="line">      P3 = 6.61375632143793436117e-05,           <span class='comment'>/* 0x3F11566A, 0xAF25DE2C */</span></td></tr>
<tr class="codeline" data-linenumber="1457"><td class="num" id="LN1457">1457</td><td class="line">      P4 = -1.65339022054652515390e-06,          <span class='comment'>/* 0xBEBBBD41, 0xC5D26BF1 */</span></td></tr>
<tr class="codeline" data-linenumber="1458"><td class="num" id="LN1458">1458</td><td class="line">      P5 = 4.13813679705723846039e-08,           <span class='comment'>/* 0x3E663769, 0x72BEA4D0 */</span></td></tr>
<tr class="codeline" data-linenumber="1459"><td class="num" id="LN1459">1459</td><td class="line">      E = 2.718281828459045;                     <span class='comment'>/* 0x4005BF0A, 0x8B145769 */</span></td></tr>
<tr class="codeline" data-linenumber="1460"><td class="num" id="LN1460">1460</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1461"><td class="num" id="LN1461">1461</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>volatile</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="1462"><td class="num" id="LN1462">1462</td><td class="line">      huge = 1.0e+300,</td></tr>
<tr class="codeline" data-linenumber="1463"><td class="num" id="LN1463">1463</td><td class="line">      twom1000 = 9.33263618503218878990e-302, <span class='comment'>/* 2**-1000=0x01700000,0*/</span></td></tr>
<tr class="codeline" data-linenumber="1464"><td class="num" id="LN1464">1464</td><td class="line">      two1023 = 8.988465674311579539e307;     <span class='comment'>/* 0x1p1023 */</span></td></tr>
<tr class="codeline" data-linenumber="1465"><td class="num" id="LN1465">1465</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1466"><td class="num" id="LN1466">1466</td><td class="line">  <span class='keyword'>double</span> y, hi = 0.0, lo = 0.0, c, t, twopk;</td></tr>
<tr class="codeline" data-linenumber="1467"><td class="num" id="LN1467">1467</td><td class="line">  int32_t k = 0, xsb;</td></tr>
<tr class="codeline" data-linenumber="1468"><td class="num" id="LN1468">1468</td><td class="line">  uint32_t hx;</td></tr>
<tr class="codeline" data-linenumber="1469"><td class="num" id="LN1469">1469</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1470"><td class="num" id="LN1470">1470</td><td class="line">  GET_HIGH_WORD(hx, x);</td></tr>
<tr class="codeline" data-linenumber="1471"><td class="num" id="LN1471">1471</td><td class="line">  xsb = (hx &gt;&gt; 31) &amp; 1; <span class='comment'>/* sign bit of x */</span></td></tr>
<tr class="codeline" data-linenumber="1472"><td class="num" id="LN1472">1472</td><td class="line">  hx &amp;= 0x7FFFFFFF;     <span class='comment'>/* high word of |x| */</span></td></tr>
<tr class="codeline" data-linenumber="1473"><td class="num" id="LN1473">1473</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1474"><td class="num" id="LN1474">1474</td><td class="line">  <span class='comment'>/* filter out non-finite argument */</span></td></tr>
<tr class="codeline" data-linenumber="1475"><td class="num" id="LN1475">1475</td><td class="line">  <span class='keyword'>if</span> (hx &gt;= 0x40862E42) { <span class='comment'>/* if |x|&gt;=709.78... */</span></td></tr>
<tr class="codeline" data-linenumber="1476"><td class="num" id="LN1476">1476</td><td class="line">    <span class='keyword'>if</span> (hx &gt;= 0x7FF00000) {</td></tr>
<tr class="codeline" data-linenumber="1477"><td class="num" id="LN1477">1477</td><td class="line">      uint32_t lx;</td></tr>
<tr class="codeline" data-linenumber="1478"><td class="num" id="LN1478">1478</td><td class="line">      GET_LOW_WORD(lx, x);</td></tr>
<tr class="codeline" data-linenumber="1479"><td class="num" id="LN1479">1479</td><td class="line">      <span class='keyword'>if</span> (((hx &amp; 0xFFFFF) | lx) != 0)</td></tr>
<tr class="codeline" data-linenumber="1480"><td class="num" id="LN1480">1480</td><td class="line">        <span class='keyword'>return</span> x + x; <span class='comment'>/* NaN */</span></td></tr>
<tr class="codeline" data-linenumber="1481"><td class="num" id="LN1481">1481</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="1482"><td class="num" id="LN1482">1482</td><td class="line">        <span class='keyword'>return</span> (xsb == 0) ? x : 0.0; <span class='comment'>/* exp(+-inf)={inf,0} */</span></td></tr>
<tr class="codeline" data-linenumber="1483"><td class="num" id="LN1483">1483</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1484"><td class="num" id="LN1484">1484</td><td class="line">    <span class='keyword'>if</span> (x &gt; o_threshold) <span class='keyword'>return</span> huge * huge;         <span class='comment'>/* overflow */</span></td></tr>
<tr class="codeline" data-linenumber="1485"><td class="num" id="LN1485">1485</td><td class="line">    <span class='keyword'>if</span> (x &lt; u_threshold) <span class='keyword'>return</span> twom1000 * twom1000; <span class='comment'>/* underflow */</span></td></tr>
<tr class="codeline" data-linenumber="1486"><td class="num" id="LN1486">1486</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1487"><td class="num" id="LN1487">1487</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1488"><td class="num" id="LN1488">1488</td><td class="line">  <span class='comment'>/* argument reduction */</span></td></tr>
<tr class="codeline" data-linenumber="1489"><td class="num" id="LN1489">1489</td><td class="line">  <span class='keyword'>if</span> (hx &gt; 0x3FD62E42) {   <span class='comment'>/* if  |x| &gt; 0.5 ln2 */</span></td></tr>
<tr class="codeline" data-linenumber="1490"><td class="num" id="LN1490">1490</td><td class="line">    <span class='keyword'>if</span> (hx &lt; 0x3FF0A2B2) { <span class='comment'>/* and |x| &lt; 1.5 ln2 */</span></td></tr>
<tr class="codeline" data-linenumber="1491"><td class="num" id="LN1491">1491</td><td class="line">      <span class='comment'>/* TODO(rtoy): We special case exp(1) here to return the correct</span></td></tr>
<tr class="codeline" data-linenumber="1492"><td class="num" id="LN1492">1492</td><td class="line">       <span class='comment'>* value of E, as the computation below would get the last bit</span></td></tr>
<tr class="codeline" data-linenumber="1493"><td class="num" id="LN1493">1493</td><td class="line">       <span class='comment'>* wrong. We should probably fix the algorithm instead.</span></td></tr>
<tr class="codeline" data-linenumber="1494"><td class="num" id="LN1494">1494</td><td class="line">       <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1495"><td class="num" id="LN1495">1495</td><td class="line">      <span class='keyword'>if</span> (x == 1.0) <span class='keyword'>return</span> E;</td></tr>
<tr class="codeline" data-linenumber="1496"><td class="num" id="LN1496">1496</td><td class="line">      hi = x - ln2HI[xsb];</td></tr>
<tr class="codeline" data-linenumber="1497"><td class="num" id="LN1497">1497</td><td class="line">      lo = ln2LO[xsb];</td></tr>
<tr class="codeline" data-linenumber="1498"><td class="num" id="LN1498">1498</td><td class="line">      k = 1 - xsb - xsb;</td></tr>
<tr class="codeline" data-linenumber="1499"><td class="num" id="LN1499">1499</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1500"><td class="num" id="LN1500">1500</td><td class="line">      k = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(invln2 * x + halF[xsb]);</td></tr>
<tr class="codeline" data-linenumber="1501"><td class="num" id="LN1501">1501</td><td class="line">      t = k;</td></tr>
<tr class="codeline" data-linenumber="1502"><td class="num" id="LN1502">1502</td><td class="line">      hi = x - t * ln2HI[0]; <span class='comment'>/* t*ln2HI is exact here */</span></td></tr>
<tr class="codeline" data-linenumber="1503"><td class="num" id="LN1503">1503</td><td class="line">      lo = t * ln2LO[0];</td></tr>
<tr class="codeline" data-linenumber="1504"><td class="num" id="LN1504">1504</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1505"><td class="num" id="LN1505">1505</td><td class="line">    x = hi - lo;</td></tr>
<tr class="codeline" data-linenumber="1506"><td class="num" id="LN1506">1506</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (hx &lt; 0x3E300000) {         <span class='comment'>/* when |x|&lt;2**-28 */</span></td></tr>
<tr class="codeline" data-linenumber="1507"><td class="num" id="LN1507">1507</td><td class="line">    <span class='keyword'>if</span> (huge + x &gt; one) <span class='keyword'>return</span> one + x; <span class='comment'>/* trigger inexact */</span></td></tr>
<tr class="codeline" data-linenumber="1508"><td class="num" id="LN1508">1508</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1509"><td class="num" id="LN1509">1509</td><td class="line">    k = 0;</td></tr>
<tr class="codeline" data-linenumber="1510"><td class="num" id="LN1510">1510</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1511"><td class="num" id="LN1511">1511</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1512"><td class="num" id="LN1512">1512</td><td class="line">  <span class='comment'>/* x is now in primary range */</span></td></tr>
<tr class="codeline" data-linenumber="1513"><td class="num" id="LN1513">1513</td><td class="line">  t = x * x;</td></tr>
<tr class="codeline" data-linenumber="1514"><td class="num" id="LN1514">1514</td><td class="line">  <span class='keyword'>if</span> (k &gt;= -1021) {</td></tr>
<tr class="codeline" data-linenumber="1515"><td class="num" id="LN1515">1515</td><td class="line">    INSERT_WORDS(</td></tr>
<tr class="codeline" data-linenumber="1516"><td class="num" id="LN1516">1516</td><td class="line">        twopk,</td></tr>
<tr class="codeline" data-linenumber="1517"><td class="num" id="LN1517">1517</td><td class="line">        0x3FF00000 + <span class='keyword'>static_cast</span>&lt;int32_t&gt;(<span class='keyword'>static_cast</span>&lt;uint32_t&gt;(k) &lt;&lt; 20), 0);</td></tr>
<tr class="codeline" data-linenumber="1518"><td class="num" id="LN1518">1518</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1519"><td class="num" id="LN1519">1519</td><td class="line">    INSERT_WORDS(twopk, 0x3FF00000 + (<span class='keyword'>static_cast</span>&lt;uint32_t&gt;(k + 1000) &lt;&lt; 20),</td></tr>
<tr class="codeline" data-linenumber="1520"><td class="num" id="LN1520">1520</td><td class="line">                 0);</td></tr>
<tr class="codeline" data-linenumber="1521"><td class="num" id="LN1521">1521</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1522"><td class="num" id="LN1522">1522</td><td class="line">  c = x - t * (P1 + t * (P2 + t * (P3 + t * (P4 + t * P5))));</td></tr>
<tr class="codeline" data-linenumber="1523"><td class="num" id="LN1523">1523</td><td class="line">  <span class='keyword'>if</span> (k == 0) {</td></tr>
<tr class="codeline" data-linenumber="1524"><td class="num" id="LN1524">1524</td><td class="line">    <span class='keyword'>return</span> one - ((x * c) / (c - 2.0) - x);</td></tr>
<tr class="codeline" data-linenumber="1525"><td class="num" id="LN1525">1525</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1526"><td class="num" id="LN1526">1526</td><td class="line">    y = one - ((lo - (x * c) / (2.0 - c)) - hi);</td></tr>
<tr class="codeline" data-linenumber="1527"><td class="num" id="LN1527">1527</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1528"><td class="num" id="LN1528">1528</td><td class="line">  <span class='keyword'>if</span> (k &gt;= -1021) {</td></tr>
<tr class="codeline" data-linenumber="1529"><td class="num" id="LN1529">1529</td><td class="line">    <span class='keyword'>if</span> (k == 1024) <span class='keyword'>return</span> y * 2.0 * two1023;</td></tr>
<tr class="codeline" data-linenumber="1530"><td class="num" id="LN1530">1530</td><td class="line">    <span class='keyword'>return</span> y * twopk;</td></tr>
<tr class="codeline" data-linenumber="1531"><td class="num" id="LN1531">1531</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1532"><td class="num" id="LN1532">1532</td><td class="line">    <span class='keyword'>return</span> y * twopk * twom1000;</td></tr>
<tr class="codeline" data-linenumber="1533"><td class="num" id="LN1533">1533</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1534"><td class="num" id="LN1534">1534</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1535"><td class="num" id="LN1535">1535</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1536"><td class="num" id="LN1536">1536</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1537"><td class="num" id="LN1537">1537</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="1538"><td class="num" id="LN1538">1538</td><td class="line"> <span class='comment'>*    1.Reduced x to positive by atanh(-x) = -atanh(x)</span></td></tr>
<tr class="codeline" data-linenumber="1539"><td class="num" id="LN1539">1539</td><td class="line"> <span class='comment'>*    2.For x&gt;=0.5</span></td></tr>
<tr class="codeline" data-linenumber="1540"><td class="num" id="LN1540">1540</td><td class="line"> <span class='comment'>*              1              2x                          x</span></td></tr>
<tr class="codeline" data-linenumber="1541"><td class="num" id="LN1541">1541</td><td class="line"> <span class='comment'>*  atanh(x) = --- * log(1 + -------) = 0.5 * log1p(2 * --------)</span></td></tr>
<tr class="codeline" data-linenumber="1542"><td class="num" id="LN1542">1542</td><td class="line"> <span class='comment'>*              2             1 - x                      1 - x</span></td></tr>
<tr class="codeline" data-linenumber="1543"><td class="num" id="LN1543">1543</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1544"><td class="num" id="LN1544">1544</td><td class="line"> <span class='comment'>*   For x&lt;0.5</span></td></tr>
<tr class="codeline" data-linenumber="1545"><td class="num" id="LN1545">1545</td><td class="line"> <span class='comment'>*  atanh(x) = 0.5*log1p(2x+2x*x/(1-x))</span></td></tr>
<tr class="codeline" data-linenumber="1546"><td class="num" id="LN1546">1546</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1547"><td class="num" id="LN1547">1547</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="1548"><td class="num" id="LN1548">1548</td><td class="line"> <span class='comment'>*  atanh(x) is NaN if |x| &gt; 1 with signal;</span></td></tr>
<tr class="codeline" data-linenumber="1549"><td class="num" id="LN1549">1549</td><td class="line"> <span class='comment'>*  atanh(NaN) is that NaN with no signal;</span></td></tr>
<tr class="codeline" data-linenumber="1550"><td class="num" id="LN1550">1550</td><td class="line"> <span class='comment'>*  atanh(+-1) is +-INF with signal.</span></td></tr>
<tr class="codeline" data-linenumber="1551"><td class="num" id="LN1551">1551</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1552"><td class="num" id="LN1552">1552</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1553"><td class="num" id="LN1553">1553</td><td class="line"><span class='keyword'>double</span> atanh(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="1554"><td class="num" id="LN1554">1554</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> one = 1.0, huge = 1e300;</td></tr>
<tr class="codeline" data-linenumber="1555"><td class="num" id="LN1555">1555</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> zero = 0.0;</td></tr>
<tr class="codeline" data-linenumber="1556"><td class="num" id="LN1556">1556</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1557"><td class="num" id="LN1557">1557</td><td class="line">  <span class='keyword'>double</span> t;</td></tr>
<tr class="codeline" data-linenumber="1558"><td class="num" id="LN1558">1558</td><td class="line">  int32_t hx, ix;</td></tr>
<tr class="codeline" data-linenumber="1559"><td class="num" id="LN1559">1559</td><td class="line">  uint32_t lx;</td></tr>
<tr class="codeline" data-linenumber="1560"><td class="num" id="LN1560">1560</td><td class="line">  EXTRACT_WORDS(hx, lx, x);</td></tr>
<tr class="codeline" data-linenumber="1561"><td class="num" id="LN1561">1561</td><td class="line">  ix = hx &amp; 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="1562"><td class="num" id="LN1562">1562</td><td class="line">  <span class='keyword'>if</span> ((ix | ((lx | NegateWithWraparound&lt;int32_t&gt;(lx)) &gt;&gt; 31)) &gt; 0x3FF00000) {</td></tr>
<tr class="codeline" data-linenumber="1563"><td class="num" id="LN1563">1563</td><td class="line">    <span class='comment'>/* |x|&gt;1 */</span></td></tr>
<tr class="codeline" data-linenumber="1564"><td class="num" id="LN1564">1564</td><td class="line">    <span class='keyword'>return</span> std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::signaling_NaN();</td></tr>
<tr class="codeline" data-linenumber="1565"><td class="num" id="LN1565">1565</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1566"><td class="num" id="LN1566">1566</td><td class="line">  <span class='keyword'>if</span> (ix == 0x3FF00000) {</td></tr>
<tr class="codeline" data-linenumber="1567"><td class="num" id="LN1567">1567</td><td class="line">    <span class='keyword'>return</span> x &gt; 0 ? std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::infinity()</td></tr>
<tr class="codeline" data-linenumber="1568"><td class="num" id="LN1568">1568</td><td class="line">                 : -std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::infinity();</td></tr>
<tr class="codeline" data-linenumber="1569"><td class="num" id="LN1569">1569</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1570"><td class="num" id="LN1570">1570</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x3E300000 &amp;&amp; (huge + x) &gt; zero) <span class='keyword'>return</span> x; <span class='comment'>/* x&lt;2**-28 */</span></td></tr>
<tr class="codeline" data-linenumber="1571"><td class="num" id="LN1571">1571</td><td class="line">  SET_HIGH_WORD(x, ix);</td></tr>
<tr class="codeline" data-linenumber="1572"><td class="num" id="LN1572">1572</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x3FE00000) { <span class='comment'>/* x &lt; 0.5 */</span></td></tr>
<tr class="codeline" data-linenumber="1573"><td class="num" id="LN1573">1573</td><td class="line">    t = x + x;</td></tr>
<tr class="codeline" data-linenumber="1574"><td class="num" id="LN1574">1574</td><td class="line">    t = 0.5 * log1p(t + t * x / (one - x));</td></tr>
<tr class="codeline" data-linenumber="1575"><td class="num" id="LN1575">1575</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1576"><td class="num" id="LN1576">1576</td><td class="line">    t = 0.5 * log1p((x + x) / (one - x));</td></tr>
<tr class="codeline" data-linenumber="1577"><td class="num" id="LN1577">1577</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1578"><td class="num" id="LN1578">1578</td><td class="line">  <span class='keyword'>if</span> (hx &gt;= 0)</td></tr>
<tr class="codeline" data-linenumber="1579"><td class="num" id="LN1579">1579</td><td class="line">    <span class='keyword'>return</span> t;</td></tr>
<tr class="codeline" data-linenumber="1580"><td class="num" id="LN1580">1580</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="1581"><td class="num" id="LN1581">1581</td><td class="line">    <span class='keyword'>return</span> -t;</td></tr>
<tr class="codeline" data-linenumber="1582"><td class="num" id="LN1582">1582</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1583"><td class="num" id="LN1583">1583</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1584"><td class="num" id="LN1584">1584</td><td class="line"><span class='comment'>/* log(x)</span></td></tr>
<tr class="codeline" data-linenumber="1585"><td class="num" id="LN1585">1585</td><td class="line"> <span class='comment'>* Return the logrithm of x</span></td></tr>
<tr class="codeline" data-linenumber="1586"><td class="num" id="LN1586">1586</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1587"><td class="num" id="LN1587">1587</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="1588"><td class="num" id="LN1588">1588</td><td class="line"> <span class='comment'>*   1. Argument Reduction: find k and f such that</span></td></tr>
<tr class="codeline" data-linenumber="1589"><td class="num" id="LN1589">1589</td><td class="line"> <span class='comment'>*     x = 2^k * (1+f),</span></td></tr>
<tr class="codeline" data-linenumber="1590"><td class="num" id="LN1590">1590</td><td class="line"> <span class='comment'>*     where  sqrt(2)/2 &lt; 1+f &lt; sqrt(2) .</span></td></tr>
<tr class="codeline" data-linenumber="1591"><td class="num" id="LN1591">1591</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1592"><td class="num" id="LN1592">1592</td><td class="line"> <span class='comment'>*   2. Approximation of log(1+f).</span></td></tr>
<tr class="codeline" data-linenumber="1593"><td class="num" id="LN1593">1593</td><td class="line"> <span class='comment'>*  Let s = f/(2+f) ; based on log(1+f) = log(1+s) - log(1-s)</span></td></tr>
<tr class="codeline" data-linenumber="1594"><td class="num" id="LN1594">1594</td><td class="line"> <span class='comment'>*     = 2s + 2/3 s**3 + 2/5 s**5 + .....,</span></td></tr>
<tr class="codeline" data-linenumber="1595"><td class="num" id="LN1595">1595</td><td class="line"> <span class='comment'>*         = 2s + s*R</span></td></tr>
<tr class="codeline" data-linenumber="1596"><td class="num" id="LN1596">1596</td><td class="line"> <span class='comment'>*      We use a special Reme algorithm on [0,0.1716] to generate</span></td></tr>
<tr class="codeline" data-linenumber="1597"><td class="num" id="LN1597">1597</td><td class="line"> <span class='comment'>*  a polynomial of degree 14 to approximate R The maximum error</span></td></tr>
<tr class="codeline" data-linenumber="1598"><td class="num" id="LN1598">1598</td><td class="line"> <span class='comment'>*  of this polynomial approximation is bounded by 2**-58.45. In</span></td></tr>
<tr class="codeline" data-linenumber="1599"><td class="num" id="LN1599">1599</td><td class="line"> <span class='comment'>*  other words,</span></td></tr>
<tr class="codeline" data-linenumber="1600"><td class="num" id="LN1600">1600</td><td class="line"> <span class='comment'>*            2      4      6      8      10      12      14</span></td></tr>
<tr class="codeline" data-linenumber="1601"><td class="num" id="LN1601">1601</td><td class="line"> <span class='comment'>*      R(z) ~ Lg1*s +Lg2*s +Lg3*s +Lg4*s +Lg5*s  +Lg6*s  +Lg7*s</span></td></tr>
<tr class="codeline" data-linenumber="1602"><td class="num" id="LN1602">1602</td><td class="line"> <span class='comment'>*    (the values of Lg1 to Lg7 are listed in the program)</span></td></tr>
<tr class="codeline" data-linenumber="1603"><td class="num" id="LN1603">1603</td><td class="line"> <span class='comment'>*  and</span></td></tr>
<tr class="codeline" data-linenumber="1604"><td class="num" id="LN1604">1604</td><td class="line"> <span class='comment'>*      |      2          14          |     -58.45</span></td></tr>
<tr class="codeline" data-linenumber="1605"><td class="num" id="LN1605">1605</td><td class="line"> <span class='comment'>*      | Lg1*s +...+Lg7*s    -  R(z) | &lt;= 2</span></td></tr>
<tr class="codeline" data-linenumber="1606"><td class="num" id="LN1606">1606</td><td class="line"> <span class='comment'>*      |                             |</span></td></tr>
<tr class="codeline" data-linenumber="1607"><td class="num" id="LN1607">1607</td><td class="line"> <span class='comment'>*  Note that 2s = f - s*f = f - hfsq + s*hfsq, where hfsq = f*f/2.</span></td></tr>
<tr class="codeline" data-linenumber="1608"><td class="num" id="LN1608">1608</td><td class="line"> <span class='comment'>*  In order to guarantee error in log below 1ulp, we compute log</span></td></tr>
<tr class="codeline" data-linenumber="1609"><td class="num" id="LN1609">1609</td><td class="line"> <span class='comment'>*  by</span></td></tr>
<tr class="codeline" data-linenumber="1610"><td class="num" id="LN1610">1610</td><td class="line"> <span class='comment'>*    log(1+f) = f - s*(f - R)  (if f is not too large)</span></td></tr>
<tr class="codeline" data-linenumber="1611"><td class="num" id="LN1611">1611</td><td class="line"> <span class='comment'>*    log(1+f) = f - (hfsq - s*(hfsq+R)). (better accuracy)</span></td></tr>
<tr class="codeline" data-linenumber="1612"><td class="num" id="LN1612">1612</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1613"><td class="num" id="LN1613">1613</td><td class="line"> <span class='comment'>*  3. Finally,  log(x) = k*ln2 + log(1+f).</span></td></tr>
<tr class="codeline" data-linenumber="1614"><td class="num" id="LN1614">1614</td><td class="line"> <span class='comment'>*          = k*ln2_hi+(f-(hfsq-(s*(hfsq+R)+k*ln2_lo)))</span></td></tr>
<tr class="codeline" data-linenumber="1615"><td class="num" id="LN1615">1615</td><td class="line"> <span class='comment'>*     Here ln2 is split into two floating point number:</span></td></tr>
<tr class="codeline" data-linenumber="1616"><td class="num" id="LN1616">1616</td><td class="line"> <span class='comment'>*      ln2_hi + ln2_lo,</span></td></tr>
<tr class="codeline" data-linenumber="1617"><td class="num" id="LN1617">1617</td><td class="line"> <span class='comment'>*     where n*ln2_hi is always exact for |n| &lt; 2000.</span></td></tr>
<tr class="codeline" data-linenumber="1618"><td class="num" id="LN1618">1618</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1619"><td class="num" id="LN1619">1619</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="1620"><td class="num" id="LN1620">1620</td><td class="line"> <span class='comment'>*  log(x) is NaN with signal if x &lt; 0 (including -INF) ;</span></td></tr>
<tr class="codeline" data-linenumber="1621"><td class="num" id="LN1621">1621</td><td class="line"> <span class='comment'>*  log(+INF) is +INF; log(0) is -INF with signal;</span></td></tr>
<tr class="codeline" data-linenumber="1622"><td class="num" id="LN1622">1622</td><td class="line"> <span class='comment'>*  log(NaN) is that NaN with no signal.</span></td></tr>
<tr class="codeline" data-linenumber="1623"><td class="num" id="LN1623">1623</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1624"><td class="num" id="LN1624">1624</td><td class="line"> <span class='comment'>* Accuracy:</span></td></tr>
<tr class="codeline" data-linenumber="1625"><td class="num" id="LN1625">1625</td><td class="line"> <span class='comment'>*  according to an error analysis, the error is always less than</span></td></tr>
<tr class="codeline" data-linenumber="1626"><td class="num" id="LN1626">1626</td><td class="line"> <span class='comment'>*  1 ulp (unit in the last place).</span></td></tr>
<tr class="codeline" data-linenumber="1627"><td class="num" id="LN1627">1627</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1628"><td class="num" id="LN1628">1628</td><td class="line"> <span class='comment'>* Constants:</span></td></tr>
<tr class="codeline" data-linenumber="1629"><td class="num" id="LN1629">1629</td><td class="line"> <span class='comment'>* The hexadecimal values are the intended ones for the following</span></td></tr>
<tr class="codeline" data-linenumber="1630"><td class="num" id="LN1630">1630</td><td class="line"> <span class='comment'>* constants. The decimal values may be used, provided that the</span></td></tr>
<tr class="codeline" data-linenumber="1631"><td class="num" id="LN1631">1631</td><td class="line"> <span class='comment'>* compiler will convert from decimal to binary accurately enough</span></td></tr>
<tr class="codeline" data-linenumber="1632"><td class="num" id="LN1632">1632</td><td class="line"> <span class='comment'>* to produce the hexadecimal values shown.</span></td></tr>
<tr class="codeline" data-linenumber="1633"><td class="num" id="LN1633">1633</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1634"><td class="num" id="LN1634">1634</td><td class="line"><span class='keyword'>double</span> log(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="1635"><td class="num" id="LN1635">1635</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span>                      <span class='comment'>/* -- */</span></td></tr>
<tr class="codeline" data-linenumber="1636"><td class="num" id="LN1636">1636</td><td class="line">      ln2_hi = 6.93147180369123816490e-01, <span class='comment'>/* 3fe62e42 fee00000 */</span></td></tr>
<tr class="codeline" data-linenumber="1637"><td class="num" id="LN1637">1637</td><td class="line">      ln2_lo = 1.90821492927058770002e-10, <span class='comment'>/* 3dea39ef 35793c76 */</span></td></tr>
<tr class="codeline" data-linenumber="1638"><td class="num" id="LN1638">1638</td><td class="line">      two54 = 1.80143985094819840000e+16,  <span class='comment'>/* 43500000 00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="1639"><td class="num" id="LN1639">1639</td><td class="line">      Lg1 = 6.666666666666735130e-01,      <span class='comment'>/* 3FE55555 55555593 */</span></td></tr>
<tr class="codeline" data-linenumber="1640"><td class="num" id="LN1640">1640</td><td class="line">      Lg2 = 3.999999999940941908e-01,      <span class='comment'>/* 3FD99999 9997FA04 */</span></td></tr>
<tr class="codeline" data-linenumber="1641"><td class="num" id="LN1641">1641</td><td class="line">      Lg3 = 2.857142874366239149e-01,      <span class='comment'>/* 3FD24924 94229359 */</span></td></tr>
<tr class="codeline" data-linenumber="1642"><td class="num" id="LN1642">1642</td><td class="line">      Lg4 = 2.222219843214978396e-01,      <span class='comment'>/* 3FCC71C5 1D8E78AF */</span></td></tr>
<tr class="codeline" data-linenumber="1643"><td class="num" id="LN1643">1643</td><td class="line">      Lg5 = 1.818357216161805012e-01,      <span class='comment'>/* 3FC74664 96CB03DE */</span></td></tr>
<tr class="codeline" data-linenumber="1644"><td class="num" id="LN1644">1644</td><td class="line">      Lg6 = 1.531383769920937332e-01,      <span class='comment'>/* 3FC39A09 D078C69F */</span></td></tr>
<tr class="codeline" data-linenumber="1645"><td class="num" id="LN1645">1645</td><td class="line">      Lg7 = 1.479819860511658591e-01;      <span class='comment'>/* 3FC2F112 DF3E5244 */</span></td></tr>
<tr class="codeline" data-linenumber="1646"><td class="num" id="LN1646">1646</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1647"><td class="num" id="LN1647">1647</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> zero = 0.0;</td></tr>
<tr class="codeline" data-linenumber="1648"><td class="num" id="LN1648">1648</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1649"><td class="num" id="LN1649">1649</td><td class="line">  <span class='keyword'>double</span> hfsq, f, s, z, R, w, t1, t2, dk;</td></tr>
<tr class="codeline" data-linenumber="1650"><td class="num" id="LN1650">1650</td><td class="line">  int32_t k, hx, i, j;</td></tr>
<tr class="codeline" data-linenumber="1651"><td class="num" id="LN1651">1651</td><td class="line">  uint32_t lx;</td></tr>
<tr class="codeline" data-linenumber="1652"><td class="num" id="LN1652">1652</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1653"><td class="num" id="LN1653">1653</td><td class="line">  EXTRACT_WORDS(hx, lx, x);</td></tr>
<tr class="codeline" data-linenumber="1654"><td class="num" id="LN1654">1654</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1655"><td class="num" id="LN1655">1655</td><td class="line">  k = 0;</td></tr>
<tr class="codeline" data-linenumber="1656"><td class="num" id="LN1656">1656</td><td class="line">  <span class='keyword'>if</span> (hx &lt; 0x00100000) { <span class='comment'>/* x &lt; 2**-1022  */</span></td></tr>
<tr class="codeline" data-linenumber="1657"><td class="num" id="LN1657">1657</td><td class="line">    <span class='keyword'>if</span> (((hx &amp; 0x7FFFFFFF) | lx) == 0) {</td></tr>
<tr class="codeline" data-linenumber="1658"><td class="num" id="LN1658">1658</td><td class="line">      <span class='keyword'>return</span> -std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::infinity(); <span class='comment'>/* log(+-0)=-inf */</span></td></tr>
<tr class="codeline" data-linenumber="1659"><td class="num" id="LN1659">1659</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1660"><td class="num" id="LN1660">1660</td><td class="line">    <span class='keyword'>if</span> (hx &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="1661"><td class="num" id="LN1661">1661</td><td class="line">      <span class='keyword'>return</span> std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::signaling_NaN(); <span class='comment'>/* log(-#) = NaN */</span></td></tr>
<tr class="codeline" data-linenumber="1662"><td class="num" id="LN1662">1662</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1663"><td class="num" id="LN1663">1663</td><td class="line">    k -= 54;</td></tr>
<tr class="codeline" data-linenumber="1664"><td class="num" id="LN1664">1664</td><td class="line">    x *= two54; <span class='comment'>/* subnormal number, scale up x */</span></td></tr>
<tr class="codeline" data-linenumber="1665"><td class="num" id="LN1665">1665</td><td class="line">    GET_HIGH_WORD(hx, x);</td></tr>
<tr class="codeline" data-linenumber="1666"><td class="num" id="LN1666">1666</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1667"><td class="num" id="LN1667">1667</td><td class="line">  <span class='keyword'>if</span> (hx &gt;= 0x7FF00000) <span class='keyword'>return</span> x + x;</td></tr>
<tr class="codeline" data-linenumber="1668"><td class="num" id="LN1668">1668</td><td class="line">  k += (hx &gt;&gt; 20) - 1023;</td></tr>
<tr class="codeline" data-linenumber="1669"><td class="num" id="LN1669">1669</td><td class="line">  hx &amp;= 0x000FFFFF;</td></tr>
<tr class="codeline" data-linenumber="1670"><td class="num" id="LN1670">1670</td><td class="line">  i = (hx + 0x95F64) &amp; 0x100000;</td></tr>
<tr class="codeline" data-linenumber="1671"><td class="num" id="LN1671">1671</td><td class="line">  SET_HIGH_WORD(x, hx | (i ^ 0x3FF00000)); <span class='comment'>/* normalize x or x/2 */</span></td></tr>
<tr class="codeline" data-linenumber="1672"><td class="num" id="LN1672">1672</td><td class="line">  k += (i &gt;&gt; 20);</td></tr>
<tr class="codeline" data-linenumber="1673"><td class="num" id="LN1673">1673</td><td class="line">  f = x - 1.0;</td></tr>
<tr class="codeline" data-linenumber="1674"><td class="num" id="LN1674">1674</td><td class="line">  <span class='keyword'>if</span> ((0x000FFFFF &amp; (2 + hx)) &lt; 3) { <span class='comment'>/* -2**-20 &lt;= f &lt; 2**-20 */</span></td></tr>
<tr class="codeline" data-linenumber="1675"><td class="num" id="LN1675">1675</td><td class="line">    <span class='keyword'>if</span> (f == zero) {</td></tr>
<tr class="codeline" data-linenumber="1676"><td class="num" id="LN1676">1676</td><td class="line">      <span class='keyword'>if</span> (k == 0) {</td></tr>
<tr class="codeline" data-linenumber="1677"><td class="num" id="LN1677">1677</td><td class="line">        <span class='keyword'>return</span> zero;</td></tr>
<tr class="codeline" data-linenumber="1678"><td class="num" id="LN1678">1678</td><td class="line">      } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1679"><td class="num" id="LN1679">1679</td><td class="line">        dk = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(k);</td></tr>
<tr class="codeline" data-linenumber="1680"><td class="num" id="LN1680">1680</td><td class="line">        <span class='keyword'>return</span> dk * ln2_hi + dk * ln2_lo;</td></tr>
<tr class="codeline" data-linenumber="1681"><td class="num" id="LN1681">1681</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="1682"><td class="num" id="LN1682">1682</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1683"><td class="num" id="LN1683">1683</td><td class="line">    R = f * f * (0.5 - 0.33333333333333333 * f);</td></tr>
<tr class="codeline" data-linenumber="1684"><td class="num" id="LN1684">1684</td><td class="line">    <span class='keyword'>if</span> (k == 0) {</td></tr>
<tr class="codeline" data-linenumber="1685"><td class="num" id="LN1685">1685</td><td class="line">      <span class='keyword'>return</span> f - R;</td></tr>
<tr class="codeline" data-linenumber="1686"><td class="num" id="LN1686">1686</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1687"><td class="num" id="LN1687">1687</td><td class="line">      dk = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(k);</td></tr>
<tr class="codeline" data-linenumber="1688"><td class="num" id="LN1688">1688</td><td class="line">      <span class='keyword'>return</span> dk * ln2_hi - ((R - dk * ln2_lo) - f);</td></tr>
<tr class="codeline" data-linenumber="1689"><td class="num" id="LN1689">1689</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1690"><td class="num" id="LN1690">1690</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1691"><td class="num" id="LN1691">1691</td><td class="line">  s = f / (2.0 + f);</td></tr>
<tr class="codeline" data-linenumber="1692"><td class="num" id="LN1692">1692</td><td class="line">  dk = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(k);</td></tr>
<tr class="codeline" data-linenumber="1693"><td class="num" id="LN1693">1693</td><td class="line">  z = s * s;</td></tr>
<tr class="codeline" data-linenumber="1694"><td class="num" id="LN1694">1694</td><td class="line">  i = hx - 0x6147A;</td></tr>
<tr class="codeline" data-linenumber="1695"><td class="num" id="LN1695">1695</td><td class="line">  w = z * z;</td></tr>
<tr class="codeline" data-linenumber="1696"><td class="num" id="LN1696">1696</td><td class="line">  j = 0x6B851 - hx;</td></tr>
<tr class="codeline" data-linenumber="1697"><td class="num" id="LN1697">1697</td><td class="line">  t1 = w * (Lg2 + w * (Lg4 + w * Lg6));</td></tr>
<tr class="codeline" data-linenumber="1698"><td class="num" id="LN1698">1698</td><td class="line">  t2 = z * (Lg1 + w * (Lg3 + w * (Lg5 + w * Lg7)));</td></tr>
<tr class="codeline" data-linenumber="1699"><td class="num" id="LN1699">1699</td><td class="line">  i |= j;</td></tr>
<tr class="codeline" data-linenumber="1700"><td class="num" id="LN1700">1700</td><td class="line">  R = t2 + t1;</td></tr>
<tr class="codeline" data-linenumber="1701"><td class="num" id="LN1701">1701</td><td class="line">  <span class='keyword'>if</span> (i &gt; 0) {</td></tr>
<tr class="codeline" data-linenumber="1702"><td class="num" id="LN1702">1702</td><td class="line">    hfsq = 0.5 * f * f;</td></tr>
<tr class="codeline" data-linenumber="1703"><td class="num" id="LN1703">1703</td><td class="line">    <span class='keyword'>if</span> (k == 0)</td></tr>
<tr class="codeline" data-linenumber="1704"><td class="num" id="LN1704">1704</td><td class="line">      <span class='keyword'>return</span> f - (hfsq - s * (hfsq + R));</td></tr>
<tr class="codeline" data-linenumber="1705"><td class="num" id="LN1705">1705</td><td class="line">    <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="1706"><td class="num" id="LN1706">1706</td><td class="line">      <span class='keyword'>return</span> dk * ln2_hi - ((hfsq - (s * (hfsq + R) + dk * ln2_lo)) - f);</td></tr>
<tr class="codeline" data-linenumber="1707"><td class="num" id="LN1707">1707</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1708"><td class="num" id="LN1708">1708</td><td class="line">    <span class='keyword'>if</span> (k == 0)</td></tr>
<tr class="codeline" data-linenumber="1709"><td class="num" id="LN1709">1709</td><td class="line">      <span class='keyword'>return</span> f - s * (f - R);</td></tr>
<tr class="codeline" data-linenumber="1710"><td class="num" id="LN1710">1710</td><td class="line">    <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="1711"><td class="num" id="LN1711">1711</td><td class="line">      <span class='keyword'>return</span> dk * ln2_hi - ((s * (f - R) - dk * ln2_lo) - f);</td></tr>
<tr class="codeline" data-linenumber="1712"><td class="num" id="LN1712">1712</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1713"><td class="num" id="LN1713">1713</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1714"><td class="num" id="LN1714">1714</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1715"><td class="num" id="LN1715">1715</td><td class="line"><span class='comment'>/* double log1p(double x)</span></td></tr>
<tr class="codeline" data-linenumber="1716"><td class="num" id="LN1716">1716</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1717"><td class="num" id="LN1717">1717</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="1718"><td class="num" id="LN1718">1718</td><td class="line"> <span class='comment'>*   1. Argument Reduction: find k and f such that</span></td></tr>
<tr class="codeline" data-linenumber="1719"><td class="num" id="LN1719">1719</td><td class="line"> <span class='comment'>*      1+x = 2^k * (1+f),</span></td></tr>
<tr class="codeline" data-linenumber="1720"><td class="num" id="LN1720">1720</td><td class="line"> <span class='comment'>*     where  sqrt(2)/2 &lt; 1+f &lt; sqrt(2) .</span></td></tr>
<tr class="codeline" data-linenumber="1721"><td class="num" id="LN1721">1721</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1722"><td class="num" id="LN1722">1722</td><td class="line"> <span class='comment'>*      Note. If k=0, then f=x is exact. However, if k!=0, then f</span></td></tr>
<tr class="codeline" data-linenumber="1723"><td class="num" id="LN1723">1723</td><td class="line"> <span class='comment'>*  may not be representable exactly. In that case, a correction</span></td></tr>
<tr class="codeline" data-linenumber="1724"><td class="num" id="LN1724">1724</td><td class="line"> <span class='comment'>*  term is need. Let u=1+x rounded. Let c = (1+x)-u, then</span></td></tr>
<tr class="codeline" data-linenumber="1725"><td class="num" id="LN1725">1725</td><td class="line"> <span class='comment'>*  log(1+x) - log(u) ~ c/u. Thus, we proceed to compute log(u),</span></td></tr>
<tr class="codeline" data-linenumber="1726"><td class="num" id="LN1726">1726</td><td class="line"> <span class='comment'>*  and add back the correction term c/u.</span></td></tr>
<tr class="codeline" data-linenumber="1727"><td class="num" id="LN1727">1727</td><td class="line"> <span class='comment'>*  (Note: when x &gt; 2**53, one can simply return log(x))</span></td></tr>
<tr class="codeline" data-linenumber="1728"><td class="num" id="LN1728">1728</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1729"><td class="num" id="LN1729">1729</td><td class="line"> <span class='comment'>*   2. Approximation of log1p(f).</span></td></tr>
<tr class="codeline" data-linenumber="1730"><td class="num" id="LN1730">1730</td><td class="line"> <span class='comment'>*  Let s = f/(2+f) ; based on log(1+f) = log(1+s) - log(1-s)</span></td></tr>
<tr class="codeline" data-linenumber="1731"><td class="num" id="LN1731">1731</td><td class="line"> <span class='comment'>*     = 2s + 2/3 s**3 + 2/5 s**5 + .....,</span></td></tr>
<tr class="codeline" data-linenumber="1732"><td class="num" id="LN1732">1732</td><td class="line"> <span class='comment'>*         = 2s + s*R</span></td></tr>
<tr class="codeline" data-linenumber="1733"><td class="num" id="LN1733">1733</td><td class="line"> <span class='comment'>*      We use a special Reme algorithm on [0,0.1716] to generate</span></td></tr>
<tr class="codeline" data-linenumber="1734"><td class="num" id="LN1734">1734</td><td class="line"> <span class='comment'>*  a polynomial of degree 14 to approximate R The maximum error</span></td></tr>
<tr class="codeline" data-linenumber="1735"><td class="num" id="LN1735">1735</td><td class="line"> <span class='comment'>*  of this polynomial approximation is bounded by 2**-58.45. In</span></td></tr>
<tr class="codeline" data-linenumber="1736"><td class="num" id="LN1736">1736</td><td class="line"> <span class='comment'>*  other words,</span></td></tr>
<tr class="codeline" data-linenumber="1737"><td class="num" id="LN1737">1737</td><td class="line"> <span class='comment'>*            2      4      6      8      10      12      14</span></td></tr>
<tr class="codeline" data-linenumber="1738"><td class="num" id="LN1738">1738</td><td class="line"> <span class='comment'>*      R(z) ~ Lp1*s +Lp2*s +Lp3*s +Lp4*s +Lp5*s  +Lp6*s  +Lp7*s</span></td></tr>
<tr class="codeline" data-linenumber="1739"><td class="num" id="LN1739">1739</td><td class="line"> <span class='comment'>*    (the values of Lp1 to Lp7 are listed in the program)</span></td></tr>
<tr class="codeline" data-linenumber="1740"><td class="num" id="LN1740">1740</td><td class="line"> <span class='comment'>*  and</span></td></tr>
<tr class="codeline" data-linenumber="1741"><td class="num" id="LN1741">1741</td><td class="line"> <span class='comment'>*      |      2          14          |     -58.45</span></td></tr>
<tr class="codeline" data-linenumber="1742"><td class="num" id="LN1742">1742</td><td class="line"> <span class='comment'>*      | Lp1*s +...+Lp7*s    -  R(z) | &lt;= 2</span></td></tr>
<tr class="codeline" data-linenumber="1743"><td class="num" id="LN1743">1743</td><td class="line"> <span class='comment'>*      |                             |</span></td></tr>
<tr class="codeline" data-linenumber="1744"><td class="num" id="LN1744">1744</td><td class="line"> <span class='comment'>*  Note that 2s = f - s*f = f - hfsq + s*hfsq, where hfsq = f*f/2.</span></td></tr>
<tr class="codeline" data-linenumber="1745"><td class="num" id="LN1745">1745</td><td class="line"> <span class='comment'>*  In order to guarantee error in log below 1ulp, we compute log</span></td></tr>
<tr class="codeline" data-linenumber="1746"><td class="num" id="LN1746">1746</td><td class="line"> <span class='comment'>*  by</span></td></tr>
<tr class="codeline" data-linenumber="1747"><td class="num" id="LN1747">1747</td><td class="line"> <span class='comment'>*    log1p(f) = f - (hfsq - s*(hfsq+R)).</span></td></tr>
<tr class="codeline" data-linenumber="1748"><td class="num" id="LN1748">1748</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1749"><td class="num" id="LN1749">1749</td><td class="line"> <span class='comment'>*  3. Finally, log1p(x) = k*ln2 + log1p(f).</span></td></tr>
<tr class="codeline" data-linenumber="1750"><td class="num" id="LN1750">1750</td><td class="line"> <span class='comment'>*           = k*ln2_hi+(f-(hfsq-(s*(hfsq+R)+k*ln2_lo)))</span></td></tr>
<tr class="codeline" data-linenumber="1751"><td class="num" id="LN1751">1751</td><td class="line"> <span class='comment'>*     Here ln2 is split into two floating point number:</span></td></tr>
<tr class="codeline" data-linenumber="1752"><td class="num" id="LN1752">1752</td><td class="line"> <span class='comment'>*      ln2_hi + ln2_lo,</span></td></tr>
<tr class="codeline" data-linenumber="1753"><td class="num" id="LN1753">1753</td><td class="line"> <span class='comment'>*     where n*ln2_hi is always exact for |n| &lt; 2000.</span></td></tr>
<tr class="codeline" data-linenumber="1754"><td class="num" id="LN1754">1754</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1755"><td class="num" id="LN1755">1755</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="1756"><td class="num" id="LN1756">1756</td><td class="line"> <span class='comment'>*  log1p(x) is NaN with signal if x &lt; -1 (including -INF) ;</span></td></tr>
<tr class="codeline" data-linenumber="1757"><td class="num" id="LN1757">1757</td><td class="line"> <span class='comment'>*  log1p(+INF) is +INF; log1p(-1) is -INF with signal;</span></td></tr>
<tr class="codeline" data-linenumber="1758"><td class="num" id="LN1758">1758</td><td class="line"> <span class='comment'>*  log1p(NaN) is that NaN with no signal.</span></td></tr>
<tr class="codeline" data-linenumber="1759"><td class="num" id="LN1759">1759</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1760"><td class="num" id="LN1760">1760</td><td class="line"> <span class='comment'>* Accuracy:</span></td></tr>
<tr class="codeline" data-linenumber="1761"><td class="num" id="LN1761">1761</td><td class="line"> <span class='comment'>*  according to an error analysis, the error is always less than</span></td></tr>
<tr class="codeline" data-linenumber="1762"><td class="num" id="LN1762">1762</td><td class="line"> <span class='comment'>*  1 ulp (unit in the last place).</span></td></tr>
<tr class="codeline" data-linenumber="1763"><td class="num" id="LN1763">1763</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1764"><td class="num" id="LN1764">1764</td><td class="line"> <span class='comment'>* Constants:</span></td></tr>
<tr class="codeline" data-linenumber="1765"><td class="num" id="LN1765">1765</td><td class="line"> <span class='comment'>* The hexadecimal values are the intended ones for the following</span></td></tr>
<tr class="codeline" data-linenumber="1766"><td class="num" id="LN1766">1766</td><td class="line"> <span class='comment'>* constants. The decimal values may be used, provided that the</span></td></tr>
<tr class="codeline" data-linenumber="1767"><td class="num" id="LN1767">1767</td><td class="line"> <span class='comment'>* compiler will convert from decimal to binary accurately enough</span></td></tr>
<tr class="codeline" data-linenumber="1768"><td class="num" id="LN1768">1768</td><td class="line"> <span class='comment'>* to produce the hexadecimal values shown.</span></td></tr>
<tr class="codeline" data-linenumber="1769"><td class="num" id="LN1769">1769</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1770"><td class="num" id="LN1770">1770</td><td class="line"> <span class='comment'>* Note: Assuming log() return accurate answer, the following</span></td></tr>
<tr class="codeline" data-linenumber="1771"><td class="num" id="LN1771">1771</td><td class="line"> <span class='comment'>*   algorithm can be used to compute log1p(x) to within a few ULP:</span></td></tr>
<tr class="codeline" data-linenumber="1772"><td class="num" id="LN1772">1772</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1773"><td class="num" id="LN1773">1773</td><td class="line"> <span class='comment'>*    u = 1+x;</span></td></tr>
<tr class="codeline" data-linenumber="1774"><td class="num" id="LN1774">1774</td><td class="line"> <span class='comment'>*    if(u==1.0) return x ; else</span></td></tr>
<tr class="codeline" data-linenumber="1775"><td class="num" id="LN1775">1775</td><td class="line"> <span class='comment'>*         return log(u)*(x/(u-1.0));</span></td></tr>
<tr class="codeline" data-linenumber="1776"><td class="num" id="LN1776">1776</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1777"><td class="num" id="LN1777">1777</td><td class="line"> <span class='comment'>*   See HP-15C Advanced Functions Handbook, p.193.</span></td></tr>
<tr class="codeline" data-linenumber="1778"><td class="num" id="LN1778">1778</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1779"><td class="num" id="LN1779">1779</td><td class="line"><span class='keyword'>double</span> log1p(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="1780"><td class="num" id="LN1780">1780</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span>                      <span class='comment'>/* -- */</span></td></tr>
<tr class="codeline" data-linenumber="1781"><td class="num" id="LN1781">1781</td><td class="line">      ln2_hi = 6.93147180369123816490e-01, <span class='comment'>/* 3fe62e42 fee00000 */</span></td></tr>
<tr class="codeline" data-linenumber="1782"><td class="num" id="LN1782">1782</td><td class="line">      ln2_lo = 1.90821492927058770002e-10, <span class='comment'>/* 3dea39ef 35793c76 */</span></td></tr>
<tr class="codeline" data-linenumber="1783"><td class="num" id="LN1783">1783</td><td class="line">      two54 = 1.80143985094819840000e+16,  <span class='comment'>/* 43500000 00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="1784"><td class="num" id="LN1784">1784</td><td class="line">      Lp1 = 6.666666666666735130e-01,      <span class='comment'>/* 3FE55555 55555593 */</span></td></tr>
<tr class="codeline" data-linenumber="1785"><td class="num" id="LN1785">1785</td><td class="line">      Lp2 = 3.999999999940941908e-01,      <span class='comment'>/* 3FD99999 9997FA04 */</span></td></tr>
<tr class="codeline" data-linenumber="1786"><td class="num" id="LN1786">1786</td><td class="line">      Lp3 = 2.857142874366239149e-01,      <span class='comment'>/* 3FD24924 94229359 */</span></td></tr>
<tr class="codeline" data-linenumber="1787"><td class="num" id="LN1787">1787</td><td class="line">      Lp4 = 2.222219843214978396e-01,      <span class='comment'>/* 3FCC71C5 1D8E78AF */</span></td></tr>
<tr class="codeline" data-linenumber="1788"><td class="num" id="LN1788">1788</td><td class="line">      Lp5 = 1.818357216161805012e-01,      <span class='comment'>/* 3FC74664 96CB03DE */</span></td></tr>
<tr class="codeline" data-linenumber="1789"><td class="num" id="LN1789">1789</td><td class="line">      Lp6 = 1.531383769920937332e-01,      <span class='comment'>/* 3FC39A09 D078C69F */</span></td></tr>
<tr class="codeline" data-linenumber="1790"><td class="num" id="LN1790">1790</td><td class="line">      Lp7 = 1.479819860511658591e-01;      <span class='comment'>/* 3FC2F112 DF3E5244 */</span></td></tr>
<tr class="codeline" data-linenumber="1791"><td class="num" id="LN1791">1791</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1792"><td class="num" id="LN1792">1792</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> zero = 0.0;</td></tr>
<tr class="codeline" data-linenumber="1793"><td class="num" id="LN1793">1793</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1794"><td class="num" id="LN1794">1794</td><td class="line">  <span class='keyword'>double</span> hfsq, f, c, s, z, R, u;</td></tr>
<tr class="codeline" data-linenumber="1795"><td class="num" id="LN1795">1795</td><td class="line">  int32_t k, hx, hu, ax;</td></tr>
<tr class="codeline" data-linenumber="1796"><td class="num" id="LN1796">1796</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1797"><td class="num" id="LN1797">1797</td><td class="line">  GET_HIGH_WORD(hx, x);</td></tr>
<tr class="codeline" data-linenumber="1798"><td class="num" id="LN1798">1798</td><td class="line">  ax = hx &amp; 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="1799"><td class="num" id="LN1799">1799</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1800"><td class="num" id="LN1800">1800</td><td class="line">  k = 1;</td></tr>
<tr class="codeline" data-linenumber="1801"><td class="num" id="LN1801">1801</td><td class="line">  <span class='keyword'>if</span> (hx &lt; 0x3FDA827A) {    <span class='comment'>/* 1+x &lt; sqrt(2)+ */</span></td></tr>
<tr class="codeline" data-linenumber="1802"><td class="num" id="LN1802">1802</td><td class="line">    <span class='keyword'>if</span> (ax &gt;= 0x3FF00000) { <span class='comment'>/* x &lt;= -1.0 */</span></td></tr>
<tr class="codeline" data-linenumber="1803"><td class="num" id="LN1803">1803</td><td class="line">      <span class='keyword'>if</span> (x == -1.0)</td></tr>
<tr class="codeline" data-linenumber="1804"><td class="num" id="LN1804">1804</td><td class="line">        <span class='keyword'>return</span> -std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::infinity(); <span class='comment'>/* log1p(-1)=+inf */</span></td></tr>
<tr class="codeline" data-linenumber="1805"><td class="num" id="LN1805">1805</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="1806"><td class="num" id="LN1806">1806</td><td class="line">        <span class='keyword'>return</span> std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::signaling_NaN();  <span class='comment'>// log1p(x&lt;-1)=NaN</span></td></tr>
<tr class="codeline" data-linenumber="1807"><td class="num" id="LN1807">1807</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1808"><td class="num" id="LN1808">1808</td><td class="line">    <span class='keyword'>if</span> (ax &lt; 0x3E200000) {    <span class='comment'>/* |x| &lt; 2**-29 */</span></td></tr>
<tr class="codeline" data-linenumber="1809"><td class="num" id="LN1809">1809</td><td class="line">      <span class='keyword'>if</span> (two54 + x &gt; zero    <span class='comment'>/* raise inexact */</span></td></tr>
<tr class="codeline" data-linenumber="1810"><td class="num" id="LN1810">1810</td><td class="line">          &amp;&amp; ax &lt; 0x3C900000) <span class='comment'>/* |x| &lt; 2**-54 */</span></td></tr>
<tr class="codeline" data-linenumber="1811"><td class="num" id="LN1811">1811</td><td class="line">        <span class='keyword'>return</span> x;</td></tr>
<tr class="codeline" data-linenumber="1812"><td class="num" id="LN1812">1812</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="1813"><td class="num" id="LN1813">1813</td><td class="line">        <span class='keyword'>return</span> x - x * x * 0.5;</td></tr>
<tr class="codeline" data-linenumber="1814"><td class="num" id="LN1814">1814</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1815"><td class="num" id="LN1815">1815</td><td class="line">    <span class='keyword'>if</span> (hx &gt; 0 || hx &lt;= <span class='keyword'>static_cast</span>&lt;int32_t&gt;(0xBFD2BEC4)) {</td></tr>
<tr class="codeline" data-linenumber="1816"><td class="num" id="LN1816">1816</td><td class="line">      k = 0;</td></tr>
<tr class="codeline" data-linenumber="1817"><td class="num" id="LN1817">1817</td><td class="line">      f = x;</td></tr>
<tr class="codeline" data-linenumber="1818"><td class="num" id="LN1818">1818</td><td class="line">      hu = 1;</td></tr>
<tr class="codeline" data-linenumber="1819"><td class="num" id="LN1819">1819</td><td class="line">    } <span class='comment'>/* sqrt(2)/2- &lt;= 1+x &lt; sqrt(2)+ */</span></td></tr>
<tr class="codeline" data-linenumber="1820"><td class="num" id="LN1820">1820</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1821"><td class="num" id="LN1821">1821</td><td class="line">  <span class='keyword'>if</span> (hx &gt;= 0x7FF00000) <span class='keyword'>return</span> x + x;</td></tr>
<tr class="codeline" data-linenumber="1822"><td class="num" id="LN1822">1822</td><td class="line">  <span class='keyword'>if</span> (k != 0) {</td></tr>
<tr class="codeline" data-linenumber="1823"><td class="num" id="LN1823">1823</td><td class="line">    <span class='keyword'>if</span> (hx &lt; 0x43400000) {</td></tr>
<tr class="codeline" data-linenumber="1824"><td class="num" id="LN1824">1824</td><td class="line">      u = 1.0 + x;</td></tr>
<tr class="codeline" data-linenumber="1825"><td class="num" id="LN1825">1825</td><td class="line">      GET_HIGH_WORD(hu, u);</td></tr>
<tr class="codeline" data-linenumber="1826"><td class="num" id="LN1826">1826</td><td class="line">      k = (hu &gt;&gt; 20) - 1023;</td></tr>
<tr class="codeline" data-linenumber="1827"><td class="num" id="LN1827">1827</td><td class="line">      c = (k &gt; 0) ? 1.0 - (u - x) : x - (u - 1.0); <span class='comment'>/* correction term */</span></td></tr>
<tr class="codeline" data-linenumber="1828"><td class="num" id="LN1828">1828</td><td class="line">      c /= u;</td></tr>
<tr class="codeline" data-linenumber="1829"><td class="num" id="LN1829">1829</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1830"><td class="num" id="LN1830">1830</td><td class="line">      u = x;</td></tr>
<tr class="codeline" data-linenumber="1831"><td class="num" id="LN1831">1831</td><td class="line">      GET_HIGH_WORD(hu, u);</td></tr>
<tr class="codeline" data-linenumber="1832"><td class="num" id="LN1832">1832</td><td class="line">      k = (hu &gt;&gt; 20) - 1023;</td></tr>
<tr class="codeline" data-linenumber="1833"><td class="num" id="LN1833">1833</td><td class="line">      c = 0;</td></tr>
<tr class="codeline" data-linenumber="1834"><td class="num" id="LN1834">1834</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1835"><td class="num" id="LN1835">1835</td><td class="line">    hu &amp;= 0x000FFFFF;</td></tr>
<tr class="codeline" data-linenumber="1836"><td class="num" id="LN1836">1836</td><td class="line">    <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1837"><td class="num" id="LN1837">1837</td><td class="line">     <span class='comment'>* The approximation to sqrt(2) used in thresholds is not</span></td></tr>
<tr class="codeline" data-linenumber="1838"><td class="num" id="LN1838">1838</td><td class="line">     <span class='comment'>* critical.  However, the ones used above must give less</span></td></tr>
<tr class="codeline" data-linenumber="1839"><td class="num" id="LN1839">1839</td><td class="line">     <span class='comment'>* strict bounds than the one here so that the k==0 case is</span></td></tr>
<tr class="codeline" data-linenumber="1840"><td class="num" id="LN1840">1840</td><td class="line">     <span class='comment'>* never reached from here, since here we have committed to</span></td></tr>
<tr class="codeline" data-linenumber="1841"><td class="num" id="LN1841">1841</td><td class="line">     <span class='comment'>* using the correction term but don't use it if k==0.</span></td></tr>
<tr class="codeline" data-linenumber="1842"><td class="num" id="LN1842">1842</td><td class="line">     <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1843"><td class="num" id="LN1843">1843</td><td class="line">    <span class='keyword'>if</span> (hu &lt; 0x6A09E) {                  <span class='comment'>/* u ~&lt; sqrt(2) */</span></td></tr>
<tr class="codeline" data-linenumber="1844"><td class="num" id="LN1844">1844</td><td class="line">      SET_HIGH_WORD(u, hu | 0x3FF00000); <span class='comment'>/* normalize u */</span></td></tr>
<tr class="codeline" data-linenumber="1845"><td class="num" id="LN1845">1845</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1846"><td class="num" id="LN1846">1846</td><td class="line">      k += 1;</td></tr>
<tr class="codeline" data-linenumber="1847"><td class="num" id="LN1847">1847</td><td class="line">      SET_HIGH_WORD(u, hu | 0x3FE00000); <span class='comment'>/* normalize u/2 */</span></td></tr>
<tr class="codeline" data-linenumber="1848"><td class="num" id="LN1848">1848</td><td class="line">      hu = (0x00100000 - hu) &gt;&gt; 2;</td></tr>
<tr class="codeline" data-linenumber="1849"><td class="num" id="LN1849">1849</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1850"><td class="num" id="LN1850">1850</td><td class="line">    f = u - 1.0;</td></tr>
<tr class="codeline" data-linenumber="1851"><td class="num" id="LN1851">1851</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1852"><td class="num" id="LN1852">1852</td><td class="line">  hfsq = 0.5 * f * f;</td></tr>
<tr class="codeline" data-linenumber="1853"><td class="num" id="LN1853">1853</td><td class="line">  <span class='keyword'>if</span> (hu == 0) { <span class='comment'>/* |f| &lt; 2**-20 */</span></td></tr>
<tr class="codeline" data-linenumber="1854"><td class="num" id="LN1854">1854</td><td class="line">    <span class='keyword'>if</span> (f == zero) {</td></tr>
<tr class="codeline" data-linenumber="1855"><td class="num" id="LN1855">1855</td><td class="line">      <span class='keyword'>if</span> (k == 0) {</td></tr>
<tr class="codeline" data-linenumber="1856"><td class="num" id="LN1856">1856</td><td class="line">        <span class='keyword'>return</span> zero;</td></tr>
<tr class="codeline" data-linenumber="1857"><td class="num" id="LN1857">1857</td><td class="line">      } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="1858"><td class="num" id="LN1858">1858</td><td class="line">        c += k * ln2_lo;</td></tr>
<tr class="codeline" data-linenumber="1859"><td class="num" id="LN1859">1859</td><td class="line">        <span class='keyword'>return</span> k * ln2_hi + c;</td></tr>
<tr class="codeline" data-linenumber="1860"><td class="num" id="LN1860">1860</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="1861"><td class="num" id="LN1861">1861</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1862"><td class="num" id="LN1862">1862</td><td class="line">    R = hfsq * (1.0 - 0.66666666666666666 * f);</td></tr>
<tr class="codeline" data-linenumber="1863"><td class="num" id="LN1863">1863</td><td class="line">    <span class='keyword'>if</span> (k == 0)</td></tr>
<tr class="codeline" data-linenumber="1864"><td class="num" id="LN1864">1864</td><td class="line">      <span class='keyword'>return</span> f - R;</td></tr>
<tr class="codeline" data-linenumber="1865"><td class="num" id="LN1865">1865</td><td class="line">    <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="1866"><td class="num" id="LN1866">1866</td><td class="line">      <span class='keyword'>return</span> k * ln2_hi - ((R - (k * ln2_lo + c)) - f);</td></tr>
<tr class="codeline" data-linenumber="1867"><td class="num" id="LN1867">1867</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1868"><td class="num" id="LN1868">1868</td><td class="line">  s = f / (2.0 + f);</td></tr>
<tr class="codeline" data-linenumber="1869"><td class="num" id="LN1869">1869</td><td class="line">  z = s * s;</td></tr>
<tr class="codeline" data-linenumber="1870"><td class="num" id="LN1870">1870</td><td class="line">  R = z * (Lp1 +</td></tr>
<tr class="codeline" data-linenumber="1871"><td class="num" id="LN1871">1871</td><td class="line">           z * (Lp2 + z * (Lp3 + z * (Lp4 + z * (Lp5 + z * (Lp6 + z * Lp7))))));</td></tr>
<tr class="codeline" data-linenumber="1872"><td class="num" id="LN1872">1872</td><td class="line">  <span class='keyword'>if</span> (k == 0)</td></tr>
<tr class="codeline" data-linenumber="1873"><td class="num" id="LN1873">1873</td><td class="line">    <span class='keyword'>return</span> f - (hfsq - s * (hfsq + R));</td></tr>
<tr class="codeline" data-linenumber="1874"><td class="num" id="LN1874">1874</td><td class="line">  <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="1875"><td class="num" id="LN1875">1875</td><td class="line">    <span class='keyword'>return</span> k * ln2_hi - ((hfsq - (s * (hfsq + R) + (k * ln2_lo + c))) - f);</td></tr>
<tr class="codeline" data-linenumber="1876"><td class="num" id="LN1876">1876</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1877"><td class="num" id="LN1877">1877</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1878"><td class="num" id="LN1878">1878</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1879"><td class="num" id="LN1879">1879</td><td class="line"> <span class='comment'>* k_log1p(f):</span></td></tr>
<tr class="codeline" data-linenumber="1880"><td class="num" id="LN1880">1880</td><td class="line"> <span class='comment'>* Return log(1+f) - f for 1+f in ~[sqrt(2)/2, sqrt(2)].</span></td></tr>
<tr class="codeline" data-linenumber="1881"><td class="num" id="LN1881">1881</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1882"><td class="num" id="LN1882">1882</td><td class="line"> <span class='comment'>* The following describes the overall strategy for computing</span></td></tr>
<tr class="codeline" data-linenumber="1883"><td class="num" id="LN1883">1883</td><td class="line"> <span class='comment'>* logarithms in base e.  The argument reduction and adding the final</span></td></tr>
<tr class="codeline" data-linenumber="1884"><td class="num" id="LN1884">1884</td><td class="line"> <span class='comment'>* term of the polynomial are done by the caller for increased accuracy</span></td></tr>
<tr class="codeline" data-linenumber="1885"><td class="num" id="LN1885">1885</td><td class="line"> <span class='comment'>* when different bases are used.</span></td></tr>
<tr class="codeline" data-linenumber="1886"><td class="num" id="LN1886">1886</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1887"><td class="num" id="LN1887">1887</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="1888"><td class="num" id="LN1888">1888</td><td class="line"> <span class='comment'>*   1. Argument Reduction: find k and f such that</span></td></tr>
<tr class="codeline" data-linenumber="1889"><td class="num" id="LN1889">1889</td><td class="line"> <span class='comment'>*         x = 2^k * (1+f),</span></td></tr>
<tr class="codeline" data-linenumber="1890"><td class="num" id="LN1890">1890</td><td class="line"> <span class='comment'>*         where  sqrt(2)/2 &lt; 1+f &lt; sqrt(2) .</span></td></tr>
<tr class="codeline" data-linenumber="1891"><td class="num" id="LN1891">1891</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1892"><td class="num" id="LN1892">1892</td><td class="line"> <span class='comment'>*   2. Approximation of log(1+f).</span></td></tr>
<tr class="codeline" data-linenumber="1893"><td class="num" id="LN1893">1893</td><td class="line"> <span class='comment'>*      Let s = f/(2+f) ; based on log(1+f) = log(1+s) - log(1-s)</span></td></tr>
<tr class="codeline" data-linenumber="1894"><td class="num" id="LN1894">1894</td><td class="line"> <span class='comment'>*            = 2s + 2/3 s**3 + 2/5 s**5 + .....,</span></td></tr>
<tr class="codeline" data-linenumber="1895"><td class="num" id="LN1895">1895</td><td class="line"> <span class='comment'>*            = 2s + s*R</span></td></tr>
<tr class="codeline" data-linenumber="1896"><td class="num" id="LN1896">1896</td><td class="line"> <span class='comment'>*      We use a special Reme algorithm on [0,0.1716] to generate</span></td></tr>
<tr class="codeline" data-linenumber="1897"><td class="num" id="LN1897">1897</td><td class="line"> <span class='comment'>*      a polynomial of degree 14 to approximate R The maximum error</span></td></tr>
<tr class="codeline" data-linenumber="1898"><td class="num" id="LN1898">1898</td><td class="line"> <span class='comment'>*      of this polynomial approximation is bounded by 2**-58.45. In</span></td></tr>
<tr class="codeline" data-linenumber="1899"><td class="num" id="LN1899">1899</td><td class="line"> <span class='comment'>*      other words,</span></td></tr>
<tr class="codeline" data-linenumber="1900"><td class="num" id="LN1900">1900</td><td class="line"> <span class='comment'>*          2      4      6      8      10      12      14</span></td></tr>
<tr class="codeline" data-linenumber="1901"><td class="num" id="LN1901">1901</td><td class="line"> <span class='comment'>*          R(z) ~ Lg1*s +Lg2*s +Lg3*s +Lg4*s +Lg5*s  +Lg6*s  +Lg7*s</span></td></tr>
<tr class="codeline" data-linenumber="1902"><td class="num" id="LN1902">1902</td><td class="line"> <span class='comment'>*      (the values of Lg1 to Lg7 are listed in the program)</span></td></tr>
<tr class="codeline" data-linenumber="1903"><td class="num" id="LN1903">1903</td><td class="line"> <span class='comment'>*      and</span></td></tr>
<tr class="codeline" data-linenumber="1904"><td class="num" id="LN1904">1904</td><td class="line"> <span class='comment'>*          |      2          14          |     -58.45</span></td></tr>
<tr class="codeline" data-linenumber="1905"><td class="num" id="LN1905">1905</td><td class="line"> <span class='comment'>*          | Lg1*s +...+Lg7*s    -  R(z) | &lt;= 2</span></td></tr>
<tr class="codeline" data-linenumber="1906"><td class="num" id="LN1906">1906</td><td class="line"> <span class='comment'>*          |                             |</span></td></tr>
<tr class="codeline" data-linenumber="1907"><td class="num" id="LN1907">1907</td><td class="line"> <span class='comment'>*      Note that 2s = f - s*f = f - hfsq + s*hfsq, where hfsq = f*f/2.</span></td></tr>
<tr class="codeline" data-linenumber="1908"><td class="num" id="LN1908">1908</td><td class="line"> <span class='comment'>*      In order to guarantee error in log below 1ulp, we compute log</span></td></tr>
<tr class="codeline" data-linenumber="1909"><td class="num" id="LN1909">1909</td><td class="line"> <span class='comment'>*      by</span></td></tr>
<tr class="codeline" data-linenumber="1910"><td class="num" id="LN1910">1910</td><td class="line"> <span class='comment'>*          log(1+f) = f - s*(f - R)            (if f is not too large)</span></td></tr>
<tr class="codeline" data-linenumber="1911"><td class="num" id="LN1911">1911</td><td class="line"> <span class='comment'>*          log(1+f) = f - (hfsq - s*(hfsq+R)). (better accuracy)</span></td></tr>
<tr class="codeline" data-linenumber="1912"><td class="num" id="LN1912">1912</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1913"><td class="num" id="LN1913">1913</td><td class="line"> <span class='comment'>*   3. Finally,  log(x) = k*ln2 + log(1+f).</span></td></tr>
<tr class="codeline" data-linenumber="1914"><td class="num" id="LN1914">1914</td><td class="line"> <span class='comment'>*          = k*ln2_hi+(f-(hfsq-(s*(hfsq+R)+k*ln2_lo)))</span></td></tr>
<tr class="codeline" data-linenumber="1915"><td class="num" id="LN1915">1915</td><td class="line"> <span class='comment'>*      Here ln2 is split into two floating point number:</span></td></tr>
<tr class="codeline" data-linenumber="1916"><td class="num" id="LN1916">1916</td><td class="line"> <span class='comment'>*          ln2_hi + ln2_lo,</span></td></tr>
<tr class="codeline" data-linenumber="1917"><td class="num" id="LN1917">1917</td><td class="line"> <span class='comment'>*      where n*ln2_hi is always exact for |n| &lt; 2000.</span></td></tr>
<tr class="codeline" data-linenumber="1918"><td class="num" id="LN1918">1918</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1919"><td class="num" id="LN1919">1919</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="1920"><td class="num" id="LN1920">1920</td><td class="line"> <span class='comment'>*      log(x) is NaN with signal if x &lt; 0 (including -INF) ;</span></td></tr>
<tr class="codeline" data-linenumber="1921"><td class="num" id="LN1921">1921</td><td class="line"> <span class='comment'>*      log(+INF) is +INF; log(0) is -INF with signal;</span></td></tr>
<tr class="codeline" data-linenumber="1922"><td class="num" id="LN1922">1922</td><td class="line"> <span class='comment'>*      log(NaN) is that NaN with no signal.</span></td></tr>
<tr class="codeline" data-linenumber="1923"><td class="num" id="LN1923">1923</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1924"><td class="num" id="LN1924">1924</td><td class="line"> <span class='comment'>* Accuracy:</span></td></tr>
<tr class="codeline" data-linenumber="1925"><td class="num" id="LN1925">1925</td><td class="line"> <span class='comment'>*      according to an error analysis, the error is always less than</span></td></tr>
<tr class="codeline" data-linenumber="1926"><td class="num" id="LN1926">1926</td><td class="line"> <span class='comment'>*      1 ulp (unit in the last place).</span></td></tr>
<tr class="codeline" data-linenumber="1927"><td class="num" id="LN1927">1927</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1928"><td class="num" id="LN1928">1928</td><td class="line"> <span class='comment'>* Constants:</span></td></tr>
<tr class="codeline" data-linenumber="1929"><td class="num" id="LN1929">1929</td><td class="line"> <span class='comment'>* The hexadecimal values are the intended ones for the following</span></td></tr>
<tr class="codeline" data-linenumber="1930"><td class="num" id="LN1930">1930</td><td class="line"> <span class='comment'>* constants. The decimal values may be used, provided that the</span></td></tr>
<tr class="codeline" data-linenumber="1931"><td class="num" id="LN1931">1931</td><td class="line"> <span class='comment'>* compiler will convert from decimal to binary accurately enough</span></td></tr>
<tr class="codeline" data-linenumber="1932"><td class="num" id="LN1932">1932</td><td class="line"> <span class='comment'>* to produce the hexadecimal values shown.</span></td></tr>
<tr class="codeline" data-linenumber="1933"><td class="num" id="LN1933">1933</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1934"><td class="num" id="LN1934">1934</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1935"><td class="num" id="LN1935">1935</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> Lg1 = 6.666666666666735130e-01, <span class='comment'>/* 3FE55555 55555593 */</span></td></tr>
<tr class="codeline" data-linenumber="1936"><td class="num" id="LN1936">1936</td><td class="line">    Lg2 = 3.999999999940941908e-01,                 <span class='comment'>/* 3FD99999 9997FA04 */</span></td></tr>
<tr class="codeline" data-linenumber="1937"><td class="num" id="LN1937">1937</td><td class="line">    Lg3 = 2.857142874366239149e-01,                 <span class='comment'>/* 3FD24924 94229359 */</span></td></tr>
<tr class="codeline" data-linenumber="1938"><td class="num" id="LN1938">1938</td><td class="line">    Lg4 = 2.222219843214978396e-01,                 <span class='comment'>/* 3FCC71C5 1D8E78AF */</span></td></tr>
<tr class="codeline" data-linenumber="1939"><td class="num" id="LN1939">1939</td><td class="line">    Lg5 = 1.818357216161805012e-01,                 <span class='comment'>/* 3FC74664 96CB03DE */</span></td></tr>
<tr class="codeline" data-linenumber="1940"><td class="num" id="LN1940">1940</td><td class="line">    Lg6 = 1.531383769920937332e-01,                 <span class='comment'>/* 3FC39A09 D078C69F */</span></td></tr>
<tr class="codeline" data-linenumber="1941"><td class="num" id="LN1941">1941</td><td class="line">    Lg7 = 1.479819860511658591e-01;                 <span class='comment'>/* 3FC2F112 DF3E5244 */</span></td></tr>
<tr class="codeline" data-linenumber="1942"><td class="num" id="LN1942">1942</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1943"><td class="num" id="LN1943">1943</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1944"><td class="num" id="LN1944">1944</td><td class="line"> <span class='comment'>* We always inline k_log1p(), since doing so produces a</span></td></tr>
<tr class="codeline" data-linenumber="1945"><td class="num" id="LN1945">1945</td><td class="line"> <span class='comment'>* substantial performance improvement (~40% on amd64).</span></td></tr>
<tr class="codeline" data-linenumber="1946"><td class="num" id="LN1946">1946</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1947"><td class="num" id="LN1947">1947</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>inline</span> <span class='keyword'>double</span> k_log1p(<span class='keyword'>double</span> f) {</td></tr>
<tr class="codeline" data-linenumber="1948"><td class="num" id="LN1948">1948</td><td class="line">  <span class='keyword'>double</span> hfsq, s, z, R, w, t1, t2;</td></tr>
<tr class="codeline" data-linenumber="1949"><td class="num" id="LN1949">1949</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1950"><td class="num" id="LN1950">1950</td><td class="line">  s = f / (2.0 + f);</td></tr>
<tr class="codeline" data-linenumber="1951"><td class="num" id="LN1951">1951</td><td class="line">  z = s * s;</td></tr>
<tr class="codeline" data-linenumber="1952"><td class="num" id="LN1952">1952</td><td class="line">  w = z * z;</td></tr>
<tr class="codeline" data-linenumber="1953"><td class="num" id="LN1953">1953</td><td class="line">  t1 = w * (Lg2 + w * (Lg4 + w * Lg6));</td></tr>
<tr class="codeline" data-linenumber="1954"><td class="num" id="LN1954">1954</td><td class="line">  t2 = z * (Lg1 + w * (Lg3 + w * (Lg5 + w * Lg7)));</td></tr>
<tr class="codeline" data-linenumber="1955"><td class="num" id="LN1955">1955</td><td class="line">  R = t2 + t1;</td></tr>
<tr class="codeline" data-linenumber="1956"><td class="num" id="LN1956">1956</td><td class="line">  hfsq = 0.5 * f * f;</td></tr>
<tr class="codeline" data-linenumber="1957"><td class="num" id="LN1957">1957</td><td class="line">  <span class='keyword'>return</span> s * (hfsq + R);</td></tr>
<tr class="codeline" data-linenumber="1958"><td class="num" id="LN1958">1958</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="1959"><td class="num" id="LN1959">1959</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1960"><td class="num" id="LN1960">1960</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="1961"><td class="num" id="LN1961">1961</td><td class="line"> <span class='comment'>* Return the base 2 logarithm of x.  See e_log.c and k_log.h for most</span></td></tr>
<tr class="codeline" data-linenumber="1962"><td class="num" id="LN1962">1962</td><td class="line"> <span class='comment'>* comments.</span></td></tr>
<tr class="codeline" data-linenumber="1963"><td class="num" id="LN1963">1963</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="1964"><td class="num" id="LN1964">1964</td><td class="line"> <span class='comment'>* This reduces x to {k, 1+f} exactly as in e_log.c, then calls the kernel,</span></td></tr>
<tr class="codeline" data-linenumber="1965"><td class="num" id="LN1965">1965</td><td class="line"> <span class='comment'>* then does the combining and scaling steps</span></td></tr>
<tr class="codeline" data-linenumber="1966"><td class="num" id="LN1966">1966</td><td class="line"> <span class='comment'>*    log2(x) = (f - 0.5*f*f + k_log1p(f)) / ln2 + k</span></td></tr>
<tr class="codeline" data-linenumber="1967"><td class="num" id="LN1967">1967</td><td class="line"> <span class='comment'>* in not-quite-routine extra precision.</span></td></tr>
<tr class="codeline" data-linenumber="1968"><td class="num" id="LN1968">1968</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="1969"><td class="num" id="LN1969">1969</td><td class="line"><span class='keyword'>double</span> log2(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="1970"><td class="num" id="LN1970">1970</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="1971"><td class="num" id="LN1971">1971</td><td class="line">      two54 = 1.80143985094819840000e+16,   <span class='comment'>/* 0x43500000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="1972"><td class="num" id="LN1972">1972</td><td class="line">      ivln2hi = 1.44269504072144627571e+00, <span class='comment'>/* 0x3FF71547, 0x65200000 */</span></td></tr>
<tr class="codeline" data-linenumber="1973"><td class="num" id="LN1973">1973</td><td class="line">      ivln2lo = 1.67517131648865118353e-10; <span class='comment'>/* 0x3DE705FC, 0x2EEFA200 */</span></td></tr>
<tr class="codeline" data-linenumber="1974"><td class="num" id="LN1974">1974</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1975"><td class="num" id="LN1975">1975</td><td class="line">  <span class='keyword'>double</span> f, hfsq, hi, lo, r, val_hi, val_lo, w, y;</td></tr>
<tr class="codeline" data-linenumber="1976"><td class="num" id="LN1976">1976</td><td class="line">  int32_t i, k, hx;</td></tr>
<tr class="codeline" data-linenumber="1977"><td class="num" id="LN1977">1977</td><td class="line">  uint32_t lx;</td></tr>
<tr class="codeline" data-linenumber="1978"><td class="num" id="LN1978">1978</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1979"><td class="num" id="LN1979">1979</td><td class="line">  EXTRACT_WORDS(hx, lx, x);</td></tr>
<tr class="codeline" data-linenumber="1980"><td class="num" id="LN1980">1980</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="1981"><td class="num" id="LN1981">1981</td><td class="line">  k = 0;</td></tr>
<tr class="codeline" data-linenumber="1982"><td class="num" id="LN1982">1982</td><td class="line">  <span class='keyword'>if</span> (hx &lt; 0x00100000) { <span class='comment'>/* x &lt; 2**-1022  */</span></td></tr>
<tr class="codeline" data-linenumber="1983"><td class="num" id="LN1983">1983</td><td class="line">    <span class='keyword'>if</span> (((hx &amp; 0x7FFFFFFF) | lx) == 0) {</td></tr>
<tr class="codeline" data-linenumber="1984"><td class="num" id="LN1984">1984</td><td class="line">      <span class='keyword'>return</span> -std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::infinity(); <span class='comment'>/* log(+-0)=-inf */</span></td></tr>
<tr class="codeline" data-linenumber="1985"><td class="num" id="LN1985">1985</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1986"><td class="num" id="LN1986">1986</td><td class="line">    <span class='keyword'>if</span> (hx &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="1987"><td class="num" id="LN1987">1987</td><td class="line">      <span class='keyword'>return</span> std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::signaling_NaN(); <span class='comment'>/* log(-#) = NaN */</span></td></tr>
<tr class="codeline" data-linenumber="1988"><td class="num" id="LN1988">1988</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="1989"><td class="num" id="LN1989">1989</td><td class="line">    k -= 54;</td></tr>
<tr class="codeline" data-linenumber="1990"><td class="num" id="LN1990">1990</td><td class="line">    x *= two54; <span class='comment'>/* subnormal number, scale up x */</span></td></tr>
<tr class="codeline" data-linenumber="1991"><td class="num" id="LN1991">1991</td><td class="line">    GET_HIGH_WORD(hx, x);</td></tr>
<tr class="codeline" data-linenumber="1992"><td class="num" id="LN1992">1992</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="1993"><td class="num" id="LN1993">1993</td><td class="line">  <span class='keyword'>if</span> (hx &gt;= 0x7FF00000) <span class='keyword'>return</span> x + x;</td></tr>
<tr class="codeline" data-linenumber="1994"><td class="num" id="LN1994">1994</td><td class="line">  <span class='keyword'>if</span> (hx == 0x3FF00000 &amp;&amp; lx == 0) <span class='keyword'>return</span> 0.0; <span class='comment'>/* log(1) = +0 */</span></td></tr>
<tr class="codeline" data-linenumber="1995"><td class="num" id="LN1995">1995</td><td class="line">  k += (hx &gt;&gt; 20) - 1023;</td></tr>
<tr class="codeline" data-linenumber="1996"><td class="num" id="LN1996">1996</td><td class="line">  hx &amp;= 0x000FFFFF;</td></tr>
<tr class="codeline" data-linenumber="1997"><td class="num" id="LN1997">1997</td><td class="line">  i = (hx + 0x95F64) &amp; 0x100000;</td></tr>
<tr class="codeline" data-linenumber="1998"><td class="num" id="LN1998">1998</td><td class="line">  SET_HIGH_WORD(x, hx | (i ^ 0x3FF00000)); <span class='comment'>/* normalize x or x/2 */</span></td></tr>
<tr class="codeline" data-linenumber="1999"><td class="num" id="LN1999">1999</td><td class="line">  k += (i &gt;&gt; 20);</td></tr>
<tr class="codeline" data-linenumber="2000"><td class="num" id="LN2000">2000</td><td class="line">  y = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(k);</td></tr>
<tr class="codeline" data-linenumber="2001"><td class="num" id="LN2001">2001</td><td class="line">  f = x - 1.0;</td></tr>
<tr class="codeline" data-linenumber="2002"><td class="num" id="LN2002">2002</td><td class="line">  hfsq = 0.5 * f * f;</td></tr>
<tr class="codeline" data-linenumber="2003"><td class="num" id="LN2003">2003</td><td class="line">  r = k_log1p(f);</td></tr>
<tr class="codeline" data-linenumber="2004"><td class="num" id="LN2004">2004</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2005"><td class="num" id="LN2005">2005</td><td class="line">  <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="2006"><td class="num" id="LN2006">2006</td><td class="line">   <span class='comment'>* f-hfsq must (for args near 1) be evaluated in extra precision</span></td></tr>
<tr class="codeline" data-linenumber="2007"><td class="num" id="LN2007">2007</td><td class="line">   <span class='comment'>* to avoid a large cancellation when x is near sqrt(2) or 1/sqrt(2).</span></td></tr>
<tr class="codeline" data-linenumber="2008"><td class="num" id="LN2008">2008</td><td class="line">   <span class='comment'>* This is fairly efficient since f-hfsq only depends on f, so can</span></td></tr>
<tr class="codeline" data-linenumber="2009"><td class="num" id="LN2009">2009</td><td class="line">   <span class='comment'>* be evaluated in parallel with R.  Not combining hfsq with R also</span></td></tr>
<tr class="codeline" data-linenumber="2010"><td class="num" id="LN2010">2010</td><td class="line">   <span class='comment'>* keeps R small (though not as small as a true `lo' term would be),</span></td></tr>
<tr class="codeline" data-linenumber="2011"><td class="num" id="LN2011">2011</td><td class="line">   <span class='comment'>* so that extra precision is not needed for terms involving R.</span></td></tr>
<tr class="codeline" data-linenumber="2012"><td class="num" id="LN2012">2012</td><td class="line">   <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2013"><td class="num" id="LN2013">2013</td><td class="line">   <span class='comment'>* Compiler bugs involving extra precision used to break Dekker's</span></td></tr>
<tr class="codeline" data-linenumber="2014"><td class="num" id="LN2014">2014</td><td class="line">   <span class='comment'>* theorem for spitting f-hfsq as hi+lo, unless double_t was used</span></td></tr>
<tr class="codeline" data-linenumber="2015"><td class="num" id="LN2015">2015</td><td class="line">   <span class='comment'>* or the multi-precision calculations were avoided when double_t</span></td></tr>
<tr class="codeline" data-linenumber="2016"><td class="num" id="LN2016">2016</td><td class="line">   <span class='comment'>* has extra precision.  These problems are now automatically</span></td></tr>
<tr class="codeline" data-linenumber="2017"><td class="num" id="LN2017">2017</td><td class="line">   <span class='comment'>* avoided as a side effect of the optimization of combining the</span></td></tr>
<tr class="codeline" data-linenumber="2018"><td class="num" id="LN2018">2018</td><td class="line">   <span class='comment'>* Dekker splitting step with the clear-low-bits step.</span></td></tr>
<tr class="codeline" data-linenumber="2019"><td class="num" id="LN2019">2019</td><td class="line">   <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2020"><td class="num" id="LN2020">2020</td><td class="line">   <span class='comment'>* y must (for args near sqrt(2) and 1/sqrt(2)) be added in extra</span></td></tr>
<tr class="codeline" data-linenumber="2021"><td class="num" id="LN2021">2021</td><td class="line">   <span class='comment'>* precision to avoid a very large cancellation when x is very near</span></td></tr>
<tr class="codeline" data-linenumber="2022"><td class="num" id="LN2022">2022</td><td class="line">   <span class='comment'>* these values.  Unlike the above cancellations, this problem is</span></td></tr>
<tr class="codeline" data-linenumber="2023"><td class="num" id="LN2023">2023</td><td class="line">   <span class='comment'>* specific to base 2.  It is strange that adding +-1 is so much</span></td></tr>
<tr class="codeline" data-linenumber="2024"><td class="num" id="LN2024">2024</td><td class="line">   <span class='comment'>* harder than adding +-ln2 or +-log10_2.</span></td></tr>
<tr class="codeline" data-linenumber="2025"><td class="num" id="LN2025">2025</td><td class="line">   <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2026"><td class="num" id="LN2026">2026</td><td class="line">   <span class='comment'>* This uses Dekker's theorem to normalize y+val_hi, so the</span></td></tr>
<tr class="codeline" data-linenumber="2027"><td class="num" id="LN2027">2027</td><td class="line">   <span class='comment'>* compiler bugs are back in some configurations, sigh.  And I</span></td></tr>
<tr class="codeline" data-linenumber="2028"><td class="num" id="LN2028">2028</td><td class="line">   <span class='comment'>* don't want to used double_t to avoid them, since that gives a</span></td></tr>
<tr class="codeline" data-linenumber="2029"><td class="num" id="LN2029">2029</td><td class="line">   <span class='comment'>* pessimization and the support for avoiding the pessimization</span></td></tr>
<tr class="codeline" data-linenumber="2030"><td class="num" id="LN2030">2030</td><td class="line">   <span class='comment'>* is not yet available.</span></td></tr>
<tr class="codeline" data-linenumber="2031"><td class="num" id="LN2031">2031</td><td class="line">   <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2032"><td class="num" id="LN2032">2032</td><td class="line">   <span class='comment'>* The multi-precision calculations for the multiplications are</span></td></tr>
<tr class="codeline" data-linenumber="2033"><td class="num" id="LN2033">2033</td><td class="line">   <span class='comment'>* routine.</span></td></tr>
<tr class="codeline" data-linenumber="2034"><td class="num" id="LN2034">2034</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2035"><td class="num" id="LN2035">2035</td><td class="line">  hi = f - hfsq;</td></tr>
<tr class="codeline" data-linenumber="2036"><td class="num" id="LN2036">2036</td><td class="line">  SET_LOW_WORD(hi, 0);</td></tr>
<tr class="codeline" data-linenumber="2037"><td class="num" id="LN2037">2037</td><td class="line">  lo = (f - hi) - hfsq + r;</td></tr>
<tr class="codeline" data-linenumber="2038"><td class="num" id="LN2038">2038</td><td class="line">  val_hi = hi * ivln2hi;</td></tr>
<tr class="codeline" data-linenumber="2039"><td class="num" id="LN2039">2039</td><td class="line">  val_lo = (lo + hi) * ivln2lo + lo * ivln2hi;</td></tr>
<tr class="codeline" data-linenumber="2040"><td class="num" id="LN2040">2040</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2041"><td class="num" id="LN2041">2041</td><td class="line">  <span class='comment'>/* spadd(val_hi, val_lo, y), except for not using double_t: */</span></td></tr>
<tr class="codeline" data-linenumber="2042"><td class="num" id="LN2042">2042</td><td class="line">  w = y + val_hi;</td></tr>
<tr class="codeline" data-linenumber="2043"><td class="num" id="LN2043">2043</td><td class="line">  val_lo += (y - w) + val_hi;</td></tr>
<tr class="codeline" data-linenumber="2044"><td class="num" id="LN2044">2044</td><td class="line">  val_hi = w;</td></tr>
<tr class="codeline" data-linenumber="2045"><td class="num" id="LN2045">2045</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2046"><td class="num" id="LN2046">2046</td><td class="line">  <span class='keyword'>return</span> val_lo + val_hi;</td></tr>
<tr class="codeline" data-linenumber="2047"><td class="num" id="LN2047">2047</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="2048"><td class="num" id="LN2048">2048</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2049"><td class="num" id="LN2049">2049</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="2050"><td class="num" id="LN2050">2050</td><td class="line"> <span class='comment'>* Return the base 10 logarithm of x</span></td></tr>
<tr class="codeline" data-linenumber="2051"><td class="num" id="LN2051">2051</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2052"><td class="num" id="LN2052">2052</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="2053"><td class="num" id="LN2053">2053</td><td class="line"> <span class='comment'>*      Let log10_2hi = leading 40 bits of log10(2) and</span></td></tr>
<tr class="codeline" data-linenumber="2054"><td class="num" id="LN2054">2054</td><td class="line"> <span class='comment'>*          log10_2lo = log10(2) - log10_2hi,</span></td></tr>
<tr class="codeline" data-linenumber="2055"><td class="num" id="LN2055">2055</td><td class="line"> <span class='comment'>*          ivln10   = 1/log(10) rounded.</span></td></tr>
<tr class="codeline" data-linenumber="2056"><td class="num" id="LN2056">2056</td><td class="line"> <span class='comment'>*      Then</span></td></tr>
<tr class="codeline" data-linenumber="2057"><td class="num" id="LN2057">2057</td><td class="line"> <span class='comment'>*              n = ilogb(x),</span></td></tr>
<tr class="codeline" data-linenumber="2058"><td class="num" id="LN2058">2058</td><td class="line"> <span class='comment'>*              if(n&lt;0)  n = n+1;</span></td></tr>
<tr class="codeline" data-linenumber="2059"><td class="num" id="LN2059">2059</td><td class="line"> <span class='comment'>*              x = scalbn(x,-n);</span></td></tr>
<tr class="codeline" data-linenumber="2060"><td class="num" id="LN2060">2060</td><td class="line"> <span class='comment'>*              log10(x) := n*log10_2hi + (n*log10_2lo + ivln10*log(x))</span></td></tr>
<tr class="codeline" data-linenumber="2061"><td class="num" id="LN2061">2061</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2062"><td class="num" id="LN2062">2062</td><td class="line"> <span class='comment'>*  Note 1:</span></td></tr>
<tr class="codeline" data-linenumber="2063"><td class="num" id="LN2063">2063</td><td class="line"> <span class='comment'>*     To guarantee log10(10**n)=n, where 10**n is normal, the rounding</span></td></tr>
<tr class="codeline" data-linenumber="2064"><td class="num" id="LN2064">2064</td><td class="line"> <span class='comment'>*     mode must set to Round-to-Nearest.</span></td></tr>
<tr class="codeline" data-linenumber="2065"><td class="num" id="LN2065">2065</td><td class="line"> <span class='comment'>*  Note 2:</span></td></tr>
<tr class="codeline" data-linenumber="2066"><td class="num" id="LN2066">2066</td><td class="line"> <span class='comment'>*      [1/log(10)] rounded to 53 bits has error .198 ulps;</span></td></tr>
<tr class="codeline" data-linenumber="2067"><td class="num" id="LN2067">2067</td><td class="line"> <span class='comment'>*      log10 is monotonic at all binary break points.</span></td></tr>
<tr class="codeline" data-linenumber="2068"><td class="num" id="LN2068">2068</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2069"><td class="num" id="LN2069">2069</td><td class="line"> <span class='comment'>*  Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="2070"><td class="num" id="LN2070">2070</td><td class="line"> <span class='comment'>*      log10(x) is NaN if x &lt; 0;</span></td></tr>
<tr class="codeline" data-linenumber="2071"><td class="num" id="LN2071">2071</td><td class="line"> <span class='comment'>*      log10(+INF) is +INF; log10(0) is -INF;</span></td></tr>
<tr class="codeline" data-linenumber="2072"><td class="num" id="LN2072">2072</td><td class="line"> <span class='comment'>*      log10(NaN) is that NaN;</span></td></tr>
<tr class="codeline" data-linenumber="2073"><td class="num" id="LN2073">2073</td><td class="line"> <span class='comment'>*      log10(10**N) = N  for N=0,1,...,22.</span></td></tr>
<tr class="codeline" data-linenumber="2074"><td class="num" id="LN2074">2074</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2075"><td class="num" id="LN2075">2075</td><td class="line"><span class='keyword'>double</span> log10(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="2076"><td class="num" id="LN2076">2076</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="2077"><td class="num" id="LN2077">2077</td><td class="line">      two54 = 1.80143985094819840000e+16, <span class='comment'>/* 0x43500000, 0x00000000 */</span></td></tr>
<tr class="codeline" data-linenumber="2078"><td class="num" id="LN2078">2078</td><td class="line">      ivln10 = 4.34294481903251816668e-01,</td></tr>
<tr class="codeline" data-linenumber="2079"><td class="num" id="LN2079">2079</td><td class="line">      log10_2hi = 3.01029995663611771306e-01, <span class='comment'>/* 0x3FD34413, 0x509F6000 */</span></td></tr>
<tr class="codeline" data-linenumber="2080"><td class="num" id="LN2080">2080</td><td class="line">      log10_2lo = 3.69423907715893078616e-13; <span class='comment'>/* 0x3D59FEF3, 0x11F12B36 */</span></td></tr>
<tr class="codeline" data-linenumber="2081"><td class="num" id="LN2081">2081</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2082"><td class="num" id="LN2082">2082</td><td class="line">  <span class='keyword'>double</span> y;</td></tr>
<tr class="codeline" data-linenumber="2083"><td class="num" id="LN2083">2083</td><td class="line">  int32_t i, k, hx;</td></tr>
<tr class="codeline" data-linenumber="2084"><td class="num" id="LN2084">2084</td><td class="line">  uint32_t lx;</td></tr>
<tr class="codeline" data-linenumber="2085"><td class="num" id="LN2085">2085</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2086"><td class="num" id="LN2086">2086</td><td class="line">  EXTRACT_WORDS(hx, lx, x);</td></tr>
<tr class="codeline" data-linenumber="2087"><td class="num" id="LN2087">2087</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2088"><td class="num" id="LN2088">2088</td><td class="line">  k = 0;</td></tr>
<tr class="codeline" data-linenumber="2089"><td class="num" id="LN2089">2089</td><td class="line">  <span class='keyword'>if</span> (hx &lt; 0x00100000) { <span class='comment'>/* x &lt; 2**-1022  */</span></td></tr>
<tr class="codeline" data-linenumber="2090"><td class="num" id="LN2090">2090</td><td class="line">    <span class='keyword'>if</span> (((hx &amp; 0x7FFFFFFF) | lx) == 0) {</td></tr>
<tr class="codeline" data-linenumber="2091"><td class="num" id="LN2091">2091</td><td class="line">      <span class='keyword'>return</span> -std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::infinity(); <span class='comment'>/* log(+-0)=-inf */</span></td></tr>
<tr class="codeline" data-linenumber="2092"><td class="num" id="LN2092">2092</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2093"><td class="num" id="LN2093">2093</td><td class="line">    <span class='keyword'>if</span> (hx &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="2094"><td class="num" id="LN2094">2094</td><td class="line">      <span class='keyword'>return</span> std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::quiet_NaN(); <span class='comment'>/* log(-#) = NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2095"><td class="num" id="LN2095">2095</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2096"><td class="num" id="LN2096">2096</td><td class="line">    k -= 54;</td></tr>
<tr class="codeline" data-linenumber="2097"><td class="num" id="LN2097">2097</td><td class="line">    x *= two54; <span class='comment'>/* subnormal number, scale up x */</span></td></tr>
<tr class="codeline" data-linenumber="2098"><td class="num" id="LN2098">2098</td><td class="line">    GET_HIGH_WORD(hx, x);</td></tr>
<tr class="codeline" data-linenumber="2099"><td class="num" id="LN2099">2099</td><td class="line">    GET_LOW_WORD(lx, x);</td></tr>
<tr class="codeline" data-linenumber="2100"><td class="num" id="LN2100">2100</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2101"><td class="num" id="LN2101">2101</td><td class="line">  <span class='keyword'>if</span> (hx &gt;= 0x7FF00000) <span class='keyword'>return</span> x + x;</td></tr>
<tr class="codeline" data-linenumber="2102"><td class="num" id="LN2102">2102</td><td class="line">  <span class='keyword'>if</span> (hx == 0x3FF00000 &amp;&amp; lx == 0) <span class='keyword'>return</span> 0.0; <span class='comment'>/* log(1) = +0 */</span></td></tr>
<tr class="codeline" data-linenumber="2103"><td class="num" id="LN2103">2103</td><td class="line">  k += (hx &gt;&gt; 20) - 1023;</td></tr>
<tr class="codeline" data-linenumber="2104"><td class="num" id="LN2104">2104</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2105"><td class="num" id="LN2105">2105</td><td class="line">  i = (k &amp; 0x80000000) &gt;&gt; 31;</td></tr>
<tr class="codeline" data-linenumber="2106"><td class="num" id="LN2106">2106</td><td class="line">  hx = (hx &amp; 0x000FFFFF) | ((0x3FF - i) &lt;&lt; 20);</td></tr>
<tr class="codeline" data-linenumber="2107"><td class="num" id="LN2107">2107</td><td class="line">  y = k + i;</td></tr>
<tr class="codeline" data-linenumber="2108"><td class="num" id="LN2108">2108</td><td class="line">  SET_HIGH_WORD(x, hx);</td></tr>
<tr class="codeline" data-linenumber="2109"><td class="num" id="LN2109">2109</td><td class="line">  SET_LOW_WORD(x, lx);</td></tr>
<tr class="codeline" data-linenumber="2110"><td class="num" id="LN2110">2110</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2111"><td class="num" id="LN2111">2111</td><td class="line">  <span class='keyword'>double</span> z = y * log10_2lo + ivln10 * log(x);</td></tr>
<tr class="codeline" data-linenumber="2112"><td class="num" id="LN2112">2112</td><td class="line">  <span class='keyword'>return</span> z + y * log10_2hi;</td></tr>
<tr class="codeline" data-linenumber="2113"><td class="num" id="LN2113">2113</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="2114"><td class="num" id="LN2114">2114</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2115"><td class="num" id="LN2115">2115</td><td class="line"><span class='comment'>/* expm1(x)</span></td></tr>
<tr class="codeline" data-linenumber="2116"><td class="num" id="LN2116">2116</td><td class="line"> <span class='comment'>* Returns exp(x)-1, the exponential of x minus 1.</span></td></tr>
<tr class="codeline" data-linenumber="2117"><td class="num" id="LN2117">2117</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2118"><td class="num" id="LN2118">2118</td><td class="line"> <span class='comment'>* Method</span></td></tr>
<tr class="codeline" data-linenumber="2119"><td class="num" id="LN2119">2119</td><td class="line"> <span class='comment'>*   1. Argument reduction:</span></td></tr>
<tr class="codeline" data-linenumber="2120"><td class="num" id="LN2120">2120</td><td class="line"> <span class='comment'>*  Given x, find r and integer k such that</span></td></tr>
<tr class="codeline" data-linenumber="2121"><td class="num" id="LN2121">2121</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2122"><td class="num" id="LN2122">2122</td><td class="line"> <span class='comment'>*               x = k*ln2 + r,  |r| &lt;= 0.5*ln2 ~ 0.34658</span></td></tr>
<tr class="codeline" data-linenumber="2123"><td class="num" id="LN2123">2123</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2124"><td class="num" id="LN2124">2124</td><td class="line"> <span class='comment'>*      Here a correction term c will be computed to compensate</span></td></tr>
<tr class="codeline" data-linenumber="2125"><td class="num" id="LN2125">2125</td><td class="line"> <span class='comment'>*  the error in r when rounded to a floating-point number.</span></td></tr>
<tr class="codeline" data-linenumber="2126"><td class="num" id="LN2126">2126</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2127"><td class="num" id="LN2127">2127</td><td class="line"> <span class='comment'>*   2. Approximating expm1(r) by a special rational function on</span></td></tr>
<tr class="codeline" data-linenumber="2128"><td class="num" id="LN2128">2128</td><td class="line"> <span class='comment'>*  the interval [0,0.34658]:</span></td></tr>
<tr class="codeline" data-linenumber="2129"><td class="num" id="LN2129">2129</td><td class="line"> <span class='comment'>*  Since</span></td></tr>
<tr class="codeline" data-linenumber="2130"><td class="num" id="LN2130">2130</td><td class="line"> <span class='comment'>*      r*(exp(r)+1)/(exp(r)-1) = 2+ r^2/6 - r^4/360 + ...</span></td></tr>
<tr class="codeline" data-linenumber="2131"><td class="num" id="LN2131">2131</td><td class="line"> <span class='comment'>*  we define R1(r*r) by</span></td></tr>
<tr class="codeline" data-linenumber="2132"><td class="num" id="LN2132">2132</td><td class="line"> <span class='comment'>*      r*(exp(r)+1)/(exp(r)-1) = 2+ r^2/6 * R1(r*r)</span></td></tr>
<tr class="codeline" data-linenumber="2133"><td class="num" id="LN2133">2133</td><td class="line"> <span class='comment'>*  That is,</span></td></tr>
<tr class="codeline" data-linenumber="2134"><td class="num" id="LN2134">2134</td><td class="line"> <span class='comment'>*      R1(r**2) = 6/r *((exp(r)+1)/(exp(r)-1) - 2/r)</span></td></tr>
<tr class="codeline" data-linenumber="2135"><td class="num" id="LN2135">2135</td><td class="line"> <span class='comment'>*         = 6/r * ( 1 + 2.0*(1/(exp(r)-1) - 1/r))</span></td></tr>
<tr class="codeline" data-linenumber="2136"><td class="num" id="LN2136">2136</td><td class="line"> <span class='comment'>*         = 1 - r^2/60 + r^4/2520 - r^6/100800 + ...</span></td></tr>
<tr class="codeline" data-linenumber="2137"><td class="num" id="LN2137">2137</td><td class="line"> <span class='comment'>*      We use a special Reme algorithm on [0,0.347] to generate</span></td></tr>
<tr class="codeline" data-linenumber="2138"><td class="num" id="LN2138">2138</td><td class="line"> <span class='comment'>*   a polynomial of degree 5 in r*r to approximate R1. The</span></td></tr>
<tr class="codeline" data-linenumber="2139"><td class="num" id="LN2139">2139</td><td class="line"> <span class='comment'>*  maximum error of this polynomial approximation is bounded</span></td></tr>
<tr class="codeline" data-linenumber="2140"><td class="num" id="LN2140">2140</td><td class="line"> <span class='comment'>*  by 2**-61. In other words,</span></td></tr>
<tr class="codeline" data-linenumber="2141"><td class="num" id="LN2141">2141</td><td class="line"> <span class='comment'>*      R1(z) ~ 1.0 + Q1*z + Q2*z**2 + Q3*z**3 + Q4*z**4 + Q5*z**5</span></td></tr>
<tr class="codeline" data-linenumber="2142"><td class="num" id="LN2142">2142</td><td class="line"> <span class='comment'>*  where   Q1  =  -1.6666666666666567384E-2,</span></td></tr>
<tr class="codeline" data-linenumber="2143"><td class="num" id="LN2143">2143</td><td class="line"> <span class='comment'>*     Q2  =   3.9682539681370365873E-4,</span></td></tr>
<tr class="codeline" data-linenumber="2144"><td class="num" id="LN2144">2144</td><td class="line"> <span class='comment'>*     Q3  =  -9.9206344733435987357E-6,</span></td></tr>
<tr class="codeline" data-linenumber="2145"><td class="num" id="LN2145">2145</td><td class="line"> <span class='comment'>*     Q4  =   2.5051361420808517002E-7,</span></td></tr>
<tr class="codeline" data-linenumber="2146"><td class="num" id="LN2146">2146</td><td class="line"> <span class='comment'>*     Q5  =  -6.2843505682382617102E-9;</span></td></tr>
<tr class="codeline" data-linenumber="2147"><td class="num" id="LN2147">2147</td><td class="line"> <span class='comment'>*    z   =  r*r,</span></td></tr>
<tr class="codeline" data-linenumber="2148"><td class="num" id="LN2148">2148</td><td class="line"> <span class='comment'>*  with error bounded by</span></td></tr>
<tr class="codeline" data-linenumber="2149"><td class="num" id="LN2149">2149</td><td class="line"> <span class='comment'>*      |                  5           |     -61</span></td></tr>
<tr class="codeline" data-linenumber="2150"><td class="num" id="LN2150">2150</td><td class="line"> <span class='comment'>*      | 1.0+Q1*z+...+Q5*z   -  R1(z) | &lt;= 2</span></td></tr>
<tr class="codeline" data-linenumber="2151"><td class="num" id="LN2151">2151</td><td class="line"> <span class='comment'>*      |                              |</span></td></tr>
<tr class="codeline" data-linenumber="2152"><td class="num" id="LN2152">2152</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2153"><td class="num" id="LN2153">2153</td><td class="line"> <span class='comment'>*  expm1(r) = exp(r)-1 is then computed by the following</span></td></tr>
<tr class="codeline" data-linenumber="2154"><td class="num" id="LN2154">2154</td><td class="line"> <span class='comment'>*   specific way which minimize the accumulation rounding error:</span></td></tr>
<tr class="codeline" data-linenumber="2155"><td class="num" id="LN2155">2155</td><td class="line"> <span class='comment'>*             2     3</span></td></tr>
<tr class="codeline" data-linenumber="2156"><td class="num" id="LN2156">2156</td><td class="line"> <span class='comment'>*            r     r    [ 3 - (R1 + R1*r/2)  ]</span></td></tr>
<tr class="codeline" data-linenumber="2157"><td class="num" id="LN2157">2157</td><td class="line"> <span class='comment'>*        expm1(r) = r + --- + --- * [--------------------]</span></td></tr>
<tr class="codeline" data-linenumber="2158"><td class="num" id="LN2158">2158</td><td class="line"> <span class='comment'>*                  2     2    [ 6 - r*(3 - R1*r/2) ]</span></td></tr>
<tr class="codeline" data-linenumber="2159"><td class="num" id="LN2159">2159</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2160"><td class="num" id="LN2160">2160</td><td class="line"> <span class='comment'>*  To compensate the error in the argument reduction, we use</span></td></tr>
<tr class="codeline" data-linenumber="2161"><td class="num" id="LN2161">2161</td><td class="line"> <span class='comment'>*    expm1(r+c) = expm1(r) + c + expm1(r)*c</span></td></tr>
<tr class="codeline" data-linenumber="2162"><td class="num" id="LN2162">2162</td><td class="line"> <span class='comment'>*         ~ expm1(r) + c + r*c</span></td></tr>
<tr class="codeline" data-linenumber="2163"><td class="num" id="LN2163">2163</td><td class="line"> <span class='comment'>*  Thus c+r*c will be added in as the correction terms for</span></td></tr>
<tr class="codeline" data-linenumber="2164"><td class="num" id="LN2164">2164</td><td class="line"> <span class='comment'>*  expm1(r+c). Now rearrange the term to avoid optimization</span></td></tr>
<tr class="codeline" data-linenumber="2165"><td class="num" id="LN2165">2165</td><td class="line"> <span class='comment'>*   screw up:</span></td></tr>
<tr class="codeline" data-linenumber="2166"><td class="num" id="LN2166">2166</td><td class="line"> <span class='comment'>*            (      2                                    2 )</span></td></tr>
<tr class="codeline" data-linenumber="2167"><td class="num" id="LN2167">2167</td><td class="line"> <span class='comment'>*            ({  ( r    [ R1 -  (3 - R1*r/2) ]  )  }    r  )</span></td></tr>
<tr class="codeline" data-linenumber="2168"><td class="num" id="LN2168">2168</td><td class="line"> <span class='comment'>*   expm1(r+c)~r - ({r*(--- * [--------------------]-c)-c} - --- )</span></td></tr>
<tr class="codeline" data-linenumber="2169"><td class="num" id="LN2169">2169</td><td class="line"> <span class='comment'>*                  ({  ( 2    [ 6 - r*(3 - R1*r/2) ]  )  }    2  )</span></td></tr>
<tr class="codeline" data-linenumber="2170"><td class="num" id="LN2170">2170</td><td class="line"> <span class='comment'>*                      (                                             )</span></td></tr>
<tr class="codeline" data-linenumber="2171"><td class="num" id="LN2171">2171</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2172"><td class="num" id="LN2172">2172</td><td class="line"> <span class='comment'>*       = r - E</span></td></tr>
<tr class="codeline" data-linenumber="2173"><td class="num" id="LN2173">2173</td><td class="line"> <span class='comment'>*   3. Scale back to obtain expm1(x):</span></td></tr>
<tr class="codeline" data-linenumber="2174"><td class="num" id="LN2174">2174</td><td class="line"> <span class='comment'>*  From step 1, we have</span></td></tr>
<tr class="codeline" data-linenumber="2175"><td class="num" id="LN2175">2175</td><td class="line"> <span class='comment'>*     expm1(x) = either 2^k*[expm1(r)+1] - 1</span></td></tr>
<tr class="codeline" data-linenumber="2176"><td class="num" id="LN2176">2176</td><td class="line"> <span class='comment'>*        = or     2^k*[expm1(r) + (1-2^-k)]</span></td></tr>
<tr class="codeline" data-linenumber="2177"><td class="num" id="LN2177">2177</td><td class="line"> <span class='comment'>*   4. Implementation notes:</span></td></tr>
<tr class="codeline" data-linenumber="2178"><td class="num" id="LN2178">2178</td><td class="line"> <span class='comment'>*  (A). To save one multiplication, we scale the coefficient Qi</span></td></tr>
<tr class="codeline" data-linenumber="2179"><td class="num" id="LN2179">2179</td><td class="line"> <span class='comment'>*       to Qi*2^i, and replace z by (x^2)/2.</span></td></tr>
<tr class="codeline" data-linenumber="2180"><td class="num" id="LN2180">2180</td><td class="line"> <span class='comment'>*  (B). To achieve maximum accuracy, we compute expm1(x) by</span></td></tr>
<tr class="codeline" data-linenumber="2181"><td class="num" id="LN2181">2181</td><td class="line"> <span class='comment'>*    (i)   if x &lt; -56*ln2, return -1.0, (raise inexact if x!=inf)</span></td></tr>
<tr class="codeline" data-linenumber="2182"><td class="num" id="LN2182">2182</td><td class="line"> <span class='comment'>*    (ii)  if k=0, return r-E</span></td></tr>
<tr class="codeline" data-linenumber="2183"><td class="num" id="LN2183">2183</td><td class="line"> <span class='comment'>*    (iii) if k=-1, return 0.5*(r-E)-0.5</span></td></tr>
<tr class="codeline" data-linenumber="2184"><td class="num" id="LN2184">2184</td><td class="line"> <span class='comment'>*        (iv)  if k=1 if r &lt; -0.25, return 2*((r+0.5)- E)</span></td></tr>
<tr class="codeline" data-linenumber="2185"><td class="num" id="LN2185">2185</td><td class="line"> <span class='comment'>*                  else       return  1.0+2.0*(r-E);</span></td></tr>
<tr class="codeline" data-linenumber="2186"><td class="num" id="LN2186">2186</td><td class="line"> <span class='comment'>*    (v)   if (k&lt;-2||k&gt;56) return 2^k(1-(E-r)) - 1 (or exp(x)-1)</span></td></tr>
<tr class="codeline" data-linenumber="2187"><td class="num" id="LN2187">2187</td><td class="line"> <span class='comment'>*    (vi)  if k &lt;= 20, return 2^k((1-2^-k)-(E-r)), else</span></td></tr>
<tr class="codeline" data-linenumber="2188"><td class="num" id="LN2188">2188</td><td class="line"> <span class='comment'>*    (vii) return 2^k(1-((E+2^-k)-r))</span></td></tr>
<tr class="codeline" data-linenumber="2189"><td class="num" id="LN2189">2189</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2190"><td class="num" id="LN2190">2190</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="2191"><td class="num" id="LN2191">2191</td><td class="line"> <span class='comment'>*  expm1(INF) is INF, expm1(NaN) is NaN;</span></td></tr>
<tr class="codeline" data-linenumber="2192"><td class="num" id="LN2192">2192</td><td class="line"> <span class='comment'>*  expm1(-INF) is -1, and</span></td></tr>
<tr class="codeline" data-linenumber="2193"><td class="num" id="LN2193">2193</td><td class="line"> <span class='comment'>*  for finite argument, only expm1(0)=0 is exact.</span></td></tr>
<tr class="codeline" data-linenumber="2194"><td class="num" id="LN2194">2194</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2195"><td class="num" id="LN2195">2195</td><td class="line"> <span class='comment'>* Accuracy:</span></td></tr>
<tr class="codeline" data-linenumber="2196"><td class="num" id="LN2196">2196</td><td class="line"> <span class='comment'>*  according to an error analysis, the error is always less than</span></td></tr>
<tr class="codeline" data-linenumber="2197"><td class="num" id="LN2197">2197</td><td class="line"> <span class='comment'>*  1 ulp (unit in the last place).</span></td></tr>
<tr class="codeline" data-linenumber="2198"><td class="num" id="LN2198">2198</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2199"><td class="num" id="LN2199">2199</td><td class="line"> <span class='comment'>* Misc. info.</span></td></tr>
<tr class="codeline" data-linenumber="2200"><td class="num" id="LN2200">2200</td><td class="line"> <span class='comment'>*  For IEEE double</span></td></tr>
<tr class="codeline" data-linenumber="2201"><td class="num" id="LN2201">2201</td><td class="line"> <span class='comment'>*      if x &gt;  7.09782712893383973096e+02 then expm1(x) overflow</span></td></tr>
<tr class="codeline" data-linenumber="2202"><td class="num" id="LN2202">2202</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2203"><td class="num" id="LN2203">2203</td><td class="line"> <span class='comment'>* Constants:</span></td></tr>
<tr class="codeline" data-linenumber="2204"><td class="num" id="LN2204">2204</td><td class="line"> <span class='comment'>* The hexadecimal values are the intended ones for the following</span></td></tr>
<tr class="codeline" data-linenumber="2205"><td class="num" id="LN2205">2205</td><td class="line"> <span class='comment'>* constants. The decimal values may be used, provided that the</span></td></tr>
<tr class="codeline" data-linenumber="2206"><td class="num" id="LN2206">2206</td><td class="line"> <span class='comment'>* compiler will convert from decimal to binary accurately enough</span></td></tr>
<tr class="codeline" data-linenumber="2207"><td class="num" id="LN2207">2207</td><td class="line"> <span class='comment'>* to produce the hexadecimal values shown.</span></td></tr>
<tr class="codeline" data-linenumber="2208"><td class="num" id="LN2208">2208</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2209"><td class="num" id="LN2209">2209</td><td class="line"><span class='keyword'>double</span> expm1(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="2210"><td class="num" id="LN2210">2210</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="2211"><td class="num" id="LN2211">2211</td><td class="line">      one = 1.0,</td></tr>
<tr class="codeline" data-linenumber="2212"><td class="num" id="LN2212">2212</td><td class="line">      tiny = 1.0e-300,</td></tr>
<tr class="codeline" data-linenumber="2213"><td class="num" id="LN2213">2213</td><td class="line">      o_threshold = 7.09782712893383973096e+02, <span class='comment'>/* 0x40862E42, 0xFEFA39EF */</span></td></tr>
<tr class="codeline" data-linenumber="2214"><td class="num" id="LN2214">2214</td><td class="line">      ln2_hi = 6.93147180369123816490e-01,      <span class='comment'>/* 0x3FE62E42, 0xFEE00000 */</span></td></tr>
<tr class="codeline" data-linenumber="2215"><td class="num" id="LN2215">2215</td><td class="line">      ln2_lo = 1.90821492927058770002e-10,      <span class='comment'>/* 0x3DEA39EF, 0x35793C76 */</span></td></tr>
<tr class="codeline" data-linenumber="2216"><td class="num" id="LN2216">2216</td><td class="line">      invln2 = 1.44269504088896338700e+00,      <span class='comment'>/* 0x3FF71547, 0x652B82FE */</span></td></tr>
<tr class="codeline" data-linenumber="2217"><td class="num" id="LN2217">2217</td><td class="line">      <span class='comment'>/* Scaled Q's: Qn_here = 2**n * Qn_above, for R(2*z) where z = hxs =</span></td></tr>
<tr class="codeline" data-linenumber="2218"><td class="num" id="LN2218">2218</td><td class="line">         <span class='comment'>x*x/2: */</span></td></tr>
<tr class="codeline" data-linenumber="2219"><td class="num" id="LN2219">2219</td><td class="line">      Q1 = -3.33333333333331316428e-02, <span class='comment'>/* BFA11111 111110F4 */</span></td></tr>
<tr class="codeline" data-linenumber="2220"><td class="num" id="LN2220">2220</td><td class="line">      Q2 = 1.58730158725481460165e-03,  <span class='comment'>/* 3F5A01A0 19FE5585 */</span></td></tr>
<tr class="codeline" data-linenumber="2221"><td class="num" id="LN2221">2221</td><td class="line">      Q3 = -7.93650757867487942473e-05, <span class='comment'>/* BF14CE19 9EAADBB7 */</span></td></tr>
<tr class="codeline" data-linenumber="2222"><td class="num" id="LN2222">2222</td><td class="line">      Q4 = 4.00821782732936239552e-06,  <span class='comment'>/* 3ED0CFCA 86E65239 */</span></td></tr>
<tr class="codeline" data-linenumber="2223"><td class="num" id="LN2223">2223</td><td class="line">      Q5 = -2.01099218183624371326e-07; <span class='comment'>/* BE8AFDB7 6E09C32D */</span></td></tr>
<tr class="codeline" data-linenumber="2224"><td class="num" id="LN2224">2224</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2225"><td class="num" id="LN2225">2225</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>volatile</span> <span class='keyword'>double</span> huge = 1.0e+300;</td></tr>
<tr class="codeline" data-linenumber="2226"><td class="num" id="LN2226">2226</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2227"><td class="num" id="LN2227">2227</td><td class="line">  <span class='keyword'>double</span> y, hi, lo, c, t, e, hxs, hfx, r1, twopk;</td></tr>
<tr class="codeline" data-linenumber="2228"><td class="num" id="LN2228">2228</td><td class="line">  int32_t k, xsb;</td></tr>
<tr class="codeline" data-linenumber="2229"><td class="num" id="LN2229">2229</td><td class="line">  uint32_t hx;</td></tr>
<tr class="codeline" data-linenumber="2230"><td class="num" id="LN2230">2230</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2231"><td class="num" id="LN2231">2231</td><td class="line">  GET_HIGH_WORD(hx, x);</td></tr>
<tr class="codeline" data-linenumber="2232"><td class="num" id="LN2232">2232</td><td class="line">  xsb = hx &amp; 0x80000000; <span class='comment'>/* sign bit of x */</span></td></tr>
<tr class="codeline" data-linenumber="2233"><td class="num" id="LN2233">2233</td><td class="line">  hx &amp;= 0x7FFFFFFF;      <span class='comment'>/* high word of |x| */</span></td></tr>
<tr class="codeline" data-linenumber="2234"><td class="num" id="LN2234">2234</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2235"><td class="num" id="LN2235">2235</td><td class="line">  <span class='comment'>/* filter out huge and non-finite argument */</span></td></tr>
<tr class="codeline" data-linenumber="2236"><td class="num" id="LN2236">2236</td><td class="line">  <span class='keyword'>if</span> (hx &gt;= 0x4043687A) {   <span class='comment'>/* if |x|&gt;=56*ln2 */</span></td></tr>
<tr class="codeline" data-linenumber="2237"><td class="num" id="LN2237">2237</td><td class="line">    <span class='keyword'>if</span> (hx &gt;= 0x40862E42) { <span class='comment'>/* if |x|&gt;=709.78... */</span></td></tr>
<tr class="codeline" data-linenumber="2238"><td class="num" id="LN2238">2238</td><td class="line">      <span class='keyword'>if</span> (hx &gt;= 0x7FF00000) {</td></tr>
<tr class="codeline" data-linenumber="2239"><td class="num" id="LN2239">2239</td><td class="line">        uint32_t low;</td></tr>
<tr class="codeline" data-linenumber="2240"><td class="num" id="LN2240">2240</td><td class="line">        GET_LOW_WORD(low, x);</td></tr>
<tr class="codeline" data-linenumber="2241"><td class="num" id="LN2241">2241</td><td class="line">        <span class='keyword'>if</span> (((hx &amp; 0xFFFFF) | low) != 0)</td></tr>
<tr class="codeline" data-linenumber="2242"><td class="num" id="LN2242">2242</td><td class="line">          <span class='keyword'>return</span> x + x; <span class='comment'>/* NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2243"><td class="num" id="LN2243">2243</td><td class="line">        <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="2244"><td class="num" id="LN2244">2244</td><td class="line">          <span class='keyword'>return</span> (xsb == 0) ? x : -1.0; <span class='comment'>/* exp(+-inf)={inf,-1} */</span></td></tr>
<tr class="codeline" data-linenumber="2245"><td class="num" id="LN2245">2245</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="2246"><td class="num" id="LN2246">2246</td><td class="line">      <span class='keyword'>if</span> (x &gt; o_threshold) <span class='keyword'>return</span> huge * huge; <span class='comment'>/* overflow */</span></td></tr>
<tr class="codeline" data-linenumber="2247"><td class="num" id="LN2247">2247</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2248"><td class="num" id="LN2248">2248</td><td class="line">    <span class='keyword'>if</span> (xsb != 0) {        <span class='comment'>/* x &lt; -56*ln2, return -1.0 with inexact */</span></td></tr>
<tr class="codeline" data-linenumber="2249"><td class="num" id="LN2249">2249</td><td class="line">      <span class='keyword'>if</span> (x + tiny &lt; 0.0)  <span class='comment'>/* raise inexact */</span></td></tr>
<tr class="codeline" data-linenumber="2250"><td class="num" id="LN2250">2250</td><td class="line">        <span class='keyword'>return</span> tiny - one; <span class='comment'>/* return -1 */</span></td></tr>
<tr class="codeline" data-linenumber="2251"><td class="num" id="LN2251">2251</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2252"><td class="num" id="LN2252">2252</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2253"><td class="num" id="LN2253">2253</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2254"><td class="num" id="LN2254">2254</td><td class="line">  <span class='comment'>/* argument reduction */</span></td></tr>
<tr class="codeline" data-linenumber="2255"><td class="num" id="LN2255">2255</td><td class="line">  <span class='keyword'>if</span> (hx &gt; 0x3FD62E42) {   <span class='comment'>/* if  |x| &gt; 0.5 ln2 */</span></td></tr>
<tr class="codeline" data-linenumber="2256"><td class="num" id="LN2256">2256</td><td class="line">    <span class='keyword'>if</span> (hx &lt; 0x3FF0A2B2) { <span class='comment'>/* and |x| &lt; 1.5 ln2 */</span></td></tr>
<tr class="codeline" data-linenumber="2257"><td class="num" id="LN2257">2257</td><td class="line">      <span class='keyword'>if</span> (xsb == 0) {</td></tr>
<tr class="codeline" data-linenumber="2258"><td class="num" id="LN2258">2258</td><td class="line">        hi = x - ln2_hi;</td></tr>
<tr class="codeline" data-linenumber="2259"><td class="num" id="LN2259">2259</td><td class="line">        lo = ln2_lo;</td></tr>
<tr class="codeline" data-linenumber="2260"><td class="num" id="LN2260">2260</td><td class="line">        k = 1;</td></tr>
<tr class="codeline" data-linenumber="2261"><td class="num" id="LN2261">2261</td><td class="line">      } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2262"><td class="num" id="LN2262">2262</td><td class="line">        hi = x + ln2_hi;</td></tr>
<tr class="codeline" data-linenumber="2263"><td class="num" id="LN2263">2263</td><td class="line">        lo = -ln2_lo;</td></tr>
<tr class="codeline" data-linenumber="2264"><td class="num" id="LN2264">2264</td><td class="line">        k = -1;</td></tr>
<tr class="codeline" data-linenumber="2265"><td class="num" id="LN2265">2265</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="2266"><td class="num" id="LN2266">2266</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2267"><td class="num" id="LN2267">2267</td><td class="line">      k = invln2 * x + ((xsb == 0) ? 0.5 : -0.5);</td></tr>
<tr class="codeline" data-linenumber="2268"><td class="num" id="LN2268">2268</td><td class="line">      t = k;</td></tr>
<tr class="codeline" data-linenumber="2269"><td class="num" id="LN2269">2269</td><td class="line">      hi = x - t * ln2_hi; <span class='comment'>/* t*ln2_hi is exact here */</span></td></tr>
<tr class="codeline" data-linenumber="2270"><td class="num" id="LN2270">2270</td><td class="line">      lo = t * ln2_lo;</td></tr>
<tr class="codeline" data-linenumber="2271"><td class="num" id="LN2271">2271</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2272"><td class="num" id="LN2272">2272</td><td class="line">    x = hi - lo;</td></tr>
<tr class="codeline" data-linenumber="2273"><td class="num" id="LN2273">2273</td><td class="line">    c = (hi - x) - lo;</td></tr>
<tr class="codeline" data-linenumber="2274"><td class="num" id="LN2274">2274</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (hx &lt; 0x3C900000) { <span class='comment'>/* when |x|&lt;2**-54, return x */</span></td></tr>
<tr class="codeline" data-linenumber="2275"><td class="num" id="LN2275">2275</td><td class="line">    t = huge + x;               <span class='comment'>/* return x with inexact flags when x!=0 */</span></td></tr>
<tr class="codeline" data-linenumber="2276"><td class="num" id="LN2276">2276</td><td class="line">    <span class='keyword'>return</span> x - (t - (huge + x));</td></tr>
<tr class="codeline" data-linenumber="2277"><td class="num" id="LN2277">2277</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2278"><td class="num" id="LN2278">2278</td><td class="line">    k = 0;</td></tr>
<tr class="codeline" data-linenumber="2279"><td class="num" id="LN2279">2279</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2280"><td class="num" id="LN2280">2280</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2281"><td class="num" id="LN2281">2281</td><td class="line">  <span class='comment'>/* x is now in primary range */</span></td></tr>
<tr class="codeline" data-linenumber="2282"><td class="num" id="LN2282">2282</td><td class="line">  hfx = 0.5 * x;</td></tr>
<tr class="codeline" data-linenumber="2283"><td class="num" id="LN2283">2283</td><td class="line">  hxs = x * hfx;</td></tr>
<tr class="codeline" data-linenumber="2284"><td class="num" id="LN2284">2284</td><td class="line">  r1 = one + hxs * (Q1 + hxs * (Q2 + hxs * (Q3 + hxs * (Q4 + hxs * Q5))));</td></tr>
<tr class="codeline" data-linenumber="2285"><td class="num" id="LN2285">2285</td><td class="line">  t = 3.0 - r1 * hfx;</td></tr>
<tr class="codeline" data-linenumber="2286"><td class="num" id="LN2286">2286</td><td class="line">  e = hxs * ((r1 - t) / (6.0 - x * t));</td></tr>
<tr class="codeline" data-linenumber="2287"><td class="num" id="LN2287">2287</td><td class="line">  <span class='keyword'>if</span> (k == 0) {</td></tr>
<tr class="codeline" data-linenumber="2288"><td class="num" id="LN2288">2288</td><td class="line">    <span class='keyword'>return</span> x - (x * e - hxs); <span class='comment'>/* c is 0 */</span></td></tr>
<tr class="codeline" data-linenumber="2289"><td class="num" id="LN2289">2289</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2290"><td class="num" id="LN2290">2290</td><td class="line">    INSERT_WORDS(</td></tr>
<tr class="codeline" data-linenumber="2291"><td class="num" id="LN2291">2291</td><td class="line">        twopk,</td></tr>
<tr class="codeline" data-linenumber="2292"><td class="num" id="LN2292">2292</td><td class="line">        0x3FF00000 + <span class='keyword'>static_cast</span>&lt;int32_t&gt;(<span class='keyword'>static_cast</span>&lt;uint32_t&gt;(k) &lt;&lt; 20),</td></tr>
<tr class="codeline" data-linenumber="2293"><td class="num" id="LN2293">2293</td><td class="line">        0); <span class='comment'>/* 2^k */</span></td></tr>
<tr class="codeline" data-linenumber="2294"><td class="num" id="LN2294">2294</td><td class="line">    e = (x * (e - c) - c);</td></tr>
<tr class="codeline" data-linenumber="2295"><td class="num" id="LN2295">2295</td><td class="line">    e -= hxs;</td></tr>
<tr class="codeline" data-linenumber="2296"><td class="num" id="LN2296">2296</td><td class="line">    <span class='keyword'>if</span> (k == -1) <span class='keyword'>return</span> 0.5 * (x - e) - 0.5;</td></tr>
<tr class="codeline" data-linenumber="2297"><td class="num" id="LN2297">2297</td><td class="line">    <span class='keyword'>if</span> (k == 1) {</td></tr>
<tr class="codeline" data-linenumber="2298"><td class="num" id="LN2298">2298</td><td class="line">      <span class='keyword'>if</span> (x &lt; -0.25)</td></tr>
<tr class="codeline" data-linenumber="2299"><td class="num" id="LN2299">2299</td><td class="line">        <span class='keyword'>return</span> -2.0 * (e - (x + 0.5));</td></tr>
<tr class="codeline" data-linenumber="2300"><td class="num" id="LN2300">2300</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="2301"><td class="num" id="LN2301">2301</td><td class="line">        <span class='keyword'>return</span> one + 2.0 * (x - e);</td></tr>
<tr class="codeline" data-linenumber="2302"><td class="num" id="LN2302">2302</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2303"><td class="num" id="LN2303">2303</td><td class="line">    <span class='keyword'>if</span> (k &lt;= -2 || k &gt; 56) { <span class='comment'>/* suffice to return exp(x)-1 */</span></td></tr>
<tr class="codeline" data-linenumber="2304"><td class="num" id="LN2304">2304</td><td class="line">      y = one - (e - x);</td></tr>
<tr class="codeline" data-linenumber="2305"><td class="num" id="LN2305">2305</td><td class="line">      <span class='comment'>// TODO(mvstanton): is this replacement for the hex float</span></td></tr>
<tr class="codeline" data-linenumber="2306"><td class="num" id="LN2306">2306</td><td class="line">      <span class='comment'>// sufficient?</span></td></tr>
<tr class="codeline" data-linenumber="2307"><td class="num" id="LN2307">2307</td><td class="line">      <span class='comment'>// if (k == 1024) y = y*2.0*0x1p1023;</span></td></tr>
<tr class="codeline" data-linenumber="2308"><td class="num" id="LN2308">2308</td><td class="line">      <span class='keyword'>if</span> (k == 1024)</td></tr>
<tr class="codeline" data-linenumber="2309"><td class="num" id="LN2309">2309</td><td class="line">        y = y * 2.0 * 8.98846567431158e+307;</td></tr>
<tr class="codeline" data-linenumber="2310"><td class="num" id="LN2310">2310</td><td class="line">      <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="2311"><td class="num" id="LN2311">2311</td><td class="line">        y = y * twopk;</td></tr>
<tr class="codeline" data-linenumber="2312"><td class="num" id="LN2312">2312</td><td class="line">      <span class='keyword'>return</span> y - one;</td></tr>
<tr class="codeline" data-linenumber="2313"><td class="num" id="LN2313">2313</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2314"><td class="num" id="LN2314">2314</td><td class="line">    t = one;</td></tr>
<tr class="codeline" data-linenumber="2315"><td class="num" id="LN2315">2315</td><td class="line">    <span class='keyword'>if</span> (k &lt; 20) {</td></tr>
<tr class="codeline" data-linenumber="2316"><td class="num" id="LN2316">2316</td><td class="line">      SET_HIGH_WORD(t, 0x3FF00000 - (0x200000 &gt;&gt; k)); <span class='comment'>/* t=1-2^-k */</span></td></tr>
<tr class="codeline" data-linenumber="2317"><td class="num" id="LN2317">2317</td><td class="line">      y = t - (e - x);</td></tr>
<tr class="codeline" data-linenumber="2318"><td class="num" id="LN2318">2318</td><td class="line">      y = y * twopk;</td></tr>
<tr class="codeline" data-linenumber="2319"><td class="num" id="LN2319">2319</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2320"><td class="num" id="LN2320">2320</td><td class="line">      SET_HIGH_WORD(t, ((0x3FF - k) &lt;&lt; 20)); <span class='comment'>/* 2^-k */</span></td></tr>
<tr class="codeline" data-linenumber="2321"><td class="num" id="LN2321">2321</td><td class="line">      y = x - (e + t);</td></tr>
<tr class="codeline" data-linenumber="2322"><td class="num" id="LN2322">2322</td><td class="line">      y += one;</td></tr>
<tr class="codeline" data-linenumber="2323"><td class="num" id="LN2323">2323</td><td class="line">      y = y * twopk;</td></tr>
<tr class="codeline" data-linenumber="2324"><td class="num" id="LN2324">2324</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2325"><td class="num" id="LN2325">2325</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2326"><td class="num" id="LN2326">2326</td><td class="line">  <span class='keyword'>return</span> y;</td></tr>
<tr class="codeline" data-linenumber="2327"><td class="num" id="LN2327">2327</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="2328"><td class="num" id="LN2328">2328</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2329"><td class="num" id="LN2329">2329</td><td class="line"><span class='keyword'>double</span> cbrt(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="2330"><td class="num" id="LN2330">2330</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> uint32_t</td></tr>
<tr class="codeline" data-linenumber="2331"><td class="num" id="LN2331">2331</td><td class="line">      B1 = 715094163, <span class='comment'>/* B1 = (1023-1023/3-0.03306235651)*2**20 */</span></td></tr>
<tr class="codeline" data-linenumber="2332"><td class="num" id="LN2332">2332</td><td class="line">      B2 = 696219795; <span class='comment'>/* B2 = (1023-1023/3-54/3-0.03306235651)*2**20 */</span></td></tr>
<tr class="codeline" data-linenumber="2333"><td class="num" id="LN2333">2333</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2334"><td class="num" id="LN2334">2334</td><td class="line">  <span class='comment'>/* |1/cbrt(x) - p(x)| &lt; 2**-23.5 (~[-7.93e-8, 7.929e-8]). */</span></td></tr>
<tr class="codeline" data-linenumber="2335"><td class="num" id="LN2335">2335</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> P0 = 1.87595182427177009643, <span class='comment'>/* 0x3FFE03E6, 0x0F61E692 */</span></td></tr>
<tr class="codeline" data-linenumber="2336"><td class="num" id="LN2336">2336</td><td class="line">      P1 = -1.88497979543377169875,                <span class='comment'>/* 0xBFFE28E0, 0x92F02420 */</span></td></tr>
<tr class="codeline" data-linenumber="2337"><td class="num" id="LN2337">2337</td><td class="line">      P2 = 1.621429720105354466140,                <span class='comment'>/* 0x3FF9F160, 0x4A49D6C2 */</span></td></tr>
<tr class="codeline" data-linenumber="2338"><td class="num" id="LN2338">2338</td><td class="line">      P3 = -0.758397934778766047437,               <span class='comment'>/* 0xBFE844CB, 0xBEE751D9 */</span></td></tr>
<tr class="codeline" data-linenumber="2339"><td class="num" id="LN2339">2339</td><td class="line">      P4 = 0.145996192886612446982;                <span class='comment'>/* 0x3FC2B000, 0xD4E4EDD7 */</span></td></tr>
<tr class="codeline" data-linenumber="2340"><td class="num" id="LN2340">2340</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2341"><td class="num" id="LN2341">2341</td><td class="line">  int32_t hx;</td></tr>
<tr class="codeline" data-linenumber="2342"><td class="num" id="LN2342">2342</td><td class="line">  <span class='keyword'>double</span> r, s, t = 0.0, w;</td></tr>
<tr class="codeline" data-linenumber="2343"><td class="num" id="LN2343">2343</td><td class="line">  uint32_t sign;</td></tr>
<tr class="codeline" data-linenumber="2344"><td class="num" id="LN2344">2344</td><td class="line">  uint32_t high, low;</td></tr>
<tr class="codeline" data-linenumber="2345"><td class="num" id="LN2345">2345</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2346"><td class="num" id="LN2346">2346</td><td class="line">  EXTRACT_WORDS(hx, low, x);</td></tr>
<tr class="codeline" data-linenumber="2347"><td class="num" id="LN2347">2347</td><td class="line">  sign = hx &amp; 0x80000000; <span class='comment'>/* sign= sign(x) */</span></td></tr>
<tr class="codeline" data-linenumber="2348"><td class="num" id="LN2348">2348</td><td class="line">  hx ^= sign;</td></tr>
<tr class="codeline" data-linenumber="2349"><td class="num" id="LN2349">2349</td><td class="line">  <span class='keyword'>if</span> (hx &gt;= 0x7FF00000) <span class='keyword'>return</span> (x + x); <span class='comment'>/* cbrt(NaN,INF) is itself */</span></td></tr>
<tr class="codeline" data-linenumber="2350"><td class="num" id="LN2350">2350</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2351"><td class="num" id="LN2351">2351</td><td class="line">  <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="2352"><td class="num" id="LN2352">2352</td><td class="line">   <span class='comment'>* Rough cbrt to 5 bits:</span></td></tr>
<tr class="codeline" data-linenumber="2353"><td class="num" id="LN2353">2353</td><td class="line">   <span class='comment'>*    cbrt(2**e*(1+m) ~= 2**(e/3)*(1+(e%3+m)/3)</span></td></tr>
<tr class="codeline" data-linenumber="2354"><td class="num" id="LN2354">2354</td><td class="line">   <span class='comment'>* where e is integral and &gt;= 0, m is real and in [0, 1), and "/" and</span></td></tr>
<tr class="codeline" data-linenumber="2355"><td class="num" id="LN2355">2355</td><td class="line">   <span class='comment'>* "%" are integer division and modulus with rounding towards minus</span></td></tr>
<tr class="codeline" data-linenumber="2356"><td class="num" id="LN2356">2356</td><td class="line">   <span class='comment'>* infinity.  The RHS is always &gt;= the LHS and has a maximum relative</span></td></tr>
<tr class="codeline" data-linenumber="2357"><td class="num" id="LN2357">2357</td><td class="line">   <span class='comment'>* error of about 1 in 16.  Adding a bias of -0.03306235651 to the</span></td></tr>
<tr class="codeline" data-linenumber="2358"><td class="num" id="LN2358">2358</td><td class="line">   <span class='comment'>* (e%3+m)/3 term reduces the error to about 1 in 32. With the IEEE</span></td></tr>
<tr class="codeline" data-linenumber="2359"><td class="num" id="LN2359">2359</td><td class="line">   <span class='comment'>* floating point representation, for finite positive normal values,</span></td></tr>
<tr class="codeline" data-linenumber="2360"><td class="num" id="LN2360">2360</td><td class="line">   <span class='comment'>* ordinary integer division of the value in bits magically gives</span></td></tr>
<tr class="codeline" data-linenumber="2361"><td class="num" id="LN2361">2361</td><td class="line">   <span class='comment'>* almost exactly the RHS of the above provided we first subtract the</span></td></tr>
<tr class="codeline" data-linenumber="2362"><td class="num" id="LN2362">2362</td><td class="line">   <span class='comment'>* exponent bias (1023 for doubles) and later add it back.  We do the</span></td></tr>
<tr class="codeline" data-linenumber="2363"><td class="num" id="LN2363">2363</td><td class="line">   <span class='comment'>* subtraction virtually to keep e &gt;= 0 so that ordinary integer</span></td></tr>
<tr class="codeline" data-linenumber="2364"><td class="num" id="LN2364">2364</td><td class="line">   <span class='comment'>* division rounds towards minus infinity; this is also efficient.</span></td></tr>
<tr class="codeline" data-linenumber="2365"><td class="num" id="LN2365">2365</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2366"><td class="num" id="LN2366">2366</td><td class="line">  <span class='keyword'>if</span> (hx &lt; 0x00100000) {             <span class='comment'>/* zero or subnormal? */</span></td></tr>
<tr class="codeline" data-linenumber="2367"><td class="num" id="LN2367">2367</td><td class="line">    <span class='keyword'>if</span> ((hx | low) == 0) <span class='keyword'>return</span> (x); <span class='comment'>/* cbrt(0) is itself */</span></td></tr>
<tr class="codeline" data-linenumber="2368"><td class="num" id="LN2368">2368</td><td class="line">    SET_HIGH_WORD(t, 0x43500000);    <span class='comment'>/* set t= 2**54 */</span></td></tr>
<tr class="codeline" data-linenumber="2369"><td class="num" id="LN2369">2369</td><td class="line">    t *= x;</td></tr>
<tr class="codeline" data-linenumber="2370"><td class="num" id="LN2370">2370</td><td class="line">    GET_HIGH_WORD(high, t);</td></tr>
<tr class="codeline" data-linenumber="2371"><td class="num" id="LN2371">2371</td><td class="line">    INSERT_WORDS(t, sign | ((high &amp; 0x7FFFFFFF) / 3 + B2), 0);</td></tr>
<tr class="codeline" data-linenumber="2372"><td class="num" id="LN2372">2372</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2373"><td class="num" id="LN2373">2373</td><td class="line">    INSERT_WORDS(t, sign | (hx / 3 + B1), 0);</td></tr>
<tr class="codeline" data-linenumber="2374"><td class="num" id="LN2374">2374</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2375"><td class="num" id="LN2375">2375</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2376"><td class="num" id="LN2376">2376</td><td class="line">  <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="2377"><td class="num" id="LN2377">2377</td><td class="line">   <span class='comment'>* New cbrt to 23 bits:</span></td></tr>
<tr class="codeline" data-linenumber="2378"><td class="num" id="LN2378">2378</td><td class="line">   <span class='comment'>*    cbrt(x) = t*cbrt(x/t**3) ~= t*P(t**3/x)</span></td></tr>
<tr class="codeline" data-linenumber="2379"><td class="num" id="LN2379">2379</td><td class="line">   <span class='comment'>* where P(r) is a polynomial of degree 4 that approximates 1/cbrt(r)</span></td></tr>
<tr class="codeline" data-linenumber="2380"><td class="num" id="LN2380">2380</td><td class="line">   <span class='comment'>* to within 2**-23.5 when |r - 1| &lt; 1/10.  The rough approximation</span></td></tr>
<tr class="codeline" data-linenumber="2381"><td class="num" id="LN2381">2381</td><td class="line">   <span class='comment'>* has produced t such than |t/cbrt(x) - 1| ~&lt; 1/32, and cubing this</span></td></tr>
<tr class="codeline" data-linenumber="2382"><td class="num" id="LN2382">2382</td><td class="line">   <span class='comment'>* gives us bounds for r = t**3/x.</span></td></tr>
<tr class="codeline" data-linenumber="2383"><td class="num" id="LN2383">2383</td><td class="line">   <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2384"><td class="num" id="LN2384">2384</td><td class="line">   <span class='comment'>* Try to optimize for parallel evaluation as in k_tanf.c.</span></td></tr>
<tr class="codeline" data-linenumber="2385"><td class="num" id="LN2385">2385</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2386"><td class="num" id="LN2386">2386</td><td class="line">  r = (t * t) * (t / x);</td></tr>
<tr class="codeline" data-linenumber="2387"><td class="num" id="LN2387">2387</td><td class="line">  t = t * ((P0 + r * (P1 + r * P2)) + ((r * r) * r) * (P3 + r * P4));</td></tr>
<tr class="codeline" data-linenumber="2388"><td class="num" id="LN2388">2388</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2389"><td class="num" id="LN2389">2389</td><td class="line">  <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="2390"><td class="num" id="LN2390">2390</td><td class="line">   <span class='comment'>* Round t away from zero to 23 bits (sloppily except for ensuring that</span></td></tr>
<tr class="codeline" data-linenumber="2391"><td class="num" id="LN2391">2391</td><td class="line">   <span class='comment'>* the result is larger in magnitude than cbrt(x) but not much more than</span></td></tr>
<tr class="codeline" data-linenumber="2392"><td class="num" id="LN2392">2392</td><td class="line">   <span class='comment'>* 2 23-bit ulps larger).  With rounding towards zero, the error bound</span></td></tr>
<tr class="codeline" data-linenumber="2393"><td class="num" id="LN2393">2393</td><td class="line">   <span class='comment'>* would be ~5/6 instead of ~4/6.  With a maximum error of 2 23-bit ulps</span></td></tr>
<tr class="codeline" data-linenumber="2394"><td class="num" id="LN2394">2394</td><td class="line">   <span class='comment'>* in the rounded t, the infinite-precision error in the Newton</span></td></tr>
<tr class="codeline" data-linenumber="2395"><td class="num" id="LN2395">2395</td><td class="line">   <span class='comment'>* approximation barely affects third digit in the final error</span></td></tr>
<tr class="codeline" data-linenumber="2396"><td class="num" id="LN2396">2396</td><td class="line">   <span class='comment'>* 0.667; the error in the rounded t can be up to about 3 23-bit ulps</span></td></tr>
<tr class="codeline" data-linenumber="2397"><td class="num" id="LN2397">2397</td><td class="line">   <span class='comment'>* before the final error is larger than 0.667 ulps.</span></td></tr>
<tr class="codeline" data-linenumber="2398"><td class="num" id="LN2398">2398</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2399"><td class="num" id="LN2399">2399</td><td class="line">  uint64_t bits = bit_cast&lt;uint64_t&gt;(t);</td></tr>
<tr class="codeline" data-linenumber="2400"><td class="num" id="LN2400">2400</td><td class="line">  bits = (bits + 0x80000000) &amp; 0xFFFFFFFFC0000000ULL;</td></tr>
<tr class="codeline" data-linenumber="2401"><td class="num" id="LN2401">2401</td><td class="line">  t = bit_cast&lt;<span class='keyword'>double</span>&gt;(bits);</td></tr>
<tr class="codeline" data-linenumber="2402"><td class="num" id="LN2402">2402</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2403"><td class="num" id="LN2403">2403</td><td class="line">  <span class='comment'>/* one step Newton iteration to 53 bits with error &lt; 0.667 ulps */</span></td></tr>
<tr class="codeline" data-linenumber="2404"><td class="num" id="LN2404">2404</td><td class="line">  s = t * t;             <span class='comment'>/* t*t is exact */</span></td></tr>
<tr class="codeline" data-linenumber="2405"><td class="num" id="LN2405">2405</td><td class="line">  r = x / s;             <span class='comment'>/* error &lt;= 0.5 ulps; |r| &lt; |t| */</span></td></tr>
<tr class="codeline" data-linenumber="2406"><td class="num" id="LN2406">2406</td><td class="line">  w = t + t;             <span class='comment'>/* t+t is exact */</span></td></tr>
<tr class="codeline" data-linenumber="2407"><td class="num" id="LN2407">2407</td><td class="line">  r = (r - t) / (w + r); <span class='comment'>/* r-t is exact; w+r ~= 3*t */</span></td></tr>
<tr class="codeline" data-linenumber="2408"><td class="num" id="LN2408">2408</td><td class="line">  t = t + t * r;         <span class='comment'>/* error &lt;= 0.5 + 0.5/3 + epsilon */</span></td></tr>
<tr class="codeline" data-linenumber="2409"><td class="num" id="LN2409">2409</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2410"><td class="num" id="LN2410">2410</td><td class="line">  <span class='keyword'>return</span> (t);</td></tr>
<tr class="codeline" data-linenumber="2411"><td class="num" id="LN2411">2411</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="2412"><td class="num" id="LN2412">2412</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2413"><td class="num" id="LN2413">2413</td><td class="line"><span class='comment'>/* sin(x)</span></td></tr>
<tr class="codeline" data-linenumber="2414"><td class="num" id="LN2414">2414</td><td class="line"> <span class='comment'>* Return sine function of x.</span></td></tr>
<tr class="codeline" data-linenumber="2415"><td class="num" id="LN2415">2415</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2416"><td class="num" id="LN2416">2416</td><td class="line"> <span class='comment'>* kernel function:</span></td></tr>
<tr class="codeline" data-linenumber="2417"><td class="num" id="LN2417">2417</td><td class="line"> <span class='comment'>*      __kernel_sin            ... sine function on [-pi/4,pi/4]</span></td></tr>
<tr class="codeline" data-linenumber="2418"><td class="num" id="LN2418">2418</td><td class="line"> <span class='comment'>*      __kernel_cos            ... cose function on [-pi/4,pi/4]</span></td></tr>
<tr class="codeline" data-linenumber="2419"><td class="num" id="LN2419">2419</td><td class="line"> <span class='comment'>*      __ieee754_rem_pio2      ... argument reduction routine</span></td></tr>
<tr class="codeline" data-linenumber="2420"><td class="num" id="LN2420">2420</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2421"><td class="num" id="LN2421">2421</td><td class="line"> <span class='comment'>* Method.</span></td></tr>
<tr class="codeline" data-linenumber="2422"><td class="num" id="LN2422">2422</td><td class="line"> <span class='comment'>*      Let S,C and T denote the sin, cos and tan respectively on</span></td></tr>
<tr class="codeline" data-linenumber="2423"><td class="num" id="LN2423">2423</td><td class="line"> <span class='comment'>*      [-PI/4, +PI/4]. Reduce the argument x to y1+y2 = x-k*pi/2</span></td></tr>
<tr class="codeline" data-linenumber="2424"><td class="num" id="LN2424">2424</td><td class="line"> <span class='comment'>*      in [-pi/4 , +pi/4], and let n = k mod 4.</span></td></tr>
<tr class="codeline" data-linenumber="2425"><td class="num" id="LN2425">2425</td><td class="line"> <span class='comment'>*      We have</span></td></tr>
<tr class="codeline" data-linenumber="2426"><td class="num" id="LN2426">2426</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2427"><td class="num" id="LN2427">2427</td><td class="line"> <span class='comment'>*          n        sin(x)      cos(x)        tan(x)</span></td></tr>
<tr class="codeline" data-linenumber="2428"><td class="num" id="LN2428">2428</td><td class="line"> <span class='comment'>*     ----------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="2429"><td class="num" id="LN2429">2429</td><td class="line"> <span class='comment'>*          0          S           C             T</span></td></tr>
<tr class="codeline" data-linenumber="2430"><td class="num" id="LN2430">2430</td><td class="line"> <span class='comment'>*          1          C          -S            -1/T</span></td></tr>
<tr class="codeline" data-linenumber="2431"><td class="num" id="LN2431">2431</td><td class="line"> <span class='comment'>*          2         -S          -C             T</span></td></tr>
<tr class="codeline" data-linenumber="2432"><td class="num" id="LN2432">2432</td><td class="line"> <span class='comment'>*          3         -C           S            -1/T</span></td></tr>
<tr class="codeline" data-linenumber="2433"><td class="num" id="LN2433">2433</td><td class="line"> <span class='comment'>*     ----------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="2434"><td class="num" id="LN2434">2434</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2435"><td class="num" id="LN2435">2435</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="2436"><td class="num" id="LN2436">2436</td><td class="line"> <span class='comment'>*      Let trig be any of sin, cos, or tan.</span></td></tr>
<tr class="codeline" data-linenumber="2437"><td class="num" id="LN2437">2437</td><td class="line"> <span class='comment'>*      trig(+-INF)  is NaN, with signals;</span></td></tr>
<tr class="codeline" data-linenumber="2438"><td class="num" id="LN2438">2438</td><td class="line"> <span class='comment'>*      trig(NaN)    is that NaN;</span></td></tr>
<tr class="codeline" data-linenumber="2439"><td class="num" id="LN2439">2439</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2440"><td class="num" id="LN2440">2440</td><td class="line"> <span class='comment'>* Accuracy:</span></td></tr>
<tr class="codeline" data-linenumber="2441"><td class="num" id="LN2441">2441</td><td class="line"> <span class='comment'>*      TRIG(x) returns trig(x) nearly rounded</span></td></tr>
<tr class="codeline" data-linenumber="2442"><td class="num" id="LN2442">2442</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2443"><td class="num" id="LN2443">2443</td><td class="line"><span class='keyword'>double</span> sin(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="2444"><td class="num" id="LN2444">2444</td><td class="line">  <span class='keyword'>double</span> y[2], z = 0.0;</td></tr>
<tr class="codeline" data-linenumber="2445"><td class="num" id="LN2445">2445</td><td class="line">  int32_t n, ix;</td></tr>
<tr class="codeline" data-linenumber="2446"><td class="num" id="LN2446">2446</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2447"><td class="num" id="LN2447">2447</td><td class="line">  <span class='comment'>/* High word of x. */</span></td></tr>
<tr class="codeline" data-linenumber="2448"><td class="num" id="LN2448">2448</td><td class="line">  GET_HIGH_WORD(ix, x);</td></tr>
<tr class="codeline" data-linenumber="2449"><td class="num" id="LN2449">2449</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2450"><td class="num" id="LN2450">2450</td><td class="line">  <span class='comment'>/* |x| ~&lt; pi/4 */</span></td></tr>
<tr class="codeline" data-linenumber="2451"><td class="num" id="LN2451">2451</td><td class="line">  ix &amp;= 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="2452"><td class="num" id="LN2452">2452</td><td class="line">  <span class='keyword'>if</span> (ix &lt;= 0x3FE921FB) {</td></tr>
<tr class="codeline" data-linenumber="2453"><td class="num" id="LN2453">2453</td><td class="line">    <span class='keyword'>return</span> __kernel_sin(x, z, 0);</td></tr>
<tr class="codeline" data-linenumber="2454"><td class="num" id="LN2454">2454</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (ix &gt;= 0x7FF00000) {</td></tr>
<tr class="codeline" data-linenumber="2455"><td class="num" id="LN2455">2455</td><td class="line">    <span class='comment'>/* sin(Inf or NaN) is NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2456"><td class="num" id="LN2456">2456</td><td class="line">    <span class='keyword'>return</span> x - x;</td></tr>
<tr class="codeline" data-linenumber="2457"><td class="num" id="LN2457">2457</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2458"><td class="num" id="LN2458">2458</td><td class="line">    <span class='comment'>/* argument reduction needed */</span></td></tr>
<tr class="codeline" data-linenumber="2459"><td class="num" id="LN2459">2459</td><td class="line">    n = __ieee754_rem_pio2(x, y);</td></tr>
<tr class="codeline" data-linenumber="2460"><td class="num" id="LN2460">2460</td><td class="line">    <span class='keyword'>switch</span> (n &amp; 3) {</td></tr>
<tr class="codeline" data-linenumber="2461"><td class="num" id="LN2461">2461</td><td class="line">      <span class='keyword'>case</span> 0:</td></tr>
<tr class="codeline" data-linenumber="2462"><td class="num" id="LN2462">2462</td><td class="line">        <span class='keyword'>return</span> __kernel_sin(y[0], y[1], 1);</td></tr>
<tr class="codeline" data-linenumber="2463"><td class="num" id="LN2463">2463</td><td class="line">      <span class='keyword'>case</span> 1:</td></tr>
<tr class="codeline" data-linenumber="2464"><td class="num" id="LN2464">2464</td><td class="line">        <span class='keyword'>return</span> __kernel_cos(y[0], y[1]);</td></tr>
<tr class="codeline" data-linenumber="2465"><td class="num" id="LN2465">2465</td><td class="line">      <span class='keyword'>case</span> 2:</td></tr>
<tr class="codeline" data-linenumber="2466"><td class="num" id="LN2466">2466</td><td class="line">        <span class='keyword'>return</span> -__kernel_sin(y[0], y[1], 1);</td></tr>
<tr class="codeline" data-linenumber="2467"><td class="num" id="LN2467">2467</td><td class="line">      <span class='keyword'>default</span>:</td></tr>
<tr class="codeline" data-linenumber="2468"><td class="num" id="LN2468">2468</td><td class="line">        <span class='keyword'>return</span> -__kernel_cos(y[0], y[1]);</td></tr>
<tr class="codeline" data-linenumber="2469"><td class="num" id="LN2469">2469</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2470"><td class="num" id="LN2470">2470</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2471"><td class="num" id="LN2471">2471</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="2472"><td class="num" id="LN2472">2472</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2473"><td class="num" id="LN2473">2473</td><td class="line"><span class='comment'>/* tan(x)</span></td></tr>
<tr class="codeline" data-linenumber="2474"><td class="num" id="LN2474">2474</td><td class="line"> <span class='comment'>* Return tangent function of x.</span></td></tr>
<tr class="codeline" data-linenumber="2475"><td class="num" id="LN2475">2475</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2476"><td class="num" id="LN2476">2476</td><td class="line"> <span class='comment'>* kernel function:</span></td></tr>
<tr class="codeline" data-linenumber="2477"><td class="num" id="LN2477">2477</td><td class="line"> <span class='comment'>*      __kernel_tan            ... tangent function on [-pi/4,pi/4]</span></td></tr>
<tr class="codeline" data-linenumber="2478"><td class="num" id="LN2478">2478</td><td class="line"> <span class='comment'>*      __ieee754_rem_pio2      ... argument reduction routine</span></td></tr>
<tr class="codeline" data-linenumber="2479"><td class="num" id="LN2479">2479</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2480"><td class="num" id="LN2480">2480</td><td class="line"> <span class='comment'>* Method.</span></td></tr>
<tr class="codeline" data-linenumber="2481"><td class="num" id="LN2481">2481</td><td class="line"> <span class='comment'>*      Let S,C and T denote the sin, cos and tan respectively on</span></td></tr>
<tr class="codeline" data-linenumber="2482"><td class="num" id="LN2482">2482</td><td class="line"> <span class='comment'>*      [-PI/4, +PI/4]. Reduce the argument x to y1+y2 = x-k*pi/2</span></td></tr>
<tr class="codeline" data-linenumber="2483"><td class="num" id="LN2483">2483</td><td class="line"> <span class='comment'>*      in [-pi/4 , +pi/4], and let n = k mod 4.</span></td></tr>
<tr class="codeline" data-linenumber="2484"><td class="num" id="LN2484">2484</td><td class="line"> <span class='comment'>*      We have</span></td></tr>
<tr class="codeline" data-linenumber="2485"><td class="num" id="LN2485">2485</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2486"><td class="num" id="LN2486">2486</td><td class="line"> <span class='comment'>*          n        sin(x)      cos(x)        tan(x)</span></td></tr>
<tr class="codeline" data-linenumber="2487"><td class="num" id="LN2487">2487</td><td class="line"> <span class='comment'>*     ----------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="2488"><td class="num" id="LN2488">2488</td><td class="line"> <span class='comment'>*          0          S           C             T</span></td></tr>
<tr class="codeline" data-linenumber="2489"><td class="num" id="LN2489">2489</td><td class="line"> <span class='comment'>*          1          C          -S            -1/T</span></td></tr>
<tr class="codeline" data-linenumber="2490"><td class="num" id="LN2490">2490</td><td class="line"> <span class='comment'>*          2         -S          -C             T</span></td></tr>
<tr class="codeline" data-linenumber="2491"><td class="num" id="LN2491">2491</td><td class="line"> <span class='comment'>*          3         -C           S            -1/T</span></td></tr>
<tr class="codeline" data-linenumber="2492"><td class="num" id="LN2492">2492</td><td class="line"> <span class='comment'>*     ----------------------------------------------------------</span></td></tr>
<tr class="codeline" data-linenumber="2493"><td class="num" id="LN2493">2493</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2494"><td class="num" id="LN2494">2494</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="2495"><td class="num" id="LN2495">2495</td><td class="line"> <span class='comment'>*      Let trig be any of sin, cos, or tan.</span></td></tr>
<tr class="codeline" data-linenumber="2496"><td class="num" id="LN2496">2496</td><td class="line"> <span class='comment'>*      trig(+-INF)  is NaN, with signals;</span></td></tr>
<tr class="codeline" data-linenumber="2497"><td class="num" id="LN2497">2497</td><td class="line"> <span class='comment'>*      trig(NaN)    is that NaN;</span></td></tr>
<tr class="codeline" data-linenumber="2498"><td class="num" id="LN2498">2498</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2499"><td class="num" id="LN2499">2499</td><td class="line"> <span class='comment'>* Accuracy:</span></td></tr>
<tr class="codeline" data-linenumber="2500"><td class="num" id="LN2500">2500</td><td class="line"> <span class='comment'>*      TRIG(x) returns trig(x) nearly rounded</span></td></tr>
<tr class="codeline" data-linenumber="2501"><td class="num" id="LN2501">2501</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2502"><td class="num" id="LN2502">2502</td><td class="line"><span class='keyword'>double</span> tan(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="2503"><td class="num" id="LN2503">2503</td><td class="line">  <span class='keyword'>double</span> y[2], z = 0.0;</td></tr>
<tr class="codeline" data-linenumber="2504"><td class="num" id="LN2504">2504</td><td class="line">  int32_t n, ix;</td></tr>
<tr class="codeline" data-linenumber="2505"><td class="num" id="LN2505">2505</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2506"><td class="num" id="LN2506">2506</td><td class="line">  <span class='comment'>/* High word of x. */</span></td></tr>
<tr class="codeline" data-linenumber="2507"><td class="num" id="LN2507">2507</td><td class="line">  GET_HIGH_WORD(ix, x);</td></tr>
<tr class="codeline" data-linenumber="2508"><td class="num" id="LN2508">2508</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2509"><td class="num" id="LN2509">2509</td><td class="line">  <span class='comment'>/* |x| ~&lt; pi/4 */</span></td></tr>
<tr class="codeline" data-linenumber="2510"><td class="num" id="LN2510">2510</td><td class="line">  ix &amp;= 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="2511"><td class="num" id="LN2511">2511</td><td class="line">  <span class='keyword'>if</span> (ix &lt;= 0x3FE921FB) {</td></tr>
<tr class="codeline" data-linenumber="2512"><td class="num" id="LN2512">2512</td><td class="line">    <span class='keyword'>return</span> __kernel_tan(x, z, 1);</td></tr>
<tr class="codeline" data-linenumber="2513"><td class="num" id="LN2513">2513</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> (ix &gt;= 0x7FF00000) {</td></tr>
<tr class="codeline" data-linenumber="2514"><td class="num" id="LN2514">2514</td><td class="line">    <span class='comment'>/* tan(Inf or NaN) is NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2515"><td class="num" id="LN2515">2515</td><td class="line">    <span class='keyword'>return</span> x - x; <span class='comment'>/* NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2516"><td class="num" id="LN2516">2516</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2517"><td class="num" id="LN2517">2517</td><td class="line">    <span class='comment'>/* argument reduction needed */</span></td></tr>
<tr class="codeline" data-linenumber="2518"><td class="num" id="LN2518">2518</td><td class="line">    n = __ieee754_rem_pio2(x, y);</td></tr>
<tr class="codeline" data-linenumber="2519"><td class="num" id="LN2519">2519</td><td class="line">    <span class='comment'>/* 1 -&gt; n even, -1 -&gt; n odd */</span></td></tr>
<tr class="codeline" data-linenumber="2520"><td class="num" id="LN2520">2520</td><td class="line">    <span class='keyword'>return</span> __kernel_tan(y[0], y[1], 1 - ((n &amp; 1) &lt;&lt; 1));</td></tr>
<tr class="codeline" data-linenumber="2521"><td class="num" id="LN2521">2521</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2522"><td class="num" id="LN2522">2522</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="2523"><td class="num" id="LN2523">2523</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2524"><td class="num" id="LN2524">2524</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="2525"><td class="num" id="LN2525">2525</td><td class="line"> <span class='comment'>* ES6 draft 09-27-13, section 20.2.2.12.</span></td></tr>
<tr class="codeline" data-linenumber="2526"><td class="num" id="LN2526">2526</td><td class="line"> <span class='comment'>* Math.cosh</span></td></tr>
<tr class="codeline" data-linenumber="2527"><td class="num" id="LN2527">2527</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="2528"><td class="num" id="LN2528">2528</td><td class="line"> <span class='comment'>* mathematically cosh(x) if defined to be (exp(x)+exp(-x))/2</span></td></tr>
<tr class="codeline" data-linenumber="2529"><td class="num" id="LN2529">2529</td><td class="line"> <span class='comment'>*      1. Replace x by |x| (cosh(x) = cosh(-x)).</span></td></tr>
<tr class="codeline" data-linenumber="2530"><td class="num" id="LN2530">2530</td><td class="line"> <span class='comment'>*      2.</span></td></tr>
<tr class="codeline" data-linenumber="2531"><td class="num" id="LN2531">2531</td><td class="line"> <span class='comment'>*                                                      [ exp(x) - 1 ]^2</span></td></tr>
<tr class="codeline" data-linenumber="2532"><td class="num" id="LN2532">2532</td><td class="line"> <span class='comment'>*          0        &lt;= x &lt;= ln2/2  :  cosh(x) := 1 + -------------------</span></td></tr>
<tr class="codeline" data-linenumber="2533"><td class="num" id="LN2533">2533</td><td class="line"> <span class='comment'>*                                                         2*exp(x)</span></td></tr>
<tr class="codeline" data-linenumber="2534"><td class="num" id="LN2534">2534</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2535"><td class="num" id="LN2535">2535</td><td class="line"> <span class='comment'>*                                                 exp(x) + 1/exp(x)</span></td></tr>
<tr class="codeline" data-linenumber="2536"><td class="num" id="LN2536">2536</td><td class="line"> <span class='comment'>*          ln2/2    &lt;= x &lt;= 22     :  cosh(x) := -------------------</span></td></tr>
<tr class="codeline" data-linenumber="2537"><td class="num" id="LN2537">2537</td><td class="line"> <span class='comment'>*                                                        2</span></td></tr>
<tr class="codeline" data-linenumber="2538"><td class="num" id="LN2538">2538</td><td class="line"> <span class='comment'>*          22       &lt;= x &lt;= lnovft :  cosh(x) := exp(x)/2</span></td></tr>
<tr class="codeline" data-linenumber="2539"><td class="num" id="LN2539">2539</td><td class="line"> <span class='comment'>*          lnovft   &lt;= x &lt;= ln2ovft:  cosh(x) := exp(x/2)/2 * exp(x/2)</span></td></tr>
<tr class="codeline" data-linenumber="2540"><td class="num" id="LN2540">2540</td><td class="line"> <span class='comment'>*          ln2ovft  &lt;  x           :  cosh(x) := huge*huge (overflow)</span></td></tr>
<tr class="codeline" data-linenumber="2541"><td class="num" id="LN2541">2541</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2542"><td class="num" id="LN2542">2542</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="2543"><td class="num" id="LN2543">2543</td><td class="line"> <span class='comment'>*      cosh(x) is |x| if x is +INF, -INF, or NaN.</span></td></tr>
<tr class="codeline" data-linenumber="2544"><td class="num" id="LN2544">2544</td><td class="line"> <span class='comment'>*      only cosh(0)=1 is exact for finite x.</span></td></tr>
<tr class="codeline" data-linenumber="2545"><td class="num" id="LN2545">2545</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2546"><td class="num" id="LN2546">2546</td><td class="line"><span class='keyword'>double</span> cosh(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="2547"><td class="num" id="LN2547">2547</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> KCOSH_OVERFLOW = 710.4758600739439;</td></tr>
<tr class="codeline" data-linenumber="2548"><td class="num" id="LN2548">2548</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> one = 1.0, half = 0.5;</td></tr>
<tr class="codeline" data-linenumber="2549"><td class="num" id="LN2549">2549</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>volatile</span> <span class='keyword'>double</span> huge = 1.0e+300;</td></tr>
<tr class="codeline" data-linenumber="2550"><td class="num" id="LN2550">2550</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2551"><td class="num" id="LN2551">2551</td><td class="line">  int32_t ix;</td></tr>
<tr class="codeline" data-linenumber="2552"><td class="num" id="LN2552">2552</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2553"><td class="num" id="LN2553">2553</td><td class="line">  <span class='comment'>/* High word of |x|. */</span></td></tr>
<tr class="codeline" data-linenumber="2554"><td class="num" id="LN2554">2554</td><td class="line">  GET_HIGH_WORD(ix, x);</td></tr>
<tr class="codeline" data-linenumber="2555"><td class="num" id="LN2555">2555</td><td class="line">  ix &amp;= 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="2556"><td class="num" id="LN2556">2556</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2557"><td class="num" id="LN2557">2557</td><td class="line">  <span class='comment'>// |x| in [0,0.5*log2], return 1+expm1(|x|)^2/(2*exp(|x|))</span></td></tr>
<tr class="codeline" data-linenumber="2558"><td class="num" id="LN2558">2558</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x3FD62E43) {</td></tr>
<tr class="codeline" data-linenumber="2559"><td class="num" id="LN2559">2559</td><td class="line">    <span class='keyword'>double</span> t = expm1(fabs(x));</td></tr>
<tr class="codeline" data-linenumber="2560"><td class="num" id="LN2560">2560</td><td class="line">    <span class='keyword'>double</span> w = one + t;</td></tr>
<tr class="codeline" data-linenumber="2561"><td class="num" id="LN2561">2561</td><td class="line">    <span class='comment'>// For |x| &lt; 2^-55, cosh(x) = 1</span></td></tr>
<tr class="codeline" data-linenumber="2562"><td class="num" id="LN2562">2562</td><td class="line">    <span class='keyword'>if</span> (ix &lt; 0x3C800000) <span class='keyword'>return</span> w;</td></tr>
<tr class="codeline" data-linenumber="2563"><td class="num" id="LN2563">2563</td><td class="line">    <span class='keyword'>return</span> one + (t * t) / (w + w);</td></tr>
<tr class="codeline" data-linenumber="2564"><td class="num" id="LN2564">2564</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2565"><td class="num" id="LN2565">2565</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2566"><td class="num" id="LN2566">2566</td><td class="line">  <span class='comment'>// |x| in [0.5*log2, 22], return (exp(|x|)+1/exp(|x|)/2</span></td></tr>
<tr class="codeline" data-linenumber="2567"><td class="num" id="LN2567">2567</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x40360000) {</td></tr>
<tr class="codeline" data-linenumber="2568"><td class="num" id="LN2568">2568</td><td class="line">    <span class='keyword'>double</span> t = exp(fabs(x));</td></tr>
<tr class="codeline" data-linenumber="2569"><td class="num" id="LN2569">2569</td><td class="line">    <span class='keyword'>return</span> half * t + half / t;</td></tr>
<tr class="codeline" data-linenumber="2570"><td class="num" id="LN2570">2570</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2571"><td class="num" id="LN2571">2571</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2572"><td class="num" id="LN2572">2572</td><td class="line">  <span class='comment'>// |x| in [22, log(maxdouble)], return half*exp(|x|)</span></td></tr>
<tr class="codeline" data-linenumber="2573"><td class="num" id="LN2573">2573</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x40862E42) <span class='keyword'>return</span> half * exp(fabs(x));</td></tr>
<tr class="codeline" data-linenumber="2574"><td class="num" id="LN2574">2574</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2575"><td class="num" id="LN2575">2575</td><td class="line">  <span class='comment'>// |x| in [log(maxdouble), overflowthreshold]</span></td></tr>
<tr class="codeline" data-linenumber="2576"><td class="num" id="LN2576">2576</td><td class="line">  <span class='keyword'>if</span> (fabs(x) &lt;= KCOSH_OVERFLOW) {</td></tr>
<tr class="codeline" data-linenumber="2577"><td class="num" id="LN2577">2577</td><td class="line">    <span class='keyword'>double</span> w = exp(half * fabs(x));</td></tr>
<tr class="codeline" data-linenumber="2578"><td class="num" id="LN2578">2578</td><td class="line">    <span class='keyword'>double</span> t = half * w;</td></tr>
<tr class="codeline" data-linenumber="2579"><td class="num" id="LN2579">2579</td><td class="line">    <span class='keyword'>return</span> t * w;</td></tr>
<tr class="codeline" data-linenumber="2580"><td class="num" id="LN2580">2580</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2581"><td class="num" id="LN2581">2581</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2582"><td class="num" id="LN2582">2582</td><td class="line">  <span class='comment'>/* x is INF or NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2583"><td class="num" id="LN2583">2583</td><td class="line">  <span class='keyword'>if</span> (ix &gt;= 0x7FF00000) <span class='keyword'>return</span> x * x;</td></tr>
<tr class="codeline" data-linenumber="2584"><td class="num" id="LN2584">2584</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2585"><td class="num" id="LN2585">2585</td><td class="line">  <span class='comment'>// |x| &gt; overflowthreshold.</span></td></tr>
<tr class="codeline" data-linenumber="2586"><td class="num" id="LN2586">2586</td><td class="line">  <span class='keyword'>return</span> huge * huge;</td></tr>
<tr class="codeline" data-linenumber="2587"><td class="num" id="LN2587">2587</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="2588"><td class="num" id="LN2588">2588</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2589"><td class="num" id="LN2589">2589</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="2590"><td class="num" id="LN2590">2590</td><td class="line"> <span class='comment'>* ES2019 Draft 2019-01-02 12.6.4</span></td></tr>
<tr class="codeline" data-linenumber="2591"><td class="num" id="LN2591">2591</td><td class="line"> <span class='comment'>* Math.pow &amp; Exponentiation Operator</span></td></tr>
<tr class="codeline" data-linenumber="2592"><td class="num" id="LN2592">2592</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2593"><td class="num" id="LN2593">2593</td><td class="line"> <span class='comment'>* Return X raised to the Yth power</span></td></tr>
<tr class="codeline" data-linenumber="2594"><td class="num" id="LN2594">2594</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2595"><td class="num" id="LN2595">2595</td><td class="line"> <span class='comment'>* Method:</span></td></tr>
<tr class="codeline" data-linenumber="2596"><td class="num" id="LN2596">2596</td><td class="line"> <span class='comment'>*     Let x =  2   * (1+f)</span></td></tr>
<tr class="codeline" data-linenumber="2597"><td class="num" id="LN2597">2597</td><td class="line"> <span class='comment'>*     1. Compute and return log2(x) in two pieces:</span></td></tr>
<tr class="codeline" data-linenumber="2598"><td class="num" id="LN2598">2598</td><td class="line"> <span class='comment'>*        log2(x) = w1 + w2,</span></td></tr>
<tr class="codeline" data-linenumber="2599"><td class="num" id="LN2599">2599</td><td class="line"> <span class='comment'>*        where w1 has 53-24 = 29 bit trailing zeros.</span></td></tr>
<tr class="codeline" data-linenumber="2600"><td class="num" id="LN2600">2600</td><td class="line"> <span class='comment'>*     2. Perform y*log2(x) = n+y' by simulating muti-precision</span></td></tr>
<tr class="codeline" data-linenumber="2601"><td class="num" id="LN2601">2601</td><td class="line"> <span class='comment'>*        arithmetic, where |y'|&lt;=0.5.</span></td></tr>
<tr class="codeline" data-linenumber="2602"><td class="num" id="LN2602">2602</td><td class="line"> <span class='comment'>*     3. Return x**y = 2**n*exp(y'*log2)</span></td></tr>
<tr class="codeline" data-linenumber="2603"><td class="num" id="LN2603">2603</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2604"><td class="num" id="LN2604">2604</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="2605"><td class="num" id="LN2605">2605</td><td class="line"> <span class='comment'>*     1.  (anything) ** 0  is 1</span></td></tr>
<tr class="codeline" data-linenumber="2606"><td class="num" id="LN2606">2606</td><td class="line"> <span class='comment'>*     2.  (anything) ** 1  is itself</span></td></tr>
<tr class="codeline" data-linenumber="2607"><td class="num" id="LN2607">2607</td><td class="line"> <span class='comment'>*     3.  (anything) ** NAN is NAN</span></td></tr>
<tr class="codeline" data-linenumber="2608"><td class="num" id="LN2608">2608</td><td class="line"> <span class='comment'>*     4.  NAN ** (anything except 0) is NAN</span></td></tr>
<tr class="codeline" data-linenumber="2609"><td class="num" id="LN2609">2609</td><td class="line"> <span class='comment'>*     5.  +-(|x| &gt; 1) **  +INF is +INF</span></td></tr>
<tr class="codeline" data-linenumber="2610"><td class="num" id="LN2610">2610</td><td class="line"> <span class='comment'>*     6.  +-(|x| &gt; 1) **  -INF is +0</span></td></tr>
<tr class="codeline" data-linenumber="2611"><td class="num" id="LN2611">2611</td><td class="line"> <span class='comment'>*     7.  +-(|x| &lt; 1) **  +INF is +0</span></td></tr>
<tr class="codeline" data-linenumber="2612"><td class="num" id="LN2612">2612</td><td class="line"> <span class='comment'>*     8.  +-(|x| &lt; 1) **  -INF is +INF</span></td></tr>
<tr class="codeline" data-linenumber="2613"><td class="num" id="LN2613">2613</td><td class="line"> <span class='comment'>*     9.  +-1         ** +-INF is NAN</span></td></tr>
<tr class="codeline" data-linenumber="2614"><td class="num" id="LN2614">2614</td><td class="line"> <span class='comment'>*     10. +0 ** (+anything except 0, NAN)               is +0</span></td></tr>
<tr class="codeline" data-linenumber="2615"><td class="num" id="LN2615">2615</td><td class="line"> <span class='comment'>*     11. -0 ** (+anything except 0, NAN, odd integer)  is +0</span></td></tr>
<tr class="codeline" data-linenumber="2616"><td class="num" id="LN2616">2616</td><td class="line"> <span class='comment'>*     12. +0 ** (-anything except 0, NAN)               is +INF</span></td></tr>
<tr class="codeline" data-linenumber="2617"><td class="num" id="LN2617">2617</td><td class="line"> <span class='comment'>*     13. -0 ** (-anything except 0, NAN, odd integer)  is +INF</span></td></tr>
<tr class="codeline" data-linenumber="2618"><td class="num" id="LN2618">2618</td><td class="line"> <span class='comment'>*     14. -0 ** (odd integer) = -( +0 ** (odd integer) )</span></td></tr>
<tr class="codeline" data-linenumber="2619"><td class="num" id="LN2619">2619</td><td class="line"> <span class='comment'>*     15. +INF ** (+anything except 0,NAN) is +INF</span></td></tr>
<tr class="codeline" data-linenumber="2620"><td class="num" id="LN2620">2620</td><td class="line"> <span class='comment'>*     16. +INF ** (-anything except 0,NAN) is +0</span></td></tr>
<tr class="codeline" data-linenumber="2621"><td class="num" id="LN2621">2621</td><td class="line"> <span class='comment'>*     17. -INF ** (anything)  = -0 ** (-anything)</span></td></tr>
<tr class="codeline" data-linenumber="2622"><td class="num" id="LN2622">2622</td><td class="line"> <span class='comment'>*     18. (-anything) ** (integer) is (-1)**(integer)*(+anything**integer)</span></td></tr>
<tr class="codeline" data-linenumber="2623"><td class="num" id="LN2623">2623</td><td class="line"> <span class='comment'>*     19. (-anything except 0 and inf) ** (non-integer) is NAN</span></td></tr>
<tr class="codeline" data-linenumber="2624"><td class="num" id="LN2624">2624</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2625"><td class="num" id="LN2625">2625</td><td class="line"> <span class='comment'>* Accuracy:</span></td></tr>
<tr class="codeline" data-linenumber="2626"><td class="num" id="LN2626">2626</td><td class="line"> <span class='comment'>*      pow(x,y) returns x**y nearly rounded. In particular,</span></td></tr>
<tr class="codeline" data-linenumber="2627"><td class="num" id="LN2627">2627</td><td class="line"> <span class='comment'>*      pow(integer, integer) always returns the correct integer provided it is</span></td></tr>
<tr class="codeline" data-linenumber="2628"><td class="num" id="LN2628">2628</td><td class="line"> <span class='comment'>*      representable.</span></td></tr>
<tr class="codeline" data-linenumber="2629"><td class="num" id="LN2629">2629</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2630"><td class="num" id="LN2630">2630</td><td class="line"> <span class='comment'>* Constants:</span></td></tr>
<tr class="codeline" data-linenumber="2631"><td class="num" id="LN2631">2631</td><td class="line"> <span class='comment'>*     The hexadecimal values are the intended ones for the following</span></td></tr>
<tr class="codeline" data-linenumber="2632"><td class="num" id="LN2632">2632</td><td class="line"> <span class='comment'>*     constants. The decimal values may be used, provided that the</span></td></tr>
<tr class="codeline" data-linenumber="2633"><td class="num" id="LN2633">2633</td><td class="line"> <span class='comment'>*     compiler will convert from decimal to binary accurately enough</span></td></tr>
<tr class="codeline" data-linenumber="2634"><td class="num" id="LN2634">2634</td><td class="line"> <span class='comment'>*     to produce the hexadecimal values shown.</span></td></tr>
<tr class="codeline" data-linenumber="2635"><td class="num" id="LN2635">2635</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2636"><td class="num" id="LN2636">2636</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2637"><td class="num" id="LN2637">2637</td><td class="line"><span class='keyword'>double</span> pow(<span class='keyword'>double</span> x, <span class='keyword'>double</span> y) {</td></tr>
<tr class="codeline" data-linenumber="2638"><td class="num" id="LN2638">2638</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span></td></tr>
<tr class="codeline" data-linenumber="2639"><td class="num" id="LN2639">2639</td><td class="line">      bp[] = {1.0, 1.5},</td></tr>
<tr class="codeline" data-linenumber="2640"><td class="num" id="LN2640">2640</td><td class="line">      dp_h[] = {0.0, 5.84962487220764160156e-01},  <span class='comment'>// 0x3FE2B803, 0x40000000</span></td></tr>
<tr class="codeline" data-linenumber="2641"><td class="num" id="LN2641">2641</td><td class="line">      dp_l[] = {0.0, 1.35003920212974897128e-08},  <span class='comment'>// 0x3E4CFDEB, 0x43CFD006</span></td></tr>
<tr class="codeline" data-linenumber="2642"><td class="num" id="LN2642">2642</td><td class="line">      zero = 0.0, one = 1.0, two = 2.0,</td></tr>
<tr class="codeline" data-linenumber="2643"><td class="num" id="LN2643">2643</td><td class="line">      two53 = 9007199254740992.0,  <span class='comment'>// 0x43400000, 0x00000000</span></td></tr>
<tr class="codeline" data-linenumber="2644"><td class="num" id="LN2644">2644</td><td class="line">      huge = 1.0e300, tiny = 1.0e-300,</td></tr>
<tr class="codeline" data-linenumber="2645"><td class="num" id="LN2645">2645</td><td class="line">      <span class='comment'>// poly coefs for (3/2)*(log(x)-2s-2/3*s**3</span></td></tr>
<tr class="codeline" data-linenumber="2646"><td class="num" id="LN2646">2646</td><td class="line">      L1 = 5.99999999999994648725e-01,      <span class='comment'>// 0x3FE33333, 0x33333303</span></td></tr>
<tr class="codeline" data-linenumber="2647"><td class="num" id="LN2647">2647</td><td class="line">      L2 = 4.28571428578550184252e-01,      <span class='comment'>// 0x3FDB6DB6, 0xDB6FABFF</span></td></tr>
<tr class="codeline" data-linenumber="2648"><td class="num" id="LN2648">2648</td><td class="line">      L3 = 3.33333329818377432918e-01,      <span class='comment'>// 0x3FD55555, 0x518F264D</span></td></tr>
<tr class="codeline" data-linenumber="2649"><td class="num" id="LN2649">2649</td><td class="line">      L4 = 2.72728123808534006489e-01,      <span class='comment'>// 0x3FD17460, 0xA91D4101</span></td></tr>
<tr class="codeline" data-linenumber="2650"><td class="num" id="LN2650">2650</td><td class="line">      L5 = 2.30660745775561754067e-01,      <span class='comment'>// 0x3FCD864A, 0x93C9DB65</span></td></tr>
<tr class="codeline" data-linenumber="2651"><td class="num" id="LN2651">2651</td><td class="line">      L6 = 2.06975017800338417784e-01,      <span class='comment'>// 0x3FCA7E28, 0x4A454EEF</span></td></tr>
<tr class="codeline" data-linenumber="2652"><td class="num" id="LN2652">2652</td><td class="line">      P1 = 1.66666666666666019037e-01,      <span class='comment'>// 0x3FC55555, 0x5555553E</span></td></tr>
<tr class="codeline" data-linenumber="2653"><td class="num" id="LN2653">2653</td><td class="line">      P2 = -2.77777777770155933842e-03,     <span class='comment'>// 0xBF66C16C, 0x16BEBD93</span></td></tr>
<tr class="codeline" data-linenumber="2654"><td class="num" id="LN2654">2654</td><td class="line">      P3 = 6.61375632143793436117e-05,      <span class='comment'>// 0x3F11566A, 0xAF25DE2C</span></td></tr>
<tr class="codeline" data-linenumber="2655"><td class="num" id="LN2655">2655</td><td class="line">      P4 = -1.65339022054652515390e-06,     <span class='comment'>// 0xBEBBBD41, 0xC5D26BF1</span></td></tr>
<tr class="codeline" data-linenumber="2656"><td class="num" id="LN2656">2656</td><td class="line">      P5 = 4.13813679705723846039e-08,      <span class='comment'>// 0x3E663769, 0x72BEA4D0</span></td></tr>
<tr class="codeline" data-linenumber="2657"><td class="num" id="LN2657">2657</td><td class="line">      lg2 = 6.93147180559945286227e-01,     <span class='comment'>// 0x3FE62E42, 0xFEFA39EF</span></td></tr>
<tr class="codeline" data-linenumber="2658"><td class="num" id="LN2658">2658</td><td class="line">      lg2_h = 6.93147182464599609375e-01,   <span class='comment'>// 0x3FE62E43, 0x00000000</span></td></tr>
<tr class="codeline" data-linenumber="2659"><td class="num" id="LN2659">2659</td><td class="line">      lg2_l = -1.90465429995776804525e-09,  <span class='comment'>// 0xBE205C61, 0x0CA86C39</span></td></tr>
<tr class="codeline" data-linenumber="2660"><td class="num" id="LN2660">2660</td><td class="line">      ovt = 8.0085662595372944372e-0017,    <span class='comment'>// -(1024-log2(ovfl+.5ulp))</span></td></tr>
<tr class="codeline" data-linenumber="2661"><td class="num" id="LN2661">2661</td><td class="line">      cp = 9.61796693925975554329e-01,      <span class='comment'>// 0x3FEEC709, 0xDC3A03FD =2/(3ln2)</span></td></tr>
<tr class="codeline" data-linenumber="2662"><td class="num" id="LN2662">2662</td><td class="line">      cp_h = 9.61796700954437255859e-01,    <span class='comment'>// 0x3FEEC709, 0xE0000000 =(float)cp</span></td></tr>
<tr class="codeline" data-linenumber="2663"><td class="num" id="LN2663">2663</td><td class="line">      cp_l = -7.02846165095275826516e-09,   <span class='comment'>// 0xBE3E2FE0, 0x145B01F5 =tail cp_h</span></td></tr>
<tr class="codeline" data-linenumber="2664"><td class="num" id="LN2664">2664</td><td class="line">      ivln2 = 1.44269504088896338700e+00,   <span class='comment'>// 0x3FF71547, 0x652B82FE =1/ln2</span></td></tr>
<tr class="codeline" data-linenumber="2665"><td class="num" id="LN2665">2665</td><td class="line">      ivln2_h =</td></tr>
<tr class="codeline" data-linenumber="2666"><td class="num" id="LN2666">2666</td><td class="line">          1.44269502162933349609e+00,  <span class='comment'>// 0x3FF71547, 0x60000000 =24b 1/ln2</span></td></tr>
<tr class="codeline" data-linenumber="2667"><td class="num" id="LN2667">2667</td><td class="line">      ivln2_l =</td></tr>
<tr class="codeline" data-linenumber="2668"><td class="num" id="LN2668">2668</td><td class="line">          1.92596299112661746887e-08;  <span class='comment'>// 0x3E54AE0B, 0xF85DDF44 =1/ln2 tail</span></td></tr>
<tr class="codeline" data-linenumber="2669"><td class="num" id="LN2669">2669</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2670"><td class="num" id="LN2670">2670</td><td class="line">  <span class='keyword'>double</span> z, ax, z_h, z_l, p_h, p_l;</td></tr>
<tr class="codeline" data-linenumber="2671"><td class="num" id="LN2671">2671</td><td class="line">  <span class='keyword'>double</span> y1, t1, t2, r, s, t, u, v, w;</td></tr>
<tr class="codeline" data-linenumber="2672"><td class="num" id="LN2672">2672</td><td class="line">  <span class='keyword'>int</span> i, j, k, yisint, n;</td></tr>
<tr class="codeline" data-linenumber="2673"><td class="num" id="LN2673">2673</td><td class="line">  <span class='keyword'>int</span> hx, hy, ix, iy;</td></tr>
<tr class="codeline" data-linenumber="2674"><td class="num" id="LN2674">2674</td><td class="line">  <span class='keyword'>unsigned</span> lx, ly;</td></tr>
<tr class="codeline" data-linenumber="2675"><td class="num" id="LN2675">2675</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2676"><td class="num" id="LN2676">2676</td><td class="line">  EXTRACT_WORDS(hx, lx, x);</td></tr>
<tr class="codeline" data-linenumber="2677"><td class="num" id="LN2677">2677</td><td class="line">  EXTRACT_WORDS(hy, ly, y);</td></tr>
<tr class="codeline" data-linenumber="2678"><td class="num" id="LN2678">2678</td><td class="line">  ix = hx &amp; 0x7fffffff;</td></tr>
<tr class="codeline" data-linenumber="2679"><td class="num" id="LN2679">2679</td><td class="line">  iy = hy &amp; 0x7fffffff;</td></tr>
<tr class="codeline" data-linenumber="2680"><td class="num" id="LN2680">2680</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2681"><td class="num" id="LN2681">2681</td><td class="line">  <span class='comment'>/* y==zero: x**0 = 1 */</span></td></tr>
<tr class="codeline" data-linenumber="2682"><td class="num" id="LN2682">2682</td><td class="line">  <span class='keyword'>if</span> ((iy | ly) == 0) <span class='keyword'>return</span> one;</td></tr>
<tr class="codeline" data-linenumber="2683"><td class="num" id="LN2683">2683</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2684"><td class="num" id="LN2684">2684</td><td class="line">  <span class='comment'>/* +-NaN return x+y */</span></td></tr>
<tr class="codeline" data-linenumber="2685"><td class="num" id="LN2685">2685</td><td class="line">  <span class='keyword'>if</span> (ix &gt; 0x7ff00000 || ((ix == 0x7ff00000) &amp;&amp; (lx != 0)) || iy &gt; 0x7ff00000 ||</td></tr>
<tr class="codeline" data-linenumber="2686"><td class="num" id="LN2686">2686</td><td class="line">      ((iy == 0x7ff00000) &amp;&amp; (ly != 0))) {</td></tr>
<tr class="codeline" data-linenumber="2687"><td class="num" id="LN2687">2687</td><td class="line">    <span class='keyword'>return</span> x + y;</td></tr>
<tr class="codeline" data-linenumber="2688"><td class="num" id="LN2688">2688</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2689"><td class="num" id="LN2689">2689</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2690"><td class="num" id="LN2690">2690</td><td class="line">  <span class='comment'>/* determine if y is an odd int when x &lt; 0</span></td></tr>
<tr class="codeline" data-linenumber="2691"><td class="num" id="LN2691">2691</td><td class="line">   <span class='comment'>* yisint = 0 ... y is not an integer</span></td></tr>
<tr class="codeline" data-linenumber="2692"><td class="num" id="LN2692">2692</td><td class="line">   <span class='comment'>* yisint = 1 ... y is an odd int</span></td></tr>
<tr class="codeline" data-linenumber="2693"><td class="num" id="LN2693">2693</td><td class="line">   <span class='comment'>* yisint = 2 ... y is an even int</span></td></tr>
<tr class="codeline" data-linenumber="2694"><td class="num" id="LN2694">2694</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2695"><td class="num" id="LN2695">2695</td><td class="line">  yisint = 0;</td></tr>
<tr class="codeline" data-linenumber="2696"><td class="num" id="LN2696">2696</td><td class="line">  <span class='keyword'>if</span> (hx &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="2697"><td class="num" id="LN2697">2697</td><td class="line">    <span class='keyword'>if</span> (iy &gt;= 0x43400000) {</td></tr>
<tr class="codeline" data-linenumber="2698"><td class="num" id="LN2698">2698</td><td class="line">      yisint = 2; <span class='comment'>/* even integer y */</span></td></tr>
<tr class="codeline" data-linenumber="2699"><td class="num" id="LN2699">2699</td><td class="line">    } <span class='keyword'>else</span> <span class='keyword'>if</span> (iy &gt;= 0x3ff00000) {</td></tr>
<tr class="codeline" data-linenumber="2700"><td class="num" id="LN2700">2700</td><td class="line">      k = (iy &gt;&gt; 20) - 0x3ff; <span class='comment'>/* exponent */</span></td></tr>
<tr class="codeline" data-linenumber="2701"><td class="num" id="LN2701">2701</td><td class="line">      <span class='keyword'>if</span> (k &gt; 20) {</td></tr>
<tr class="codeline" data-linenumber="2702"><td class="num" id="LN2702">2702</td><td class="line">        j = ly &gt;&gt; (52 - k);</td></tr>
<tr class="codeline" data-linenumber="2703"><td class="num" id="LN2703">2703</td><td class="line">        <span class='keyword'>if</span> ((j &lt;&lt; (52 - k)) == <span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(ly)) yisint = 2 - (j &amp; 1);</td></tr>
<tr class="codeline" data-linenumber="2704"><td class="num" id="LN2704">2704</td><td class="line">      } <span class='keyword'>else</span> <span class='keyword'>if</span> (ly == 0) {</td></tr>
<tr class="codeline" data-linenumber="2705"><td class="num" id="LN2705">2705</td><td class="line">        j = iy &gt;&gt; (20 - k);</td></tr>
<tr class="codeline" data-linenumber="2706"><td class="num" id="LN2706">2706</td><td class="line">        <span class='keyword'>if</span> ((j &lt;&lt; (20 - k)) == iy) yisint = 2 - (j &amp; 1);</td></tr>
<tr class="codeline" data-linenumber="2707"><td class="num" id="LN2707">2707</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="2708"><td class="num" id="LN2708">2708</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2709"><td class="num" id="LN2709">2709</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2710"><td class="num" id="LN2710">2710</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2711"><td class="num" id="LN2711">2711</td><td class="line">  <span class='comment'>/* special value of y */</span></td></tr>
<tr class="codeline" data-linenumber="2712"><td class="num" id="LN2712">2712</td><td class="line">  <span class='keyword'>if</span> (ly == 0) {</td></tr>
<tr class="codeline" data-linenumber="2713"><td class="num" id="LN2713">2713</td><td class="line">    <span class='keyword'>if</span> (iy == 0x7ff00000) { <span class='comment'>/* y is +-inf */</span></td></tr>
<tr class="codeline" data-linenumber="2714"><td class="num" id="LN2714">2714</td><td class="line">      <span class='keyword'>if</span> (((ix - 0x3ff00000) | lx) == 0) {</td></tr>
<tr class="codeline" data-linenumber="2715"><td class="num" id="LN2715">2715</td><td class="line">        <span class='keyword'>return</span> y - y;                <span class='comment'>/* inf**+-1 is NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2716"><td class="num" id="LN2716">2716</td><td class="line">      } <span class='keyword'>else</span> <span class='keyword'>if</span> (ix &gt;= 0x3ff00000) { <span class='comment'>/* (|x|&gt;1)**+-inf = inf,0 */</span></td></tr>
<tr class="codeline" data-linenumber="2717"><td class="num" id="LN2717">2717</td><td class="line">        <span class='keyword'>return</span> (hy &gt;= 0) ? y : zero;</td></tr>
<tr class="codeline" data-linenumber="2718"><td class="num" id="LN2718">2718</td><td class="line">      } <span class='keyword'>else</span> { <span class='comment'>/* (|x|&lt;1)**-,+inf = inf,0 */</span></td></tr>
<tr class="codeline" data-linenumber="2719"><td class="num" id="LN2719">2719</td><td class="line">        <span class='keyword'>return</span> (hy &lt; 0) ? -y : zero;</td></tr>
<tr class="codeline" data-linenumber="2720"><td class="num" id="LN2720">2720</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="2721"><td class="num" id="LN2721">2721</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2722"><td class="num" id="LN2722">2722</td><td class="line">    <span class='keyword'>if</span> (iy == 0x3ff00000) { <span class='comment'>/* y is  +-1 */</span></td></tr>
<tr class="codeline" data-linenumber="2723"><td class="num" id="LN2723">2723</td><td class="line">      <span class='keyword'>if</span> (hy &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="2724"><td class="num" id="LN2724">2724</td><td class="line">        <span class='keyword'>return</span> base::Divide(one, x);</td></tr>
<tr class="codeline" data-linenumber="2725"><td class="num" id="LN2725">2725</td><td class="line">      } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2726"><td class="num" id="LN2726">2726</td><td class="line">        <span class='keyword'>return</span> x;</td></tr>
<tr class="codeline" data-linenumber="2727"><td class="num" id="LN2727">2727</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="2728"><td class="num" id="LN2728">2728</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2729"><td class="num" id="LN2729">2729</td><td class="line">    <span class='keyword'>if</span> (hy == 0x40000000) <span class='keyword'>return</span> x * x; <span class='comment'>/* y is  2 */</span></td></tr>
<tr class="codeline" data-linenumber="2730"><td class="num" id="LN2730">2730</td><td class="line">    <span class='keyword'>if</span> (hy == 0x3fe00000) {             <span class='comment'>/* y is  0.5 */</span></td></tr>
<tr class="codeline" data-linenumber="2731"><td class="num" id="LN2731">2731</td><td class="line">      <span class='keyword'>if</span> (hx &gt;= 0) {                    <span class='comment'>/* x &gt;= +0 */</span></td></tr>
<tr class="codeline" data-linenumber="2732"><td class="num" id="LN2732">2732</td><td class="line">        <span class='keyword'>return</span> sqrt(x);</td></tr>
<tr class="codeline" data-linenumber="2733"><td class="num" id="LN2733">2733</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="2734"><td class="num" id="LN2734">2734</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2735"><td class="num" id="LN2735">2735</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2736"><td class="num" id="LN2736">2736</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2737"><td class="num" id="LN2737">2737</td><td class="line">  ax = fabs(x);</td></tr>
<tr class="codeline" data-linenumber="2738"><td class="num" id="LN2738">2738</td><td class="line">  <span class='comment'>/* special value of x */</span></td></tr>
<tr class="codeline" data-linenumber="2739"><td class="num" id="LN2739">2739</td><td class="line">  <span class='keyword'>if</span> (lx == 0) {</td></tr>
<tr class="codeline" data-linenumber="2740"><td class="num" id="LN2740">2740</td><td class="line">    <span class='keyword'>if</span> (ix == 0x7ff00000 || ix == 0 || ix == 0x3ff00000) {</td></tr>
<tr class="codeline" data-linenumber="2741"><td class="num" id="LN2741">2741</td><td class="line">      z = ax;                         <span class='comment'>/*x is +-0,+-inf,+-1*/</span></td></tr>
<tr class="codeline" data-linenumber="2742"><td class="num" id="LN2742">2742</td><td class="line">      <span class='keyword'>if</span> (hy &lt; 0) z = base::Divide(one, z); <span class='comment'>/* z = (1/|x|) */</span></td></tr>
<tr class="codeline" data-linenumber="2743"><td class="num" id="LN2743">2743</td><td class="line">      <span class='keyword'>if</span> (hx &lt; 0) {</td></tr>
<tr class="codeline" data-linenumber="2744"><td class="num" id="LN2744">2744</td><td class="line">        <span class='keyword'>if</span> (((ix - 0x3ff00000) | yisint) == 0) {</td></tr>
<tr class="codeline" data-linenumber="2745"><td class="num" id="LN2745">2745</td><td class="line">          <span class='comment'>/* (-1)**non-int is NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2746"><td class="num" id="LN2746">2746</td><td class="line">          z = std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::signaling_NaN();</td></tr>
<tr class="codeline" data-linenumber="2747"><td class="num" id="LN2747">2747</td><td class="line">        } <span class='keyword'>else</span> <span class='keyword'>if</span> (yisint == 1) {</td></tr>
<tr class="codeline" data-linenumber="2748"><td class="num" id="LN2748">2748</td><td class="line">          z = -z; <span class='comment'>/* (x&lt;0)**odd = -(|x|**odd) */</span></td></tr>
<tr class="codeline" data-linenumber="2749"><td class="num" id="LN2749">2749</td><td class="line">        }</td></tr>
<tr class="codeline" data-linenumber="2750"><td class="num" id="LN2750">2750</td><td class="line">      }</td></tr>
<tr class="codeline" data-linenumber="2751"><td class="num" id="LN2751">2751</td><td class="line">      <span class='keyword'>return</span> z;</td></tr>
<tr class="codeline" data-linenumber="2752"><td class="num" id="LN2752">2752</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2753"><td class="num" id="LN2753">2753</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2754"><td class="num" id="LN2754">2754</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2755"><td class="num" id="LN2755">2755</td><td class="line">  n = (hx &gt;&gt; 31) + 1;</td></tr>
<tr class="codeline" data-linenumber="2756"><td class="num" id="LN2756">2756</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2757"><td class="num" id="LN2757">2757</td><td class="line">  <span class='comment'>/* (x&lt;0)**(non-int) is NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2758"><td class="num" id="LN2758">2758</td><td class="line">  <span class='keyword'>if</span> ((n | yisint) == 0) {</td></tr>
<tr class="codeline" data-linenumber="2759"><td class="num" id="LN2759">2759</td><td class="line">    <span class='keyword'>return</span> std::numeric_limits&lt;<span class='keyword'>double</span>&gt;::signaling_NaN();</td></tr>
<tr class="codeline" data-linenumber="2760"><td class="num" id="LN2760">2760</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2761"><td class="num" id="LN2761">2761</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2762"><td class="num" id="LN2762">2762</td><td class="line">  s = one; <span class='comment'>/* s (sign of result -ve**odd) = -1 else = 1 */</span></td></tr>
<tr class="codeline" data-linenumber="2763"><td class="num" id="LN2763">2763</td><td class="line">  <span class='keyword'>if</span> ((n | (yisint - 1)) == 0) s = -one; <span class='comment'>/* (-ve)**(odd int) */</span></td></tr>
<tr class="codeline" data-linenumber="2764"><td class="num" id="LN2764">2764</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2765"><td class="num" id="LN2765">2765</td><td class="line">  <span class='comment'>/* |y| is huge */</span></td></tr>
<tr class="codeline" data-linenumber="2766"><td class="num" id="LN2766">2766</td><td class="line">  <span class='keyword'>if</span> (iy &gt; 0x41e00000) {   <span class='comment'>/* if |y| &gt; 2**31 */</span></td></tr>
<tr class="codeline" data-linenumber="2767"><td class="num" id="LN2767">2767</td><td class="line">    <span class='keyword'>if</span> (iy &gt; 0x43f00000) { <span class='comment'>/* if |y| &gt; 2**64, must o/uflow */</span></td></tr>
<tr class="codeline" data-linenumber="2768"><td class="num" id="LN2768">2768</td><td class="line">      <span class='keyword'>if</span> (ix &lt;= 0x3fefffff) <span class='keyword'>return</span> (hy &lt; 0) ? huge * huge : tiny * tiny;</td></tr>
<tr class="codeline" data-linenumber="2769"><td class="num" id="LN2769">2769</td><td class="line">      <span class='keyword'>if</span> (ix &gt;= 0x3ff00000) <span class='keyword'>return</span> (hy &gt; 0) ? huge * huge : tiny * tiny;</td></tr>
<tr class="codeline" data-linenumber="2770"><td class="num" id="LN2770">2770</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2771"><td class="num" id="LN2771">2771</td><td class="line">    <span class='comment'>/* over/underflow if x is not close to one */</span></td></tr>
<tr class="codeline" data-linenumber="2772"><td class="num" id="LN2772">2772</td><td class="line">    <span class='keyword'>if</span> (ix &lt; 0x3fefffff) <span class='keyword'>return</span> (hy &lt; 0) ? s * huge * huge : s * tiny * tiny;</td></tr>
<tr class="codeline" data-linenumber="2773"><td class="num" id="LN2773">2773</td><td class="line">    <span class='keyword'>if</span> (ix &gt; 0x3ff00000) <span class='keyword'>return</span> (hy &gt; 0) ? s * huge * huge : s * tiny * tiny;</td></tr>
<tr class="codeline" data-linenumber="2774"><td class="num" id="LN2774">2774</td><td class="line">    <span class='comment'>/* now |1-x| is tiny &lt;= 2**-20, suffice to compute</span></td></tr>
<tr class="codeline" data-linenumber="2775"><td class="num" id="LN2775">2775</td><td class="line">       <span class='comment'>log(x) by x-x^2/2+x^3/3-x^4/4 */</span></td></tr>
<tr class="codeline" data-linenumber="2776"><td class="num" id="LN2776">2776</td><td class="line">    t = ax - one; <span class='comment'>/* t has 20 trailing zeros */</span></td></tr>
<tr class="codeline" data-linenumber="2777"><td class="num" id="LN2777">2777</td><td class="line">    w = (t * t) * (0.5 - t * (0.3333333333333333333333 - t * 0.25));</td></tr>
<tr class="codeline" data-linenumber="2778"><td class="num" id="LN2778">2778</td><td class="line">    u = ivln2_h * t; <span class='comment'>/* ivln2_h has 21 sig. bits */</span></td></tr>
<tr class="codeline" data-linenumber="2779"><td class="num" id="LN2779">2779</td><td class="line">    v = t * ivln2_l - w * ivln2;</td></tr>
<tr class="codeline" data-linenumber="2780"><td class="num" id="LN2780">2780</td><td class="line">    t1 = u + v;</td></tr>
<tr class="codeline" data-linenumber="2781"><td class="num" id="LN2781">2781</td><td class="line">    SET_LOW_WORD(t1, 0);</td></tr>
<tr class="codeline" data-linenumber="2782"><td class="num" id="LN2782">2782</td><td class="line">    t2 = v - (t1 - u);</td></tr>
<tr class="codeline" data-linenumber="2783"><td class="num" id="LN2783">2783</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2784"><td class="num" id="LN2784">2784</td><td class="line">    <span class='keyword'>double</span> ss, s2, s_h, s_l, t_h, t_l;</td></tr>
<tr class="codeline" data-linenumber="2785"><td class="num" id="LN2785">2785</td><td class="line">    n = 0;</td></tr>
<tr class="codeline" data-linenumber="2786"><td class="num" id="LN2786">2786</td><td class="line">    <span class='comment'>/* take care subnormal number */</span></td></tr>
<tr class="codeline" data-linenumber="2787"><td class="num" id="LN2787">2787</td><td class="line">    <span class='keyword'>if</span> (ix &lt; 0x00100000) {</td></tr>
<tr class="codeline" data-linenumber="2788"><td class="num" id="LN2788">2788</td><td class="line">      ax *= two53;</td></tr>
<tr class="codeline" data-linenumber="2789"><td class="num" id="LN2789">2789</td><td class="line">      n -= 53;</td></tr>
<tr class="codeline" data-linenumber="2790"><td class="num" id="LN2790">2790</td><td class="line">      GET_HIGH_WORD(ix, ax);</td></tr>
<tr class="codeline" data-linenumber="2791"><td class="num" id="LN2791">2791</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2792"><td class="num" id="LN2792">2792</td><td class="line">    n += ((ix) &gt;&gt; 20) - 0x3ff;</td></tr>
<tr class="codeline" data-linenumber="2793"><td class="num" id="LN2793">2793</td><td class="line">    j = ix &amp; 0x000fffff;</td></tr>
<tr class="codeline" data-linenumber="2794"><td class="num" id="LN2794">2794</td><td class="line">    <span class='comment'>/* determine interval */</span></td></tr>
<tr class="codeline" data-linenumber="2795"><td class="num" id="LN2795">2795</td><td class="line">    ix = j | 0x3ff00000; <span class='comment'>/* normalize ix */</span></td></tr>
<tr class="codeline" data-linenumber="2796"><td class="num" id="LN2796">2796</td><td class="line">    <span class='keyword'>if</span> (j &lt;= 0x3988E) {</td></tr>
<tr class="codeline" data-linenumber="2797"><td class="num" id="LN2797">2797</td><td class="line">      k = 0; <span class='comment'>/* |x|&lt;sqrt(3/2) */</span></td></tr>
<tr class="codeline" data-linenumber="2798"><td class="num" id="LN2798">2798</td><td class="line">    } <span class='keyword'>else</span> <span class='keyword'>if</span> (j &lt; 0xBB67A) {</td></tr>
<tr class="codeline" data-linenumber="2799"><td class="num" id="LN2799">2799</td><td class="line">      k = 1; <span class='comment'>/* |x|&lt;sqrt(3)   */</span></td></tr>
<tr class="codeline" data-linenumber="2800"><td class="num" id="LN2800">2800</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2801"><td class="num" id="LN2801">2801</td><td class="line">      k = 0;</td></tr>
<tr class="codeline" data-linenumber="2802"><td class="num" id="LN2802">2802</td><td class="line">      n += 1;</td></tr>
<tr class="codeline" data-linenumber="2803"><td class="num" id="LN2803">2803</td><td class="line">      ix -= 0x00100000;</td></tr>
<tr class="codeline" data-linenumber="2804"><td class="num" id="LN2804">2804</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2805"><td class="num" id="LN2805">2805</td><td class="line">    SET_HIGH_WORD(ax, ix);</td></tr>
<tr class="codeline" data-linenumber="2806"><td class="num" id="LN2806">2806</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2807"><td class="num" id="LN2807">2807</td><td class="line">    <span class='comment'>/* compute ss = s_h+s_l = (x-1)/(x+1) or (x-1.5)/(x+1.5) */</span></td></tr>
<tr class="codeline" data-linenumber="2808"><td class="num" id="LN2808">2808</td><td class="line">    u = ax - bp[k]; <span class='comment'>/* bp[0]=1.0, bp[1]=1.5 */</span></td></tr>
<tr class="codeline" data-linenumber="2809"><td class="num" id="LN2809">2809</td><td class="line">    v = base::Divide(one, ax + bp[k]);</td></tr>
<tr class="codeline" data-linenumber="2810"><td class="num" id="LN2810">2810</td><td class="line">    ss = u * v;</td></tr>
<tr class="codeline" data-linenumber="2811"><td class="num" id="LN2811">2811</td><td class="line">    s_h = ss;</td></tr>
<tr class="codeline" data-linenumber="2812"><td class="num" id="LN2812">2812</td><td class="line">    SET_LOW_WORD(s_h, 0);</td></tr>
<tr class="codeline" data-linenumber="2813"><td class="num" id="LN2813">2813</td><td class="line">    <span class='comment'>/* t_h=ax+bp[k] High */</span></td></tr>
<tr class="codeline" data-linenumber="2814"><td class="num" id="LN2814">2814</td><td class="line">    t_h = zero;</td></tr>
<tr class="codeline" data-linenumber="2815"><td class="num" id="LN2815">2815</td><td class="line">    SET_HIGH_WORD(t_h, ((ix &gt;&gt; 1) | 0x20000000) + 0x00080000 + (k &lt;&lt; 18));</td></tr>
<tr class="codeline" data-linenumber="2816"><td class="num" id="LN2816">2816</td><td class="line">    t_l = ax - (t_h - bp[k]);</td></tr>
<tr class="codeline" data-linenumber="2817"><td class="num" id="LN2817">2817</td><td class="line">    s_l = v * ((u - s_h * t_h) - s_h * t_l);</td></tr>
<tr class="codeline" data-linenumber="2818"><td class="num" id="LN2818">2818</td><td class="line">    <span class='comment'>/* compute log(ax) */</span></td></tr>
<tr class="codeline" data-linenumber="2819"><td class="num" id="LN2819">2819</td><td class="line">    s2 = ss * ss;</td></tr>
<tr class="codeline" data-linenumber="2820"><td class="num" id="LN2820">2820</td><td class="line">    r = s2 * s2 *</td></tr>
<tr class="codeline" data-linenumber="2821"><td class="num" id="LN2821">2821</td><td class="line">        (L1 + s2 * (L2 + s2 * (L3 + s2 * (L4 + s2 * (L5 + s2 * L6)))));</td></tr>
<tr class="codeline" data-linenumber="2822"><td class="num" id="LN2822">2822</td><td class="line">    r += s_l * (s_h + ss);</td></tr>
<tr class="codeline" data-linenumber="2823"><td class="num" id="LN2823">2823</td><td class="line">    s2 = s_h * s_h;</td></tr>
<tr class="codeline" data-linenumber="2824"><td class="num" id="LN2824">2824</td><td class="line">    t_h = 3.0 + s2 + r;</td></tr>
<tr class="codeline" data-linenumber="2825"><td class="num" id="LN2825">2825</td><td class="line">    SET_LOW_WORD(t_h, 0);</td></tr>
<tr class="codeline" data-linenumber="2826"><td class="num" id="LN2826">2826</td><td class="line">    t_l = r - ((t_h - 3.0) - s2);</td></tr>
<tr class="codeline" data-linenumber="2827"><td class="num" id="LN2827">2827</td><td class="line">    <span class='comment'>/* u+v = ss*(1+...) */</span></td></tr>
<tr class="codeline" data-linenumber="2828"><td class="num" id="LN2828">2828</td><td class="line">    u = s_h * t_h;</td></tr>
<tr class="codeline" data-linenumber="2829"><td class="num" id="LN2829">2829</td><td class="line">    v = s_l * t_h + t_l * ss;</td></tr>
<tr class="codeline" data-linenumber="2830"><td class="num" id="LN2830">2830</td><td class="line">    <span class='comment'>/* 2/(3log2)*(ss+...) */</span></td></tr>
<tr class="codeline" data-linenumber="2831"><td class="num" id="LN2831">2831</td><td class="line">    p_h = u + v;</td></tr>
<tr class="codeline" data-linenumber="2832"><td class="num" id="LN2832">2832</td><td class="line">    SET_LOW_WORD(p_h, 0);</td></tr>
<tr class="codeline" data-linenumber="2833"><td class="num" id="LN2833">2833</td><td class="line">    p_l = v - (p_h - u);</td></tr>
<tr class="codeline" data-linenumber="2834"><td class="num" id="LN2834">2834</td><td class="line">    z_h = cp_h * p_h; <span class='comment'>/* cp_h+cp_l = 2/(3*log2) */</span></td></tr>
<tr class="codeline" data-linenumber="2835"><td class="num" id="LN2835">2835</td><td class="line">    z_l = cp_l * p_h + p_l * cp + dp_l[k];</td></tr>
<tr class="codeline" data-linenumber="2836"><td class="num" id="LN2836">2836</td><td class="line">    <span class='comment'>/* log2(ax) = (ss+..)*2/(3*log2) = n + dp_h + z_h + z_l */</span></td></tr>
<tr class="codeline" data-linenumber="2837"><td class="num" id="LN2837">2837</td><td class="line">    t = <span class='keyword'>static_cast</span>&lt;<span class='keyword'>double</span>&gt;(n);</td></tr>
<tr class="codeline" data-linenumber="2838"><td class="num" id="LN2838">2838</td><td class="line">    t1 = (((z_h + z_l) + dp_h[k]) + t);</td></tr>
<tr class="codeline" data-linenumber="2839"><td class="num" id="LN2839">2839</td><td class="line">    SET_LOW_WORD(t1, 0);</td></tr>
<tr class="codeline" data-linenumber="2840"><td class="num" id="LN2840">2840</td><td class="line">    t2 = z_l - (((t1 - t) - dp_h[k]) - z_h);</td></tr>
<tr class="codeline" data-linenumber="2841"><td class="num" id="LN2841">2841</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2842"><td class="num" id="LN2842">2842</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2843"><td class="num" id="LN2843">2843</td><td class="line">  <span class='comment'>/* split up y into y1+y2 and compute (y1+y2)*(t1+t2) */</span></td></tr>
<tr class="codeline" data-linenumber="2844"><td class="num" id="LN2844">2844</td><td class="line">  y1 = y;</td></tr>
<tr class="codeline" data-linenumber="2845"><td class="num" id="LN2845">2845</td><td class="line">  SET_LOW_WORD(y1, 0);</td></tr>
<tr class="codeline" data-linenumber="2846"><td class="num" id="LN2846">2846</td><td class="line">  p_l = (y - y1) * t1 + y * t2;</td></tr>
<tr class="codeline" data-linenumber="2847"><td class="num" id="LN2847">2847</td><td class="line">  p_h = y1 * t1;</td></tr>
<tr class="codeline" data-linenumber="2848"><td class="num" id="LN2848">2848</td><td class="line">  z = p_l + p_h;</td></tr>
<tr class="codeline" data-linenumber="2849"><td class="num" id="LN2849">2849</td><td class="line">  EXTRACT_WORDS(j, i, z);</td></tr>
<tr class="codeline" data-linenumber="2850"><td class="num" id="LN2850">2850</td><td class="line">  <span class='keyword'>if</span> (j &gt;= 0x40900000) {               <span class='comment'>/* z &gt;= 1024 */</span></td></tr>
<tr class="codeline" data-linenumber="2851"><td class="num" id="LN2851">2851</td><td class="line">    <span class='keyword'>if</span> (((j - 0x40900000) | i) != 0) { <span class='comment'>/* if z &gt; 1024 */</span></td></tr>
<tr class="codeline" data-linenumber="2852"><td class="num" id="LN2852">2852</td><td class="line">      <span class='keyword'>return</span> s * huge * huge;          <span class='comment'>/* overflow */</span></td></tr>
<tr class="codeline" data-linenumber="2853"><td class="num" id="LN2853">2853</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2854"><td class="num" id="LN2854">2854</td><td class="line">      <span class='keyword'>if</span> (p_l + ovt &gt; z - p_h) <span class='keyword'>return</span> s * huge * huge; <span class='comment'>/* overflow */</span></td></tr>
<tr class="codeline" data-linenumber="2855"><td class="num" id="LN2855">2855</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2856"><td class="num" id="LN2856">2856</td><td class="line">  } <span class='keyword'>else</span> <span class='keyword'>if</span> ((j &amp; 0x7fffffff) &gt;= 0x4090cc00) { <span class='comment'>/* z &lt;= -1075 */</span></td></tr>
<tr class="codeline" data-linenumber="2857"><td class="num" id="LN2857">2857</td><td class="line">    <span class='keyword'>if</span> (((j - 0xc090cc00) | i) != 0) {         <span class='comment'>/* z &lt; -1075 */</span></td></tr>
<tr class="codeline" data-linenumber="2858"><td class="num" id="LN2858">2858</td><td class="line">      <span class='keyword'>return</span> s * tiny * tiny;                  <span class='comment'>/* underflow */</span></td></tr>
<tr class="codeline" data-linenumber="2859"><td class="num" id="LN2859">2859</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2860"><td class="num" id="LN2860">2860</td><td class="line">      <span class='keyword'>if</span> (p_l &lt;= z - p_h) <span class='keyword'>return</span> s * tiny * tiny; <span class='comment'>/* underflow */</span></td></tr>
<tr class="codeline" data-linenumber="2861"><td class="num" id="LN2861">2861</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2862"><td class="num" id="LN2862">2862</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2863"><td class="num" id="LN2863">2863</td><td class="line">  <span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="2864"><td class="num" id="LN2864">2864</td><td class="line">   <span class='comment'>* compute 2**(p_h+p_l)</span></td></tr>
<tr class="codeline" data-linenumber="2865"><td class="num" id="LN2865">2865</td><td class="line">   <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2866"><td class="num" id="LN2866">2866</td><td class="line">  i = j &amp; 0x7fffffff;</td></tr>
<tr class="codeline" data-linenumber="2867"><td class="num" id="LN2867">2867</td><td class="line">  k = (i &gt;&gt; 20) - 0x3ff;</td></tr>
<tr class="codeline" data-linenumber="2868"><td class="num" id="LN2868">2868</td><td class="line">  n = 0;</td></tr>
<tr class="codeline" data-linenumber="2869"><td class="num" id="LN2869">2869</td><td class="line">  <span class='keyword'>if</span> (i &gt; 0x3fe00000) { <span class='comment'>/* if |z| &gt; 0.5, set n = [z+0.5] */</span></td></tr>
<tr class="codeline" data-linenumber="2870"><td class="num" id="LN2870">2870</td><td class="line">    n = j + (0x00100000 &gt;&gt; (k + 1));</td></tr>
<tr class="codeline" data-linenumber="2871"><td class="num" id="LN2871">2871</td><td class="line">    k = ((n &amp; 0x7fffffff) &gt;&gt; 20) - 0x3ff; <span class='comment'>/* new k for n */</span></td></tr>
<tr class="codeline" data-linenumber="2872"><td class="num" id="LN2872">2872</td><td class="line">    t = zero;</td></tr>
<tr class="codeline" data-linenumber="2873"><td class="num" id="LN2873">2873</td><td class="line">    SET_HIGH_WORD(t, n &amp; ~(0x000fffff &gt;&gt; k));</td></tr>
<tr class="codeline" data-linenumber="2874"><td class="num" id="LN2874">2874</td><td class="line">    n = ((n &amp; 0x000fffff) | 0x00100000) &gt;&gt; (20 - k);</td></tr>
<tr class="codeline" data-linenumber="2875"><td class="num" id="LN2875">2875</td><td class="line">    <span class='keyword'>if</span> (j &lt; 0) n = -n;</td></tr>
<tr class="codeline" data-linenumber="2876"><td class="num" id="LN2876">2876</td><td class="line">    p_h -= t;</td></tr>
<tr class="codeline" data-linenumber="2877"><td class="num" id="LN2877">2877</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2878"><td class="num" id="LN2878">2878</td><td class="line">  t = p_l + p_h;</td></tr>
<tr class="codeline" data-linenumber="2879"><td class="num" id="LN2879">2879</td><td class="line">  SET_LOW_WORD(t, 0);</td></tr>
<tr class="codeline" data-linenumber="2880"><td class="num" id="LN2880">2880</td><td class="line">  u = t * lg2_h;</td></tr>
<tr class="codeline" data-linenumber="2881"><td class="num" id="LN2881">2881</td><td class="line">  v = (p_l - (t - p_h)) * lg2 + t * lg2_l;</td></tr>
<tr class="codeline" data-linenumber="2882"><td class="num" id="LN2882">2882</td><td class="line">  z = u + v;</td></tr>
<tr class="codeline" data-linenumber="2883"><td class="num" id="LN2883">2883</td><td class="line">  w = v - (z - u);</td></tr>
<tr class="codeline" data-linenumber="2884"><td class="num" id="LN2884">2884</td><td class="line">  t = z * z;</td></tr>
<tr class="codeline" data-linenumber="2885"><td class="num" id="LN2885">2885</td><td class="line">  t1 = z - t * (P1 + t * (P2 + t * (P3 + t * (P4 + t * P5))));</td></tr>
<tr class="codeline" data-linenumber="2886"><td class="num" id="LN2886">2886</td><td class="line">  r = base::Divide(z * t1, (t1 - two) - (w + z * w));</td></tr>
<tr class="codeline" data-linenumber="2887"><td class="num" id="LN2887">2887</td><td class="line">  z = one - (r - z);</td></tr>
<tr class="codeline" data-linenumber="2888"><td class="num" id="LN2888">2888</td><td class="line">  GET_HIGH_WORD(j, z);</td></tr>
<tr class="codeline" data-linenumber="2889"><td class="num" id="LN2889">2889</td><td class="line">  j += <span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(<span class='keyword'>static_cast</span>&lt;uint32_t&gt;(n) &lt;&lt; 20);</td></tr>
<tr class="codeline" data-linenumber="2890"><td class="num" id="LN2890">2890</td><td class="line">  <span class='keyword'>if</span> ((j &gt;&gt; 20) &lt;= 0) {</td></tr>
<tr class="codeline" data-linenumber="2891"><td class="num" id="LN2891">2891</td><td class="line">    z = scalbn(z, n); <span class='comment'>/* subnormal output */</span></td></tr>
<tr class="codeline" data-linenumber="2892"><td class="num" id="LN2892">2892</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="2893"><td class="num" id="LN2893">2893</td><td class="line">    <span class='keyword'>int</span> tmp;</td></tr>
<tr class="codeline" data-linenumber="2894"><td class="num" id="LN2894">2894</td><td class="line">    GET_HIGH_WORD(tmp, z);</td></tr>
<tr class="codeline" data-linenumber="2895"><td class="num" id="LN2895">2895</td><td class="line">    SET_HIGH_WORD(z, tmp + <span class='keyword'>static_cast</span>&lt;<span class='keyword'>int</span>&gt;(<span class='keyword'>static_cast</span>&lt;uint32_t&gt;(n) &lt;&lt; 20));</td></tr>
<tr class="codeline" data-linenumber="2896"><td class="num" id="LN2896">2896</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2897"><td class="num" id="LN2897">2897</td><td class="line">  <span class='keyword'>return</span> s * z;</td></tr>
<tr class="codeline" data-linenumber="2898"><td class="num" id="LN2898">2898</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="2899"><td class="num" id="LN2899">2899</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2900"><td class="num" id="LN2900">2900</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr class="codeline" data-linenumber="2901"><td class="num" id="LN2901">2901</td><td class="line"> <span class='comment'>* ES6 draft 09-27-13, section 20.2.2.30.</span></td></tr>
<tr class="codeline" data-linenumber="2902"><td class="num" id="LN2902">2902</td><td class="line"> <span class='comment'>* Math.sinh</span></td></tr>
<tr class="codeline" data-linenumber="2903"><td class="num" id="LN2903">2903</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="2904"><td class="num" id="LN2904">2904</td><td class="line"> <span class='comment'>* mathematically sinh(x) if defined to be (exp(x)-exp(-x))/2</span></td></tr>
<tr class="codeline" data-linenumber="2905"><td class="num" id="LN2905">2905</td><td class="line"> <span class='comment'>*      1. Replace x by |x| (sinh(-x) = -sinh(x)).</span></td></tr>
<tr class="codeline" data-linenumber="2906"><td class="num" id="LN2906">2906</td><td class="line"> <span class='comment'>*      2.</span></td></tr>
<tr class="codeline" data-linenumber="2907"><td class="num" id="LN2907">2907</td><td class="line"> <span class='comment'>*                                                  E + E/(E+1)</span></td></tr>
<tr class="codeline" data-linenumber="2908"><td class="num" id="LN2908">2908</td><td class="line"> <span class='comment'>*          0        &lt;= x &lt;= 22     :  sinh(x) := --------------, E=expm1(x)</span></td></tr>
<tr class="codeline" data-linenumber="2909"><td class="num" id="LN2909">2909</td><td class="line"> <span class='comment'>*                                                      2</span></td></tr>
<tr class="codeline" data-linenumber="2910"><td class="num" id="LN2910">2910</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2911"><td class="num" id="LN2911">2911</td><td class="line"> <span class='comment'>*          22       &lt;= x &lt;= lnovft :  sinh(x) := exp(x)/2</span></td></tr>
<tr class="codeline" data-linenumber="2912"><td class="num" id="LN2912">2912</td><td class="line"> <span class='comment'>*          lnovft   &lt;= x &lt;= ln2ovft:  sinh(x) := exp(x/2)/2 * exp(x/2)</span></td></tr>
<tr class="codeline" data-linenumber="2913"><td class="num" id="LN2913">2913</td><td class="line"> <span class='comment'>*          ln2ovft  &lt;  x           :  sinh(x) := x*shuge (overflow)</span></td></tr>
<tr class="codeline" data-linenumber="2914"><td class="num" id="LN2914">2914</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2915"><td class="num" id="LN2915">2915</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="2916"><td class="num" id="LN2916">2916</td><td class="line"> <span class='comment'>*      sinh(x) is |x| if x is +Infinity, -Infinity, or NaN.</span></td></tr>
<tr class="codeline" data-linenumber="2917"><td class="num" id="LN2917">2917</td><td class="line"> <span class='comment'>*      only sinh(0)=0 is exact for finite x.</span></td></tr>
<tr class="codeline" data-linenumber="2918"><td class="num" id="LN2918">2918</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2919"><td class="num" id="LN2919">2919</td><td class="line"><span class='keyword'>double</span> sinh(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="2920"><td class="num" id="LN2920">2920</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> KSINH_OVERFLOW = 710.4758600739439,</td></tr>
<tr class="codeline" data-linenumber="2921"><td class="num" id="LN2921">2921</td><td class="line">                      TWO_M28 =</td></tr>
<tr class="codeline" data-linenumber="2922"><td class="num" id="LN2922">2922</td><td class="line">                          3.725290298461914e-9,  <span class='comment'>// 2^-28, empty lower half</span></td></tr>
<tr class="codeline" data-linenumber="2923"><td class="num" id="LN2923">2923</td><td class="line">      LOG_MAXD = 709.7822265625;  <span class='comment'>// 0x40862E42 00000000, empty lower half</span></td></tr>
<tr class="codeline" data-linenumber="2924"><td class="num" id="LN2924">2924</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> shuge = 1.0e307;</td></tr>
<tr class="codeline" data-linenumber="2925"><td class="num" id="LN2925">2925</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2926"><td class="num" id="LN2926">2926</td><td class="line">  <span class='keyword'>double</span> h = (x &lt; 0) ? -0.5 : 0.5;</td></tr>
<tr class="codeline" data-linenumber="2927"><td class="num" id="LN2927">2927</td><td class="line">  <span class='comment'>// |x| in [0, 22]. return sign(x)*0.5*(E+E/(E+1))</span></td></tr>
<tr class="codeline" data-linenumber="2928"><td class="num" id="LN2928">2928</td><td class="line">  <span class='keyword'>double</span> ax = fabs(x);</td></tr>
<tr class="codeline" data-linenumber="2929"><td class="num" id="LN2929">2929</td><td class="line">  <span class='keyword'>if</span> (ax &lt; 22) {</td></tr>
<tr class="codeline" data-linenumber="2930"><td class="num" id="LN2930">2930</td><td class="line">    <span class='comment'>// For |x| &lt; 2^-28, sinh(x) = x</span></td></tr>
<tr class="codeline" data-linenumber="2931"><td class="num" id="LN2931">2931</td><td class="line">    <span class='keyword'>if</span> (ax &lt; TWO_M28) <span class='keyword'>return</span> x;</td></tr>
<tr class="codeline" data-linenumber="2932"><td class="num" id="LN2932">2932</td><td class="line">    <span class='keyword'>double</span> t = expm1(ax);</td></tr>
<tr class="codeline" data-linenumber="2933"><td class="num" id="LN2933">2933</td><td class="line">    <span class='keyword'>if</span> (ax &lt; 1) {</td></tr>
<tr class="codeline" data-linenumber="2934"><td class="num" id="LN2934">2934</td><td class="line">      <span class='keyword'>return</span> h * (2 * t - t * t / (t + 1));</td></tr>
<tr class="codeline" data-linenumber="2935"><td class="num" id="LN2935">2935</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2936"><td class="num" id="LN2936">2936</td><td class="line">    <span class='keyword'>return</span> h * (t + t / (t + 1));</td></tr>
<tr class="codeline" data-linenumber="2937"><td class="num" id="LN2937">2937</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2938"><td class="num" id="LN2938">2938</td><td class="line">  <span class='comment'>// |x| in [22, log(maxdouble)], return 0.5 * exp(|x|)</span></td></tr>
<tr class="codeline" data-linenumber="2939"><td class="num" id="LN2939">2939</td><td class="line">  <span class='keyword'>if</span> (ax &lt; LOG_MAXD) <span class='keyword'>return</span> h * exp(ax);</td></tr>
<tr class="codeline" data-linenumber="2940"><td class="num" id="LN2940">2940</td><td class="line">  <span class='comment'>// |x| in [log(maxdouble), overflowthreshold]</span></td></tr>
<tr class="codeline" data-linenumber="2941"><td class="num" id="LN2941">2941</td><td class="line">  <span class='comment'>// overflowthreshold = 710.4758600739426</span></td></tr>
<tr class="codeline" data-linenumber="2942"><td class="num" id="LN2942">2942</td><td class="line">  <span class='keyword'>if</span> (ax &lt;= KSINH_OVERFLOW) {</td></tr>
<tr class="codeline" data-linenumber="2943"><td class="num" id="LN2943">2943</td><td class="line">    <span class='keyword'>double</span> w = exp(0.5 * ax);</td></tr>
<tr class="codeline" data-linenumber="2944"><td class="num" id="LN2944">2944</td><td class="line">    <span class='keyword'>double</span> t = h * w;</td></tr>
<tr class="codeline" data-linenumber="2945"><td class="num" id="LN2945">2945</td><td class="line">    <span class='keyword'>return</span> t * w;</td></tr>
<tr class="codeline" data-linenumber="2946"><td class="num" id="LN2946">2946</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2947"><td class="num" id="LN2947">2947</td><td class="line">  <span class='comment'>// |x| &gt; overflowthreshold or is NaN.</span></td></tr>
<tr class="codeline" data-linenumber="2948"><td class="num" id="LN2948">2948</td><td class="line">  <span class='comment'>// Return Infinity of the appropriate sign or NaN.</span></td></tr>
<tr class="codeline" data-linenumber="2949"><td class="num" id="LN2949">2949</td><td class="line">  <span class='keyword'>return</span> x * shuge;</td></tr>
<tr class="codeline" data-linenumber="2950"><td class="num" id="LN2950">2950</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="2951"><td class="num" id="LN2951">2951</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2952"><td class="num" id="LN2952">2952</td><td class="line"><span class='comment'>/* Tanh(x)</span></td></tr>
<tr class="codeline" data-linenumber="2953"><td class="num" id="LN2953">2953</td><td class="line"> <span class='comment'>* Return the Hyperbolic Tangent of x</span></td></tr>
<tr class="codeline" data-linenumber="2954"><td class="num" id="LN2954">2954</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2955"><td class="num" id="LN2955">2955</td><td class="line"> <span class='comment'>* Method :</span></td></tr>
<tr class="codeline" data-linenumber="2956"><td class="num" id="LN2956">2956</td><td class="line"> <span class='comment'>*                                 x    -x</span></td></tr>
<tr class="codeline" data-linenumber="2957"><td class="num" id="LN2957">2957</td><td class="line"> <span class='comment'>*                                e  - e</span></td></tr>
<tr class="codeline" data-linenumber="2958"><td class="num" id="LN2958">2958</td><td class="line"> <span class='comment'>*  0. tanh(x) is defined to be -----------</span></td></tr>
<tr class="codeline" data-linenumber="2959"><td class="num" id="LN2959">2959</td><td class="line"> <span class='comment'>*                                 x    -x</span></td></tr>
<tr class="codeline" data-linenumber="2960"><td class="num" id="LN2960">2960</td><td class="line"> <span class='comment'>*                                e  + e</span></td></tr>
<tr class="codeline" data-linenumber="2961"><td class="num" id="LN2961">2961</td><td class="line"> <span class='comment'>*  1. reduce x to non-negative by tanh(-x) = -tanh(x).</span></td></tr>
<tr class="codeline" data-linenumber="2962"><td class="num" id="LN2962">2962</td><td class="line"> <span class='comment'>*  2.  0      &lt;= x &lt;  2**-28 : tanh(x) := x with inexact if x != 0</span></td></tr>
<tr class="codeline" data-linenumber="2963"><td class="num" id="LN2963">2963</td><td class="line"> <span class='comment'>*                                          -t</span></td></tr>
<tr class="codeline" data-linenumber="2964"><td class="num" id="LN2964">2964</td><td class="line"> <span class='comment'>*      2**-28 &lt;= x &lt;  1      : tanh(x) := -----; t = expm1(-2x)</span></td></tr>
<tr class="codeline" data-linenumber="2965"><td class="num" id="LN2965">2965</td><td class="line"> <span class='comment'>*                                         t + 2</span></td></tr>
<tr class="codeline" data-linenumber="2966"><td class="num" id="LN2966">2966</td><td class="line"> <span class='comment'>*                                               2</span></td></tr>
<tr class="codeline" data-linenumber="2967"><td class="num" id="LN2967">2967</td><td class="line"> <span class='comment'>*      1      &lt;= x &lt;  22     : tanh(x) := 1 - -----; t = expm1(2x)</span></td></tr>
<tr class="codeline" data-linenumber="2968"><td class="num" id="LN2968">2968</td><td class="line"> <span class='comment'>*                                             t + 2</span></td></tr>
<tr class="codeline" data-linenumber="2969"><td class="num" id="LN2969">2969</td><td class="line"> <span class='comment'>*      22     &lt;= x &lt;= INF    : tanh(x) := 1.</span></td></tr>
<tr class="codeline" data-linenumber="2970"><td class="num" id="LN2970">2970</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr class="codeline" data-linenumber="2971"><td class="num" id="LN2971">2971</td><td class="line"> <span class='comment'>* Special cases:</span></td></tr>
<tr class="codeline" data-linenumber="2972"><td class="num" id="LN2972">2972</td><td class="line"> <span class='comment'>*      tanh(NaN) is NaN;</span></td></tr>
<tr class="codeline" data-linenumber="2973"><td class="num" id="LN2973">2973</td><td class="line"> <span class='comment'>*      only tanh(0)=0 is exact for finite argument.</span></td></tr>
<tr class="codeline" data-linenumber="2974"><td class="num" id="LN2974">2974</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr class="codeline" data-linenumber="2975"><td class="num" id="LN2975">2975</td><td class="line"><span class='keyword'>double</span> tanh(<span class='keyword'>double</span> x) {</td></tr>
<tr class="codeline" data-linenumber="2976"><td class="num" id="LN2976">2976</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>volatile</span> <span class='keyword'>double</span> tiny = 1.0e-300;</td></tr>
<tr class="codeline" data-linenumber="2977"><td class="num" id="LN2977">2977</td><td class="line">  <span class='keyword'>static</span> <span class='keyword'>const</span> <span class='keyword'>double</span> one = 1.0, two = 2.0, huge = 1.0e300;</td></tr>
<tr class="codeline" data-linenumber="2978"><td class="num" id="LN2978">2978</td><td class="line">  <span class='keyword'>double</span> t, z;</td></tr>
<tr class="codeline" data-linenumber="2979"><td class="num" id="LN2979">2979</td><td class="line">  int32_t jx, ix;</td></tr>
<tr class="codeline" data-linenumber="2980"><td class="num" id="LN2980">2980</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2981"><td class="num" id="LN2981">2981</td><td class="line">  GET_HIGH_WORD(jx, x);</td></tr>
<tr class="codeline" data-linenumber="2982"><td class="num" id="LN2982">2982</td><td class="line">  ix = jx &amp; 0x7FFFFFFF;</td></tr>
<tr class="codeline" data-linenumber="2983"><td class="num" id="LN2983">2983</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2984"><td class="num" id="LN2984">2984</td><td class="line">  <span class='comment'>/* x is INF or NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2985"><td class="num" id="LN2985">2985</td><td class="line">  <span class='keyword'>if</span> (ix &gt;= 0x7FF00000) {</td></tr>
<tr class="codeline" data-linenumber="2986"><td class="num" id="LN2986">2986</td><td class="line">    <span class='keyword'>if</span> (jx &gt;= 0)</td></tr>
<tr class="codeline" data-linenumber="2987"><td class="num" id="LN2987">2987</td><td class="line">      <span class='keyword'>return</span> one / x + one; <span class='comment'>/* tanh(+-inf)=+-1 */</span></td></tr>
<tr class="codeline" data-linenumber="2988"><td class="num" id="LN2988">2988</td><td class="line">    <span class='keyword'>else</span></td></tr>
<tr class="codeline" data-linenumber="2989"><td class="num" id="LN2989">2989</td><td class="line">      <span class='keyword'>return</span> one / x - one; <span class='comment'>/* tanh(NaN) = NaN */</span></td></tr>
<tr class="codeline" data-linenumber="2990"><td class="num" id="LN2990">2990</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="2991"><td class="num" id="LN2991">2991</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="2992"><td class="num" id="LN2992">2992</td><td class="line">  <span class='comment'>/* |x| &lt; 22 */</span></td></tr>
<tr class="codeline" data-linenumber="2993"><td class="num" id="LN2993">2993</td><td class="line">  <span class='keyword'>if</span> (ix &lt; 0x40360000) {            <span class='comment'>/* |x|&lt;22 */</span></td></tr>
<tr class="codeline" data-linenumber="2994"><td class="num" id="LN2994">2994</td><td class="line">    <span class='keyword'>if</span> (ix &lt; 0x3E300000) {          <span class='comment'>/* |x|&lt;2**-28 */</span></td></tr>
<tr class="codeline" data-linenumber="2995"><td class="num" id="LN2995">2995</td><td class="line">      <span class='keyword'>if</span> (huge + x &gt; one) <span class='keyword'>return</span> x; <span class='comment'>/* tanh(tiny) = tiny with inexact */</span></td></tr>
<tr class="codeline" data-linenumber="2996"><td class="num" id="LN2996">2996</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="2997"><td class="num" id="LN2997">2997</td><td class="line">    <span class='keyword'>if</span> (ix &gt;= 0x3FF00000) { <span class='comment'>/* |x|&gt;=1  */</span></td></tr>
<tr class="codeline" data-linenumber="2998"><td class="num" id="LN2998">2998</td><td class="line">      t = expm1(two * fabs(x));</td></tr>
<tr class="codeline" data-linenumber="2999"><td class="num" id="LN2999">2999</td><td class="line">      z = one - two / (t + two);</td></tr>
<tr class="codeline" data-linenumber="3000"><td class="num" id="LN3000">3000</td><td class="line">    } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="3001"><td class="num" id="LN3001">3001</td><td class="line">      t = expm1(-two * fabs(x));</td></tr>
<tr class="codeline" data-linenumber="3002"><td class="num" id="LN3002">3002</td><td class="line">      z = -t / (t + two);</td></tr>
<tr class="codeline" data-linenumber="3003"><td class="num" id="LN3003">3003</td><td class="line">    }</td></tr>
<tr class="codeline" data-linenumber="3004"><td class="num" id="LN3004">3004</td><td class="line">    <span class='comment'>/* |x| &gt;= 22, return +-1 */</span></td></tr>
<tr class="codeline" data-linenumber="3005"><td class="num" id="LN3005">3005</td><td class="line">  } <span class='keyword'>else</span> {</td></tr>
<tr class="codeline" data-linenumber="3006"><td class="num" id="LN3006">3006</td><td class="line">    z = one - tiny; <span class='comment'>/* raise inexact flag */</span></td></tr>
<tr class="codeline" data-linenumber="3007"><td class="num" id="LN3007">3007</td><td class="line">  }</td></tr>
<tr class="codeline" data-linenumber="3008"><td class="num" id="LN3008">3008</td><td class="line">  <span class='keyword'>return</span> (jx &gt;= 0) ? z : -z;</td></tr>
<tr class="codeline" data-linenumber="3009"><td class="num" id="LN3009">3009</td><td class="line">}</td></tr>
<tr class="codeline" data-linenumber="3010"><td class="num" id="LN3010">3010</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="3011"><td class="num" id="LN3011">3011</td><td class="line"><span class='directive'>#undef EXTRACT_WORDS</span></td></tr>
<tr class="codeline" data-linenumber="3012"><td class="num" id="LN3012">3012</td><td class="line"><span class='directive'>#undef GET_HIGH_WORD</span></td></tr>
<tr class="codeline" data-linenumber="3013"><td class="num" id="LN3013">3013</td><td class="line"><span class='directive'>#undef GET_LOW_WORD</span></td></tr>
<tr class="codeline" data-linenumber="3014"><td class="num" id="LN3014">3014</td><td class="line"><span class='directive'>#undef INSERT_WORDS</span></td></tr>
<tr class="codeline" data-linenumber="3015"><td class="num" id="LN3015">3015</td><td class="line"><span class='directive'>#undef SET_HIGH_WORD</span></td></tr>
<tr class="codeline" data-linenumber="3016"><td class="num" id="LN3016">3016</td><td class="line"><span class='directive'>#undef SET_LOW_WORD</span></td></tr>
<tr class="codeline" data-linenumber="3017"><td class="num" id="LN3017">3017</td><td class="line"> </td></tr>
<tr class="codeline" data-linenumber="3018"><td class="num" id="LN3018">3018</td><td class="line">}  <span class='comment'>// namespace ieee754</span></td></tr>
<tr class="codeline" data-linenumber="3019"><td class="num" id="LN3019">3019</td><td class="line">}  <span class='comment'>// namespace base</span></td></tr>
<tr class="codeline" data-linenumber="3020"><td class="num" id="LN3020">3020</td><td class="line">}  <span class='comment'>// namespace v8</span></td></tr>
</table></body></html>
